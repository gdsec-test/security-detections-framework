{"id":"cf8b8940-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T15:57:38.699Z","updated_by":"admin","created_at":"2021-09-22T15:57:38.699Z","created_by":"admin","name":"Setuid / Setgid Bit Set via chmod [Duplicate]","tags":["Elastic","Host","Linux","macOS","Privilege Escalation","Threat Detection"],"interval":"5m","enabled":false,"description":"An adversary may add the setuid or setgid bit to a file or directory in order to run a file with the privileges of the owning user or group. An adversary can take advantage of this to either do a shell escape or exploit a vulnerability in an application with the setuid or setgid bit to get code running in a different userâ€™s context. Additionally, adversaries can use this mechanism on their own malware to make sure they're able to execute in elevated contexts in the future.","risk_score":21,"severity":"low","license":"Elastic License v2","output_index":".siem-signals-default","timestamp_override":"event.ingested","author":["Elastic"],"false_positives":[],"from":"now-9m","rule_id":"ae9633a8-0ff8-433e-ab90-1677c0bb024c","max_signals":33,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0004","name":"Privilege Escalation","reference":"https://attack.mitre.org/tactics/TA0004/"},"technique":[{"id":"T1548","name":"Abuse Elevation Control Mechanism","reference":"https://attack.mitre.org/techniques/T1548/","subtechnique":[{"id":"T1548.001","name":"Setuid and Setgid","reference":"https://attack.mitre.org/techniques/T1548/001/"}]}]},{"framework":"MITRE ATT&CK","tactic":{"id":"TA0003","name":"Persistence","reference":"https://attack.mitre.org/tactics/TA0003/"},"technique":[]}],"to":"now","references":[],"version":7,"exceptions_list":[],"immutable":false,"type":"query","language":"lucene","index":["auditbeat-*","logs-endpoint.events.*"],"query":"event.category:process AND event.type:(start OR process_started) AND process.name:chmod AND process.args:(\"+s\" OR \"u+s\" OR /4[0-9]{3}/ OR g+s OR /2[0-9]{3}/)","throttle":"no_actions","actions":[]}
