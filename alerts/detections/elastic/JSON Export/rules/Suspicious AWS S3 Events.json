{"id":"4287d4a0-90d3-11ec-b59d-e77f2674f157","updated_at":"2022-03-21T22:28:00.114Z","updated_by":"jprentice1@godaddy.com","created_at":"2022-02-18T15:55:58.052Z","created_by":"admin","name":"Suspicious AWS S3 Events","tags":["GD","Security"],"interval":"1h","enabled":true,"description":"based on splunk Suspicious AWS S3 Events rule logic. no hits searching over 7 days of historical data","risk_score":21,"severity":"low","license":"","output_index":".siem-signals-default","meta":{"from":"10m","kibana_siem_app_url":"https://security-prod.kibana.int.gdcorp.tools/app/security"},"author":[],"false_positives":[],"from":"now-4200s","rule_id":"9de0f03f-daa6-409a-abef-1764d6a91290","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[],"to":"now","references":[],"version":8,"exceptions_list":[],"immutable":false,"type":"query","language":"kuery","index":["*:aws-cloudtrail-*"],"query":"NOT ((aws.cloudtrail.user_identity.arn: arn\\:aws\\:iam\\:\\:*\\:user/GD-user-tanium-threat-response AND event.type: UploadPart*) OR (aws.cloudtrail.user_identity.arn: arn\\:aws\\:sts\\:\\:*\\:assumed-role/ServiceCatalogLaunchConstraintRole/servicecatalog AND source.address: \"AWS Internal\") OR (aws.cloudtrail.user_identity.arn: arn\\:aws\\:sts\\:\\:*\\:assumed-role/SC-*-BucketReplicationRole-*/s3-replication AND user.id: *\\:s3-replication AND source.address: \"AWS Internal\"))","filters":[{"$state":{"store":"appState"},"meta":{"negate":false,"alias":null,"disabled":false,"type":"phrases","params":["539225272086","763338924548","745293682974"],"key":"cloud.account.id"},"query":{"bool":{"should":[{"match_phrase":{"cloud.account.id":"539225272086"}},{"match_phrase":{"cloud.account.id":"763338924548"}},{"match_phrase":{"cloud.account.id":"745293682974"}}],"minimum_should_match":1}}},{"$state":{"store":"appState"},"meta":{"negate":false,"alias":null,"disabled":false,"type":"custom","value":"{\"bool\":{\"should\":[{\"wildcard\":{\"aws.cloudtrail.request_parameters\":{\"value\":\"*bucketName=gd-respstorag-*-forensic-storage*\"}}},{\"wildcard\":{\"aws.cloudtrail.request_parameters\":{\"value\":\"*bucketName=gd-respstorag-*-forensic-storage-replica*\"}}}],\"minimum_should_match\":1}}","key":"query"},"query":{"bool":{"should":[{"wildcard":{"aws.cloudtrail.request_parameters":{"value":"*bucketName=gd-respstorag-*-forensic-storage*"}}},{"wildcard":{"aws.cloudtrail.request_parameters":{"value":"*bucketName=gd-respstorag-*-forensic-storage-replica*"}}}],"minimum_should_match":1}}},{"$state":{"store":"appState"},"meta":{"negate":false,"alias":null,"disabled":false,"type":"custom","value":"{\"bool\":{\"should\":[{\"wildcard\":{\"event.action\":{\"value\":\"DeleteBucketPolicy\"}}},{\"wildcard\":{\"event.action\":{\"value\":\"DeleteBucket\"}}},{\"wildcard\":{\"event.action\":{\"value\":\"CreateBucketPolicy\"}}},{\"wildcard\":{\"event.action\":{\"value\":\"CreateBucket\"}}},{\"wildcard\":{\"event.action\":{\"value\":\"GetObject\"}}},{\"wildcard\":{\"event.action\":{\"value\":\"DeleteObjects\"}}},{\"wildcard\":{\"event.action\":{\"value\":\"PutObject*\"}}},{\"wildcard\":{\"event.action\":{\"value\":\"UploadPart*\"}}}],\"minimum_should_match\":1}}","key":"query"},"query":{"bool":{"should":[{"wildcard":{"event.action":{"value":"DeleteBucketPolicy"}}},{"wildcard":{"event.action":{"value":"DeleteBucket"}}},{"wildcard":{"event.action":{"value":"CreateBucketPolicy"}}},{"wildcard":{"event.action":{"value":"CreateBucket"}}},{"wildcard":{"event.action":{"value":"GetObject"}}},{"wildcard":{"event.action":{"value":"DeleteObjects"}}},{"wildcard":{"event.action":{"value":"PutObject*"}}},{"wildcard":{"event.action":{"value":"UploadPart*"}}}],"minimum_should_match":1}}}],"throttle":"rule","actions":[{"group":"default","id":"56fd1b40-5f85-11ec-9d1e-5b56ec0d9762","params":{"body":"{\n  \"short_description\": \"Suspicious AWS S3 Events (Storage Account)\",\n  \"assignment_group\": \"OPS-GCSO\",\n  \"category\": \"Unauthorized access\",\n  \"contact_type\": \"siem\",\n  \"description\": \"See following Info:\\nSuspicious AWS S3 Events (Storage Account)\\n\\n{{#context.alerts}}\\nStatus: {{Status}}\\nEnvironment: {{environment}}\\nAccount ID: {{cloud.account.id}}\\nUserType: {{aws.cloudtrail.user_identity.type}}\\nUser/Role: {{user.name}}\\nPrincipal ID: {{user.id}}\\nEvent: {{event.action}}\\nObject: {{aws.s3.object.key}}\\nsource.address: {{source.address}}\\n{{/context.alerts}}\\n\\nSee Process Here:\\nhttps://confluence.godaddy.com/pages/viewpage.action?pageId=214401824\",\n  \"priority\": \"1\",\n  \"severity\": \"2\",\n  \"state\": \"10\"\n}"},"action_type_id":".webhook"}]}
