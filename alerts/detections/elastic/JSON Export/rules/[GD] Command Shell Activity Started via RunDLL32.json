{"id":"d3d93880-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T16:00:33.889Z","updated_by":"admin","created_at":"2021-09-22T15:57:46.923Z","created_by":"admin","name":"[GD] Command Shell Activity Started via RunDLL32","tags":["Elastic","Execution","Host","Threat Detection","Windows"],"interval":"5m","enabled":false,"description":"Identifies command shell activity started via RunDLL32, which is commonly abused by attackers to host malicious code.","risk_score":21,"severity":"low","license":"Elastic License v2","output_index":".siem-signals-default","meta":{"from":"4m"},"timestamp_override":"event.ingested","author":["Elastic"],"false_positives":[],"from":"now-540s","rule_id":"6e0ec5b2-cfae-49e3-9936-a405ddf9f8dc","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","technique":[{"reference":"https://attack.mitre.org/techniques/T1059/","name":"Command and Scripting Interpreter","subtechnique":[{"reference":"https://attack.mitre.org/techniques/T1059/001/","name":"PowerShell","id":"T1059.001"}],"id":"T1059"}],"tactic":{"reference":"https://attack.mitre.org/tactics/TA0002/","name":"Execution","id":"TA0002"}}],"to":"now","references":[],"version":4,"exceptions_list":[],"immutable":false,"type":"eql","language":"eql","index":["windows-*"],"query":"process where event.type in (\"start\", \"process_started\") and\n process.name : (\"cmd.exe\", \"powershell.exe\") and\n  process.parent.name : \"rundll32.exe\" and \n  /* common FPs can be added here */\n  not process.parent.args : \"C:\\\\Windows\\\\System32\\\\SHELL32.dll,RunAsNewUser_RunDLL\"\n","filters":[],"throttle":"no_actions","actions":[]}
