{"id":"d1a40900-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T15:59:11.886Z","updated_by":"admin","created_at":"2021-09-22T15:57:42.868Z","created_by":"admin","name":"[GD] Microsoft Build Engine Started an Unusual Process","tags":["Defense Evasion","Elastic","Host","Threat Detection","Windows"],"interval":"5m","enabled":false,"description":"An instance of MSBuild, the Microsoft Build Engine, started a PowerShell script or the Visual C# Command Line Compiler. This technique is sometimes used to deploy a malicious payload using the Build Engine.","risk_score":21,"severity":"low","license":"Elastic License v2","output_index":".siem-signals-default","meta":{"from":"4m"},"timestamp_override":"event.ingested","author":["Elastic"],"false_positives":["The Build Engine is commonly used by Windows developers but use by non-engineers is unusual. If a build system triggers this rule it can be exempted by process, user or host name."],"from":"now-540s","rule_id":"ca6a8e8b-8a1f-4d97-aae3-412befe2ac04","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","technique":[{"reference":"https://attack.mitre.org/techniques/T1027/","name":"Obfuscated Files or Information","subtechnique":[{"reference":"https://attack.mitre.org/techniques/T1027/004/","name":"Compile After Delivery","id":"T1027.004"}],"id":"T1027"}],"tactic":{"reference":"https://attack.mitre.org/tactics/TA0005/","name":"Defense Evasion","id":"TA0005"}}],"to":"now","references":["https://blog.talosintelligence.com/2020/02/building-bypass-with-msbuild.html"],"version":8,"exceptions_list":[],"immutable":false,"type":"query","language":"kuery","index":["windows-*"],"query":"event.category:process and event.type:(start or process_started) and process.parent.name:MSBuild.exe and process.name:(csc.exe or iexplore.exe or powershell.exe)","filters":[],"throttle":"no_actions","actions":[]}
