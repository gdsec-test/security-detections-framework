{"id":"d3d78ad0-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T16:00:34.244Z","updated_by":"admin","created_at":"2021-09-22T15:57:46.897Z","created_by":"admin","name":"[GD] Execution from Unusual Directory - Command Line","tags":["Elastic","Execution","Host","Threat Detection","Windows"],"interval":"5m","enabled":false,"description":"Identifies process execution from suspicious default Windows directories. This may be abused by adversaries to hide malware in trusted paths.","risk_score":47,"severity":"medium","note":"This is related to the Process Execution from an Unusual Directory rule","license":"Elastic License v2","output_index":".siem-signals-default","meta":{"from":"4m"},"timestamp_override":"event.ingested","author":["Elastic"],"false_positives":[],"from":"now-540s","rule_id":"72bbb11e-4caa-4225-8913-bb0134c97245","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[],"to":"now","references":[],"version":4,"exceptions_list":[],"immutable":false,"type":"eql","language":"eql","index":["windows-*"],"query":"process where event.type in (\"start\", \"process_started\", \"info\") and\n process.name : (\"wscript.exe\",\"cscript.exe\",\"rundll32.exe\",\"regsvr32.exe\",\"cmstp.exe\",\"RegAsm.exe\",\"installutil.exe\",\"mshta.exe\",\"RegSvcs.exe\", \"powershell.exe\", \"pwsh.exe\", \"cmd.exe\") and\n /* add suspicious execution paths here */\nprocess.args : (\"C:\\\\PerfLogs\\\\*\",\"C:\\\\Users\\\\Public\\\\*\",\"C:\\\\Users\\\\Default\\\\*\",\"C:\\\\Windows\\\\Tasks\\\\*\",\"C:\\\\Intel\\\\*\", \"C:\\\\AMD\\\\Temp\\\\*\", \n \"C:\\\\Windows\\\\AppReadiness\\\\*\", \"C:\\\\Windows\\\\ServiceState\\\\*\",\"C:\\\\Windows\\\\security\\\\*\",\"C:\\\\Windows\\\\IdentityCRL\\\\*\",\"C:\\\\Windows\\\\Branding\\\\*\",\"C:\\\\Windows\\\\csc\\\\*\",\n \"C:\\\\Windows\\\\DigitalLocker\\\\*\",\"C:\\\\Windows\\\\en-US\\\\*\",\"C:\\\\Windows\\\\wlansvc\\\\*\",\"C:\\\\Windows\\\\Prefetch\\\\*\",\"C:\\\\Windows\\\\Fonts\\\\*\",\n \"C:\\\\Windows\\\\diagnostics\\\\*\",\"C:\\\\Windows\\\\TAPI\\\\*\",\"C:\\\\Windows\\\\INF\\\\*\",\"C:\\\\Windows\\\\System32\\\\Speech\\\\*\",\"C:\\\\windows\\\\tracing\\\\*\",\n \"c:\\\\windows\\\\IME\\\\*\",\"c:\\\\Windows\\\\Performance\\\\*\",\"c:\\\\windows\\\\intel\\\\*\",\"c:\\\\windows\\\\ms\\\\*\",\"C:\\\\Windows\\\\dot3svc\\\\*\",\"C:\\\\Windows\\\\ServiceProfiles\\\\*\",\n \"C:\\\\Windows\\\\panther\\\\*\",\"C:\\\\Windows\\\\RemotePackages\\\\*\",\"C:\\\\Windows\\\\OCR\\\\*\",\"C:\\\\Windows\\\\appcompat\\\\*\",\"C:\\\\Windows\\\\apppatch\\\\*\",\"C:\\\\Windows\\\\addins\\\\*\",\n \"C:\\\\Windows\\\\Setup\\\\*\",\"C:\\\\Windows\\\\Help\\\\*\",\"C:\\\\Windows\\\\SKB\\\\*\",\"C:\\\\Windows\\\\Vss\\\\*\",\"C:\\\\Windows\\\\Web\\\\*\",\"C:\\\\Windows\\\\servicing\\\\*\",\"C:\\\\Windows\\\\CbsTemp\\\\*\",\n \"C:\\\\Windows\\\\Logs\\\\*\",\"C:\\\\Windows\\\\WaaS\\\\*\",\"C:\\\\Windows\\\\twain_32\\\\*\",\"C:\\\\Windows\\\\ShellExperiences\\\\*\",\"C:\\\\Windows\\\\ShellComponents\\\\*\",\"C:\\\\Windows\\\\PLA\\\\*\",\n \"C:\\\\Windows\\\\Migration\\\\*\",\"C:\\\\Windows\\\\debug\\\\*\",\"C:\\\\Windows\\\\Cursors\\\\*\",\"C:\\\\Windows\\\\Containers\\\\*\",\"C:\\\\Windows\\\\Boot\\\\*\",\"C:\\\\Windows\\\\bcastdvr\\\\*\",\n \"C:\\\\Windows\\\\assembly\\\\*\",\"C:\\\\Windows\\\\TextInput\\\\*\",\"C:\\\\Windows\\\\security\\\\*\",\"C:\\\\Windows\\\\schemas\\\\*\",\"C:\\\\Windows\\\\SchCache\\\\*\",\"C:\\\\Windows\\\\Resources\\\\*\",\n \"C:\\\\Windows\\\\rescache\\\\*\",\"C:\\\\Windows\\\\Provisioning\\\\*\",\"C:\\\\Windows\\\\PrintDialog\\\\*\",\"C:\\\\Windows\\\\PolicyDefinitions\\\\*\",\"C:\\\\Windows\\\\media\\\\*\",\n \"C:\\\\Windows\\\\Globalization\\\\*\",\"C:\\\\Windows\\\\L2Schemas\\\\*\",\"C:\\\\Windows\\\\LiveKernelReports\\\\*\",\"C:\\\\Windows\\\\ModemLogs\\\\*\",\"C:\\\\Windows\\\\ImmersiveControlPanel\\\\*\",\n \"C:\\\\$Recycle.Bin\\\\*\")\n","filters":[],"throttle":"no_actions","actions":[]}
{"id":"d1b56e21-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T16:00:34.241Z","updated_by":"admin","created_at":"2021-09-22T15:57:42.886Z","created_by":"admin","name":"[GD] Unusual Network Activity from a Windows System Binary","tags":["Defense Evasion","Elastic","Host","Threat Detection","Windows"],"interval":"5m","enabled":false,"description":"Identifies network activity from unexpected system applications. This may indicate adversarial activity as these applications are often leveraged by adversaries to execute code and evade detection.","risk_score":21,"severity":"medium","license":"Elastic License v2","output_index":".siem-signals-default","meta":{"from":"4m"},"author":["Elastic"],"false_positives":[],"from":"now-540s","rule_id":"d4a94ce3-2b39-4af1-9ef4-3dde3ef53a45","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","technique":[{"reference":"https://attack.mitre.org/techniques/T1127/","name":"Trusted Developer Utilities Proxy Execution","subtechnique":[],"id":"T1127"}],"tactic":{"reference":"https://attack.mitre.org/tactics/TA0005/","name":"Defense Evasion","id":"TA0005"}}],"to":"now","references":[],"version":3,"exceptions_list":[],"immutable":false,"type":"eql","language":"eql","index":["windows-*"],"query":"sequence by process.entity_id with maxspan=5m\n  [process where event.type in (\"start\", \"process_started\") and\n\n     /* known applocker bypasses */\n     (process.name : \"bginfo.exe\" or\n      process.name : \"cdb.exe\" or\n      process.name : \"control.exe\" or\n      process.name : \"cmstp.exe\" or\n      process.name : \"csi.exe\" or\n      process.name : \"dnx.exe\" or\n      process.name : \"fsi.exe\" or\n      process.name : \"ieexec.exe\" or\n      process.name : \"iexpress.exe\" or\n      process.name : \"installutil.exe\" or\n      process.name : \"Microsoft.Workflow.Compiler.exe\" or\n      process.name : \"MSBuild.exe\" or\n      process.name : \"msdt.exe\" or\n      process.name : \"mshta.exe\" or\n      process.name : \"msiexec.exe\" or\n      process.name : \"msxsl.exe\" or\n      process.name : \"odbcconf.exe\" or\n      process.name : \"rcsi.exe\" or\n      process.name : \"regsvr32.exe\" or\n      process.name : \"xwizard.exe\")]\n  [network where\n     (process.name : \"bginfo.exe\" or\n      process.name : \"cdb.exe\" or\n      process.name : \"control.exe\" or\n      process.name : \"cmstp.exe\" or\n      process.name : \"csi.exe\" or\n      process.name : \"dnx.exe\" or\n      process.name : \"fsi.exe\" or\n      process.name : \"ieexec.exe\" or\n      process.name : \"iexpress.exe\" or\n      process.name : \"installutil.exe\" or\n      process.name : \"Microsoft.Workflow.Compiler.exe\" or\n      process.name : \"MSBuild.exe\" or\n      process.name : \"msdt.exe\" or\n      process.name : \"mshta.exe\" or\n      process.name : \"msiexec.exe\" or\n      process.name : \"msxsl.exe\" or\n      process.name : \"odbcconf.exe\" or\n      process.name : \"rcsi.exe\" or\n      process.name : \"regsvr32.exe\" or\n      process.name : \"xwizard.exe\")]\n","filters":[],"throttle":"no_actions","actions":[]}
{"id":"d1a45720-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T16:00:33.736Z","updated_by":"admin","created_at":"2021-09-22T15:57:42.862Z","created_by":"admin","name":"[GD] New ActiveSyncAllowedDeviceID Added via PowerShell","tags":["Collection","Elastic","Host","Threat Detection","Windows"],"interval":"5m","enabled":false,"description":"Identifies the use of the Exchange PowerShell cmdlet, Set-CASMailbox, to add a new ActiveSync allowed device. Adversaries may target user email to collect sensitive information.","risk_score":47,"severity":"medium","license":"Elastic License v2","output_index":".siem-signals-default","meta":{"from":"4m"},"timestamp_override":"event.ingested","author":["Elastic"],"false_positives":["Legitimate exchange system administration activity."],"from":"now-540s","rule_id":"d7cdfca2-234d-49bd-9eb1-1acf95e53c7a","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","technique":[{"reference":"https://attack.mitre.org/techniques/T1114/","name":"Email Collection","subtechnique":[],"id":"T1114"}],"tactic":{"reference":"https://attack.mitre.org/tactics/TA0009/","name":"Collection","id":"TA0009"}}],"to":"now","references":["https://www.volexity.com/blog/2020/12/14/dark-halo-leverages-solarwinds-compromise-to-breach-organizations/","https://docs.microsoft.com/en-us/powershell/module/exchange/set-casmailbox?view=exchange-ps"],"version":4,"exceptions_list":[],"immutable":false,"type":"eql","language":"eql","index":["windows-*"],"query":"process where event.type in (\"start\", \"process_started\") and\n  process.name: (\"powershell.exe\", \"pwsh.exe\") and process.args : \"Set-CASMailbox*ActiveSyncAllowedDeviceIDs*\"\n","filters":[],"throttle":"no_actions","actions":[]}
{"id":"95b33e30-37f5-11ec-a2aa-e9d655de077e","updated_at":"2022-03-03T20:46:04.632Z","updated_by":"schoi@godaddy.com","created_at":"2021-10-28T13:47:26.429Z","created_by":"admin","name":"[GD] Windows - EXE run from Share Drive","tags":["GD","Windows"],"interval":"20m","enabled":false,"description":"Test alert to identify a program running from a share folder on windows machines.","risk_score":47,"severity":"medium","license":"","output_index":".siem-signals-default","meta":{"from":"10m","kibana_siem_app_url":"https://827ebd6fd06146bea2d2ad3a453d7e43.vpce.gdw55e.elastic-cloud.com:9243/app/security"},"author":[],"false_positives":[],"from":"now-1800s","rule_id":"a4973ba9-5344-4404-a66f-87295379a74e","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","technique":[{"reference":"https://attack.mitre.org/techniques/T1204","name":"User Execution","subtechnique":[],"id":"T1204"},{"reference":"https://attack.mitre.org/techniques/T1053","name":"Scheduled Task/Job","subtechnique":[],"id":"T1053"}],"tactic":{"reference":"https://attack.mitre.org/tactics/TA0002","name":"Execution","id":"TA0002"}}],"to":"now","references":[],"version":4,"exceptions_list":[],"immutable":false,"type":"eql","language":"eql","index":["windows-*","GD-AWS-USA-GD-secesspmed-ESSP:windows-*"],"query":"sequence\n[ file where event.code == \"5140\" ] by winlog.event_data.SubjectUserName\n[ process where event.code == \"4688\" and winlog.event_data.TokenElevationType != \"%%1936\" ] by user.name ","filters":[],"throttle":"no_actions","actions":[]}
{"id":"cf8bb051-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T15:57:38.696Z","updated_by":"admin","created_at":"2021-09-22T15:57:38.696Z","created_by":"admin","name":"Creation of Hidden Files and Directories [Duplicate]","tags":["Defense Evasion","Elastic","Host","Linux","Threat Detection"],"interval":"5m","enabled":false,"description":"Users can mark specific files as hidden simply by putting a \".\" as the first character in the file or folder name. Adversaries can use this to their advantage to hide files and folders on the system for persistence and defense evasion. This rule looks for hidden files or folders in common writable directories.","risk_score":47,"severity":"medium","license":"Elastic License v2","output_index":".siem-signals-default","timestamp_override":"event.ingested","author":["Elastic"],"false_positives":["Certain tools may create hidden temporary files or directories upon installation or as part of their normal behavior. These events can be filtered by the process arguments, username, or process name values."],"from":"now-9m","rule_id":"d6feff96-f43f-4a38-8744-93808e08cddd","max_signals":33,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0005","name":"Defense Evasion","reference":"https://attack.mitre.org/tactics/TA0005/"},"technique":[{"id":"T1564","name":"Hide Artifacts","reference":"https://attack.mitre.org/techniques/T1564/","subtechnique":[{"id":"T1564.001","name":"Hidden Files and Directories","reference":"https://attack.mitre.org/techniques/T1564/001/"}]}]},{"framework":"MITRE ATT&CK","tactic":{"id":"TA0003","name":"Persistence","reference":"https://attack.mitre.org/tactics/TA0003/"},"technique":[]}],"to":"now","references":[],"version":6,"exceptions_list":[],"immutable":false,"type":"query","language":"lucene","index":["auditbeat-*","logs-endpoint.events.*"],"query":"event.category:process AND event.type:(start or process_started) AND process.working_directory:(\"/tmp\" or \"/var/tmp\" or \"/dev/shm\") AND process.args:/\\.[a-zA-Z0-9_\\-][a-zA-Z0-9_\\-\\.]{1,254}/ AND NOT process.name:(ls or find)","throttle":"no_actions","actions":[]}
{"id":"d1b239d1-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T15:59:30.247Z","updated_by":"admin","created_at":"2021-09-22T15:57:42.880Z","created_by":"admin","name":"[GD] Suspicious Cmd Execution via WMI","tags":["Elastic","Execution","Host","Threat Detection","Windows"],"interval":"5m","enabled":false,"description":"Identifies suspicious command execution (cmd) via Windows Management Instrumentation (WMI) on a remote host. This could be indicative of adversary lateral movement.","risk_score":47,"severity":"medium","license":"Elastic License v2","output_index":".siem-signals-default","meta":{"from":"4m"},"timestamp_override":"event.ingested","author":["Elastic"],"false_positives":[],"from":"now-540s","rule_id":"7249da25-3d31-4976-a685-0392a6d9281b","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","technique":[{"reference":"https://attack.mitre.org/techniques/T1047/","name":"Windows Management Instrumentation","subtechnique":[],"id":"T1047"}],"tactic":{"reference":"https://attack.mitre.org/tactics/TA0002/","name":"Execution","id":"TA0002"}}],"to":"now","references":[],"version":4,"exceptions_list":[],"immutable":false,"type":"eql","language":"eql","index":["windows-*"],"query":"process where event.type in (\"start\", \"process_started\") and\n process.parent.name : \"WmiPrvSE.exe\" and process.name : \"cmd.exe\" and\n process.args : \"\\\\\\\\127.0.0.1\\\\*\" and process.args : (\"2>&1\", \"1>\")\n","filters":[],"throttle":"no_actions","actions":[]}
{"id":"cf8a9ee0-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T15:57:38.666Z","updated_by":"admin","created_at":"2021-09-22T15:57:38.666Z","created_by":"admin","name":"Auditd Login from Forbidden Location [Duplicate]","tags":["Elastic","Host","Initial Access","Linux","Threat Detection"],"interval":"5m","enabled":false,"description":"Identifies that a login attempt has happened from a forbidden location.","risk_score":73,"severity":"high","license":"Elastic License v2","output_index":".siem-signals-default","timestamp_override":"event.ingested","author":["Elastic"],"false_positives":[],"from":"now-6m","rule_id":"e680864b-4539-4f5a-8e81-b0da2ccffd79","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0001","name":"Initial Access","reference":"https://attack.mitre.org/tactics/TA0001/"},"technique":[{"id":"T1078","name":"Valid Accounts","reference":"https://attack.mitre.org/techniques/T1078/"}]},{"framework":"MITRE ATT&CK","tactic":{"id":"TA0003","name":"Persistence","reference":"https://attack.mitre.org/tactics/TA0003/"},"technique":[{"id":"T1078","name":"Valid Accounts","reference":"https://attack.mitre.org/techniques/T1078/"}]}],"to":"now","references":["https://github.com/linux-pam/linux-pam/blob/aac5a8fdc4aa3f7e56335a6343774cc1b63b408d/modules/pam_access/pam_access.c#L412"],"version":1,"exceptions_list":[],"immutable":false,"type":"query","language":"kuery","index":["auditbeat-*"],"query":"event.module:auditd and event.action:\"attempted-log-in-from-unusual-place-to\"","throttle":"no_actions","actions":[]}
{"id":"d1b14f70-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T15:59:11.898Z","updated_by":"admin","created_at":"2021-09-22T15:57:42.868Z","created_by":"admin","name":"[GD] Windows Event Logs Cleared","tags":["Defense Evasion","Elastic","Host","Threat Detection","Windows"],"interval":"5m","enabled":false,"description":"Identifies attempts to clear Windows event log stores. This is often done by attackers in an attempt to evade detection or destroy forensic evidence on a system.","risk_score":21,"severity":"low","license":"Elastic License v2","output_index":".siem-signals-default","meta":{"from":"4m"},"timestamp_override":"event.ingested","author":["Elastic","Anabella Cristaldi"],"false_positives":[],"from":"now-540s","rule_id":"1a98b0bd-a4d1-41c4-821a-3c0b35f76aba","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","technique":[{"reference":"https://attack.mitre.org/techniques/T1070/","name":"Indicator Removal on Host","subtechnique":[],"id":"T1070"}],"tactic":{"reference":"https://attack.mitre.org/tactics/TA0005/","name":"Defense Evasion","id":"TA0005"}}],"to":"now","references":[],"version":2,"exceptions_list":[],"immutable":false,"type":"query","language":"kuery","index":["windows-*"],"query":"event.action:(\"audit-log-cleared\" or \"Log clear\")","filters":[],"throttle":"no_actions","actions":[]}
{"id":"cf8ce8d1-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T15:57:38.740Z","updated_by":"admin","created_at":"2021-09-22T15:57:38.740Z","created_by":"admin","name":"Unusual Windows Network Activity [Duplicate]","tags":["Elastic","Host","ML","Threat Detection","Windows"],"interval":"15m","enabled":false,"description":"Identifies Windows processes that do not usually use the network but have unexpected network activity, which can indicate command-and-control, lateral movement, persistence, or data exfiltration activity. A process with unusual network activity can denote process exploitation or injection, where the process is used to run persistence mechanisms that allow a malicious actor remote access or control of the host, data exfiltration, and execution of unauthorized network applications.","risk_score":21,"severity":"low","note":"### Investigating Unusual Network Activity ###\nDetection alerts from this rule indicate the presence of network activity from a Windows process for which network activity is very unusual.  Here are some possible avenues of investigation:\n- Consider the IP addresses, protocol and ports. Are these used by normal but infrequent network workflows? Are they expected or unexpected?\n- If the destination IP address is remote or external, does it associate with an expected domain, organization or geography? Note: avoid interacting directly with suspected malicious IP addresses.\n- Consider the user as identified by the username field. Is this network activity part of an expected workflow for the user who ran the program?\n- Examine the history of execution. If this process manifested only very recently, it might be part of a new software package. If it has a consistent cadence - for example if it runs monthly or quarterly - it might be part of a monthly or quarterly business process.\n- Examine the process arguments, title and working directory. These may provide indications as to the source of the program or the nature of the tasks it is performing.\n- Consider the same for the parent process. If the parent process is a legitimate system utility or service, this could be related to software updates or system management. If the parent process is something user-facing like an Office application, this process could be more suspicious.\n- If you have file hash values in the event data, and you suspect malware, you can optionally run a search for the file hash to see if the file is identified as malware by anti-malware tools.","license":"Elastic License v2","output_index":".siem-signals-default","author":["Elastic"],"false_positives":["A newly installed program or one that rarely uses the network could trigger this alert."],"from":"now-45m","rule_id":"5b1c252d-85ce-47e9-8db1-a1c8d43f7376","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[],"to":"now","references":["https://www.elastic.co/guide/en/security/current/prebuilt-ml-jobs.html"],"version":4,"exceptions_list":[],"immutable":false,"type":"machine_learning","anomaly_threshold":50,"machine_learning_job_id":["windows_anomalous_network_activity_ecs"],"throttle":"no_actions","actions":[]}
{"id":"d1b260e1-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T15:59:30.166Z","updated_by":"admin","created_at":"2021-09-22T15:57:42.891Z","created_by":"admin","name":"[GD] Potential Evasion via Filter Manager","tags":["Defense Evasion","Elastic","Host","Threat Detection","Windows"],"interval":"5m","enabled":false,"description":"The Filter Manager Control Program (fltMC.exe) binary may be abused by adversaries to unload a filter driver and evade defenses.","risk_score":21,"severity":"low","license":"Elastic License v2","output_index":".siem-signals-default","meta":{"from":"4m"},"timestamp_override":"event.ingested","author":["Elastic"],"false_positives":[],"from":"now-540s","rule_id":"544224a8-d5cf-41e1-aace-783231bc63f3","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","technique":[{"reference":"https://attack.mitre.org/techniques/T1222/","name":"File and Directory Permissions Modification","subtechnique":[],"id":"T1222"}],"tactic":{"reference":"https://attack.mitre.org/tactics/TA0005/","name":"Defense Evasion","id":"TA0005"}}],"to":"now","references":[],"version":7,"exceptions_list":[],"immutable":false,"type":"query","language":"kuery","index":["windows-*"],"query":"event.category:process and event.type:(start or process_started) and process.name:fltMC.exe","filters":[],"throttle":"no_actions","actions":[]}
{"id":"d647c781-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T16:00:34.079Z","updated_by":"admin","created_at":"2021-09-22T15:57:50.929Z","created_by":"admin","name":"[GD] Persistence via Update Orchestrator Service Hijack","tags":["Elastic","Host","Persistence","Threat Detection","Windows"],"interval":"5m","enabled":false,"description":"Identifies potential hijacking of the Microsoft Update Orchestrator Service to establish persistence with an integrity level of SYSTEM.","risk_score":73,"severity":"high","license":"Elastic License v2","output_index":".siem-signals-default","meta":{"from":"4m"},"timestamp_override":"event.ingested","author":["Elastic"],"false_positives":[],"from":"now-540s","rule_id":"47242894-ae1c-4ab3-a2d3-9c2695556db5","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","technique":[{"reference":"https://attack.mitre.org/techniques/T1543/","name":"Create or Modify System Process","subtechnique":[{"reference":"https://attack.mitre.org/techniques/T1543/003/","name":"Windows Service","id":"T1543.003"}],"id":"T1543"}],"tactic":{"reference":"https://attack.mitre.org/tactics/TA0003/","name":"Persistence","id":"TA0003"}}],"to":"now","references":["https://github.com/irsl/CVE-2020-1313"],"version":5,"exceptions_list":[],"immutable":false,"type":"eql","language":"eql","index":["windows-*"],"query":"process where event.type == \"start\" and\n  process.parent.executable : \"C:\\\\Windows\\\\System32\\\\svchost.exe\" and\n  process.parent.args : \"UsoSvc\" and\n  not process.executable :\n         (\n          \"C:\\\\Windows\\\\System32\\\\UsoClient.exe\",\n          \"C:\\\\Windows\\\\System32\\\\MusNotification.exe\",\n          \"C:\\\\Windows\\\\System32\\\\MusNotificationUx.exe\",\n          \"C:\\\\Windows\\\\System32\\\\MusNotifyIcon.exe\",\n          \"C:\\\\Windows\\\\System32\\\\WerFault.exe\",\n          \"C:\\\\Windows\\\\System32\\\\WerMgr.exe\"\n          )\n","filters":[],"throttle":"no_actions","actions":[]}
{"id":"d1b1c4a0-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T16:00:34.247Z","updated_by":"admin","created_at":"2021-09-22T15:57:42.888Z","created_by":"admin","name":"[GD] Suspicious Image Load (taskschd.dll) from MS Office","tags":["Elastic","Host","Persistence","Threat Detection","Windows"],"interval":"5m","enabled":false,"description":"Identifies a suspicious image load (taskschd.dll) from Microsoft Office processes. This behavior may indicate adversarial activity where a scheduled task is configured via Windows Component Object Model (COM). This technique can be used to configure persistence and evade monitoring by avoiding the usage of the traditional Windows binary (schtasks.exe) used to manage scheduled tasks.","risk_score":21,"severity":"low","license":"Elastic License v2","output_index":".siem-signals-default","meta":{"from":"4m"},"timestamp_override":"event.ingested","author":["Elastic"],"false_positives":[],"from":"now-540s","rule_id":"dc1ed87b-2607-41dd-968a-53cbc06c222c","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","technique":[{"reference":"https://attack.mitre.org/techniques/T1053/","name":"Scheduled Task/Job","subtechnique":[],"id":"T1053"}],"tactic":{"reference":"https://attack.mitre.org/tactics/TA0003/","name":"Persistence","id":"TA0003"}}],"to":"now","references":["https://medium.com/threatpunter/detecting-adversary-tradecraft-with-image-load-event-logging-and-eql-8de93338c16","https://www.clearskysec.com/wp-content/uploads/2020/10/Operation-Quicksand.pdf"],"version":4,"exceptions_list":[],"immutable":false,"type":"eql","language":"eql","index":["windows-*"],"query":"library where process.name : (\"WINWORD.EXE\", \"EXCEL.EXE\", \"POWERPNT.EXE\", \"MSPUB.EXE\", \"MSACCESS.EXE\") and\n  event.action : \"load\" and\n  event.category : \"library\" and\n  dll.name : \"taskschd.dll\"\n","filters":[],"throttle":"no_actions","actions":[]}
{"id":"d64815a0-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T16:00:33.279Z","updated_by":"admin","created_at":"2021-09-22T15:57:50.934Z","created_by":"admin","name":"[GD] AWS Access Secret in Secrets Manager","tags":["AWS","Cloud","Continuous Monitoring","Data Protection","Elastic","SecOps"],"interval":"10m","enabled":false,"description":"An adversary may attempt to access the secrets in secrets manager to steal certificates, credentials, or other sensitive material","risk_score":73,"severity":"high","note":"The AWS Filebeat module must be enabled to use this rule.","license":"Elastic License v2","output_index":".siem-signals-default","meta":{"from":"50m"},"timestamp_override":"event.ingested","author":["Nick Jones","Elastic"],"false_positives":["Verify whether the user identity, user agent, and/or hostname should be using GetSecretString API for the specified SecretId. If known behavior is causing false positives, it can be exempted from the rule."],"from":"now-3600s","rule_id":"7d338cf8-9054-4360-9fa6-c29d39b49a74","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","technique":[{"reference":"https://attack.mitre.org/techniques/T1528/","name":"Steal Application Access Token","subtechnique":[],"id":"T1528"}],"tactic":{"reference":"https://attack.mitre.org/tactics/TA0006/","name":"Credential Access","id":"TA0006"}}],"to":"now","references":["https://docs.aws.amazon.com/secretsmanager/latest/apireference/API_GetSecretValue.html","http://detectioninthe.cloud/credential_access/access_secret_in_secrets_manager/"],"version":5,"exceptions_list":[],"immutable":false,"type":"query","language":"kuery","index":["aws-config-*","aws-cloudtrail-*"],"query":"event.dataset:aws.cloudtrail and event.provider:secretsmanager.amazonaws.com and event.action:GetSecretValue","filters":[],"throttle":"no_actions","actions":[]}
{"id":"d6455680-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T16:00:33.312Z","updated_by":"admin","created_at":"2021-09-22T15:57:50.917Z","created_by":"admin","name":"[GD] Potential Credential Access via Windows Utilities","tags":["Credential Access","Elastic","Host","Threat Detection","Windows"],"interval":"5m","enabled":false,"description":"Identifies the execution of known Windows utilities often abused to dump LSASS memory or the Active Directory database (NTDS.dit) in preparation for credential access.","risk_score":73,"severity":"high","license":"Elastic License v2","output_index":".siem-signals-default","meta":{"from":"4m"},"timestamp_override":"event.ingested","author":["Elastic"],"false_positives":[],"from":"now-540s","rule_id":"cd45c075-ecbe-4527-97a6-08299ff92b68","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","technique":[{"reference":"https://attack.mitre.org/techniques/T1003/","name":"OS Credential Dumping","subtechnique":[],"id":"T1003"}],"tactic":{"reference":"https://attack.mitre.org/tactics/TA0006/","name":"Credential Access","id":"TA0006"}}],"to":"now","references":["https://lolbas-project.github.io/"],"version":4,"exceptions_list":[],"immutable":false,"type":"eql","language":"eql","index":["windows-*"],"query":"process where event.type in (\"start\", \"process_started\") and\n/* update here with any new lolbas with dump capability */\n(process.pe.original_file_name == \"procdump\" and process.args : \"-ma\") or\n(process.name : \"ProcessDump.exe\" and not process.parent.executable : \"C:\\\\Program Files*\\\\Cisco Systems\\\\*.exe\") or\n(process.pe.original_file_name == \"WriteMiniDump.exe\" and not process.parent.executable : \"C:\\\\Program Files*\\\\Steam\\\\*.exe\") or\n(process.pe.original_file_name == \"RUNDLL32.EXE\" and (process.args : \"MiniDump*\" or process.command_line : \"*comsvcs.dll*#24*\")) or\n(process.pe.original_file_name == \"RdrLeakDiag.exe\" and process.args : \"/fullmemdmp\") or\n(process.pe.original_file_name == \"SqlDumper.exe\" and process.args : \"0x01100*\") or\n(process.pe.original_file_name == \"TTTracer.exe\" and process.args : \"-dumpFull\" and process.args : \"-attach\") or\n(process.pe.original_file_name == \"ntdsutil.exe\" and process.args : \"create*full*\") or\n(process.pe.original_file_name == \"diskshadow.exe\" and process.args : \"/s\")\n","filters":[],"throttle":"no_actions","actions":[]}
{"id":"d648d8f1-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T16:00:33.327Z","updated_by":"admin","created_at":"2021-09-22T15:57:50.922Z","created_by":"admin","name":"[GD] AWS CloudWatch Alarm Deletion","tags":["AWS","Cloud","Continuous Monitoring","Elastic","Monitoring","SecOps"],"interval":"10m","enabled":false,"description":"Identifies the deletion of an AWS CloudWatch alarm. An adversary may delete alarms in an attempt to evade defenses.","risk_score":47,"severity":"medium","note":"The AWS Filebeat module must be enabled to use this rule.","license":"Elastic License v2","output_index":".siem-signals-default","meta":{"from":"50m"},"timestamp_override":"event.ingested","author":["Elastic"],"false_positives":["Verify whether the user identity, user agent, and/or hostname should be making changes in your environment. Alarm deletions from unfamiliar users or hosts should be investigated. If known behavior is causing false positives, it can be exempted from the rule."],"from":"now-3600s","rule_id":"cee1c48e-6616-451a-8739-949335b4e0a7","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","technique":[{"reference":"https://attack.mitre.org/techniques/T1562/","name":"Impair Defenses","subtechnique":[{"reference":"https://attack.mitre.org/techniques/T1562/001/","name":"Disable or Modify Tools","id":"T1562.001"}],"id":"T1562"}],"tactic":{"reference":"https://attack.mitre.org/tactics/TA0005/","name":"Defense Evasion","id":"TA0005"}}],"to":"now","references":["https://awscli.amazonaws.com/v2/documentation/api/latest/reference/cloudwatch/delete-alarms.html","https://docs.aws.amazon.com/AmazonCloudWatch/latest/APIReference/API_DeleteAlarms.html"],"version":6,"exceptions_list":[],"immutable":false,"type":"query","language":"kuery","index":["aws-config-*","aws-cloudtrail-*"],"query":"event.action:DeleteAlarms and event.dataset:aws.cloudtrail and event.provider:monitoring.amazonaws.com and event.outcome:success","filters":[],"throttle":"no_actions","actions":[]}
{"id":"d64ad4c0-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T16:00:33.331Z","updated_by":"admin","created_at":"2021-09-22T15:57:50.926Z","created_by":"admin","name":"[GD] AWS RDS Instance-Cluster Stoppage","tags":["Asset Visibility","AWS","Cloud","Continuous Monitoring","Elastic","SecOps"],"interval":"10m","enabled":false,"description":"Identifies that an Amazon Relational Database Service (RDS) cluster or instance has been stopped.","risk_score":47,"severity":"medium","note":"The AWS Filebeat module must be enabled to use this rule.","license":"Elastic License v2","output_index":".siem-signals-default","meta":{"from":"50m"},"timestamp_override":"event.ingested","author":["Elastic"],"false_positives":["Valid clusters or instances may be stopped by a system administrator. Verify whether the user identity, user agent, and/or hostname should be making changes in your environment. Cluster or instance stoppages from unfamiliar users or hosts should be investigated. If known behavior is causing false positives, it can be exempted from the rule."],"from":"now-3600s","rule_id":"383e67ec-c393-4e1a-905f-6bb5da3c5d12","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","technique":[{"reference":"https://attack.mitre.org/techniques/T1489/","name":"Service Stop","subtechnique":[],"id":"T1489"}],"tactic":{"reference":"https://attack.mitre.org/tactics/TA0040/","name":"Impact","id":"TA0040"}}],"to":"now","references":["https://awscli.amazonaws.com/v2/documentation/api/latest/reference/rds/stop-db-cluster.html","https://docs.aws.amazon.com/AmazonRDS/latest/APIReference/API_StopDBCluster.html","https://awscli.amazonaws.com/v2/documentation/api/latest/reference/rds/stop-db-instance.html","https://docs.aws.amazon.com/AmazonRDS/latest/APIReference/API_StopDBInstance.html"],"version":5,"exceptions_list":[],"immutable":false,"type":"query","language":"kuery","index":["aws-config-*","aws-cloudtrail-*"],"query":"event.action:(StopDBCluster or StopDBInstance) and event.dataset:aws.cloudtrail and event.provider:rds.amazonaws.com and event.outcome:success","filters":[],"throttle":"no_actions","actions":[]}
{"id":"d3d7b1e0-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T16:00:34.092Z","updated_by":"admin","created_at":"2021-09-22T15:57:46.903Z","created_by":"admin","name":"[GD] Persistence via TelemetryController Scheduled Task Hijack","tags":["Elastic","Host","Persistence","Threat Detection","Windows"],"interval":"5m","enabled":false,"description":"Detects the successful hijack of Microsoft Compatibility Appraiser scheduled task to establish persistence with an integrity level of system.","risk_score":73,"severity":"high","license":"Elastic License v2","output_index":".siem-signals-default","meta":{"from":"4m"},"timestamp_override":"event.ingested","author":["Elastic"],"false_positives":[],"from":"now-540s","rule_id":"416ebae3-c16e-4494-aec5-207ff58cb9d3","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","technique":[{"reference":"https://attack.mitre.org/techniques/T1053/","name":"Scheduled Task/Job","subtechnique":[],"id":"T1053"}],"tactic":{"reference":"https://attack.mitre.org/tactics/TA0003/","name":"Persistence","id":"TA0003"}}],"to":"now","references":["https://www.trustedsec.com/blog/abusing-windows-telemetry-for-persistence/?utm_content=131234033&utm_medium=social&utm_source=twitter&hss_channel=tw-403811306"],"version":5,"exceptions_list":[],"immutable":false,"type":"query","language":"kuery","index":["windows-*"],"query":"event.category:process and event.type:(start or process_started) and process.parent.name:(CompatTelRunner.exe or compattelrunner.exe) and process.args:-cv* and not process.name:(conhost.exe or DeviceCensus.exe or devicecensus.exe or CompatTelRunner.exe or compattelrunner.exe or DismHost.exe or dismhost.exe or rundll32.exe or powershell.exe)","filters":[],"throttle":"no_actions","actions":[]}
{"id":"d3d91170-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T15:59:47.225Z","updated_by":"admin","created_at":"2021-09-22T15:57:46.901Z","created_by":"admin","name":"[GD] Program Files Directory Masquerading","tags":["Defense Evasion","Elastic","Host","Threat Detection","Windows"],"interval":"5m","enabled":false,"description":"Identifies execution from a directory masquerading as the Windows Program Files directories. These paths are trusted and usually host trusted third party programs. An adversary may leverage masquerading, along with low privileges to bypass detections whitelisting those folders.","risk_score":47,"severity":"medium","license":"Elastic License v2","output_index":".siem-signals-default","meta":{"from":"4m"},"timestamp_override":"event.ingested","author":["Elastic"],"false_positives":[],"from":"now-540s","rule_id":"b1be788d-49af-467e-b6d5-c52a4efbce79","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","technique":[{"reference":"https://attack.mitre.org/techniques/T1036/","name":"Masquerading","subtechnique":[],"id":"T1036"}],"tactic":{"reference":"https://attack.mitre.org/tactics/TA0005/","name":"Defense Evasion","id":"TA0005"}}],"to":"now","references":[],"version":4,"exceptions_list":[],"immutable":false,"type":"eql","language":"eql","index":["windows-*"],"query":"process where event.type in (\"start\", \"process_started\", \"info\") and\n /* capture both fake program files directory in process executable as well as if passed in process args as a dll*/\n  process.args : (\"C:\\\\*Program*Files*\\\\*\", \"C:\\\\*Program*Files*\\\\*\") and\n  not process.args : (\"C:\\\\Program Files\\\\*\", \"C:\\\\Program Files (x86)\\\\*\")\n","filters":[],"throttle":"no_actions","actions":[]}
{"id":"d6492711-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T16:00:34.138Z","updated_by":"admin","created_at":"2021-09-22T15:57:50.925Z","created_by":"admin","name":"[GD] AWS CloudTrail Log Deleted","tags":["AWS","Cloud","Continuous Monitoring","Elastic","Log Auditing","SecOps"],"interval":"10m","enabled":false,"description":"Identifies the deletion of an AWS log trail. An adversary may delete trails in an attempt to evade defenses.","risk_score":47,"severity":"medium","note":"The AWS Filebeat module must be enabled to use this rule.","license":"Elastic License v2","output_index":".siem-signals-default","meta":{"from":"50m"},"timestamp_override":"event.ingested","author":["Elastic"],"false_positives":["Trail deletions may be made by a system or network administrator. Verify whether the user identity, user agent, and/or hostname should be making changes in your environment. Trail deletions from unfamiliar users or hosts should be investigated. If known behavior is causing false positives, it can be exempted from the rule."],"from":"now-3600s","rule_id":"3cee1d4f-ca72-4779-88d4-f84a1a92a894","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","technique":[{"reference":"https://attack.mitre.org/techniques/T1562/","name":"Impair Defenses","subtechnique":[{"reference":"https://attack.mitre.org/techniques/T1562/001/","name":"Disable or Modify Tools","id":"T1562.001"}],"id":"T1562"}],"tactic":{"reference":"https://attack.mitre.org/tactics/TA0005/","name":"Defense Evasion","id":"TA0005"}}],"to":"now","references":["https://docs.aws.amazon.com/awscloudtrail/latest/APIReference/API_DeleteTrail.html","https://awscli.amazonaws.com/v2/documentation/api/latest/reference/cloudtrail/delete-trail.html"],"version":6,"exceptions_list":[],"immutable":false,"type":"query","language":"kuery","index":["aws-config-*","aws-cloudtrail-*"],"query":"event.action:DeleteTrail and event.dataset:aws.cloudtrail and event.provider:cloudtrail.amazonaws.com and event.outcome:success","filters":[],"throttle":"no_actions","actions":[]}
{"id":"d1b287f2-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T16:00:32.725Z","updated_by":"admin","created_at":"2021-09-22T15:57:42.872Z","created_by":"admin","name":"[GD] Credential Acquisition via Registry Hive Dumping","tags":["Credential Access","Elastic","Host","Threat Detection","Windows"],"interval":"5m","enabled":false,"description":"Identifies attempts to export a registry hive which may contain credentials using the Windows reg.exe tool.","risk_score":73,"severity":"high","license":"Elastic License v2","output_index":".siem-signals-default","meta":{"from":"4m"},"timestamp_override":"event.ingested","author":["Elastic"],"false_positives":[],"from":"now-540s","rule_id":"28f7e733-c4c2-49a8-9b8d-d1af95e8ec3a","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","technique":[{"reference":"https://attack.mitre.org/techniques/T1003/","name":"OS Credential Dumping","subtechnique":[],"id":"T1003"}],"tactic":{"reference":"https://attack.mitre.org/tactics/TA0006/","name":"Credential Access","id":"TA0006"}}],"to":"now","references":["https://medium.com/threatpunter/detecting-attempts-to-steal-passwords-from-the-registry-7512674487f8"],"version":4,"exceptions_list":[],"immutable":false,"type":"eql","language":"eql","index":["windows-*"],"query":"process where event.type in (\"start\", \"process_started\") and\n process.pe.original_file_name == \"reg.exe\" and\n process.args : (\"save\", \"export\") and\n process.args : (\"hklm\\\\sam\", \"hklm\\\\security\")\n","filters":[],"throttle":"no_actions","actions":[]}
{"id":"d3d93881-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T16:00:34.140Z","updated_by":"admin","created_at":"2021-09-22T15:57:46.936Z","created_by":"admin","name":"[GD] Suspicious .NET Code Compilation","tags":["Defense Evasion","Elastic","Host","Threat Detection","Windows"],"interval":"5m","enabled":false,"description":"Identifies suspicious .NET code execution. connections.","risk_score":47,"severity":"medium","license":"Elastic License v2","output_index":".siem-signals-default","meta":{"from":"4m"},"timestamp_override":"event.ingested","author":["Elastic"],"false_positives":[],"from":"now-540s","rule_id":"8ec5cd28-1a0d-4dab-9660-7a526039d929","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","technique":[{"reference":"https://attack.mitre.org/techniques/T1055/","name":"Process Injection","subtechnique":[],"id":"T1055"}],"tactic":{"reference":"https://attack.mitre.org/tactics/TA0005/","name":"Defense Evasion","id":"TA0005"}}],"to":"now","references":[],"version":5,"exceptions_list":[],"immutable":false,"type":"eql","language":"eql","index":["windows-*"],"query":"process where event.type in (\"start\", \"process_started\") and\n  process.name : (\"csc.exe\", \"vbc.exe\") and\n  process.parent.name : (\"wscript.exe\", \"mshta.exe\", \"cscript.exe\", \"wmic.exe\", \"svchost.exe\", \"rundll32.exe\", \"cmstp.exe\", \"regsvr32.exe\")\n","filters":[],"throttle":"no_actions","actions":[]}
{"id":"d647ee90-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T16:00:34.192Z","updated_by":"admin","created_at":"2021-09-22T15:57:50.930Z","created_by":"admin","name":"[GD] AWS Root Login Without MFA","tags":["AWS","Cloud","Continuous Monitoring","Elastic","Identity and Access","SecOps"],"interval":"10m","enabled":false,"description":"Identifies attempts to login to AWS as the root user without using multi-factor authentication (MFA). Amazon AWS best practices indicate that the root user should be protected by MFA.","risk_score":73,"severity":"high","note":"The AWS Filebeat module must be enabled to use this rule.","license":"Elastic License v2","output_index":".siem-signals-default","meta":{"from":"50m"},"timestamp_override":"event.ingested","author":["Elastic"],"false_positives":["Some organizations allow login with the root user without MFA, however, this is not considered best practice by AWS and increases the risk of compromised credentials."],"from":"now-3600s","rule_id":"41716ef8-eb85-49d5-9dd2-5b8dc54650d4","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":" ATT&CK","technique":[{MITRE"reference":"https://attack.mitre.org/techniques/T1078/","name":"Valid Accounts","subtechnique":[],"id":"T1078"}],"tactic":{"reference":"https://attack.mitre.org/tactics/TA0004/","name":"Privilege Escalation","id":"TA0004"}}],"to":"now","references":["https://docs.aws.amazon.com/IAM/latest/UserGuide/id_root-user.html"],"version":5,"exceptions_list":[],"immutable":false,"type":"query","language":"kuery","index":["aws-config-*","aws-cloudtrail-*"],"query":"event.dataset:aws.cloudtrail and event.provider:signin.amazonaws.com and event.action:ConsoleLogin and aws.cloudtrail.user_identity.type:Root and aws.cloudtrail.console_login.additional_eventdata.mfa_used:false and event.outcome:success","filters":[],"throttle":"no_actions","actions":[]}
{"id":"398f9b30-6293-11ec-9d1e-5b56ec0d9762","updated_at":"2021-12-21T19:22:46.810Z","updated_by":"admin","created_at":"2021-12-21T19:21:40.712Z","created_by":"admin","name":"[GD] PCI - Detected Modification of Windows Firewall Rules","tags":["GD"],"interval":"30m","enabled":false,"description":"Waiting until pci_windows_* are ingested before enabling this detection\nThis rule performs actions of both Splunk Rules: PCI - Detected Modification of Windows Firewall Rules AND PCI - Windows Firewall Disabled","risk_score":42,"severity":"low","license":"","output_index":".siem-signals-default","meta":{"from":"1m","kibana_siem_app_url":"https://827ebd6fd06146bea2d2ad3a453d7e43.vpce.gdw55e.elastic-cloud.com:9243/app/security"},"author":[],"false_positives":[],"from":"now-1860s","rule_id":"dcd4e000-1c46-445e-902f-56bc10c968c7","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[],"to":"now","references":[],"version":2,"exceptions_list":[],"immutable":false,"type":"query","language":"kuery","index":["windows-*"],"query":"","filters":[{"meta":{"type":"phrases","key":"event.code","params":["4946","4947","4948","4950"],"alias":null,"negate":false,"disabled":false},"query":{"bool":{"should":[{"match_phrase":{"event.code":"4946"}},{"match_phrase":{"event.code":"4947"}},{"match_phrase":{"event.code":"4948"}},{"match_phrase":{"event.code":"4950"}}],"minimum_should_match":1}},"$state":{"store":"appState"}}],"throttle":"no_actions","actions":[]}
{"id":"cf8d0fe0-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T16:00:33.439Z","updated_by":"admin","created_at":"2021-09-22T15:57:39.721Z","created_by":"admin","name":"[GD] Suspicious RDP ActiveX Client Loaded","tags":["Elastic","Host","Lateral Movement","Threat Detection","Windows"],"interval":"5m","enabled":false,"description":"Identifies suspicious Image Loading of the Remote Desktop Services ActiveX Client (mstscax), this may indicate the presence of RDP lateral movement capability.","risk_score":47,"severity":"medium","license":"Elastic License v2","output_index":".siem-signals-default","meta":{"from":"4m"},"timestamp_override":"event.ingested","author":["Elastic"],"false_positives":[],"from":"now-540s","rule_id":"67efbc5b-932d-412f-ad20-70decd5a8742","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","technique":[{"reference":"https://attack.mitre.org/techniques/T1021/","name":"Remote Services","subtechnique":[],"id":"T1021"}],"tactic":{"reference":"https://attack.mitre.org/tactics/TA0008/","name":"Lateral Movement","id":"TA0008"}}],"to":"now","references":["https://posts.specterops.io/revisiting-remote-desktop-lateral-movement-8fb905cb46c3"],"version":4,"exceptions_list":[],"immutable":false,"type":"eql","language":"eql","index":["windows-*"],"query":"library where dll.name : \"mstscax.dll\" and\n   /* depending on noise in your env add here extra paths  */\n  process.executable :\n    (\n    \"C:\\\\Windows\\\\*\",\n    \"C:\\\\Users\\\\Public\\\\*\",\n    \"C:\\\\Users\\\\Default\\\\*\",\n    \"C:\\\\Intel\\\\*\",\n    \"C:\\\\PerfLogs\\\\*\",\n    \"C:\\\\ProgramData\\\\*\",\n    \"\\\\Device\\\\Mup\\\\*\",\n    \"\\\\\\\\*\"\n    ) and\n    /* add here FPs */\n  not process.executable : (\"C:\\\\Windows\\\\System32\\\\mstsc.exe\", \"C:\\\\Windows\\\\SysWOW64\\\\mstsc.exe\")\n","filters":[],"throttle":"no_actions","actions":[]}
{"id":"d3d763c0-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T16:00:34.216Z","updated_by":"admin","created_at":"2021-09-22T15:57:46.903Z","created_by":"admin","name":"[GD] Clearing Windows Event Logs","tags":["Defense Evasion","Elastic","Host","Threat Detection","Windows"],"interval":"5m","enabled":false,"description":"Identifies attempts to clear or disable Windows event log stores using Windows wevetutil command. This is often done by attackers in an attempt to evade detection or destroy forensic evidence on a system.","risk_score":21,"severity":"low","license":"Elastic License v2","output_index":".siem-signals-default","meta":{"from":"4m"},"timestamp_override":"event.ingested","author":["Elastic"],"false_positives":[],"from":"now-540s","rule_id":"f556b3b8-4f5f-4a93-ada8-ff5ff375ae6c","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","technique":[{"reference":"https://attack.mitre.org/techniques/T1070/","name":"Indicator Removal on Host","subtechnique":[],"id":"T1070"}],"tactic":{"reference":"https://attack.mitre.org/tactics/TA0005/","name":"Defense Evasion","id":"TA0005"}}],"to":"now","references":[],"version":9,"exceptions_list":[],"immutable":false,"type":"query","language":"kuery","index":["windows-*"],"query":"event.category:process and event.type:(process_started or start) and (process.name:\"wevtutil.exe\" or process.pe.original_file_name:\"wevtutil.exe\") and process.args:(\"/e:false\" or cl or \"clear-log\") or process.name:\"powershell.exe\" and process.args:\"Clear-EventLog\"","filters":[],"throttle":"no_actions","actions":[]}
{"id":"cf8d8510-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T15:57:38.736Z","updated_by":"admin","created_at":"2021-09-22T15:57:38.736Z","created_by":"admin","name":"Unusual Windows Service [Duplicate]","tags":["Elastic","Host","ML","Threat Detection","Windows"],"interval":"15m","enabled":false,"description":"A machine learning job detected an unusual Windows service, This can indicate execution of unauthorized services, malware, or persistence mechanisms. In corporate Windows environments, hosts do not generally run many rare or unique services. This job helps detect malware and persistence mechanisms that have been installed and run as a service.","risk_score":21,"severity":"low","license":"Elastic License v2","output_index":".siem-signals-default","author":["Elastic"],"false_positives":["A newly installed program or one that runs rarely as part of a monthly or quarterly workflow could trigger this alert."],"from":"now-45m","rule_id":"925adc73-5032-4969-9405-2bbef2fa15f2","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[],"to":"now","references":["https://www.elastic.co/guide/en/security/current/prebuilt-ml-jobs.html"],"version":4,"exceptions_list":[],"immutable":false,"type":"machine_learning","anomaly_threshold":50,"machine_learning_job_id":["windows_anomalous_service"],"throttle":"no_actions","actions":[]}
{"id":"d1a652f0-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T16:00:32.724Z","updated_by":"admin","created_at":"2021-09-22T15:57:42.864Z","created_by":"admin","name":"[GD] Process Execution from an Unusual Directory","tags":["Elastic","Execution","Host","Threat Detection","Windows"],"interval":"5m","enabled":false,"description":"Identifies process execution from suspicious default Windows directories. This is sometimes done by adversaries to hide malware in trusted paths.","risk_score":47,"severity":"medium","license":"Elastic License v2","output_index":".siem-signals-default","meta":{"from":"4m"},"timestamp_override":"event.ingested","author":["Elastic"],"false_positives":[],"from":"now-540s","rule_id":"cefaa8d1-8451-46d3-833d-f47f0677fc2c","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[],"to":"now","references":[],"version":4,"exceptions_list":[],"immutable":false,"type":"eql","language":"eql","index":["windows-*"],"query":"process where event.type in (\"start\", \"process_started\", \"info\") and\n /* add suspicious execution paths here */\nprocess.executable : (\"C:\\\\PerfLogs\\\\*.exe\",\"C:\\\\Users\\\\Public\\\\*.exe\",\"C:\\\\Users\\\\Default\\\\*.exe\",\"C:\\\\Windows\\\\Tasks\\\\*.exe\",\"C:\\\\Intel\\\\*.exe\",\"C:\\\\AMD\\\\Temp\\\\*.exe\",\"C:\\\\Windows\\\\AppReadiness\\\\*.exe\",\n\"C:\\\\Windows\\\\ServiceState\\\\*.exe\",\"C:\\\\Windows\\\\security\\\\*.exe\",\"C:\\\\Windows\\\\IdentityCRL\\\\*.exe\",\"C:\\\\Windows\\\\Branding\\\\*.exe\",\"C:\\\\Windows\\\\csc\\\\*.exe\",\n \"C:\\\\Windows\\\\DigitalLocker\\\\*.exe\",\"C:\\\\Windows\\\\en-US\\\\*.exe\",\"C:\\\\Windows\\\\wlansvc\\\\*.exe\",\"C:\\\\Windows\\\\Prefetch\\\\*.exe\",\"C:\\\\Windows\\\\Fonts\\\\*.exe\",\n \"C:\\\\Windows\\\\diagnostics\\\\*.exe\",\"C:\\\\Windows\\\\TAPI\\\\*.exe\",\"C:\\\\Windows\\\\INF\\\\*.exe\",\"C:\\\\Windows\\\\System32\\\\Speech\\\\*.exe\",\"C:\\\\windows\\\\tracing\\\\*.exe\",\n \"c:\\\\windows\\\\IME\\\\*.exe\",\"c:\\\\Windows\\\\Performance\\\\*.exe\",\"c:\\\\windows\\\\intel\\\\*.exe\",\"c:\\\\windows\\\\ms\\\\*.exe\",\"C:\\\\Windows\\\\dot3svc\\\\*.exe\",\"C:\\\\Windows\\\\ServiceProfiles\\\\*.exe\",\n \"C:\\\\Windows\\\\panther\\\\*.exe\",\"C:\\\\Windows\\\\RemotePackages\\\\*.exe\",\"C:\\\\Windows\\\\OCR\\\\*.exe\",\"C:\\\\Windows\\\\appcompat\\\\*.exe\",\"C:\\\\Windows\\\\apppatch\\\\*.exe\",\"C:\\\\Windows\\\\addins\\\\*.exe\",\n \"C:\\\\Windows\\\\Setup\\\\*.exe\",\"C:\\\\Windows\\\\Help\\\\*.exe\",\"C:\\\\Windows\\\\SKB\\\\*.exe\",\"C:\\\\Windows\\\\Vss\\\\*.exe\",\"C:\\\\Windows\\\\Web\\\\*.exe\",\"C:\\\\Windows\\\\servicing\\\\*.exe\",\"C:\\\\Windows\\\\CbsTemp\\\\*.exe\",\n \"C:\\\\Windows\\\\Logs\\\\*.exe\",\"C:\\\\Windows\\\\WaaS\\\\*.exe\",\"C:\\\\Windows\\\\twain_32\\\\*.exe\",\"C:\\\\Windows\\\\ShellExperiences\\\\*.exe\",\"C:\\\\Windows\\\\ShellComponents\\\\*.exe\",\"C:\\\\Windows\\\\PLA\\\\*.exe\",\n \"C:\\\\Windows\\\\Migration\\\\*.exe\",\"C:\\\\Windows\\\\debug\\\\*.exe\",\"C:\\\\Windows\\\\Cursors\\\\*.exe\",\"C:\\\\Windows\\\\Containers\\\\*.exe\",\"C:\\\\Windows\\\\Boot\\\\*.exe\",\"C:\\\\Windows\\\\bcastdvr\\\\*.exe\",\n \"C:\\\\Windows\\\\assembly\\\\*.exe\",\"C:\\\\Windows\\\\TextInput\\\\*.exe\",\"C:\\\\Windows\\\\security\\\\*.exe\",\"C:\\\\Windows\\\\schemas\\\\*.exe\",\"C:\\\\Windows\\\\SchCache\\\\*.exe\",\"C:\\\\Windows\\\\Resources\\\\*.exe\",\n \"C:\\\\Windows\\\\rescache\\\\*.exe\",\"C:\\\\Windows\\\\Provisioning\\\\*.exe\",\"C:\\\\Windows\\\\PrintDialog\\\\*.exe\",\"C:\\\\Windows\\\\PolicyDefinitions\\\\*.exe\",\"C:\\\\Windows\\\\media\\\\*.exe\",\n \"C:\\\\Windows\\\\Globalization\\\\*.exe\",\"C:\\\\Windows\\\\L2Schemas\\\\*.exe\",\"C:\\\\Windows\\\\LiveKernelReports\\\\*.exe\",\"C:\\\\Windows\\\\ModemLogs\\\\*.exe\",\"C:\\\\Windows\\\\ImmersiveControlPanel\\\\*.exe\") and\n not process.name : (\"SpeechUXWiz.exe\",\"SystemSettings.exe\",\"TrustedInstaller.exe\",\"PrintDialog.exe\",\"MpSigStub.exe\",\"LMS.exe\",\"mpam-*.exe\")\n /* uncomment once in winlogbeat */\n /* and not (process.code_signature.subject_name == \"Microsoft Corporation\" and process.code_signature.trusted == true) */\n","filters":[],"throttle":"no_actions","actions":[]}
{"id":"f64c2cf0-5917-11ec-8f3e-0bb4bad39cd8","updated_at":"2022-05-04T18:33:49.688Z","updated_by":"clopez1@godaddy.com","created_at":"2021-12-09T17:46:40.171Z","created_by":"admin","name":"Tanium-Detect","tags":["GD","Tanium"],"interval":"1h","enabled":false,"description":"Based on Splunk rule. *Note* Splunk rule also filters on  (NOT \"SEC0129734\" NOT \"Suspicious PowerShell Command Line,Beta\"). The \"Suspicious PowerShell Command Line,Beta\" alert has since been tuned in Tanium, so it has been removed from the Elastic filters.\nCurrently, parsing is broken, so we are filtering for \"tanium-signal\" from the message field. This should be updated to the correct field once parsing is eventually fixed.","risk_score":21,"severity":"low","license":"","output_index":".siem-signals-default","meta":{"from":"10m","kibana_siem_app_url":"https://security-prod.kibana.int.gdcorp.tools/app/security"},"author":[],"false_positives":[],"from":"now-4200s","rule_id":"492393b8-dbbd-4068-b83d-38f3c3ee774a","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[],"to":"now","references":[],"version":16,"exceptions_list":[],"immutable":false,"type":"query","language":"kuery","index":["*:tanium-*"],"query":"message:\"tanium-signal\" and NOT message:\"SEC0129734\"","filters":[],"throttle":"rule","actions":[{"group":"default","id":"56fd1b40-5f85-11ec-9d1e-5b56ec0d9762","params":{"body":"{\n  \"short_description\": \"Elastic Test - Tanium-Detect ({{state.signals_count}} alerts)\",\n  \"assignment_group\": \"OPS-GCSO\",\n  \"category\": \"Unauthorized access\",\n  \"contact_type\": \"siem\",\n  \"description\": \"An event occurred with the following events:\\n\\n{{#context.alerts}}\\n@timestamp: {{signal.original_time}}\\nevent.original: {{event.original}}\\ntanium.question: N/A at the moment in Elastic\\ntanium.Computer-Name: N/A at the moment in Elastic\\n{{/context.alerts}}\\n\\nFor additional details, the alert can be viewed here:\\n{{context.results_link}}\",\n  \"priority\": \"3\",\n  \"severity\": \"3\",\n  \"state\": \"10\"\n}"},"action_type_id":".webhook"}]}
{"id":"d64815a1-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T16:00:33.805Z","updated_by":"admin","created_at":"2021-09-22T15:57:50.923Z","created_by":"admin","name":"[GD] AWS CloudTrail Log Created","tags":["AWS","Cloud","Continuous Monitoring","Elastic","Log Auditing","SecOps"],"interval":"10m","enabled":false,"description":"Identifies the creation of an AWS log trail that specifies the settings for delivery of log data.","risk_score":21,"severity":"low","note":"The AWS Filebeat module must be enabled to use this rule.","license":"Elastic License v2","output_index":".siem-signals-default","meta":{"from":"50m"},"timestamp_override":"event.ingested","author":["Elastic"],"false_positives":["Trail creations may be made by a system or network administrator. Verify whether the user identity, user agent, and/or hostname should be making changes in your environment. Trail creations from unfamiliar users or hosts should be investigated. If known behavior is causing false positives, it can be exempted from the rule."],"from":"now-3600s","rule_id":"90056afa-0424-4260-9c13-84aeb859620e","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","technique":[{"reference":"https://attack.mitre.org/techniques/T1530/","name":"Data from Cloud Storage Object","subtechnique":[],"id":"T1530"}],"tactic":{"reference":"https://attack.mitre.org/tactics/TA0009/","name":"Collection","id":"TA0009"}}],"to":"now","references":["https://docs.aws.amazon.com/awscloudtrail/latest/APIReference/API_CreateTrail.html","https://awscli.amazonaws.com/v2/documentation/api/latest/reference/cloudtrail/create-trail.html"],"version":5,"exceptions_list":[],"immutable":false,"type":"query","language":"kuery","index":["aws-cloudtrail-*","aws-config-*"],"query":"event.action:CreateTrail and event.dataset:aws.cloudtrail and event.provider:cloudtrail.amazonaws.com and event.outcome:success","filters":[],"throttle":"no_actions","actions":[]}
{"id":"cf8b3b20-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T15:57:38.676Z","updated_by":"admin","created_at":"2021-09-22T15:57:38.676Z","created_by":"admin","name":"Unusual Process For a Windows Host [Duplicate]","tags":["Elastic","Host","ML","Threat Detection","Windows"],"interval":"15m","enabled":false,"description":"Identifies rare processes that do not usually run on individual hosts, which can indicate execution of unauthorized services, malware, or persistence mechanisms. Processes are considered rare when they only run occasionally as compared with other processes running on the host.","risk_score":21,"severity":"low","note":"### Investigating an Unusual Windows Process ###\nDetection alerts from this rule indicate the presence of a Windows process that is rare and unusual for the host it ran on. Here are some possible avenues of investigation:\n- Consider the user as identified by the username field. Is this program part of an expected workflow for the user who ran this program on this host?\n- Examine the history of execution. If this process manifested only very recently, it might be part of a new software package. If it has a consistent cadence - for example if it runs monthly or quarterly - it might be part of a monthly or quarterly business process.\n- Examine the process metadata like the values of the Company, Description and Product fields which may indicate whether the program is associated with an expected software vendor or package.\n- Examine arguments and working directory. These may provide indications as to the source of the program or the nature of the tasks it is performing.\n- Consider the same for the parent process. If the parent process is a legitimate system utility or service, this could be related to software updates or system management. If the parent process is something user-facing like an Office application, this process could be more suspicious.\n- If you have file hash values in the event data, and you suspect malware, you can optionally run a search for the file hash to see if the file is identified as malware by anti-malware tools. ","license":"Elastic License v2","output_index":".siem-signals-default","author":["Elastic"],"false_positives":["A newly installed program or one that runs rarely as part of a monthly or quarterly workflow could trigger this alert."],"from":"now-45m","rule_id":"03f3cdcb-5a89-4a4c-80b6-ecb8c4c83bb4","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[],"to":"now","references":["https://www.elastic.co/guide/en/security/current/prebuilt-ml-jobs.html"],"version":4,"exceptions_list":[],"immutable":false,"type":"machine_learning","anomaly_threshold":50,"machine_learning_job_id":["rare_process_by_host_windows_ecs"],"throttle":"no_actions","actions":[]}
{"id":"cf8cc1c0-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T15:57:38.721Z","updated_by":"admin","created_at":"2021-09-22T15:57:38.721Z","created_by":"admin","name":"Nping Process Activity [Duplicate]","tags":["Elastic","Host","Linux","Threat Detection"],"interval":"5m","enabled":false,"description":"Nping ran on a Linux host. Nping is part of the Nmap tool suite and has the ability to construct raw packets for a wide variety of security testing applications, including denial of service testing.","risk_score":47,"severity":"medium","license":"Elastic License v2","output_index":".siem-signals-default","timestamp_override":"event.ingested","author":["Elastic"],"false_positives":["Some normal use of this command may originate from security engineers and network or server administrators, but this is usually not routine or unannounced. Use of `Nping` by non-engineers or ordinary users is uncommon."],"from":"now-9m","rule_id":"1d9ada9d-b607-48fc-a669-b8b15aa23aac","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[],"to":"now","references":["https://en.wikipedia.org/wiki/Nmap"],"version":7,"exceptions_list":[],"immutable":false,"type":"query","language":"kuery","index":["auditbeat-*","logs-endpoint.events.*"],"query":"event.category:process and event.type:(start or process_started) and process.name:nping","throttle":"no_actions","actions":[]}
{"id":"d1a25b50-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T16:00:32.731Z","updated_by":"admin","created_at":"2021-09-22T15:57:42.865Z","created_by":"admin","name":"[GD] Microsoft Build Engine Started by an Office Application","tags":["Defense Evasion","Elastic","Host","Threat Detection","Windows"],"interval":"5m","enabled":false,"description":"An instance of MSBuild, the Microsoft Build Engine, was started by Excel or Word. This is unusual behavior for the Build Engine and could have been caused by an Excel or Word document executing a malicious script payload.","risk_score":73,"severity":"high","license":"Elastic License v2","output_index":".siem-signals-default","meta":{"from":"4m"},"timestamp_override":"event.ingested","author":["Elastic"],"false_positives":["The Build Engine is commonly used by Windows developers but use by non-engineers is unusual. It is quite unusual for this program to be started by an Office application like Word or Excel."],"from":"now-540s","rule_id":"8a2575fd-a464-4b8c-bebf-e03159c2c30a","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","technique":[{"reference":"https://attack.mitre.org/techniques/T1127/","name":"Trusted Developer Utilities Proxy Execution","subtechnique":[],"id":"T1127"}],"tactic":{"reference":"https://attack.mitre.org/tactics/TA0005/","name":"Defense Evasion","id":"TA0005"}},{"framework":"MITRE ATT&CK","technique":[],"tactic":{"reference":"https://attack.mitre.org/tactics/TA0002/","name":"Execution","id":"TA0002"}}],"to":"now","references":["https://blog.talosintelligence.com/2020/02/building-bypass-with-msbuild.html"],"version":8,"exceptions_list":[],"immutable":false,"type":"query","language":"kuery","index":["windows-*"],"query":"event.category:process and event.type:(start or process_started) and process.name:MSBuild.exe and process.parent.name:(eqnedt32.exe or excel.exe or fltldr.exe or msaccess.exe or mspub.exe or outlook.exe or powerpnt.exe or winword.exe)","filters":[],"throttle":"no_actions","actions":[]}
{"id":"d6457d91-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T16:00:32.795Z","updated_by":"admin","created_at":"2021-09-22T15:57:50.919Z","created_by":"admin","name":"[GD] UAC Bypass Attempt via Windows Directory Masquerading","tags":["Elastic","Host","Privilege Escalation","Threat Detection","Windows"],"interval":"5m","enabled":false,"description":"Identifies an attempt to bypass User Account Control (UAC) by masquerading as a Microsoft trusted Windows directory. Attackers may bypass UAC to stealthily execute code with elevated permissions.","risk_score":73,"severity":"high","license":"Elastic License v2","output_index":".siem-signals-default","meta":{"from":"4m"},"timestamp_override":"event.ingested","author":["Elastic"],"false_positives":[],"from":"now-540s","rule_id":"6acc2b29-26bd-443d-9d67-18fec685562a","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","technique":[{"reference":"https://attack.mitre.org/techniques/T1548/","name":"Abuse Elevation Control Mechanism","subtechnique":[{"reference":"https://attack.mitre.org/techniques/T1548/002/","name":"Bypass User Access Control","id":"T1548.002"}],"id":"T1548"}],"tactic":{"reference":"https://attack.mitre.org/tactics/TA0004/","name":"Privilege Escalation","id":"TA0004"}}],"to":"now","references":["https://medium.com/tenable-techblog/uac-bypass-by-mocking-trusted-directories-24a96675f6e"],"version":4,"exceptions_list":[],"immutable":false,"type":"eql","language":"eql","index":["windows-*"],"query":"process where event.type in (\"start\", \"process_started\") and\n  process.args : (\"C:\\\\Windows \\\\system32\\\\*.exe\", \"C:\\\\Windows \\\\SysWOW64\\\\*.exe\")\n","filters":[],"throttle":"no_actions","actions":[]}
{"id":"d1a45721-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T16:00:32.798Z","updated_by":"admin","created_at":"2021-09-22T15:57:42.862Z","created_by":"admin","name":"[GD] Peripheral Device Discovery","tags":["Discovery","Elastic","Host","Threat Detection","Windows"],"interval":"5m","enabled":false,"description":"Identifies use of the Windows file system utility (fsutil.exe ) to gather information about attached peripheral devices and components connected to a computer system.","risk_score":21,"severity":"low","license":"Elastic License v2","output_index":".siem-signals-default","meta":{"from":"4m"},"timestamp_override":"event.ingested","author":["Elastic"],"false_positives":[],"from":"now-540s","rule_id":"19e642ed-57ad-4322-82c8-a2e752eb7aca","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","technique":[{"reference":"https://attack.mitre.org/techniques/T1120/","name":"Peripheral Device Discovery","subtechnique":[],"id":"T1120"}],"tactic":{"reference":"https://attack.mitre.org/tactics/TA0007/","name":"Discovery","id":"TA0007"}}],"to":"now","references":[],"version":4,"exceptions_list":[],"immutable":false,"type":"eql","language":"eql","index":["windows-*"],"query":"process where event.type in (\"start\", \"process_started\") and\n  (process.name : \"fsutil.exe\" or process.pe.original_file_name == \"fsutil.exe\") and \n  process.args : \"fsinfo\" and process.args : \"drives\"\n","filters":[],"throttle":"no_actions","actions":[]}
{"id":"d645f2c1-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T16:00:33.092Z","updated_by":"admin","created_at":"2021-09-22T15:57:50.921Z","created_by":"admin","name":"[GD] AWS GuardDuty Detector Deletion","tags":["AWS","Cloud","Continuous Monitoring","Elastic","Monitoring","SecOps"],"interval":"10m","enabled":false,"description":"Identifies the deletion of an Amazon GuardDuty detector. Upon deletion, GuardDuty stops monitoring the environment and all existing findings are lost.","risk_score":73,"severity":"high","note":"The AWS Filebeat module must be enabled to use this rule.","license":"Elastic License v2","output_index":".siem-signals-default","meta":{"from":"50m"},"timestamp_override":"event.ingested","author":["Elastic"],"false_positives":["The GuardDuty detector may be deleted by a system or network administrator. Verify whether the user identity, user agent, and/or hostname should be making changes in your environment. Detector deletions from unfamiliar users or hosts should be investigated. If known behavior is causing false positives, it can be exempted from the rule."],"from":"now-3600s","rule_id":"3b153e3e-edf1-41f4-bede-687c44c6e163","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","technique":[{"reference":"https://attack.mitre.org/techniques/T1562/","name":"Impair Defenses","subtechnique":[{"reference":"https://attack.mitre.org/techniques/T1562/001/","name":"Disable or Modify Tools","id":"T1562.001"}],"id":"T1562"}],"tactic":{"reference":"https://attack.mitre.org/tactics/TA0005/","name":"Defense Evasion","id":"TA0005"}}],"to":"now","references":["https://awscli.amazonaws.com/v2/documentation/api/latest/reference/guardduty/delete-detector.html","https://docs.aws.amazon.com/guardduty/latest/APIReference/API_DeleteDetector.html"],"version":6,"exceptions_list":[],"immutable":false,"type":"query","language":"kuery","index":["aws-cloudtrail-*","aws-config-*"],"query":"event.action:DeleteDetector and event.dataset:aws.cloudtrail and event.provider:guardduty.amazonaws.com and event.outcome:success","filters":[],"throttle":"no_actions","actions":[]}
{"id":"d1a43010-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T16:00:33.093Z","updated_by":"admin","created_at":"2021-09-22T15:57:42.863Z","created_by":"admin","name":"[GD] Suspicious Zoom Child Process","tags":["Defense Evasion","Elastic","Host","Threat Detection","Windows"],"interval":"5m","enabled":false,"description":"A suspicious Zoom child process was detected, which may indicate an attempt to run unnoticed. Verify process details such as command line, network connections, file writes and associated file signature details as well.","risk_score":47,"severity":"medium","license":"Elastic License v2","output_index":".siem-signals-default","meta":{"from":"4m"},"timestamp_override":"event.ingested","author":["Elastic"],"false_positives":[],"from":"now-540s","rule_id":"84207fb6-194e-4685-95a6-20cd1f4a9d33","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","technique":[{"reference":"https://attack.mitre.org/techniques/T1036/","name":"Masquerading","subtechnique":[],"id":"T1036"},{"reference":"https://attack.mitre.org/techniques/T1055/","name":"Process Injection","subtechnique":[],"id":"T1055"}],"tactic":{"reference":"https://attack.mitre.org/tactics/TA0005/","name":"Defense Evasion","id":"TA0005"}}],"to":"now","references":[],"version":5,"exceptions_list":[],"immutable":false,"type":"eql","language":"eql","index":["windows-*"],"query":"process where event.type in (\"start\", \"process_started\", \"info\") and\n process.parent.name : \"Zoom.exe\" and process.name : (\"cmd.exe\", \"powershell.exe\", \"pwsh.exe\")\n","filters":[],"throttle":"no_actions","actions":[]}
{"id":"d1a3bae0-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T16:00:33.116Z","updated_by":"admin","created_at":"2021-09-22T15:57:42.869Z","created_by":"admin","name":"[GD] UAC Bypass via DiskCleanup Scheduled Task Hijack","tags":["Elastic","Host","Privilege Escalation","Threat Detection","Windows"],"interval":"5m","enabled":false,"description":"Identifies User Account Control (UAC) bypass via hijacking DiskCleanup Scheduled Task. Attackers bypass UAC to stealthily execute code with elevated permissions.","risk_score":47,"severity":"medium","license":"Elastic License v2","output_index":".siem-signals-default","meta":{"from":"4m"},"timestamp_override":"event.ingested","author":["Elastic"],"false_positives":[],"from":"now-540s","rule_id":"2e305d86-414b-4ec7-9536-50f6d7b157c0","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","technique":[{"reference":"https://attack.mitre.org/techniques/T1548/","name":"Abuse Elevation Control Mechanism","subtechnique":[{"reference":"https://attack.mitre.org/techniques/T1548/002/","name":"Bypass User Access Control","id":"T1548.002"}],"id":"T1548"}],"tactic":{"reference":"https://attack.mitre.org/tactics/TA0004/","name":"Privilege Escalation","id":"TA0004"}}],"to":"now","references":[],"version":5,"exceptions_list":[],"immutable":false,"type":"eql","language":"eql","index":["windows-*"],"query":"process where event.type in (\"start\", \"process_started\") and\nprocess.args:\"/autoclean\" and process.args:\"/d\" and\nnot process.executable : (\"C:\\\\Windows\\\\System32\\\\cleanmgr.exe\", \"C:\\\\Windows\\\\SysWOW64\\\\cleanmgr.exe\")\n","filters":[],"throttle":"no_actions","actions":[]}
{"id":"d6468f00-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T16:00:33.121Z","updated_by":"admin","created_at":"2021-09-22T15:57:50.920Z","created_by":"admin","name":"[GD] AWS Config Service Tampering","tags":["AWS","Cloud","Continuous Monitoring","Elastic","Monitoring","SecOps"],"interval":"10m","enabled":false,"description":"Identifies attempts to delete an AWS Config Service rule. An adversary may tamper with Config rules in order to reduce visibiltiy into the security posture of an account and / or its workload instances.","risk_score":47,"severity":"medium","note":"The AWS Filebeat module must be enabled to use this rule.","license":"Elastic License v2","output_index":".siem-signals-default","meta":{"from":"50m"},"timestamp_override":"event.ingested","author":["Elastic"],"false_positives":["Privileged IAM users with security responsibilities may be expected to make changes to the Config rules in order to align with local security policies and requirements. Automation, orchestration, and security tools may also make changes to the Config service, where they are used to automate setup or configuration of AWS accounts. Other kinds of user or service contexts do not commonly make changes to this service."],"from":"now-3600s","rule_id":"944041aa-a940-4259-b880-8b1fd973c39a","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","technique":[{"reference":"https://attack.mitre.org/techniques/T1562/","name":"Impair Defenses","subtechnique":[{"reference":"https://attack.mitre.org/techniques/T1562/001/","name":"Disable or Modify Tools","id":"T1562.001"}],"id":"T1562"}],"tactic":{"reference":"https://attack.mitre.org/tactics/TA0005/","name":"Defense Evasion","id":"TA0005"}}],"to":"now","references":["https://docs.aws.amazon.com/config/latest/developerguide/how-does-config-work.html","https://docs.aws.amazon.com/config/latest/APIReference/API_Operations.html"],"version":6,"exceptions_list":[],"immutable":false,"type":"query","language":"kuery","index":["aws-config-*","aws-cloudtrail-*"],"query":"event.dataset: aws.cloudtrail and event.action: DeleteConfigRule and event.provider: config.amazonaws.com","filters":[],"throttle":"no_actions","actions":[]}
{"id":"d6494e20-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T16:00:33.226Z","updated_by":"admin","created_at":"2021-09-22T15:57:50.935Z","created_by":"admin","name":"[GD] AWS CloudTrail Log Updated ","tags":["AWS","Cloud","Continuous Monitoring","Elastic","Log Auditing","SecOps"],"interval":"10m","enabled":false,"description":"Identifies an update to an AWS log trail setting that specifies the delivery of log files.","risk_score":21,"severity":"low","note":"The AWS Filebeat module must be enabled to use this rule.","license":"Elastic License v2","output_index":".siem-signals-default","meta":{"from":"50m"},"timestamp_override":"event.ingested","author":["Elastic"],"false_positives":["Trail updates may be made by a system or network administrator. Verify whether the user identity, user agent, and/or hostname should be making changes in your environment. Trail updates from unfamiliar users or hosts should be investigated. If known behavior is causing false positives, it can be exempted from the rule."],"from":"now-3600s","rule_id":"ef277254-3713-41f5-9d21-63ee8f787c7c","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","technique":[{"reference":"https://attack.mitre.org/techniques/T1565/","name":"Data Manipulation","subtechnique":[{"reference":"https://attack.mitre.org/techniques/T1565/001/","name":"Stored Data Manipulation","id":"T1565.001"}],"id":"T1565"}],"tactic":{"reference":"https://attack.mitre.org/tactics/TA0040/","name":"Impact","id":"TA0040"}},{"framework":"MITRE ATT&CK","technique":[{"reference":"https://attack.mitre.org/techniques/T1530/","name":"Data from Cloud Storage Object","subtechnique":[],"id":"T1530"}],"tactic":{"reference":"https://attack.mitre.org/tactics/TA0009/","name":"Collection","id":"TA0009"}}],"to":"now","references":["https://docs.aws.amazon.com/awscloudtrail/latest/APIReference/API_UpdateTrail.html","https://awscli.amazonaws.com/v2/documentation/api/latest/reference/cloudtrail/update-trail.html"],"version":6,"exceptions_list":[],"immutable":false,"type":"query","language":"kuery","index":["aws-config-*","aws-cloudtrail-*"],"query":"event.action:UpdateTrail and event.dataset:aws.cloudtrail and event.provider:cloudtrail.amazonaws.com and event.outcome:success","filters":[],"throttle":"no_actions","actions":[]}
{"id":"d6452f71-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T16:00:33.231Z","updated_by":"admin","created_at":"2021-09-22T15:57:50.914Z","created_by":"admin","name":"[GD] Enumeration of Administrator Accounts","tags":["Discovery","Elastic","Host","Threat Detection","Windows"],"interval":"5m","enabled":false,"description":"Identifies instances of lower privilege accounts enumerating Administrator accounts or groups using built-in Windows tools.","risk_score":21,"severity":"low","license":"Elastic License v2","output_index":".siem-signals-default","meta":{"from":"4m"},"timestamp_override":"event.ingested","author":["Elastic"],"false_positives":[],"from":"now-540s","rule_id":"9b158842-61a4-4ede-a40a-ea2c2890ef31","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","technique":[{"reference":"https://attack.mitre.org/techniques/T1069/","name":"Permission Groups Discovery","subtechnique":[],"id":"T1069"},{"reference":"https://attack.mitre.org/techniques/T1087/","name":"Account Discovery","subtechnique":[],"id":"T1087"}],"tactic":{"reference":"https://attack.mitre.org/tactics/TA0007/","name":"Discovery","id":"TA0007"}}],"to":"now","references":[],"version":4,"exceptions_list":[],"immutable":false,"type":"eql","language":"eql","index":["windows-*"],"query":"process where event.type in (\"start\", \"process_started\") and\n  (((process.name : \"net.exe\" or process.pe.original_file_name == \"net.exe\") or\n    ((process.name : \"net1.exe\" or process.pe.original_file_name == \"net1.exe\") and\n        not process.parent.name : \"net.exe\")) and\n   process.args : (\"group\", \"user\", \"localgroup\") and\n   process.args : (\"admin\", \"Domain Admins\", \"Remote Desktop Users\", \"Enterprise Admins\", \"Organization Management\") and\n   not process.args : \"/add\")\n\n   or\n\n  ((process.name : \"wmic.exe\" or process.pe.original_file_name == \"wmic.exe\") and\n     process.args : (\"group\", \"useraccount\"))\n","filters":[],"throttle":"no_actions","actions":[]}
{"id":"d648b1e1-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T16:00:33.229Z","updated_by":"admin","created_at":"2021-09-22T15:57:50.924Z","created_by":"admin","name":"[GD] Encrypting Files with WinRar or 7z","tags":["Collection","Elastic","Host","Threat Detection","Windows"],"interval":"5m","enabled":false,"description":"Identifies use of WinRar or 7z to create an encrypted files. Adversaries will often compress and encrypt data in preparation for exfiltration.","risk_score":47,"severity":"medium","license":"Elastic License v2","output_index":".siem-signals-default","meta":{"from":"4m"},"timestamp_override":"event.ingested","author":["Elastic"],"false_positives":[],"from":"now-540s","rule_id":"c2b69f94-d469-4731-8350-00ca1c8d994b","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","technique":[{"reference":"https://attack.mitre.org/techniques/T1560/","name":"Archive Collected Data","subtechnique":[],"id":"T1560"}],"tactic":{"reference":"https://attack.mitre.org/tactics/TA0009/","name":"Collection","id":"TA0009"}}],"to":"now","references":["https://www.welivesecurity.com/2020/12/02/turla-crutch-keeping-back-door-open/"],"version":5,"exceptions_list":[],"immutable":false,"type":"eql","language":"eql","index":["windows-*"],"query":"process where event.type in (\"start\", \"process_started\") and\n  ((process.name:\"rar.exe\" or process.code_signature.subject_name == \"win.rar GmbH\" or\n      process.pe.original_file_name == \"Command line RAR\") and\n    process.args == \"a\" and process.args : (\"-hp*\", \"-p*\", \"-dw\", \"-tb\", \"-ta\", \"/hp*\", \"/p*\", \"/dw\", \"/tb\", \"/ta\"))\n\n  or\n  (process.pe.original_file_name in (\"7z.exe\", \"7za.exe\") and\n     process.args == \"a\" and process.args : (\"-p*\", \"-sdel\"))\n\n  /* uncomment if noisy for backup software related FPs */\n  /* not process.parent.executable : (\"C:\\\\Program Files\\\\*.exe\", \"C:\\\\Program Files (x86)\\\\*.exe\") */\n","filters":[],"throttle":"no_actions","actions":[]}
{"id":"d1b239d0-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T16:00:32.704Z","updated_by":"admin","created_at":"2021-09-22T15:57:42.873Z","created_by":"admin","name":"[GD] Suspicious MS Office Child Process","tags":["Elastic","Host","Initial Access","Threat Detection","Windows"],"interval":"5m","enabled":false,"description":"Identifies suspicious child processes of frequently targeted Microsoft Office applications (Word, PowerPoint, Excel). These child processes are often launched during exploitation of Office applications or from documents with malicious macros.","risk_score":47,"severity":"medium","license":"Elastic License v2","output_index":".siem-signals-default","meta":{"from":"4m"},"timestamp_override":"event.ingested","author":["Elastic"],"false_positives":[],"from":"now-540s","rule_id":"2d7b858f-6bdd-4f8c-86d8-fd9dd4ee97e9","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","technique":[{"reference":"https://attack.mitre.org/techniques/T1566/","name":"Phishing","subtechnique":[{"reference":"https://attack.mitre.org/techniques/T1566/001/","name":"Spearphishing Attachment","id":"T1566.001"}],"id":"T1566"}],"tactic":{"reference":"https://attack.mitre.org/tactics/TA0001/","name":"Initial Access","id":"TA0001"}}],"to":"now","references":[],"version":9,"exceptions_list":[],"immutable":false,"type":"eql","language":"eql","index":["windows-*"],"query":"process where event.type in (\"start\", \"process_started\") and\n  process.parent.name : (\"eqnedt32.exe\", \"excel.exe\", \"fltldr.exe\", \"msaccess.exe\", \"mspub.exe\", \"powerpnt.exe\", \"winword.exe\") and\n  process.name : (\"Microsoft.Workflow.Compiler.exe\", \"arp.exe\", \"atbroker.exe\", \"bginfo.exe\", \"bitsadmin.exe\", \"cdb.exe\", \"certutil.exe\",\n                \"cmd.exe\", \"cmstp.exe\", \"cscript.exe\", \"csi.exe\", \"dnx.exe\", \"dsget.exe\", \"dsquery.exe\", \"forfiles.exe\", \"fsi.exe\",\n                \"ftp.exe\", \"gpresult.exe\", \"hostname.exe\", \"ieexec.exe\", \"iexpress.exe\", \"installutil.exe\", \"ipconfig.exe\", \"mshta.exe\",\n                \"msxsl.exe\", \"nbtstat.exe\", \"net.exe\", \"net1.exe\", \"netsh.exe\", \"netstat.exe\", \"nltest.exe\", \"odbcconf.exe\", \"ping.exe\",\n                \"powershell.exe\", \"pwsh.exe\", \"qprocess.exe\", \"quser.exe\", \"qwinsta.exe\", \"rcsi.exe\", \"reg.exe\", \"regasm.exe\", \"regsvcs.exe\",\n                \"regsvr32.exe\", \"sc.exe\", \"schtasks.exe\", \"systeminfo.exe\", \"tasklist.exe\", \"tracert.exe\", \"whoami.exe\",\n                \"wmic.exe\", \"wscript.exe\", \"xwizard.exe\", \"explorer.exe\", \"rundll32.exe\", \"hh.exe\")\n","filters":[],"throttle":"no_actions","actions":[]}
{"id":"d3d95f91-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T16:00:32.714Z","updated_by":"admin","created_at":"2021-09-22T15:57:46.914Z","created_by":"admin","name":"[GD] Trusted Developer Application Usage","tags":["Defense Evasion","Elastic","Host","Threat Detection","Windows"],"interval":"5m","enabled":false,"description":"Identifies possibly suspicious activity using trusted Windows developer activity.","risk_score":21,"severity":"low","license":"Elastic License v2","output_index":".siem-signals-default","meta":{"from":"4m"},"timestamp_override":"event.ingested","author":["Elastic"],"false_positives":["These programs may be used by Windows developers but use by non-engineers is unusual."],"from":"now-540s","rule_id":"e71693b7-3ad4-4f0b-93e2-c272246028e6","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","technique":[{"reference":"https://attack.mitre.org/techniques/T1127/","name":"Trusted Developer Utilities Proxy Execution","subtechnique":[],"id":"T1127"}],"tactic":{"reference":"https://attack.mitre.org/tactics/TA0005/","name":"Defense Evasion","id":"TA0005"}},{"framework":"MITRE ATT&CK","technique":[],"tactic":{"reference":"https://attack.mitre.org/tactics/TA0002/","name":"Execution","id":"TA0002"}}],"to":"now","references":[],"version":8,"exceptions_list":[],"immutable":false,"type":"query","language":"kuery","index":["windows-*"],"query":"event.category:process and event.type:(start or process_started) and process.name:(MSBuild.exe or msxsl.exe)","filters":[],"throttle":"no_actions","actions":[]}
{"id":"cf8c2581-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T16:00:32.715Z","updated_by":"admin","created_at":"2021-09-22T15:57:39.720Z","created_by":"admin","name":"[GD] Potential Cookies Theft via Browser Debugging","tags":["Credential Access","Elastic","Host","Linux","macOS","Threat Detection","Windows"],"interval":"5m","enabled":false,"description":"Identifies the execution of a Chromium based browser with the debugging process argument, which may indicate an attempt to steal authentication cookies. An adversary may steal web application or service session cookies and use them to gain access web applications or Internet services as an authenticated user without needing credentials.","risk_score":47,"severity":"medium","license":"Elastic License v2","output_index":".siem-signals-default","meta":{"from":"4m"},"timestamp_override":"event.ingested","author":["Elastic"],"false_positives":["Developers performing browsers plugin or extension debugging."],"from":"now-540s","rule_id":"7d5ddd02-fdd6-452d-a6fa-23bc47935021","max_signals":33,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","technique":[{"reference":"https://attack.mitre.org/techniques/T1539/","name":"Steal Web Session Cookie","subtechnique":[],"id":"T1539"}],"tactic":{"reference":"https://attack.mitre.org/tactics/TA0006/","name":"Credential Access","id":"TA0006"}}],"to":"now","references":["https://github.com/defaultnamehere/cookie_crimes","https://embracethered.com/blog/posts/2020/cookie-crimes-on-mirosoft-edge/","https://github.com/rapid7/metasploit-framework/blob/master/documentation/modules/post/multi/gather/chrome_cookies.md","https://posts.specterops.io/hands-in-the-cookie-jar-dumping-cookies-with-chromiums-remote-debugger-port-34c4f468844e"],"version":2,"exceptions_list":[],"immutable":false,"type":"eql","language":"eql","index":["windows-*"],"query":"process where event.type in (\"start\", \"process_started\", \"info\") and\n  process.name in (\n             \"Microsoft Edge\",\n             \"chrome.exe\",\n             \"Google Chrome\",\n             \"google-chrome-stable\",\n             \"google-chrome-beta\",\n             \"google-chrome\",\n             \"msedge.exe\") and\n   process.args : (\"--remote-debugging-port=*\", \n                   \"--remote-debugging-targets=*\",  \n                   \"--remote-debugging-pipe=*\") and\n   process.args : \"--user-data-dir=*\" and not process.args:\"--remote-debugging-port=0\"\n","filters":[],"throttle":"no_actions","actions":[]}
{"id":"d1a3e1f1-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T16:00:32.721Z","updated_by":"admin","created_at":"2021-09-22T15:57:42.861Z","created_by":"admin","name":"[GD] Enumeration Command Spawned via WMIPrvSE","tags":["Elastic","Execution","Host","Threat Detection","Windows"],"interval":"5m","enabled":false,"description":"Identifies native Windows host and network enumeration commands spawned by the Windows Management Instrumentation Provider Service (WMIPrvSE).","risk_score":21,"severity":"low","license":"Elastic License v2","output_index":".siem-signals-default","meta":{"from":"4m"},"timestamp_override":"event.ingested","author":["Elastic"],"false_positives":[],"from":"now-540s","rule_id":"9ff9880e-b427-429f-973a-a252eaa079ee","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","technique":[{"reference":"https://attack.mitre.org/techniques/T1047/","name":"Windows Management Instrumentation","subtechnique":[],"id":"T1047"}],"tactic":{"reference":"https://attack.mitre.org/tactics/TA0002/","name":"Execution","id":"TA0002"}}],"to":"now","references":[],"version":2,"exceptions_list":[],"immutable":false,"type":"eql","language":"eql","index":["windows-*"],"query":"process where event.type in (\"start\", \"process_started\") and\n  process.name:\n  (\n    \"arp.exe\",\n    \"dsquery.exe\",\n    \"dsget.exe\",\n    \"gpresult.exe\",\n    \"hostname.exe\",\n    \"ipconfig.exe\",\n    \"nbtstat.exe\",\n    \"net.exe\",\n    \"net1.exe\",\n    \"netsh.exe\",\n    \"netstat.exe\",\n    \"nltest.exe\",\n    \"ping.exe\",\n    \"qprocess.exe\",\n    \"quser.exe\",\n    \"qwinsta.exe\",\n    \"reg.exe\",\n    \"sc.exe\",\n    \"systeminfo.exe\",\n    \"tasklist.exe\",\n    \"tracert.exe\",\n    \"whoami.exe\"\n  ) and\n  process.parent.name:\"wmiprvse.exe\"\n","filters":[],"throttle":"no_actions","actions":[]}
{"id":"d3dae631-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T16:00:32.723Z","updated_by":"admin","created_at":"2021-09-22T15:57:46.924Z","created_by":"admin","name":"[GD] Suspicious DLL Loaded for Persistence or Privilege Escalation","tags":["Elastic","Host","Persistence","Privilege Escalation","Threat Detection","Windows"],"interval":"5m","enabled":false,"description":"Identifies the loading of a non Microsoft signed DLL that is missing on a default Windows install (phantom DLL) or one that can be loaded from a different location by a native Windows process. This may be abused to persist or elevate privileges via privileged file write vulnerabilities.","risk_score":73,"severity":"high","license":"Elastic License v2","output_index":".siem-signals-default","meta":{"from":"4m"},"timestamp_override":"event.ingested","author":["Elastic"],"false_positives":[],"from":"now-540s","rule_id":"f07f49fd-d625-44f1-87d5-a8e79801a39f","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","technique":[{"reference":"https://attack.mitre.org/techniques/T1574/","name":"Hijack Execution Flow","subtechnique":[{"reference":"https://attack.mitre.org/techniques/T1574/002/","name":"DLL Side-Loading","id":"T1574.002"}],"id":"T1574"}],"tactic":{"reference":"https://attack.mitre.org/tactics/TA0004/","name":"Privilege Escalation","id":"TA0004"}},{"framework":"MITRE ATT&CK","technique":[{"reference":"https://attack.mitre.org/techniques/T1574/","name":"Hijack Execution Flow","subtechnique":[{"reference":"https://attack.mitre.org/techniques/T1574/001/","name":"DLL Search Order Hijacking","id":"T1574.001"}],"id":"T1574"}],"tactic":{"reference":"https://attack.mitre.org/tactics/TA0003/","name":"Persistence","id":"TA0003"}}],"to":"now","references":["https://itm4n.github.io/windows-dll-hijacking-clarified/","http://remoteawesomethoughts.blogspot.com/2019/05/windows-10-task-schedulerservice.html","https://googleprojectzero.blogspot.com/2018/04/windows-exploitation-tricks-exploiting.html","https://shellz.club/edgegdi-dll-for-persistence-and-lateral-movement/","https://windows-internals.com/faxing-your-way-to-system/","http://waleedassar.blogspot.com/2013/01/wow64logdll.html"],"version":2,"exceptions_list":[],"immutable":false,"type":"eql","language":"eql","index":["windows-*"],"query":"library where dll.name :\n  (\n  \"wlbsctrl.dll\",\n  \"wbemcomn.dll\",\n  \"WptsExtensions.dll\",\n  \"Tsmsisrv.dll\",\n  \"TSVIPSrv.dll\",\n  \"Msfte.dll\",\n  \"wow64log.dll\",\n  \"WindowsCoreDeviceInfo.dll\",\n  \"Ualapi.dll\",\n  \"wlanhlp.dll\",\n  \"phoneinfo.dll\",\n  \"EdgeGdi.dll\",\n  \"cdpsgshims.dll\",\n  \"windowsperformancerecordercontrol.dll\",\n  \"diagtrack_win.dll\"\n  ) and \nnot (dll.code_signature.subject_name : \"Microsoft Windows\" and dll.code_signature.status : \"trusted\")\n","filters":[],"throttle":"no_actions","actions":[]}
{"id":"d6494e21-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T16:00:32.716Z","updated_by":"admin","created_at":"2021-09-22T15:57:50.927Z","created_by":"admin","name":"[GD] Remote System Discovery Commands","tags":["Discovery","Elastic","Host","Threat Detection","Windows"],"interval":"5m","enabled":false,"description":"Discovery of remote system information using built-in commands, which may be used to mover laterally.","risk_score":21,"severity":"low","license":"Elastic License v2","output_index":".siem-signals-default","meta":{"from":"4m"},"timestamp_override":"event.ingested","author":["Elastic"],"false_positives":[],"from":"now-540s","rule_id":"6cddbe6c-4d4e-4a47-824a-ef59d09b7d25","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","technique":[{"reference":"https://attack.mitre.org/techniques/T1018/","name":"Remote System Discovery","subtechnique":[],"id":"T1018"}],"tactic":{"reference":"https://attack.mitre.org/tactics/TA0007/","name":"Discovery","id":"TA0007"}}],"to":"now","references":[],"version":4,"exceptions_list":[],"immutable":false,"type":"eql","language":"eql","index":["windows-*"],"query":"process where event.type in (\"start\", \"process_started\") and\n  (process.name : \"nbtstat.exe\" and process.args : (\"-n\", \"-s\")) or\n  (process.name : \"arp.exe\" and process.args : \"-a\")\n","filters":[],"throttle":"no_actions","actions":[]}
{"id":"cd8272d0-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T15:57:35.240Z","updated_by":"admin","created_at":"2021-09-22T15:57:35.240Z","created_by":"admin","name":"Unusual Linux Network Port Activity [Duplicate]","tags":["Elastic","Host","Linux","ML","Threat Detection"],"interval":"15m","enabled":false,"description":"Identifies unusual destination port activity that can indicate command-and-control, persistence mechanism, or data exfiltration activity. Rarely used destination port activity is generally unusual in Linux fleets, and can indicate unauthorized access or threat actor activity.","risk_score":21,"severity":"low","license":"Elastic License v2","output_index":".siem-signals-default","author":["Elastic"],"false_positives":["A newly installed program or one that rarely uses the network could trigger this alert."],"from":"now-45m","rule_id":"8765b5ab-3776-441b-af5a-b7321501383c","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[],"to":"now","references":["https://www.elastic.co/guide/en/security/current/prebuilt-ml-jobs.html"],"version":4,"exceptions_list":[],"immutable":false,"type":"machine_learning","anomaly_threshold":50,"machine_learning_job_id":["linux_anomalous_network_port_activity_ecs"],"throttle":"no_actions","actions":[]}
{"id":"cf8a50c0-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T15:57:38.658Z","updated_by":"admin","created_at":"2021-09-22T15:57:38.658Z","created_by":"admin","name":"Potential Persistence via Cron Job [Duplicate]","tags":["Elastic","Host","Linux","macOS","Persistence","Threat Detection"],"interval":"5m","enabled":false,"description":"Identifies the creation or execution of a cron job. Adversaries may abuse cron jobs to perform task scheduling for initial or recurring execution of malicious code.","risk_score":21,"severity":"low","license":"Elastic License v2","output_index":".siem-signals-default","timestamp_override":"event.ingested","author":["Elastic"],"false_positives":["Legitimate software or scripts using cron jobs for recurring tasks."],"from":"now-9m","rule_id":"5990288d-724d-45e7-9262-fa34508b6749","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0003","name":"Persistence","reference":"https://attack.mitre.org/tactics/TA0003/"},"technique":[{"id":"T1053","name":"Scheduled Task/Job","reference":"https://attack.mitre.org/techniques/T1053/","subtechnique":[{"id":"T1053.003","name":"Cron","reference":"https://attack.mitre.org/techniques/T1053/003/"}]}]}],"to":"now","references":["https://archive.f-secure.com/weblog/archives/00002576.html","https://ss64.com/osx/crontab.html"],"version":1,"exceptions_list":[],"immutable":false,"type":"query","language":"kuery","index":["auditbeat-*","logs-endpoint.events.*"],"query":"event.category:process and event.type:(start or process_started or info) and not user.name:root and ((process.name:crontab and not process.args:(\"-l\" or \"-r\" or \"-e\" or \"-help\" or \"-h\")) or (process.parent.name:cron and not process.name:\"running job\" and not process.executable:(/Applications/Docker.app/Contents/Resources/bin/docker or /usr/bin/killall or /usr/sbin/sendmail or /usr/bin/env or /usr/bin/timeshift or /bin/rm)))","throttle":"no_actions","actions":[]}
{"id":"d3c7d360-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T15:59:47.296Z","updated_by":"admin","created_at":"2021-09-22T15:57:46.769Z","created_by":"admin","name":"[GD] Execution via TSClient Mountpoint","tags":["Elastic","Host","Lateral Movement","Threat Detection","Windows"],"interval":"5m","enabled":false,"description":"Identifies execution from the Remote Desktop Protocol (RDP) shared mountpoint tsclient on the target host. This may indicate a lateral movement attempt.","risk_score":73,"severity":"high","license":"Elastic License v2","output_index":".siem-signals-default","meta":{"from":"4m"},"timestamp_override":"event.ingested","author":["Elastic"],"false_positives":[],"from":"now-540s","rule_id":"41735558-0915-44a7-b016-052903eea264","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","technique":[{"reference":"https://attack.mitre.org/techniques/T1021/","name":"Remote Services","subtechnique":[],"id":"T1021"}],"tactic":{"reference":"https://attack.mitre.org/tactics/TA0008/","name":"Lateral Movement","id":"TA0008"}}],"to":"now","references":["https://posts.specterops.io/revisiting-remote-desktop-lateral-movement-8fb905cb46c3"],"version":4,"exceptions_list":[],"immutable":false,"type":"eql","language":"eql","index":["windows-*"],"query":"process where event.type in (\"start\", \"process_started\") and process.executable : \"\\\\Device\\\\Mup\\\\tsclient\\\\*.exe\"\n","filters":[],"throttle":"no_actions","actions":[]}
{"id":"d6497531-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T16:00:33.786Z","updated_by":"admin","created_at":"2021-09-22T15:57:50.925Z","created_by":"admin","name":"[GD] AWS CloudWatch Log Group Deletion","tags":["AWS","Cloud","Continuous Monitoring","Elastic","Log Auditing","SecOps"],"interval":"10m","enabled":false,"description":"Identifies the deletion of a specified AWS CloudWatch log group. When a log group is deleted, all the archived log events associated with the log group are also permanently deleted.","risk_score":47,"severity":"medium","note":"The AWS Filebeat module must be enabled to use this rule.","license":"Elastic License v2","output_index":".siem-signals-default","meta":{"from":"50m"},"timestamp_override":"event.ingested","author":["Elastic"],"false_positives":["Verify whether the user identity, user agent, and/or hostname should be making changes in your environment. Log group deletions from unfamiliar users or hosts should be investigated. If known behavior is causing false positives, it can be exempted from the rule."],"from":"now-3600s","rule_id":"c6d9bea7-a185-4f05-830d-15211bba1fa2","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","technique":[{"reference":"https://attack.mitre.org/techniques/T1485/","name":"Data Destruction","subtechnique":[],"id":"T1485"}],"tactic":{"reference":"https://attack.mitre.org/tactics/TA0040/","name":"Impact","id":"TA0040"}},{"framework":"MITRE ATT&CK","technique":[{"reference":"https://attack.mitre.org/techniques/T1562/","name":"Impair Defenses","subtechnique":[{"reference":"https://attack.mitre.org/techniques/T1562/001/","name":"Disable or Modify Tools","id":"T1562.001"}],"id":"T1562"}],"tactic":{"reference":"https://attack.mitre.org/tactics/TA0005/","name":"Defense Evasion","id":"TA0005"}}],"to":"now","references":["https://awscli.amazonaws.com/v2/documentation/api/latest/reference/logs/delete-log-group.html","https://docs.aws.amazon.com/AmazonCloudWatchLogs/latest/APIReference/API_DeleteLogGroup.html"],"version":6,"exceptions_list":[],"immutable":false,"type":"query","language":"kuery","index":["aws-cloudtrail-*","aws-config-*"],"query":"event.action:DeleteLogGroup and event.dataset:aws.cloudtrail and event.provider:logs.amazonaws.com and event.outcome:success","filters":[],"throttle":"no_actions","actions":[]}
{"id":"d1b287f1-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T16:00:33.795Z","updated_by":"admin","created_at":"2021-09-22T15:57:42.885Z","created_by":"admin","name":"[GD] Privilege Escalation via Named Pipe Impersonation","tags":["Elastic","Host","Privilege Escalation","Threat Detection","Windows"],"interval":"5m","enabled":false,"description":"Identifies a privilege escalation attempt via named pipe impersonation. An adversary may abuse this technique by utilizing a framework such Metasploit's meterpreter getsystem command.","risk_score":73,"severity":"high","license":"Elastic License v2","output_index":".siem-signals-default","meta":{"from":"4m"},"timestamp_override":"event.ingested","author":["Elastic"],"false_positives":[],"from":"now-540s","rule_id":"3ab9fa25-ef5f-4a1b-a0be-ba0564cf2a95","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","technique":[{"reference":"https://attack.mitre.org/techniques/T1134/","name":"Access Token Manipulation","subtechnique":[],"id":"T1134"}],"tactic":{"reference":"https://attack.mitre.org/tactics/TA0004/","name":"Privilege Escalation","id":"TA0004"}}],"to":"now","references":["https://www.ired.team/offensive-security/privilege-escalation/windows-namedpipes-privilege-escalation"],"version":4,"exceptions_list":[],"immutable":false,"type":"eql","language":"eql","index":["windows-*"],"query":"process where event.type in (\"start\", \"process_started\") and\n process.pe.original_file_name in (\"Cmd.Exe\", \"PowerShell.EXE\") and \n process.args : \"echo\" and process.args : \">\" and process.args : \"\\\\\\\\.\\\\pipe\\\\*\"\n","filters":[],"throttle":"no_actions","actions":[]}
{"id":"d3d9adb1-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T16:00:33.919Z","updated_by":"admin","created_at":"2021-09-22T15:57:46.922Z","created_by":"admin","name":"[GD] Local Scheduled Task Commands","tags":["Elastic","Host","Persistence","Threat Detection","Windows"],"interval":"5m","enabled":false,"description":"A scheduled task can be used by an adversary to establish persistence, move laterally, and/or escalate privileges.","risk_score":21,"severity":"low","license":"Elastic License v2","output_index":".siem-signals-default","meta":{"from":"4m"},"timestamp_override":"event.ingested","author":["Elastic"],"false_positives":["Legitimate scheduled tasks may be created during installation of new software."],"from":"now-540s","rule_id":"6e545423-e63a-4ce2-a9cc-0c271a2db4aa","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","technique":[{"reference":"https://attack.mitre.org/techniques/T1053/","name":"Scheduled Task/Job","subtechnique":[],"id":"T1053"}],"tactic":{"reference":"https://attack.mitre.org/tactics/TA0003/","name":"Persistence","id":"TA0003"}}],"to":"now","references":[],"version":8,"exceptions_list":[],"immutable":false,"type":"query","language":"kuery","index":["windows-*"],"query":"event.category:process and event.type:(start or process_started) and process.name:schtasks.exe and process.args:(-change or -create or -run or -s or /S or /change or /create or /run)","filters":[],"throttle":"no_actions","actions":[]}
{"id":"d645cbb1-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T16:00:33.921Z","updated_by":"admin","created_at":"2021-09-22T15:57:50.930Z","created_by":"admin","name":"[GD] AWS Management Console Root Login","tags":["AWS","Cloud","Continuous Monitoring","Elastic","Identity and Access","SecOps"],"interval":"10m","enabled":false,"description":"Identifies a successful login to the AWS Management Console by the Root user.","risk_score":73,"severity":"high","note":"The AWS Filebeat module must be enabled to use this rule.","license":"Elastic License v2","output_index":".siem-signals-default","meta":{"from":"50m"},"timestamp_override":"event.ingested","author":["Elastic"],"false_positives":["It's strongly recommended that the root user is not used for everyday tasks, including the administrative ones. Verify whether the IP address, location, and/or hostname should be logging in as root in your environment. Unfamiliar root logins should be investigated immediately. If known behavior is causing false positives, it can be exempted from the rule."],"from":"now-3600s","rule_id":"ee9ccce0-a8a4-4284-bf62-833ce275e93e","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","technique":[{"reference":"https://attack.mitre.org/techniques/T1078/","name":"Valid Accounts","subtechnique":[],"id":"T1078"}],"tactic":{"reference":"https://attack.mitre.org/tactics/TA0001/","name":"Initial Access","id":"TA0001"}},{"framework":"MITRE ATT&CK","technique":[{"reference":"https://attack.mitre.org/techniques/T1078/","name":"Valid Accounts","subtechnique":[],"id":"T1078"}],"tactic":{"reference":"https://attack.mitre.org/tactics/TA0003/","name":"Persistence","id":"TA0003"}}],"to":"now","references":["https://docs.aws.amazon.com/IAM/latest/UserGuide/id_root-user.html"],"version":5,"exceptions_list":[],"immutable":false,"type":"query","language":"kuery","index":["aws-cloudtrail-*","aws-config-*"],"query":"event.action:ConsoleLogin and event.dataset:aws.cloudtrail and event.provider:signin.amazonaws.com and aws.cloudtrail.user_identity.type:Root and event.outcome:success","filters":[],"throttle":"no_actions","actions":[]}
{"id":"d641d410-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T16:00:34.133Z","updated_by":"admin","created_at":"2021-09-22T15:57:50.914Z","created_by":"admin","name":"[GD] Potential Application Shimming via Sdbinst","tags":["Elastic","Host","Persistence","Threat Detection","Windows"],"interval":"5m","enabled":false,"description":"The Application Shim was created to allow for backward compatibility of software as the operating system codebase changes over time. This Windows functionality has been abused by attackers to stealthily gain persistence and arbitrary code execution in legitimate Windows processes.","risk_score":21,"severity":"low","license":"Elastic License v2","output_index":".siem-signals-default","meta":{"from":"4m"},"timestamp_override":"event.ingested","author":["Elastic"],"false_positives":[],"from":"now-540s","rule_id":"18c7440b-6257-4707-a73a-7b7fcec9a272","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","technique":[{"reference":"https://attack.mitre.org/techniques/T1546/","name":"Event Triggered Execution","subtechnique":[{"reference":"https://attack.mitre.org/techniques/T1546/011/","name":"Application Shimming","id":"T1546.011"}],"id":"T1546"}],"tactic":{"reference":"https://attack.mitre.org/tactics/TA0003/","name":"Persistence","id":"TA0003"}},{"framework":"MITRE ATT&CK","technique":[{"reference":"https://attack.mitre.org/techniques/T1546/","name":"Event Triggered Execution","subtechnique":[{"reference":"https://attack.mitre.org/techniques/T1546/011/","name":"Application Shimming","id":"T1546.011"}],"id":"T1546"}],"tactic":{"reference":"https://attack.mitre.org/tactics/TA0004/","name":"Privilege Escalation","id":"TA0004"}}],"to":"now","references":[],"version":8,"exceptions_list":[],"immutable":false,"type":"query","language":"kuery","index":["windows-*"],"query":"event.category:process and event.type:(start or process_started) and process.name:sdbinst.exe","filters":[],"throttle":"no_actions","actions":[]}
{"id":"d82e88e0-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T16:01:21.600Z","updated_by":"admin","created_at":"2021-09-22T15:57:53.944Z","created_by":"admin","name":"[GD] Attempt to Modify an Okta Network Zone","tags":["Continuous Monitoring","Elastic","Identity","Network Security","Okta","SecOps"],"interval":"5m","enabled":false,"description":"Detects attempts to modify an Okta network zone. Okta network zones can be configured to limit or restrict access to a network based on IP addresses or geolocations. An adversary may attempt to modify, delete, or deactivate an Okta network zone in order to remove or weaken an organization's security controls.","risk_score":47,"severity":"medium","note":"The Okta Fleet integration or Filebeat module must be enabled to use this rule.","license":"Elastic License v2","output_index":".siem-signals-default","meta":{"from":"1m"},"timestamp_override":"event.ingested","author":["Elastic"],"false_positives":["Consider adding exceptions to this rule to filter false positives if Oyour organization's Okta network zones are regularly modified."],"from":"now-360s","rule_id":"e9d1c573-8b3b-4b24-a35c-76ae14cb7eff","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[],"to":"now","references":["https://help.okta.com/en/prod/Content/Topics/Security/network/network-zones.htm","https://developer.okta.com/docs/reference/api/system-log/","https://developer.okta.com/docs/reference/api/event-types/"],"version":6,"exceptions_list":[],"immutable":false,"type":"query","language":"kuery","index":["okta-*"],"query":"event.dataset:okta.system and event.action:(zone.update or network_zone.rule.disabled or zone.remove_blacklist)","filters":[],"throttle":"no_actions","actions":[]}
{"id":"d1b1ebb1-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T16:00:33.814Z","updated_by":"admin","created_at":"2021-09-22T15:57:42.863Z","created_by":"admin","name":"[GD] Windows Suspicious Script Object Execution","tags":["Defense Evasion","Elastic","Host","Threat Detection","Windows"],"interval":"5m","enabled":false,"description":"Identifies scrobj.dll loaded into unusual Microsoft processes. This usually means a malicious scriptlet is being executed in the target process.","risk_score":21,"severity":"medium","license":"Elastic License v2","output_index":".siem-signals-default","meta":{"from":"4m"},"author":["Elastic"],"false_positives":[],"from":"now-540s","rule_id":"4dd4ea6e-aefd-4bfd-8580-f0dbeaff6267","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","technique":[],"tactic":{"reference":"https://attack.mitre.org/tactics/TA0005/","name":"Defense Evasion","id":"TA0005"}}],"to":"now","references":[],"version":4,"exceptions_list":[],"immutable":false,"type":"eql","language":"eql","index":["windows-*"],"query":"/* add winlogbeat-* when process.code_signature.* fields are populated */\n\nsequence by process.entity_id with maxspan = 2m\n  [process where event.type in (\"start\", \"process_started\") and\n     /* uncomment once in winlogbeat */\n     /* process.code_signature.subject_name : \"Microsoft Corporation\" and process.code_signature.trusted : true and */\n     not process.name : (\n       \"cscript.exe\",\n       \"iexplore.exe\",\n       \"MicrosoftEdge.exe\",\n       \"msiexec.exe\",\n       \"smartscreen.exe\",\n       \"taskhostw.exe\",\n       \"w3wp.exe\",\n       \"wscript.exe\")]\n  [library where event.type == \"start\" and dll.name : \"scrobj.dll\"]\n","filters":[],"throttle":"no_actions","actions":[]}
{"id":"d1a40901-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T16:00:33.927Z","updated_by":"admin","created_at":"2021-09-22T15:57:42.869Z","created_by":"admin","name":"[GD] Process Discovery via Tasklist","tags":["Discovery","Elastic","Host","Threat Detection","Windows"],"interval":"5m","enabled":false,"description":"Adversaries may attempt to get information about running processes on a system.","risk_score":21,"severity":"low","license":"Elastic License v2","output_index":".siem-signals-default","meta":{"from":"4m"},"timestamp_override":"event.ingested","author":["Elastic"],"false_positives":["Administrators may use the tasklist command to display a list of currently running processes. By itself, it does not indicate malicious activity. After obtaining a foothold, it's possible adversaries may use discovery commands like tasklist to get information about running processes."],"from":"now-540s","rule_id":"5464835e-3f52-4bd1-a822-29098abffa07","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","technique":[{"reference":"https://attack.mitre.org/techniques/T1057/","name":"Process Discovery","subtechnique":[],"id":"T1057"}],"tactic":{"reference":"https://attack.mitre.org/tactics/TA0007/","name":"Discovery","id":"TA0007"}}],"to":"now","references":[],"version":7,"exceptions_list":[],"immutable":false,"type":"query","language":"kuery","index":["windows-*"],"query":"event.category:process and event.type:(start or process_started) and process.name:tasklist.exe","filters":[],"throttle":"no_actions","actions":[]}
{"id":"d1a3e1f0-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T16:00:33.926Z","updated_by":"admin","created_at":"2021-09-22T15:57:42.875Z","created_by":"admin","name":"[GD] User Added to Privileged Group in Active Directory","tags":["Elastic","Host","Persistence","Threat Detection","Windows"],"interval":"5m","enabled":false,"description":"Identifies a user being added to a privileged group in Active Directory. Privileged accounts and groups in Active Directory are those to which powerful rights, privileges, and permissions are granted that allow them to perform nearly any action in Active Directory and on domain-joined systems.","risk_score":21,"severity":"low","license":"Elastic License v2","output_index":".siem-signals-default","meta":{"from":"4m"},"timestamp_override":"event.ingested","author":["Elastic","Skoetting"],"false_positives":[],"from":"now-540s","rule_id":"8a3203de-1f00-47c0-b120-c420301ee48c","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","technique":[{"reference":"https://attack.mitre.org/techniques/T1136/","name":"Create Account","subtechnique":[{"reference":"https://attack.mitre.org/techniques/T1136/001/","name":"Local Account","id":"T1136.001"}],"id":"T1136"}],"tactic":{"reference":"https://attack.mitre.org/tactics/TA0003/","name":"Persistence","id":"TA0003"}}],"to":"now","references":["https://docs.microsoft.com/en-us/windows-server/identity/ad-ds/plan/security-best-practices/appendix-b--privileged-accounts-and-groups-in-active-directory"],"version":3,"exceptions_list":[],"immutable":false,"type":"query","language":"kuery","index":["windows-*"],"query":"event.category:iam and event.action:\"added-member-to-group\" and group.name:(Administrators or \"Local Administrators\" or \"Domain Admins\" or \"Enterprise Admins\" or \"Backup Admins\" or \"Schema Admins\" or \"DnsAdmins\" or \"SecOps\")","filters":[],"throttle":"no_actions","actions":[]}
{"id":"cd4e9190-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T15:57:34.904Z","updated_by":"admin","created_at":"2021-09-22T15:57:34.904Z","created_by":"admin","name":"Potential Disabling of SELinux [Duplicate]","tags":["Defense Evasion","Elastic","Host","Linux","Threat Detection"],"interval":"5m","enabled":false,"description":"Identifies potential attempts to disable Security-Enhanced Linux (SELinux), which is a Linux kernel security feature to support access control policies. Adversaries may disable security tools to avoid possible detection of their tools and activities.","risk_score":47,"severity":"medium","license":"Elastic License v2","output_index":".siem-signals-default","timestamp_override":"event.ingested","author":["Elastic"],"false_positives":[],"from":"now-9m","rule_id":"5a101fb5-f6c6-43e6-b300-ba0c2b9e9fe2","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0005","name":"Defense Evasion","reference":"https://attack.mitre.org/tactics/TA0005/"},"technique":[{"id":"T1562","name":"Impair Defenses","reference":"https://attack.mitre.org/techniques/T1562/","subtechnique":[{"id":"T1562.001","name":"Disable or Modify Tools","reference":"https://attack.mitre.org/techniques/T1562/001/"}]}]}],"to":"now","references":[],"version":7,"exceptions_list":[],"immutable":false,"type":"query","language":"kuery","index":["auditbeat-*","logs-endpoint.events.*"],"query":"event.category:process and event.type:(start or process_started) and process.name:setenforce and process.args:0","throttle":"no_actions","actions":[]}
{"id":"cd49af91-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T15:57:34.865Z","updated_by":"admin","created_at":"2021-09-22T15:57:34.865Z","created_by":"admin","name":"Hping Process Activity [Duplicate]","tags":["Elastic","Host","Linux","Threat Detection"],"interval":"5m","enabled":false,"description":"Hping ran on a Linux host. Hping is a FOSS command-line packet analyzer and has the ability to construct network packets for a wide variety of network security testing applications, including scanning and firewall auditing.","risk_score":73,"severity":"high","license":"Elastic License v2","output_index":".siem-signals-default","timestamp_override":"event.ingested","author":["Elastic"],"false_positives":["Normal use of hping is uncommon apart from security testing and research. Use by non-security engineers is very uncommon."],"from":"now-9m","rule_id":"6f581410-9bf8-4fcb-baaf-74d8d72efe13","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[],"to":"now","references":["https://en.wikipedia.org/wiki/Hping"],"version":7,"exceptions_list":[],"immutable":false,"type":"query","language":"kuery","index":["auditbeat-*","logs-endpoint.events.*"],"query":"event.category:process and event.type:(start or process_started) and process.name:(hping or hping2 or hping3)","throttle":"no_actions","actions":[]}
{"id":"cf8b6231-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T15:57:38.688Z","updated_by":"admin","created_at":"2021-09-22T15:57:38.688Z","created_by":"admin","name":"Persistence via KDE AutoStart Script or Desktop File Modification [Duplicate]","tags":["Elastic","Host","Linux","Persistence","Threat Detection"],"interval":"5m","enabled":false,"description":"Identifies the creation or modification of a K Desktop Environment (KDE) AutoStart script or desktop file that will execute upon each user logon. Adversaries may abuse this method for persistence.","risk_score":47,"severity":"medium","license":"Elastic License v2","output_index":".siem-signals-default","timestamp_override":"event.ingested","author":["Elastic"],"false_positives":[],"from":"now-9m","rule_id":"fd713891-ecea-4338-b3eb-1785b88e927a","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0003","name":"Persistence","reference":"https://attack.mitre.org/tactics/TA0003/"},"technique":[{"id":"T1547","name":"Boot or Logon Autostart Execution","reference":"https://attack.mitre.org/techniques/T1547/"}]}],"to":"now","references":["https://userbase.kde.org/System_Settings/Autostart","https://www.amnesty.org/en/latest/research/2020/09/german-made-finspy-spyware-found-in-egypt-and-mac-and-linux-versions-revealed/","https://www.intezer.com/blog/research/operation-electrorat-attacker-creates-fake-companies-to-drain-your-crypto-wallets/"],"version":1,"exceptions_list":[],"immutable":false,"type":"eql","language":"eql","index":["auditbeat-*","logs-endpoint.events.*"],"query":"file where event.type != \"deletion\" and\n  file.extension in (\"sh\", \"desktop\") and\n  file.path :\n    (\n      \"/home/*/.config/autostart/*\", \"/root/.config/autostart/*\",\n      \"/home/*/.kde/Autostart/*\", \"/root/.kde/Autostart/*\",\n      \"/home/*/.kde4/Autostart/*\", \"/root/.kde4/Autostart/*\",\n      \"/home/*/.kde/share/autostart/*\", \"/root/.kde/share/autostart/*\",\n      \"/home/*/.kde4/share/autostart/*\", \"/root/.kde4/share/autostart/*\",\n      \"/home/*/.local/share/autostart/*\", \"/root/.local/share/autostart/*\",\n      \"/home/*/.config/autostart-scripts/*\", \"/root/.config/autostart-scripts/*\",\n      \"/etc/xdg/autostart/*\", \"/usr/share/autostart/*\"\n    )\n","throttle":"no_actions","actions":[]}
{"id":"cf8b8941-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T15:57:38.690Z","updated_by":"admin","created_at":"2021-09-22T15:57:38.690Z","created_by":"admin","name":"Persistence via Kernel Module Modification [Duplicate]","tags":["Elastic","Host","Linux","Persistence","Threat Detection"],"interval":"5m","enabled":false,"description":"Identifies loadable kernel module errors, which are often indicative of potential persistence attempts.","risk_score":21,"severity":"low","license":"Elastic License v2","output_index":".siem-signals-default","timestamp_override":"event.ingested","author":["Elastic"],"false_positives":["Security tools and device drivers may run these programs in order to load legitimate kernel modules. Use of these programs by ordinary users is uncommon."],"from":"now-9m","rule_id":"952908b0-87de-47dc-8d64-4df0b36ebe3c","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0003","name":"Persistence","reference":"https://attack.mitre.org/tactics/TA0003/"},"technique":[{"id":"T1547","name":"Boot or Logon Autostart Execution","reference":"https://attack.mitre.org/techniques/T1547/","subtechnique":[{"id":"T1547.006","name":"Kernel Modules and Extensions","reference":"https://attack.mitre.org/techniques/T1547/006/"}]}]}],"to":"now","references":["https://www.hackers-arise.com/single-post/2017/11/03/Linux-for-Hackers-Part-10-Loadable-Kernel-Modules-LKM"],"version":8,"exceptions_list":[],"immutable":false,"type":"query","language":"kuery","index":["auditbeat-*","logs-endpoint.events.*"],"query":"event.category:process and event.type:(start or process_started) and process.name:(insmod or kmod or modprobe or rmod)","throttle":"no_actions","actions":[]}
{"id":"cf8c73a0-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T15:57:38.711Z","updated_by":"admin","created_at":"2021-09-22T15:57:38.711Z","created_by":"admin","name":"Potential OpenSSH Backdoor Logging Activity [Duplicate]","tags":["Credential Access","Elastic","Host","Linux","Persistence","Threat Detection"],"interval":"5m","enabled":false,"description":"Identifies a Secure Shell (SSH) client or server process creating or writing to a known SSH backdoor log file. Adversaries may modify SSH related binaries for persistence or credential access via patching sensitive functions to enable unauthorized access or to log SSH credentials for exfiltration.","risk_score":73,"severity":"high","license":"Elastic License v2","output_index":".siem-signals-default","timestamp_override":"event.ingested","author":["Elastic"],"false_positives":["Updates to approved and trusted SSH executables can trigger this rule."],"from":"now-9m","rule_id":"b0c066ca-df8f-4b14-900e-8deb5ef23916","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0006","name":"Credential Access","reference":"https://attack.mitre.org/tactics/TA0006/"},"technique":[{"id":"T1556","name":"Modify Authentication Process","reference":"https://attack.mitre.org/techniques/T1556/"}]},{"framework":"MITRE ATT&CK","tactic":{"id":"TA0003","name":"Persistence","reference":"https://attack.mitre.org/tactics/TA0003/"},"technique":[{"id":"T1554","name":"Compromise Client Software Binary","reference":"https://attack.mitre.org/techniques/T1554/"}]}],"to":"now","references":["https://github.com/eset/malware-ioc/tree/master/sshdoor","https://www.welivesecurity.com/wp-content/uploads/2021/01/ESET_Kobalos.pdf"],"version":1,"exceptions_list":[],"immutable":false,"type":"eql","language":"eql","index":["auditbeat-*","logs-endpoint.events.*"],"query":"file where event.type == \"change\" and process.executable : (\"/usr/sbin/sshd\", \"/usr/bin/ssh\") and\n  (\n    file.name : (\".*\", \"~*\") or\n    file.extension : (\"in\", \"out\", \"ini\", \"h\", \"gz\", \"so\", \"sock\", \"sync\", \"0\", \"1\", \"2\", \"3\", \"4\", \"5\", \"6\", \"7\", \"8\", \"9\") or\n    file.path : \n    (\n      \"/private/etc/*--\", \n      \"/usr/share/*\", \n      \"/usr/include/*\", \n      \"/usr/local/include/*\", \n      \"/private/tmp/*\", \n      \"/private/var/tmp/*\",\n      \"/usr/tmp/*\", \n      \"/usr/share/man/*\", \n      \"/usr/local/share/*\", \n      \"/usr/lib/*.so.*\", \n      \"/private/etc/ssh/.sshd_auth\",\n      \"/usr/bin/ssd\", \n      \"/private/var/opt/power\", \n      \"/private/etc/ssh/ssh_known_hosts\", \n      \"/private/var/html/lol\", \n      \"/private/var/log/utmp\", \n      \"/private/var/lib\",\n      \"/var/run/sshd/sshd.pid\",\n      \"/var/run/nscd/ns.pid\",\n      \"/var/run/udev/ud.pid\",\n      \"/var/run/udevd.pid\"\n    )\n  )\n","throttle":"no_actions","actions":[]}
{"id":"cf8c9ab1-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T15:57:38.719Z","updated_by":"admin","created_at":"2021-09-22T15:57:38.719Z","created_by":"admin","name":"Unusual Windows Remote User [Duplicate]","tags":["Elastic","Host","ML","Threat Detection","Windows"],"interval":"15m","enabled":false,"description":"A machine learning job detected an unusual remote desktop protocol (RDP) username, which can indicate account takeover or credentialed persistence using compromised accounts. RDP attacks, such as BlueKeep, also tend to use unusual usernames.","risk_score":21,"severity":"low","note":"### Investigating an Unusual Windows User ###\nDetection alerts from this rule indicate activity for a rare and unusual Windows RDP (remote desktop) user. Here are some possible avenues of investigation:\n- Consider the user as identified by the username field. Is the user part of a group who normally logs into Windows hosts using RDP (remote desktop protocol)? Is this logon activity part of an expected workflow for the user?\n- Consider the source of the login. If the source is remote, could this be related to occasional troubleshooting or support activity by a vendor or an employee working remotely?","license":"Elastic License v2","output_index":".siem-signals-default","author":["Elastic"],"false_positives":["Uncommon username activity can be due to an engineer logging onto a server instance in order to perform manual troubleshooting or reconfiguration."],"from":"now-45m","rule_id":"15f6a95c-5a5c-4897-8829-7055d03c1dcd","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[],"to":"now","references":["https://www.elastic.co/guide/en/security/current/prebuilt-ml-jobs.html"],"version":4,"exceptions_list":[],"immutable":false,"type":"machine_learning","anomaly_threshold":50,"machine_learning_job_id":["windows_rare_user_type10_remote_login"],"throttle":"no_actions","actions":[]}
{"id":"cf8d36f1-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T15:57:38.728Z","updated_by":"admin","created_at":"2021-09-22T15:57:38.728Z","created_by":"admin","name":"File Deletion via Shred [Duplicate]","tags":["Defense Evasion","Elastic","Host","Linux","Threat Detection"],"interval":"5m","enabled":false,"description":"Malware or other files dropped or created on a system by an adversary may leave traces behind as to what was done within a network and how. Adversaries may remove these files over the course of an intrusion to keep their footprint low or remove them at the end as part of the post-intrusion cleanup process.","risk_score":21,"severity":"low","license":"Elastic License v2","output_index":".siem-signals-default","timestamp_override":"event.ingested","author":["Elastic"],"false_positives":[],"from":"now-9m","rule_id":"74a69573-cdce-41a5-9978-fd47c89875e2","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0005","name":"Defense Evasion","reference":"https://attack.mitre.org/tactics/TA0005/"},"technique":[{"id":"T1070","name":"Indicator Removal on Host","reference":"https://attack.mitre.org/techniques/T1070/","subtechnique":[{"id":"T1070.004","name":"File Deletion","reference":"https://attack.mitre.org/techniques/T1070/004/"}]}]}],"to":"now","references":[],"version":7,"exceptions_list":[],"immutable":false,"type":"query","language":"kuery","index":["auditbeat-*","logs-endpoint.events.*"],"query":"event.category:process and event.type:(start or process_started) and process.name:shred and process.args:(\"-u\" or \"--remove\" or \"-z\" or \"--zero\")","throttle":"no_actions","actions":[]}
{"id":"cd833620-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T15:59:11.911Z","updated_by":"admin","created_at":"2021-09-22T15:57:35.846Z","created_by":"admin","name":"Unusual Log Rate for Micro Service Detected","tags":["GD","Application Security","ML"],"interval":"5m","enabled":false,"description":"This alerts triggers when Elastic ML detects an unusual log rate for a micro service.","risk_score":47,"severity":"medium","license":"","output_index":".siem-signals-default","timeline_id":"85660c36-058e-4ce6-a157-3ffbc167ac63","timeline_title":"App Security","meta":{"from":"1m","kibana_siem_app_url":"https://cbbf317cf62e4dd9b9913c1cc96ca394.vpce.gdw55e.elastic-cloud.com:9243/app/security"},"author":[],"false_positives":[],"from":"now-360s","rule_id":"b7590a0e-90e8-4666-9650-265b16811b9f","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[],"to":"now","references":[],"version":1,"exceptions_list":[],"immutable":false,"type":"machine_learning","anomaly_threshold":50,"machine_learning_job_id":["unusual-log-rate-for-micro-service"],"throttle":"no_actions","actions":[]}
{"id":"d3da49f0-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T15:59:11.917Z","updated_by":"admin","created_at":"2021-09-22T15:57:46.902Z","created_by":"admin","name":"[GD] Execution of Persistent Suspicious Program","tags":["Elastic","Host","Persistence","Threat Detection","Windows"],"interval":"5m","enabled":false,"description":"Identifies execution of suspicious persistent programs (scripts, rundll32, etc.) by looking at process lineage and command line usage.","risk_score":47,"severity":"medium","license":"Elastic License v2","output_index":".siem-signals-default","meta":{"from":"4m"},"author":["Elastic"],"false_positives":[],"from":"now-540s","rule_id":"94cb7bc6-26dc-4330-961a-79c1945dc13c","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","technique":[{"reference":"https://attack.mitre.org/techniques/T1547/","name":"Boot or Logon Autostart Execution","subtechnique":[{"reference":"https://attack.mitre.org/techniques/T1547/001/","name":"Registry Run Keys / Startup Folder","id":"T1547.001"}],"id":"T1547"}],"tactic":{"reference":"https://attack.mitre.org/tactics/TA0003/","name":"Persistence","id":"TA0003"}}],"to":"now","references":[],"version":3,"exceptions_list":[],"immutable":false,"type":"eql","language":"eql","index":["windows-*"],"query":"/* userinit followed by explorer followed by early child process of explorer (unlikely to be launched interactively) within 1m */\nsequence by host.id, user.name with maxspan=1m\n  [process where event.type in (\"start\", \"process_started\") and process.name : \"userinit.exe\" and process.parent.name : \"winlogon.exe\"]\n  [process where event.type in (\"start\", \"process_started\") and process.name : \"explorer.exe\"]\n  [process where event.type in (\"start\", \"process_started\") and process.parent.name : \"explorer.exe\" and\n   /* add suspicious programs here */\n   process.pe.original_file_name in (\"cscript.exe\",\n                                     \"wscript.exe\",\n                                     \"PowerShell.EXE\",\n                                     \"MSHTA.EXE\",\n                                     \"RUNDLL32.EXE\",\n                                     \"REGSVR32.EXE\",\n                                     \"RegAsm.exe\",\n                                     \"MSBuild.exe\",\n                                     \"InstallUtil.exe\") and\n    /* add potential suspicious paths here */\n    process.args : (\"C:\\\\Users\\\\*\", \"C:\\\\ProgramData\\\\*\", \"C:\\\\Windows\\\\Temp\\\\*\", \"C:\\\\Windows\\\\Tasks\\\\*\", \"C:\\\\PerfLogs\\\\*\", \"C:\\\\Intel\\\\*\")\n   ]\n","filters":[],"throttle":"no_actions","actions":[]}
{"id":"cd49fdb0-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T15:59:11.925Z","updated_by":"admin","created_at":"2021-09-22T15:57:35.845Z","created_by":"admin","name":"[GD] Process Starting from a Shared Folder","tags":["GD","POC","Windows","Process"],"interval":"5m","enabled":false,"description":"Detect processes starting from shared folders and or mapped drives.","risk_score":47,"severity":"medium","license":"","output_index":".siem-signals-default","meta":{"from":"1m","kibana_siem_app_url":"https://cbbf317cf62e4dd9b9913c1cc96ca394.vpce.gdw55e.elastic-cloud.com:9243/app/security"},"timestamp_override":"event.ingested","author":[],"false_positives":[],"from":"now-360s","rule_id":"4dff3128-c32e-4b37-9c93-a1a8bcc8935a","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[],"to":"now","references":[],"version":3,"exceptions_list":[],"immutable":false,"type":"query","language":"kuery","index":["windows-*"],"query":"event.type : \"start\" and process.executable : \\\\Device\\\\Mup\\\\*","filters":[],"throttle":"no_actions","actions":[]}
{"id":"cd45df01-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T15:59:11.933Z","updated_by":"admin","created_at":"2021-09-22T15:57:35.841Z","created_by":"admin","name":"[GD] Okta Failed Authentication Sequence ","tags":["Okta","GD","POC"],"interval":"5m","enabled":false,"description":"If a user fails 3 times, but then is successful.","risk_score":66,"severity":"medium","license":"","output_index":".siem-signals-default","meta":{"from":"1m","kibana_siem_app_url":"https://cbbf317cf62e4dd9b9913c1cc96ca394.vpce.gdw55e.elastic-cloud.com:9243/app/security"},"timestamp_override":"event.ingested","author":[],"false_positives":[],"from":"now-360s","rule_id":"f3baef76-8735-429a-8035-a2a6b870de9b","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[],"to":"now","references":[],"version":1,"exceptions_list":[],"immutable":false,"type":"eql","language":"eql","index":["okta-*"],"query":"sequence by user.full_name, source.ip\n  [authentication where event.outcome == \"failure\"]\n  [authentication where event.outcome == \"failure\"]\n  [authentication where event.outcome == \"failure\"]\n  [authentication where event.outcome == \"success\"]","filters":[],"throttle":"no_actions","actions":[]}
{"id":"cd842080-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T15:57:35.258Z","updated_by":"admin","created_at":"2021-09-22T15:57:35.258Z","created_by":"admin","name":"Unusual Linux Username [Duplicate]","tags":["Elastic","Host","Linux","ML","Threat Detection"],"interval":"15m","enabled":false,"description":"A machine learning job detected activity for a username that is not normally active, which can indicate unauthorized changes, activity by unauthorized users, lateral movement, or compromised credentials. In many organizations, new usernames are not often created apart from specific types of system activities, such as creating new accounts for new employees. These user accounts quickly become active and routine. Events from rarely used usernames can point to suspicious activity. Additionally, automated Linux fleets tend to see activity from rarely used usernames only when personnel log in to make authorized or unauthorized changes, or threat actors have acquired credentials and log in for malicious purposes. Unusual usernames can also indicate pivoting, where compromised credentials are used to try and move laterally from one host to another.","risk_score":21,"severity":"low","note":"### Investigating an Unusual Linux User ###\nDetection alerts from this rule indicate activity for a Linux user name that is rare and unusual. Here are some possible avenues of investigation:\n- Consider the user as identified by the username field. Is this program part of an expected workflow for the user who ran this program on this host? Could this be related to troubleshooting or debugging activity by a developer or site reliability engineer?\n- Examine the history of user activity. If this user manifested only very recently, it might be a service account for a new software package. If it has a consistent cadence - for example if it runs monthly or quarterly - it might be part of a monthly or quarterly business process.\n- Examine the process arguments, title and working directory. These may provide indications as to the source of the program or the nature of the tasks that the user is performing.","license":"Elastic License v2","output_index":".siem-signals-default","author":["Elastic"],"false_positives":["Uncommon user activity can be due to an engineer logging onto a server instance in order to perform manual troubleshooting or reconfiguration."],"from":"now-45m","rule_id":"762be905-cfac-488f-a275-83c31a98a477","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[],"to":"now","references":["https://www.elastic.co/guide/en/security/current/prebuilt-ml-jobs.html"],"version":4,"exceptions_list":[],"immutable":false,"type":"machine_learning","anomaly_threshold":50,"machine_learning_job_id":["linux_anomalous_user_name_ecs"],"throttle":"no_actions","actions":[]}
{"id":"af172000-4ba8-11ec-9fcb-3bc48f034fff","updated_at":"2022-02-28T19:49:04.951Z","updated_by":"admin","created_at":"2021-11-22T15:27:21.506Z","created_by":"admin","name":"[GD] Carbon Black File Unauthorized Run","tags":["GD"],"interval":"24h","enabled":false,"description":"When a file is accessecd on a system without the users explicit permissions","risk_score":21,"severity":"low","license":"","output_index":".siem-signals-default","meta":{"from":"24h","kibana_siem_app_url":"https://security-prod.kibana.int.gdcorp.tools/app/security"},"author":[],"false_positives":[],"from":"now-172800s","rule_id":"606eea46-0eb2-4285-835b-ed3bc587535c","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[],"to":"now","references":[],"version":6,"exceptions_list":[],"immutable":false,"type":"query","language":"kuery","index":["*:onprem-*","*:windows*","*:aws-syslog*"],"query":"(aws.fluent_tags: \"CARBONBLACK\"  and (rule.description: \"New unapproved file to computer\" or rule.description: \"Execution block \\(unapproved file\\)\" or rule.description: \"Process demoted\")) or (winlog.event_id: \"4688\" or winlog.event_id: \"4663\" )","filters":[],"throttle":"no_actions","actions":[]}
{"id":"d6483cb0-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T16:00:33.733Z","updated_by":"admin","created_at":"2021-09-22T15:57:50.923Z","created_by":"admin","name":"[GD] AWS RDS Cluster Creation","tags":["Asset Visibility","AWS","Cloud","Continuous Monitoring","Elastic","SecOps"],"interval":"10m","enabled":false,"description":"Identifies the creation of a new Amazon Relational Database Service (RDS) Aurora DB cluster or global database spread across multiple regions.","risk_score":21,"severity":"low","note":"The AWS Filebeat module must be enabled to use this rule.","license":"Elastic License v2","output_index":".siem-signals-default","meta":{"from":"50m"},"timestamp_override":"event.ingested","author":["Elastic"],"false_positives":["Valid clusters may be created by a system or network administrator. Verify whether the user identity, user agent, and/or hostname should be making changes in your environment. Cluster creations from unfamiliar users or hosts should be investigated. If known behavior is causing false positives, it can be exempted from the rule."],"from":"now-3600s","rule_id":"c8176844-d8a4-4282-8d50-ef9dcc97e737","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","technique":[{"reference":"https://attack.mitre.org/techniques/T1133/","name":"External Remote Services","subtechnique":[],"id":"T1133"}],"tactic":{"reference":"https://attack.mitre.org/tactics/TA0003/","name":"Persistence","id":"TA0003"}},{"framework":"MITRE ATT&CK","technique":[],"tactic":{"reference":"https://attack.mitre.org/tactics/TA0005/","name":"Defense Evasion","id":"TA0005"}}],"to":"now","references":["https://awscli.amazonaws.com/v2/documentation/api/latest/reference/rds/create-db-cluster.html","https://docs.aws.amazon.com/AmazonRDS/latest/APIReference/API_CreateDBCluster.html","https://awscli.amazonaws.com/v2/documentation/api/latest/reference/rds/create-global-cluster.html","https://docs.aws.amazon.com/AmazonRDS/latest/APIReference/API_CreateGlobalCluster.html"],"version":6,"exceptions_list":[],"immutable":false,"type":"query","language":"kuery","index":["aws-cloudtrail-*","aws-config-*"],"query":"event.action:(CreateDBCluster or CreateGlobalCluster) and event.dataset:aws.cloudtrail and event.provider:rds.amazonaws.com and event.outcome:success","filters":[],"throttle":"no_actions","actions":[]}
{"id":"d3d7d8f0-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T16:00:33.787Z","updated_by":"admin","created_at":"2021-09-22T15:57:46.923Z","created_by":"admin","name":"[GD] Delete Volume USN Journal with Fsutil","tags":["Defense Evasion","Elastic","Host","Threat Detection","Windows"],"interval":"5m","enabled":false,"description":"Identifies use of the fsutil.exe to delete the volume USNJRNL. This technique is used by attackers to eliminate evidence of files created during post-exploitation activities.","risk_score":21,"severity":"low","license":"Elastic License v2","output_index":".siem-signals-default","meta":{"from":"4m"},"timestamp_override":"event.ingested","author":["Elastic"],"false_positives":[],"from":"now-540s","rule_id":"bd4cf2ce-2f97-4052-900f-1e13116dfe78","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","technique":[{"reference":"https://attack.mitre.org/techniques/T1070/","name":"Indicator Removal on Host","subtechnique":[{"reference":"https://attack.mitre.org/techniques/T1070/004/","name":"File Deletion","id":"T1070.004"}],"id":"T1070"}],"tactic":{"reference":"https://attack.mitre.org/tactics/TA0005/","name":"Defense Evasion","id":"TA0005"}}],"to":"now","references":[],"version":9,"exceptions_list":[],"immutable":false,"type":"query","language":"kuery","index":["windows-*"],"query":"event.category:process and event.type:(start or process_started) and process.name:fsutil.exe and process.args:(deletejournal and usn)","filters":[],"throttle":"no_actions","actions":[]}
{"id":"d3dabf21-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T16:00:33.811Z","updated_by":"admin","created_at":"2021-09-22T15:57:46.915Z","created_by":"admin","name":"[GD] Windows Network Enumeration","tags":["Discovery","Elastic","Host","Threat Detection","Windows"],"interval":"5m","enabled":false,"description":"Identifies attempts to enumerate hosts in a network using the built-in Windows net.exe tool.","risk_score":47,"severity":"medium","license":"Elastic License v2","output_index":".siem-signals-default","meta":{"from":"4m"},"timestamp_override":"event.ingested","author":["Elastic"],"false_positives":[],"from":"now-540s","rule_id":"a1485a82-14e1-4a5a-96cd-76a33f0dc467","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","technique":[{"reference":"https://attack.mitre.org/techniques/T1018/","name":"Remote System Discovery","subtechnique":[],"id":"T1018"},{"reference":"https://attack.mitre.org/techniques/T1135/","name":"Network Share Discovery","subtechnique":[],"id":"T1135"}],"tactic":{"reference":"https://attack.mitre.org/tactics/TA0007/","name":"Discovery","id":"TA0007"}}],"to":"now","references":[],"version":4,"exceptions_list":[],"immutable":false,"type":"eql","language":"eql","index":["windows-*"],"query":"process where event.type in (\"start\", \"process_started\") and\n  ((process.name : \"net.exe\" or process.pe.original_file_name == \"net.exe\") or\n   ((process.name : \"net1.exe\" or process.pe.original_file_name == \"net1.exe\") and\n       not process.parent.name : \"net.exe\")) and\n  (process.args : \"view\" or (process.args : \"time\" and process.args : \"\\\\\\\\*\"))\n\n\n  /* expand when ancestory is available\n  and not descendant of [process where event.type == (\"start\", \"process_started\") and process.name : \"cmd.exe\" and\n                           ((process.parent.name : \"userinit.exe\") or\n                            (process.parent.name : \"gpscript.exe\") or\n                            (process.parent.name : \"explorer.exe\" and\n                               process.args : \"C:\\\\*\\\\Start Menu\\\\Programs\\\\Startup\\\\*.bat*\"))]\n  */\n","filters":[],"throttle":"no_actions","actions":[]}
{"id":"d3d9fbd0-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T16:00:33.819Z","updated_by":"admin","created_at":"2021-09-22T15:57:46.912Z","created_by":"admin","name":"[GD] Unusual Parent Process for cmd.exe","tags":["Elastic","Execution","Host","Threat Detection","Windows"],"interval":"5m","enabled":false,"description":"Identifies a suspicious parent child process relationship with cmd.exe descending from an unusual process.","risk_score":47,"severity":"medium","license":"Elastic License v2","output_index":".siem-signals-default","meta":{"from":"4m"},"timestamp_override":"event.ingested","author":["Elastic"],"false_positives":[],"from":"now-540s","rule_id":"f2e2d35f-4452-4884-b5ab-f0a70fb57214","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","technique":[{"reference":"https://attack.mitre.org/techniques/T1059/","name":"Command and Scripting Interpreter","subtechnique":[],"id":"T1059"}],"tactic":{"reference":"https://attack.mitre.org/tactics/TA0002/","name":"Execution","id":"TA0002"}}],"to":"now","references":[],"version":4,"exceptions_list":[],"immutable":false,"type":"query","language":"kuery","index":["windows-*"],"query":"event.category:process and event.type:(start or process_started) and process.name:cmd.exe and process.parent.name:(lsass.exe or csrss.exe or notepad.exe or regsvr32.exe or dllhost.exe or LogonUI.exe or wermgr.exe or spoolsv.exe or jucheck.exe or jusched.exe or ctfmon.exe or taskhostw.exe or GoogleUpdate.exe or sppsvc.exe or sihost.exe or slui.exe or SIHClient.exe or SearchIndexer.exe or SearchProtocolHost.exe or FlashPlayerUpdateService.exe or WerFault.exe or WUDFHost.exe or unsecapp.exe or wlanext.exe)","filters":[],"throttle":"no_actions","actions":[]}
{"id":"d644e150-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T16:00:33.824Z","updated_by":"admin","created_at":"2021-09-22T15:57:50.913Z","created_by":"admin","name":"[GD] Microsoft Build Engine Using an Alternate Name","tags":["Defense Evasion","Elastic","Host","Threat Detection","Windows"],"interval":"5m","enabled":false,"description":"An instance of MSBuild, the Microsoft Build Engine, was started after being renamed. This is uncommon behavior and may indicate an attempt to run unnoticed or undetected.","risk_score":21,"severity":"low","license":"Elastic License v2","output_index":".siem-signals-default","meta":{"from":"4m"},"timestamp_override":"event.ingested","author":["Elastic"],"false_positives":["The Build Engine is commonly used by Windows developers but use by non-engineers is unusual."],"from":"now-540s","rule_id":"7258da78-925f-461e-8e57-30455246cd15","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","technique":[{"reference":"https://attack.mitre.org/techniques/T1036/","name":"Masquerading","subtechnique":[],"id":"T1036"}],"tactic":{"reference":"https://attack.mitre.org/tactics/TA0005/","name":"Defense Evasion","id":"TA0005"}}],"to":"now","references":[],"version":8,"exceptions_list":[],"immutable":false,"type":"query","language":"kuery","index":["windows-*"],"query":"event.category:process and event.type:(start or process_started) and process.pe.original_file_name:MSBuild.exe and not process.name: MSBuild.exe","filters":[],"throttle":"no_actions","actions":[]}
{"id":"d1b260e0-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T16:00:33.829Z","updated_by":"admin","created_at":"2021-09-22T15:57:42.876Z","created_by":"admin","name":"[GD] Execution via Regsvcs/Regasm","tags":["Elastic","Execution","Host","Threat Detection","Windows"],"interval":"5m","enabled":false,"description":"RegSvcs.exe and RegAsm.exe are Windows command line utilities that are used to register .NET Component Object Model (COM) assemblies. Adversaries can use RegSvcs.exe and RegAsm.exe to proxy execution of code through a trusted Windows utility.","risk_score":21,"severity":"low","license":"Elastic License v2","output_index":".siem-signals-default","meta":{"from":"4m"},"timestamp_override":"event.ingested","author":["Elastic"],"false_positives":[],"from":"now-540s","rule_id":"6a83e93f-785c-466f-b818-8e46f92d6bfb","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","technique":[],"tactic":{"reference":"https://attack.mitre.org/tactics/TA0002/","name":"Execution","id":"TA0002"}},{"framework":"MITRE ATT&CK","technique":[{"reference":"https://attack.mitre.org/techniques/T1218/","name":"Signed Binary Proxy Execution","subtechnique":[{"reference":"https://attack.mitre.org/techniques/T1218/009/","name":"Regsvcs/Regasm","id":"T1218.009"}],"id":"T1218"}],"tactic":{"reference":"https://attack.mitre.org/tactics/TA0005/","name":"Defense Evasion","id":"TA0005"}}],"to":"now","references":[],"version":8,"exceptions_list":[],"immutable":false,"type":"query","language":"kuery","index":["windows-*"],"query":"event.category:process and event.type:(start or process_started) and process.name:(RegAsm.exe or RegSvcs.exe)","filters":[],"throttle":"no_actions","actions":[]}
{"id":"cd4bab60-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T15:57:34.878Z","updated_by":"admin","created_at":"2021-09-22T15:57:34.878Z","created_by":"admin","name":"Security Software Discovery via Grep [Duplicate]","tags":["Discovery","Elastic","Host","Linux","macOS","Threat Detection"],"interval":"5m","enabled":false,"description":"Identifies the use of the grep command to discover known third-party macOS and Linux security tools, such as Antivirus or Host Firewall details.","risk_score":47,"severity":"medium","license":"Elastic License v2","output_index":".siem-signals-default","timestamp_override":"event.ingested","author":["Elastic"],"false_positives":[],"from":"now-9m","rule_id":"b35e3dd6-c07f-4791-ab29-34218709b3c5","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0007","name":"Discovery","reference":"https://attack.mitre.org/tactics/TA0007/"},"technique":[{"id":"T1518","name":"Software Discovery","reference":"https://attack.mitre.org/techniques/T1518/"}]}],"to":"now","references":[],"version":1,"exceptions_list":[],"immutable":false,"type":"query","language":"kuery","index":["logs-endpoint.events.*","auditbeat-*"],"query":"event.category : process and event.type : (start or process_started) and process.name : grep and process.args : (\"Little Snitch\" or Avast* or Avira* or ESET* or esets_* or BlockBlock or 360* or LuLu or KnockKnock* or kav or KIS or RTProtectionDaemon or Malware* or VShieldScanner or WebProtection or webinspectord or McAfee* or isecespd* or macmnsvc* or masvc or kesl or avscan or guard or rtvscand or symcfgd or scmdaemon or symantec or elastic-endpoint )","throttle":"no_actions","actions":[]}
{"id":"cd4a72e1-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T15:57:34.897Z","updated_by":"admin","created_at":"2021-09-22T15:57:34.897Z","created_by":"admin","name":"Timestomping using Touch Command [Duplicate]","tags":["Defense Evasion","Elastic","Host","Linux","macOS","Threat Detection"],"interval":"5m","enabled":false,"description":"Timestomping is an anti-forensics technique which is used to modify the timestamps of a file, often to mimic files that are in the same folder.","risk_score":47,"severity":"medium","license":"Elastic License v2","output_index":".siem-signals-default","timestamp_override":"event.ingested","author":["Elastic"],"false_positives":[],"from":"now-9m","rule_id":"990c77fa-a910-4610-b14d-4f57df23b5bd","max_signals":33,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0005","name":"Defense Evasion","reference":"https://attack.mitre.org/tactics/TA0005/"},"technique":[{"id":"T1070","name":"Indicator Removal on Host","reference":"https://attack.mitre.org/techniques/T1070/","subtechnique":[{"id":"T1070.006","name":"Timestomp","reference":"https://attack.mitre.org/techniques/T1070/006/"}]}]}],"to":"now","references":[],"version":3,"exceptions_list":[],"immutable":false,"type":"eql","language":"eql","index":["auditbeat-*","logs-endpoint.events.*"],"query":"process where event.type in (\"start\", \"process_started\") and\n process.name : \"touch\" and process.args : (\"-r\", \"-t\", \"-a*\",\"-m*\")\n","throttle":"no_actions","actions":[]}
{"id":"d17ad620-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T16:00:33.894Z","updated_by":"admin","created_at":"2021-09-22T15:57:42.865Z","created_by":"admin","name":"[GD] ImageLoad via Windows Update Auto Update Client","tags":["Defense Evasion","Elastic","Host","Threat Detection","Windows"],"interval":"5m","enabled":false,"description":"Identifies abuse of the Windows Update Auto Update Client (wuauclt.exe) to load an arbitrary DLL. This behavior is used as a defense evasion technique to blend-in malicious activity with legitimate Windows software.","risk_score":47,"severity":"medium","license":"Elastic License v2","output_index":".siem-signals-default","meta":{"from":"4m"},"timestamp_override":"event.ingested","author":["Elastic"],"false_positives":[],"from":"now-540s","rule_id":"3bf85011-591c-47ff-bdea-fcb608f25503","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","technique":[{"reference":"https://attack.mitre.org/techniques/T1218/","name":"Signed Binary Proxy Execution","subtechnique":[],"id":"T1218"}],"tactic":{"reference":"https://attack.mitre.org/tactics/TA0005/","name":"Defense Evasion","id":"TA0005"}}],"to":"now","references":["https://dtm.uk/wuauclt/"],"version":4,"exceptions_list":[],"immutable":false,"type":"eql","language":"eql","index":["windows-*"],"query":"process where event.type in (\"start\", \"process_started\") and\n  (process.pe.original_file_name == \"wuauclt.exe\" or process.name : \"wuauclt.exe\") and\n   /* necessary windows update client args to load a dll */\n   process.args : \"/RunHandlerComServer\" and process.args : \"/UpdateDeploymentProvider\" and\n   /* common paths writeable by a standard user where the target DLL can be placed */\n   process.args : (\"C:\\\\Users\\\\*.dll\", \"C:\\\\ProgramData\\\\*.dll\", \"C:\\\\Windows\\\\Temp\\\\*.dll\", \"C:\\\\Windows\\\\Tasks\\\\*.dll\")\n","filters":[],"throttle":"no_actions","actions":[]}
{"id":"d82e61d0-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T16:01:21.627Z","updated_by":"admin","created_at":"2021-09-22T15:57:53.946Z","created_by":"admin","name":"[GD] Attempt to Delete an Okta Network Zone","tags":["Continuous Monitoring","Elastic","Identity","Network Security","Okta","SecOps"],"interval":"5m","enabled":false,"description":"Detects attempts to delete an Okta network zone. Okta network zones can be configured to limit or restrict access to a network based on IP addresses or geolocations. An adversary may attempt to modify, delete, or deactivate an Okta network zone in order to remove or weaken an organization's security controls.","risk_score":47,"severity":"medium","note":"The Okta Fleet integration or Filebeat module must be enabled to use this rule.","license":"Elastic License v2","output_index":".siem-signals-default","meta":{"from":"1m"},"timestamp_override":"event.ingested","author":["Elastic"],"false_positives":["Consider adding exceptions to this rule to filter false positives if Oyour organization's Okta network zones are regularly deleted."],"from":"now-360s","rule_id":"df438fd0-7930-497e-b649-72688c33b7e0","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[],"to":"now","references":["https://help.okta.com/en/prod/Content/Topics/Security/network/network-zones.htm","https://developer.okta.com/docs/reference/api/system-log/","https://developer.okta.com/docs/reference/api/event-types/"],"version":4,"exceptions_list":[],"immutable":false,"type":"query","language":"kuery","index":["okta-*"],"query":"event.dataset:okta.system and event.action:zone.delete","filters":[],"throttle":"no_actions","actions":[]}
{"id":"cd81af80-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T15:57:35.246Z","updated_by":"admin","created_at":"2021-09-22T15:57:35.246Z","created_by":"admin","name":"Unusual Linux Network Service [Duplicate]","tags":["Elastic","Host","Linux","ML","Threat Detection"],"interval":"15m","enabled":false,"description":"Identifies unusual listening ports on Linux instances that can indicate execution of unauthorized services, backdoors, or persistence mechanisms.","risk_score":21,"severity":"low","license":"Elastic License v2","output_index":".siem-signals-default","author":["Elastic"],"false_positives":["A newly installed program or one that rarely uses the network could trigger this alert."],"from":"now-45m","rule_id":"c3f5f9af-12d9-48ad-9176-8b4a78469c3d","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[],"to":"now","references":["https://www.elastic.co/guide/en/security/current/prebuilt-ml-jobs.html"],"version":4,"exceptions_list":[],"immutable":false,"type":"machine_learning","anomaly_threshold":50,"machine_learning_job_id":["linux_anomalous_network_service"],"throttle":"no_actions","actions":[]}
{"id":"cd4e6a80-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T15:57:34.902Z","updated_by":"admin","created_at":"2021-09-22T15:57:34.902Z","created_by":"admin","name":"Sudoers File Modification [Duplicate]","tags":["Elastic","Host","Linux","macOS","Privilege Escalation","Threat Detection"],"interval":"5m","enabled":false,"description":"A sudoers file specifies the commands that users or groups can run and from which terminals. Adversaries can take advantage of these configurations to execute commands as other users or spawn processes with higher privileges.","risk_score":47,"severity":"medium","license":"Elastic License v2","output_index":".siem-signals-default","timestamp_override":"event.ingested","author":["Elastic"],"false_positives":[],"from":"now-9m","rule_id":"f2da50e4-153e-4e1b-be3a-2bd0de6e92f6","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0004","name":"Privilege Escalation","reference":"https://attack.mitre.org/tactics/TA0004/"},"technique":[{"id":"T1548","name":"Abuse Elevation Control Mechanism","reference":"https://attack.mitre.org/techniques/T1548/","subtechnique":[{"id":"T1548.003","name":"Sudo and Sudo Caching","reference":"https://attack.mitre.org/techniques/T1548/003/"}]}]}],"to":"now","references":[],"version":7,"exceptions_list":[],"immutable":false,"type":"query","language":"kuery","index":["auditbeat-*","logs-endpoint.events.*"],"query":"event.category:file and event.type:change and file.path:(/etc/sudoers* or /private/etc/sudoers*)","throttle":"no_actions","actions":[]}
{"id":"cd45b7f1-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T15:57:34.849Z","updated_by":"admin","created_at":"2021-09-22T15:57:34.849Z","created_by":"admin","name":"Potential DNS Tunneling via Iodine [Duplicate]","tags":["Elastic","Host","Linux","Threat Detection"],"interval":"5m","enabled":false,"description":"Iodine is a tool for tunneling Internet protocol version 4 (IPV4) traffic over the DNS protocol to circumvent firewalls, network security groups, and network access lists while evading detection.","risk_score":73,"severity":"high","license":"Elastic License v2","output_index":".siem-signals-default","timestamp_override":"event.ingested","author":["Elastic"],"false_positives":["Normal use of Iodine is uncommon apart from security testing and research. Use by non-security engineers is very uncommon."],"from":"now-9m","rule_id":"6137f5e2-92f2-41fa-bba8-14e887504cbf","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[],"to":"now","references":["https://code.kryo.se/iodine/"],"version":7,"exceptions_list":[],"immutable":false,"type":"query","language":"kuery","index":["auditbeat-*","logs-endpoint.events.*"],"query":"event.category:process and event.type:(start or process_started) and process.name:(iodine or iodined)","throttle":"no_actions","actions":[]}
{"id":"d1b8c980-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T16:00:33.913Z","updated_by":"admin","created_at":"2021-09-22T15:57:42.890Z","created_by":"admin","name":"[GD] UAC Bypass Attempt via Elevated COM Internet Explorer Add-On Installer","tags":["Elastic","Host","Privilege Escalation","Threat Detection","Windows"],"interval":"5m","enabled":false,"description":"Identifies User Account Control (UAC) bypass attempts by abusing an elevated COM Interface to launch a malicious program. Attackers may attempt to bypass UAC to stealthily execute code with elevated permissions.","risk_score":47,"severity":"medium","license":"Elastic License v2","output_index":".siem-signals-default","meta":{"from":"4m"},"timestamp_override":"event.ingested","author":["Elastic"],"false_positives":[],"from":"now-540s","rule_id":"a4b4fa3c-337c-4a7e-a2cf-dd353e4a7800","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","technique":[{"reference":"https://attack.mitre.org/techniques/T1548/","name":"Abuse Elevation Control Mechanism","subtechnique":[{"reference":"https://attack.mitre.org/techniques/T1548/002/","name":"Bypass User Access Control","id":"T1548.002"}],"id":"T1548"}],"tactic":{"reference":"https://attack.mitre.org/tactics/TA0004/","name":"Privilege Escalation","id":"TA0004"}}],"to":"now","references":["https://swapcontext.blogspot.com/2020/11/uac-bypasses-from-comautoapprovallist.html"],"version":4,"exceptions_list":[],"immutable":false,"type":"eql","language":"eql","index":["windows-*"],"query":"process where event.type in (\"start\", \"process_started\") and\n process.executable : \"C:\\\\*\\\\AppData\\\\*\\\\Temp\\\\IDC*.tmp\\\\*.exe\" and\n process.parent.name : \"ieinstal.exe\" and process.parent.args : \"-Embedding\"\n\n /* uncomment once in winlogbeat */\n /* and not (process.code_signature.subject_name == \"Microsoft Corporation\" and process.code_signature.trusted == true) */\n","filters":[],"throttle":"no_actions","actions":[]}
{"id":"cd4a72e0-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T15:57:34.893Z","updated_by":"admin","created_at":"2021-09-22T15:57:34.893Z","created_by":"admin","name":"Hex Encoding/Decoding Activity [Duplicate]","tags":["Defense Evasion","Elastic","Host","Linux","Threat Detection"],"interval":"5m","enabled":false,"description":"Adversaries may encode/decode data in an attempt to evade detection by host- or network-based security controls.","risk_score":21,"severity":"low","license":"Elastic License v2","output_index":".siem-signals-default","timestamp_override":"event.ingested","author":["Elastic"],"false_positives":["Automated tools such as Jenkins may encode or decode files as part of their normal behavior. These events can be filtered by the process executable or username values."],"from":"now-9m","rule_id":"8c619897-9292-4b38-bc60-9e24c93c0272","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0005","name":"Defense Evasion","reference":"https://attack.mitre.org/tactics/TA0005/"},"technique":[{"id":"T1140","name":"Deobfuscate/Decode Files or Information","reference":"https://attack.mitre.org/techniques/T1140/"},{"id":"T1027","name":"Obfuscated Files or Information","reference":"https://attack.mitre.org/techniques/T1027/"}]}],"to":"now","references":[],"version":7,"exceptions_list":[],"immutable":false,"type":"query","language":"kuery","index":["auditbeat-*","logs-endpoint.events.*"],"query":"event.category:process and event.type:(start or process_started) and process.name:(hexdump or od or xxd)","throttle":"no_actions","actions":[]}
{"id":"cd460611-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T15:59:11.889Z","updated_by":"admin","created_at":"2021-09-22T15:57:35.844Z","created_by":"admin","name":"Carbon Black: Process demoted","tags":["Carbon Black","GD","POC"],"interval":"5m","enabled":false,"description":"This rules triggers when Carbon Black detects a process demoted event.","risk_score":47,"severity":"medium","license":"","output_index":".siem-signals-default","meta":{"from":"1m","kibana_siem_app_url":"https://cbbf317cf62e4dd9b9913c1cc96ca394.vpce.gdw55e.elastic-cloud.com:9243/app/security"},"timestamp_override":"event.ingested","author":[],"false_positives":[],"from":"now-360s","rule_id":"ca58fd67-b394-4038-8808-5426857d0e81","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[],"to":"now","references":[],"version":6,"exceptions_list":[],"immutable":false,"type":"query","language":"kuery","index":["carbon-black-*"],"query":"rule.description : \"Process demoted\"","filters":[],"throttle":"no_actions","actions":[]}
{"id":"cf8bfe72-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T15:57:38.703Z","updated_by":"admin","created_at":"2021-09-22T15:57:38.703Z","created_by":"admin","name":"User Discovery via Whoami [Duplicate]","tags":["Discovery","Elastic","Host","Linux","Threat Detection"],"interval":"5m","enabled":false,"description":"The whoami application was executed on a Linux host. This is often used by tools and persistence mechanisms to test for privileged access.","risk_score":21,"severity":"low","license":"Elastic License v2","output_index":".siem-signals-default","timestamp_override":"event.ingested","author":["Elastic"],"false_positives":["Security testing tools and frameworks may run this command. Some normal use of this command may originate from automation tools and frameworks."],"from":"now-9m","rule_id":"c30e6129-e5f7-48ba-9616-a933b468f1a3","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0007","name":"Discovery","reference":"https://attack.mitre.org/tactics/TA0007/"},"technique":[{"id":"T1033","name":"System Owner/User Discovery","reference":"https://attack.mitre.org/techniques/T1033/"}]}],"to":"now","references":[],"version":7,"exceptions_list":[],"immutable":false,"type":"query","language":"kuery","index":["auditbeat-*","logs-endpoint.events.*"],"query":"event.category:process and event.type:(start or process_started) and process.name:whoami","throttle":"no_actions","actions":[]}
{"id":"d6435ab0-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T16:00:32.727Z","updated_by":"admin","created_at":"2021-09-22T15:57:50.921Z","created_by":"admin","name":"[GD] Modification of Boot Configuration","tags":["Defense Evasion","Elastic","Host","Threat Detection","Windows"],"interval":"5m","enabled":false,"description":"Identifies use of bcdedit.exe to delete boot configuration data. This tactic is sometimes used as by malware or an attacker as a destructive technique.","risk_score":21,"severity":"low","license":"Elastic License v2","output_index":".siem-signals-default","meta":{"from":"4m"},"timestamp_override":"event.ingested","author":["Elastic"],"false_positives":[],"from":"now-540s","rule_id":"ae669915-9dfc-47f3-8d2f-98f6de3fbf4a","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","technique":[{"reference":"https://attack.mitre.org/techniques/T1070/","name":"Indicator Removal on Host","subtechnique":[{"reference":"https://attack.mitre.org/techniques/T1070/004/","name":"File Deletion","id":"T1070.004"}],"id":"T1070"}],"tactic":{"reference":"https://attack.mitre.org/tactics/TA0005/","name":"Defense Evasion","id":"TA0005"}}],"to":"now","references":[],"version":8,"exceptions_list":[],"immutable":false,"type":"query","language":"kuery","index":["windows-*"],"query":"event.category:process and event.type:(start or process_started) and process.name:bcdedit.exe and process.args:(/set and (bootstatuspolicy and ignoreallfailures or no and recoveryenabled))","filters":[],"throttle":"no_actions","actions":[]}
{"id":"cf8a9ee1-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T15:57:38.669Z","updated_by":"admin","created_at":"2021-09-22T15:57:38.669Z","created_by":"admin","name":"Potential Privilege Escalation via Sudoers File Modification [Duplicate]","tags":["Elastic","Host","Linux","macOS","Privilege Escalation","Threat Detection"],"interval":"5m","enabled":false,"description":"A sudoers file specifies the commands users or groups can run and from which terminals. Adversaries can take advantage of these configurations to execute commands as other users or spawn processes with higher privileges.","risk_score":73,"severity":"high","license":"Elastic License v2","output_index":".siem-signals-default","timestamp_override":"event.ingested","author":["Elastic"],"false_positives":[],"from":"now-9m","rule_id":"fa983b58-d4e2-4a26-9f17-c211fd8fd4b7","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0004","name":"Privilege Escalation","reference":"https://attack.mitre.org/tactics/TA0004/"},"technique":[{"id":"T1548","name":"Abuse Elevation Control Mechanism","reference":"https://attack.mitre.org/techniques/T1548/","subtechnique":[{"id":"T1548.003","name":"Sudo and Sudo Caching","reference":"https://attack.mitre.org/techniques/T1548/003/"}]}]}],"to":"now","references":[],"version":1,"exceptions_list":[],"immutable":false,"type":"query","language":"kuery","index":["auditbeat-*","logs-endpoint.events.*"],"query":"event.category:process and event.type:start and process.args:(echo and *NOPASSWD*ALL*)","throttle":"no_actions","actions":[]}
{"id":"c1990500-99a4-11ec-ab18-0d51419cd75c","updated_at":"2022-03-04T20:34:22.753Z","updated_by":"jprentice1@godaddy.com","created_at":"2022-03-01T21:15:45.209Z","created_by":"admin","name":"IDS Alert - Top 10 IPs","tags":["GD","Security"],"interval":"24h","enabled":false,"description":"Opens a case daily with link to IDS dashboard. **Still need to schedule as daily action, with link to dashboard in webhook action**\nURL to IDS dashboard: https://827ebd6fd06146bea2d2ad3a453d7e43.vpce.gdw55e.elastic-cloud.com:9243/app/dashboards#/view/7b206310-5dfa-11ec-9d1e-5b56ec0d9762?_g=(filters:!(),query:(language:kuery,query:''))","risk_score":21,"severity":"low","license":"","output_index":".siem-signals-default","meta":{"from":"144h","kibana_siem_app_url":"https://security-prod.kibana.int.gdcorp.tools/app/security"},"author":[],"false_positives":[],"from":"now-604800s","rule_id":"1868dc5a-690d-4645-a67c-f5db55473281","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[],"to":"now","references":[],"version":8,"exceptions_list":[],"immutable":false,"type":"threshold","language":"kuery","index":["*:onprem-*"],"query":"","filters":[{"$state":{"store":"appState"},"meta":{"negate":false,"alias":null,"disabled":false,"type":"phrase","params":{"query":"SECURITY.GEN.ALL.IDS.PROD"},"key":"aws.fluent_data"},"query":{"match_phrase":{"aws.fluent_data":"SECURITY.GEN.ALL.IDS.PROD"}}}],"threshold":{"field":["aws.fluent_data"],"value":1,"cardinality":[]},"throttle":"rule","actions":[{"group":"default","id":"56fd1b40-5f85-11ec-9d1e-5b56ec0d9762","params":{"body":"{\n  \"short_description\": \"Elastic Test - DSR - IDS Alerts Review - Top 10 IPs\",\n  \"assignment_group\": \"OPS-GCSO\",\n  \"category\": \"Unauthorized access\",\n  \"contact_type\": \"siem\",\n  \"description\": \"Daily Reminder: Review IDS Alerts Review - Top 10 IPs dashboard. \\nhttps://security-prod.kibana.int.gdcorp.tools/app/dashboards#/view/7b206310-5dfa-11ec-9d1e-5b56ec0d9762\",\n  \"priority\": \"4\",\n  \"severity\": \"2\",\n  \"state\": \"10\"\n}"},"action_type_id":".webhook"}]}
{"id":"cf8d0fe1-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T15:57:38.733Z","updated_by":"admin","created_at":"2021-09-22T15:57:38.733Z","created_by":"admin","name":"Unusual Windows User Calling the Metadata Service [Duplicate]","tags":["Elastic","Host","ML","Threat Detection","Windows"],"interval":"15m","enabled":false,"description":"Looks for anomalous access to the cloud platform metadata service by an unusual user. The metadata service may be targeted in order to harvest credentials or user data scripts containing secrets.","risk_score":21,"severity":"low","license":"Elastic License v2","output_index":".siem-signals-default","author":["Elastic"],"false_positives":["A newly installed program, or one that runs under a new or rarely used user context, could trigger this detection rule. Manual interrogation of the metadata service during debugging or troubleshooting could trigger this rule."],"from":"now-45m","rule_id":"52e021d5-66a0-4cf2-8f1e-41653d50b7b8","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[],"to":"now","references":[],"version":2,"exceptions_list":[],"immutable":false,"type":"machine_learning","anomaly_threshold":75,"machine_learning_job_id":["windows_rare_metadata_user"],"throttle":"no_actions","actions":[]}
{"id":"d64a86a0-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T16:01:20.523Z","updated_by":"admin","created_at":"2021-09-22T15:57:50.922Z","created_by":"admin","name":"[GD] AWS IAM Group Creation","tags":["AWS","Cloud","Continuous Monitoring","Elastic","Identity and Access","SecOps"],"interval":"10m","enabled":false,"description":"Identifies the creation of a group in AWS Identity and Access Management (IAM). Groups specify permissions for multiple users. Any user in a group automatically has the permissions that are assigned to the group.","risk_score":21,"severity":"low","note":"The AWS Filebeat module must be enabled to use this rule.","license":"Elastic License v2","output_index":".siem-signals-default","meta":{"from":"50m"},"timestamp_override":"event.ingested","author":["Elastic"],"false_positives":["A group may be created by a system or network administrator. Verify whether the user identity, user agent, and/or hostname should be making changes in your environment. Group creations from unfamiliar users or hosts should be investigated. If known behavior is causing false positives, it can be exempted from the rule."],"from":"now-3600s","rule_id":"f6473789-ec71-4b63-958a-250850dc3281","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","technique":[{"reference":"https://attack.mitre.org/techniques/T1136/","name":"Create Account","subtechnique":[{"reference":"https://attack.mitre.org/techniques/T1136/003/","name":"Cloud Account","id":"T1136.003"}],"id":"T1136"}],"tactic":{"reference":"https://attack.mitre.org/tactics/TA0003/","name":"Persistence","id":"TA0003"}}],"to":"now","references":["https://awscli.amazonaws.com/v2/documentation/api/latest/reference/iam/create-group.html","https://docs.aws.amazon.com/IAM/latest/APIReference/API_CreateGroup.html"],"version":6,"exceptions_list":[],"immutable":false,"type":"query","language":"kuery","index":["aws-config-*","aws-cloudtrail-*"],"query":"event.action:CreateGroup and event.dataset:aws.cloudtrail and event.provider:iam.amazonaws.com and event.outcome:success","filters":[],"throttle":"no_actions","actions":[]}
{"id":"d82ed701-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T16:01:20.525Z","updated_by":"admin","created_at":"2021-09-22T15:57:53.954Z","created_by":"admin","name":"[GD] Attempt to Reset MFA Factors for an Okta User Account","tags":["Continuous Monitoring","Elastic","Identity","Identity and Access","Okta","SecOps"],"interval":"5m","enabled":false,"description":"Detects attempts to reset an Okta user's enrolled multi-factor authentication (MFA) factors. An adversary may attempt to reset the MFA factors for an Okta user's account in order to register new MFA factors and abuse the account to blend in with normal activity in the victim's environment.","risk_score":21,"severity":"low","note":"The Okta Fleet integration or Filebeat module must be enabled to use this rule.","license":"Elastic License v2","output_index":".siem-signals-default","meta":{"from":"1m"},"timestamp_override":"event.ingested","author":["Elastic"],"false_positives":["Consider adding exceptions to this rule to filter false positives if the MFA factors for Okta user accounts are regularly reset in your organization."],"from":"now-360s","rule_id":"12acc659-08c4-4e22-a170-64665af3be5b","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","technique":[{"reference":"https://attack.mitre.org/techniques/T1098/","name":"Account Manipulation","subtechnique":[],"id":"T1098"}],"tactic":{"reference":"https://attack.mitre.org/tactics/TA0003/","name":"Persistence","id":"TA0003"}}],"to":"now","references":["https://developer.okta.com/docs/reference/api/system-log/","https://developer.okta.com/docs/reference/api/event-types/"],"version":6,"exceptions_list":[],"immutable":false,"type":"query","language":"kuery","index":["okta-*"],"query":"event.dataset:okta.system and event.action:user.mfa.factor.reset_all","filters":[],"throttle":"no_actions","actions":[]}
{"id":"d82f4c30-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T16:01:21.420Z","updated_by":"admin","created_at":"2021-09-22T15:57:53.950Z","created_by":"admin","name":"[GD] High Number of Okta User Password Reset or Unlock Attempts","tags":["Continuous Monitoring","Elastic","Identity","Identity and Access","Okta","SecOps"],"interval":"5m","enabled":false,"description":"Identifies a high number of Okta user password reset or account unlock attempts. An adversary may attempt to obtain unauthorized access to an Okta user account using these methods and attempt to blend in with normal activity in their target's environment and evade detection.","risk_score":47,"severity":"medium","note":"The Okta Fleet integration or Filebeat module must be enabled to use this rule.","license":"Elastic License v2","output_index":".siem-signals-default","meta":{"from":"55m","kibana_siem_app_url":"https://cbbf317cf62e4dd9b9913c1cc96ca394.vpce.gdw55e.elastic-cloud.com:9243/app/security"},"author":["Elastic"],"false_positives":["The number of Okta user password reset or account unlock attempts will likely vary between organizations. To fit this rule to their organization, users can duplicate this rule and edit the schedule and threshold values in the new rule."],"from":"now-3600s","rule_id":"cbb9346e-7bb3-4623-a816-43b67047305e","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","technique":[{"reference":"https://attack.mitre.org/techniques/T1078/","name":"Valid Accounts","subtechnique":[],"id":"T1078"}],"tactic":{"reference":"https://attack.mitre.org/tactics/TA0005/","name":"Defense Evasion","id":"TA0005"}},{"framework":"MITRE ATT&CK","technique":[{"reference":"https://attack.mitre.org/techniques/T1078/","name":"Valid Accounts","subtechnique":[],"id":"T1078"}],"tactic":{"reference":"https://attack.mitre.org/tactics/TA0003/","name":"Persistence","id":"TA0003"}},{"framework":"MITRE ATT&CK","technique":[{"reference":"https://attack.mitre.org/techniques/T1078/","name":"Valid Accounts","subtechnique":[],"id":"T1078"}],"tactic":{"reference":"https://attack.mitre.org/tactics/TA0001/","name":"Initial Access","id":"TA0001"}}],"to":"now","references":["https://developer.okta.com/docs/reference/api/system-log/","https://developer.okta.com/docs/reference/api/event-types/"],"version":5,"exceptions_list":[],"immutable":false,"type":"threshold","language":"kuery","index":["okta-*"],"query":"event.dataset:okta.system and event.action:(system.email.account_unlock.sent_message or system.email.password_reset.sent_message or system.sms.send_account_unlock_message or system.sms.send_password_reset_message or system.voice.send_account_unlock_call or system.voice.send_password_reset_call or user.account.unlock_token)","filters":[],"threshold":{"field":["okta.actor.id"],"value":5,"cardinality":[]},"throttle":"no_actions","actions":[]}
{"id":"d82e88e1-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T16:01:21.426Z","updated_by":"admin","created_at":"2021-09-22T15:57:53.949Z","created_by":"admin","name":"[GD] Attempt to Create Okta API Token","tags":["Continuous Monitoring","Elastic","Identity","Monitoring","Okta","SecOps"],"interval":"5m","enabled":false,"description":"Detects attempts to create an Okta API token. An adversary may create an Okta API token to maintain access to an organization's network while they work to achieve their objectives. An attacker may abuse an API token to execute techniques such as creating user accounts or disabling security rules or policies.","risk_score":47,"severity":"medium","note":"The Okta Fleet integration or Filebeat module must be enabled to use this rule.","license":"Elastic License v2","output_index":".siem-signals-default","meta":{"from":"1m"},"timestamp_override":"event.ingested","author":["Elastic"],"false_positives":["If the behavior of creating Okta API tokens is expected, consider adding exceptions to this rule to filter false positives."],"from":"now-360s","rule_id":"3f90b225-3965-45c2-8faa-a1eaa9c647bf","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","technique":[{"reference":"https://attack.mitre.org/techniques/T1136/","name":"Create Account","subtechnique":[],"id":"T1136"}],"tactic":{"reference":"https://attack.mitre.org/tactics/TA0003/","name":"Persistence","id":"TA0003"}}],"to":"now","references":["https://developer.okta.com/docs/reference/api/system-log/","https://developer.okta.com/docs/reference/api/event-types/"],"version":7,"exceptions_list":[],"immutable":false,"type":"query","language":"kuery","index":["okta-*"],"query":"event.dataset:okta.system and event.action:system.api_token.create","filters":[],"throttle":"no_actions","actions":[]}
{"id":"d82f2521-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T16:01:21.481Z","updated_by":"admin","created_at":"2021-09-22T15:57:53.945Z","created_by":"admin","name":"[GD] Attempt to Revoke Okta API Token","tags":["Continuous Monitoring","Elastic","Identity","Monitoring","Okta","SecOps"],"interval":"5m","enabled":false,"description":"Identifies attempts to revoke an Okta API token. An adversary may attempt to revoke or delete an Okta API token to disrupt an organization's business operations.","risk_score":21,"severity":"low","note":"The Okta Fleet integration or Filebeat module must be enabled to use this rule.","license":"Elastic License v2","output_index":".siem-signals-default","meta":{"from":"1m"},"timestamp_override":"event.ingested","author":["Elastic"],"false_positives":["If the behavior of revoking Okta API tokens is expected, consider adding exceptions to this rule to filter false positives."],"from":"now-360s","rule_id":"aee636e7-73a3-44ab-a612-3b636237eedd","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","technique":[{"reference":"https://attack.mitre.org/techniques/T1531/","name":"Account Access Removal","subtechnique":[],"id":"T1531"}],"tactic":{"reference":"https://attack.mitre.org/tactics/TA0040/","name":"Impact","id":"TA0040"}}],"to":"now","references":["https://developer.okta.com/docs/reference/api/system-log/","https://developer.okta.com/docs/reference/api/event-types/"],"version":6,"exceptions_list":[],"immutable":false,"type":"query","language":"kuery","index":["okta-*"],"query":"event.dataset:okta.system and event.action:system.api_token.revoke","filters":[],"throttle":"no_actions","actions":[]}
{"id":"cd81fda0-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T15:57:35.230Z","updated_by":"admin","created_at":"2021-09-22T15:57:35.230Z","created_by":"admin","name":"Anomalous Kernel Module Activity [Duplicate]","tags":["Elastic","Host","Linux","ML","Threat Detection"],"interval":"15m","enabled":false,"description":"Looks for unusual kernel module activity. Kernel modules are sometimes used by malware and persistence mechanisms for stealth.","risk_score":21,"severity":"low","license":"Elastic License v2","output_index":".siem-signals-default","author":["Elastic"],"false_positives":["A Linux host running unusual device drivers or other kinds of kernel modules could trigger this detection. Troubleshooting or debugging activity using unusual arguments could also trigger this detection."],"from":"now-45m","rule_id":"d99afcad-c315-40db-b5fa-9564c4407c47","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0003","name":"Persistence","reference":"https://attack.mitre.org/tactics/TA0003/"},"technique":[{"id":"T1547","name":"Boot or Logon Autostart Execution","reference":"https://attack.mitre.org/techniques/T1547/","subtechnique":[{"id":"T1547.006","name":"Kernel Modules and Extensions","reference":"https://attack.mitre.org/techniques/T1547/006/"}]}]}],"to":"now","references":["references"],"version":3,"exceptions_list":[],"immutable":false,"type":"machine_learning","anomaly_threshold":25,"machine_learning_job_id":["linux_rare_kernel_module_arguments"],"throttle":"no_actions","actions":[]}
{"id":"d6488ad0-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T16:00:34.136Z","updated_by":"admin","created_at":"2021-09-22T15:57:50.928Z","created_by":"admin","name":"[GD] Spike in AWS Error Messages","tags":["AWS","Cloud","Elastic","ML"],"interval":"15m","enabled":false,"description":"A machine learning job detected a significant spike in the rate of a particular error in the CloudTrail messages. Spikes in error messages may accompany attempts at privilege escalation, lateral movement, or discovery.","risk_score":21,"severity":"low","note":"### Investigating Spikes in CloudTrail Errors ###\nDetection alerts from this rule indicate a large spike in the number of CloudTrail log messages that contain a particular error message. The error message in question was associated with the response to an AWS API command or method call. Here are some possible avenues of investigation:\n- Examine the history of the error. Has it manifested before? If the error, which is visible in the `aws.cloudtrail.error_message` field, manifested only very recently, it might be related to recent changes in an automation module or script.\n- Examine the request parameters. These may provide indications as to the nature of the task being performed when the error occurred. Is the error related to unsuccessful attempts to enumerate or access objects, data or secrets? If so, this can sometimes be a byproduct of discovery, privilege escalation or lateral movement attempts.\n- Consider the user as identified by the user.name field. Is this activity part of an expected workflow for the user context? Examine the user identity in the `aws.cloudtrail.user_identity.arn` field and the access key id in the `aws.cloudtrail.user_identity.access_key_id` field which can help identify the precise user context. The user agent details in the `user_agent.original` field may also indicate what kind of a client made the request.\n- Consider the source IP address and geolocation for the calling user who issued the command. Do they look normal for the calling user? If the source is an EC2 IP address, is it associated with an EC2 instance in one of your accounts or could it be sourcing from an EC2 instance not under your control? If it is an authorized EC2 instance, is the activity associated with normal behavior for the instance role or roles? Are there any other alerts or signs of suspicious activity involving this instance?","license":"Elastic License v2","output_index":".siem-signals-default","meta":{"from":"45m"},"author":["Elastic"],"false_positives":["Spikes in error message activity can also be due to bugs in cloud automation scripts or workflows; changes to cloud automation scripts or workflows; adoption of new services; changes in the way services are used; or changes to IAM privileges."],"from":"now-3600s","rule_id":"2f6b705d-403a-40a3-8135-a42cf8b97dc3","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[],"to":"now","references":["https://www.elastic.co/guide/en/security/current/prebuilt-ml-jobs.html"],"version":4,"exceptions_list":[],"immutable":false,"type":"machine_learning","anomaly_threshold":50,"machine_learning_job_id":["high_distinct_count_error_message"],"throttle":"no_actions","actions":[]}
{"id":"d832f5b0-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T16:01:21.592Z","updated_by":"admin","created_at":"2021-09-22T15:57:53.950Z","created_by":"admin","name":"[GD] Attempt to Delete an Okta Application","tags":["Continuous Monitoring","Elastic","Identity","Monitoring","Okta","SecOps"],"interval":"5m","enabled":false,"description":"Detects attempts to delete an Okta application. An adversary may attempt to modify, deactivate, or delete an Okta application in order to weaken an organization's security controls or disrupt their business operations.","risk_score":21,"severity":"low","note":"The Okta Fleet integration or Filebeat module must be enabled to use this rule.","license":"Elastic License v2","output_index":".siem-signals-default","meta":{"from":"1m"},"timestamp_override":"event.ingested","author":["Elastic"],"false_positives":["Consider adding exceptions to this rule to filter false positives if your organization's Okta applications are regularly deleted and the behavior is expected."],"from":"now-360s","rule_id":"6a6b8158-f247-44e7-9e66-b1f80415f202","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[],"to":"now","references":["https://developer.okta.com/docs/reference/api/system-log/","https://developer.okta.com/docs/reference/api/event-types/"],"version":4,"exceptions_list":[],"immutable":false,"type":"query","language":"kuery","index":["okta-*"],"query":"event.dataset:okta.system and event.action:application.lifecycle.delete","filters":[],"throttle":"no_actions","actions":[]}
{"id":"cd835d31-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T15:57:35.255Z","updated_by":"admin","created_at":"2021-09-22T15:57:35.255Z","created_by":"admin","name":"Anomalous Process For a Linux Population [Duplicate]","tags":["Elastic","Host","Linux","ML","Threat Detection"],"interval":"15m","enabled":false,"description":"Searches for rare processes running on multiple Linux hosts in an entire fleet or network. This reduces the detection of false positives since automated maintenance processes usually only run occasionally on a single machine but are common to all or many hosts in a fleet.","risk_score":21,"severity":"low","note":"### Investigating an Unusual Linux Process ###\nDetection alerts from this rule indicate the presence of a Linux process that is rare and unusual for all of the monitored Linux hosts for which Auditbeat data is available. Here are some possible avenues of investigation:\n- Consider the user as identified by the username field. Is this program part of an expected workflow for the user who ran this program on this host?\n- Examine the history of execution. If this process manifested only very recently, it might be part of a new software package. If it has a consistent cadence - for example if it runs monthly or quarterly - it might be part of a monthly or quarterly business process.\n- Examine the process arguments, title and working directory. These may provide indications as to the source of the program or the nature of the tasks it is performing.","license":"Elastic License v2","output_index":".siem-signals-default","author":["Elastic"],"false_positives":["A newly installed program or one that runs rarely as part of a monthly or quarterly workflow could trigger this alert."],"from":"now-45m","rule_id":"d9f75622-8afb-47ed-b774-fd3fa126d684","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[],"to":"now","references":["https://www.elastic.co/guide/en/security/current/prebuilt-ml-jobs.html"],"version":4,"exceptions_list":[],"immutable":false,"type":"machine_learning","anomaly_threshold":50,"machine_learning_job_id":["linux_anomalous_process_all_hosts_ecs"],"throttle":"no_actions","actions":[]}
{"id":"d1b19d91-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T16:00:33.813Z","updated_by":"admin","created_at":"2021-09-22T15:57:42.887Z","created_by":"admin","name":"[GD] Microsoft Exchange Server UM Spawning Suspicious Processes","tags":["Elastic","Host","Initial Access","Threat Detection","Windows"],"interval":"5m","enabled":false,"description":"Identifies suspicious processes being spawned by the Microsoft Exchange Server Unified Messaging (UM) service. This activity has been observed exploiting CVE-2021-26857.","risk_score":47,"severity":"medium","license":"Elastic License v2","output_index":".siem-signals-default","meta":{"from":"4m"},"timestamp_override":"event.ingested","author":["Elastic","Austin Songer"],"false_positives":["Legitimate processes may be spawned from the Microsoft Exchange Server Unified Messaging (UM) service. If known processes are causing false positives, they can be exempted from the rule."],"from":"now-540s","rule_id":"24a180a2-43ae-45ed-9067-057d6f52d52e","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","technique":[{"reference":"https://attack.mitre.org/techniques/T1190/","name":"Exploit Public-Facing Application","subtechnique":[],"id":"T1190"}],"tactic":{"reference":"https://attack.mitre.org/tactics/TA0001/","name":"Initial Access","id":"TA0001"}}],"to":"now","references":["https://www.microsoft.com/security/blog/2021/03/02/hafnium-targeting-exchange-servers","https://www.volexity.com/blog/2021/03/02/active-exploitation-of-microsoft-exchange-zero-day-vulnerabilities"],"version":2,"exceptions_list":[],"immutable":false,"type":"eql","language":"eql","index":["windows-*"],"query":"process where event.type == \"start\" and\n  process.parent.name : (\"UMService.exe\", \"UMWorkerProcess.exe\") and\n    not process.name : (\"werfault.exe\", \"wermgr.exe\")\n","filters":[],"throttle":"no_actions","actions":[]}
{"id":"cf8bd760-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T15:57:38.700Z","updated_by":"admin","created_at":"2021-09-22T15:57:38.700Z","created_by":"admin","name":"Anomalous Windows Process Creation [Duplicate]","tags":["Elastic","Host","ML","Threat Detection","Windows"],"interval":"15m","enabled":false,"description":"Identifies unusual parent-child process relationships that can indicate malware execution or persistence mechanisms. Malicious scripts often call on other applications and processes as part of their exploit payload. For example, when a malicious Office document runs scripts as part of an exploit payload, Excel or Word may start a script interpreter process, which, in turn, runs a script that downloads and executes malware. Another common scenario is Outlook running an unusual process when malware is downloaded in an email. Monitoring and identifying anomalous process relationships is a method of detecting new and emerging malware that is not yet recognized by anti-virus scanners.","risk_score":21,"severity":"low","license":"Elastic License v2","output_index":".siem-signals-default","author":["Elastic"],"false_positives":["Users running scripts in the course of technical support operations of software upgrades could trigger this alert. A newly installed program or one that runs rarely as part of a monthly or quarterly workflow could trigger this alert."],"from":"now-45m","rule_id":"5eb1be9a-f3fd-4050-871d-a6f275278344","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[],"to":"now","references":["https://www.elastic.co/guide/en/security/current/prebuilt-ml-jobs.html"],"version":4,"exceptions_list":[],"immutable":false,"type":"machine_learning","anomaly_threshold":50,"machine_learning_job_id":["windows_anomalous_process_creation"],"throttle":"no_actions","actions":[]}
{"id":"d832cea0-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T16:01:20.526Z","updated_by":"admin","created_at":"2021-09-22T15:57:53.953Z","created_by":"admin","name":"[GD] Attempt to Deactivate an Okta Policy Rule","tags":["Continuous Monitoring","Elastic","Identity","Identity and Access","Okta","SecOps"],"interval":"5m","enabled":false,"description":"Detects attempts to deactivate a rule within an Okta policy. An adversary may attempt to deactivate a rule within an Okta policy in order to remove or weaken an organization's security controls.","risk_score":47,"severity":"medium","note":"The Okta Fleet integration or Filebeat module must be enabled to use this rule.","license":"Elastic License v2","output_index":".siem-signals-default","meta":{"from":"1m"},"timestamp_override":"event.ingested","author":["Elastic"],"false_positives":["Consider adding exceptions to this rule to filter false positives if Okta MFA rules are regularly deactivated in your organization."],"from":"now-360s","rule_id":"13495726-cb43-4244-8359-40d2cc561caa","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[],"to":"now","references":["https://help.okta.com/en/prod/Content/Topics/Security/Security_Policies.htm","https://developer.okta.com/docs/reference/api/system-log/","https://developer.okta.com/docs/reference/api/event-types/"],"version":6,"exceptions_list":[],"immutable":false,"type":"query","language":"kuery","index":["okta-*"],"query":"event.dataset:okta.system and event.action:policy.rule.deactivate","filters":[],"throttle":"no_actions","actions":[]}
{"id":"d82deca1-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T16:01:20.529Z","updated_by":"admin","created_at":"2021-09-22T15:57:53.958Z","created_by":"admin","name":"[GD] Attempts to Brute Force an Okta User Account","tags":["Continuous Monitoring","Elastic","Identity","Identity and Access","Okta","SecOps"],"interval":"5m","enabled":false,"description":"Identifies when an Okta user account is locked out 3 times within a 3 hour window. An adversary may attempt a brute force or password spraying attack to obtain unauthorized access to user accounts. The default Okta authentication policy ensures that a user account is locked out after 10 failed authentication attempts.","risk_score":47,"severity":"medium","note":"The Okta Fleet integration or Filebeat module must be enabled to use this rule.","license":"Elastic License v2","output_index":".siem-signals-default","meta":{"from":"175m"},"author":["Elastic"],"false_positives":[],"from":"now-10800s","rule_id":"7c854fa2-b5fc-4d5e-a8fe-dc3e5e77ae2e","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","technique":[{"reference":"https://attack.mitre.org/techniques/T1110/","name":"Brute Force","subtechnique":[],"id":"T1110"}],"tactic":{"reference":"https://attack.mitre.org/tactics/TA0006/","name":"Credential Access","id":"TA0006"}}],"to":"now","references":["https://developer.okta.com/docs/reference/api/system-log/","https://developer.okta.com/docs/reference/api/event-types/"],"version":4,"exceptions_list":[],"immutable":false,"type":"threshold","language":"kuery","index":["okta-*"],"query":"event.dataset:okta.system and event.action:user.account.lock","filters":[],"threshold":{"field":["okta.actor.id"],"value":3,"cardinality":[]},"throttle":"no_actions","actions":[]}
{"id":"d832f5b1-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T16:01:21.441Z","updated_by":"admin","created_at":"2021-09-22T15:57:53.947Z","created_by":"admin","name":"[GD] Attempt to Deactivate an Okta Application","tags":["Continuous Monitoring","Elastic","Identity","Monitoring","Okta","SecOps"],"interval":"5m","enabled":false,"description":"Detects attempts to deactivate an Okta application. An adversary may attempt to modify, deactivate, or delete an Okta application in order to weaken an organization's security controls or disrupt their business operations.","risk_score":21,"severity":"low","note":"The Okta Fleet integration or Filebeat module must be enabled to use this rule.","license":"Elastic License v2","output_index":".siem-signals-default","meta":{"from":"1m"},"timestamp_override":"event.ingested","author":["Elastic"],"false_positives":["Consider adding exceptions to this rule to filter false positives if your organization's Okta applications are regularly deactivated and the behavior is expected."],"from":"now-360s","rule_id":"98a2745d-614d-4c49-aba7-90402e54df6d","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[],"to":"now","references":["https://help.okta.com/en/prod/Content/Topics/Apps/Apps_Apps.htm","https://developer.okta.com/docs/reference/api/system-log/","https://developer.okta.com/docs/reference/api/event-types/"],"version":4,"exceptions_list":[],"immutable":false,"type":"query","language":"kuery","index":["okta-*"],"query":"event.dataset:okta.system and event.action:application.lifecycle.deactivate","filters":[],"throttle":"no_actions","actions":[]}
{"id":"cd4a99f0-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T15:59:11.877Z","updated_by":"admin","created_at":"2021-09-22T15:57:35.843Z","created_by":"admin","name":"Okta: New MFA Added for Account","tags":["Okta","GD"],"interval":"5m","enabled":false,"description":"This detection trigger for \"system.mfa.factor.activate\" Okta events.\n\nFrom Okta Documentation:\n\nActivate a new MFA factor. Can be used to identify when an admin has enabled a new factor for MFA. When fired the event will contain details of which factor is enabled.","risk_score":21,"severity":"low","license":"","output_index":".siem-signals-default","meta":{"from":"1m","kibana_siem_app_url":"https://cbbf317cf62e4dd9b9913c1cc96ca394.vpce.gdw55e.elastic-cloud.com:9243/app/security"},"timestamp_override":"event.ingested","author":[],"false_positives":[],"from":"now-360s","rule_id":"39e0c131-ebd5-43bb-b3a5-c0e0db56d29f","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[],"to":"now","references":["https://developer.okta.com/docs/reference/api/event-types/#catalog"],"version":4,"exceptions_list":[],"immutable":false,"type":"query","language":"kuery","index":["okta-*"],"query":"event.action : \"user.mfa.factor.activate\" and okta.outcome.reason: User*factor","filters":[],"throttle":"no_actions","actions":[]}
{"id":"cf8bfe71-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T15:57:38.730Z","updated_by":"admin","created_at":"2021-09-22T15:57:38.730Z","created_by":"admin","name":"Interactive Terminal Spawned via Perl [Duplicate]","tags":["Elastic","Execution","Host","Linux","Threat Detection"],"interval":"5m","enabled":false,"description":"Identifies when a terminal (tty) is spawned via Perl. Attackers may upgrade a simple reverse shell to a fully interactive tty after obtaining initial access to a host.","risk_score":73,"severity":"high","license":"Elastic License v2","output_index":".siem-signals-default","timestamp_override":"event.ingested","author":["Elastic"],"false_positives":[],"from":"now-9m","rule_id":"ed5ea643-415a-4405-aefa-3ebb06ed30ed","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0002","name":"Execution","reference":"https://attack.mitre.org/tactics/TA0002/"},"technique":[{"id":"T1059","name":"Command and Scripting Interpreter","reference":"https://attack.mitre.org/techniques/T1059/"}]}],"to":"now","references":[],"version":6,"exceptions_list":[],"immutable":false,"type":"query","language":"kuery","index":["auditbeat-*","logs-endpoint.events.*"],"query":"event.category:process and event.type:(start or process_started) and process.name:perl and process.args:(\"exec \\\"/bin/sh\\\";\" or \"exec \\\"/bin/dash\\\";\" or \"exec \\\"/bin/bash\\\";\")","throttle":"no_actions","actions":[]}
{"id":"cf8aed01-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T15:57:38.675Z","updated_by":"admin","created_at":"2021-09-22T15:57:38.675Z","created_by":"admin","name":"Modification of Dynamic Linker Preload Shared Object [Duplicate]","tags":["Elastic","Host","Linux","Privilege Escalation","Threat Detection"],"interval":"5m","enabled":false,"description":"Identifies modification of the dynamic linker preload shared object (ld.so.preload). Adversaries may execute malicious payloads by hijacking the dynamic linker used to load libraries.","risk_score":47,"severity":"medium","license":"Elastic License v2","output_index":".siem-signals-default","timestamp_override":"event.ingested","author":["Elastic"],"false_positives":[],"from":"now-9m","rule_id":"d4d4359d-8335-4d7c-a8a5-0b585b79b091","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0004","name":"Privilege Escalation","reference":"https://attack.mitre.org/tactics/TA0004/"},"technique":[{"id":"T1574","name":"Hijack Execution Flow","reference":"https://attack.mitre.org/techniques/T1574/","subtechnique":[{"id":"T1574.006","name":"LD_PRELOAD","reference":"https://attack.mitre.org/techniques/T1574/006/"}]}]}],"to":"now","references":["https://www.anomali.com/blog/rocke-evolves-its-arsenal-with-a-new-malware-family-written-in-golang"],"version":1,"exceptions_list":[],"immutable":false,"type":"query","language":"kuery","index":["auditbeat-*","logs-endpoint.events.*"],"query":"event.category:file and not event.type:deletion and file.path:/etc/ld.so.preload","throttle":"no_actions","actions":[]}
{"id":"d64863c0-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T16:00:34.102Z","updated_by":"admin","created_at":"2021-09-22T15:57:50.917Z","created_by":"admin","name":"[GD] Unusual AWS Command for a User","tags":["AWS","Cloud","Elastic","ML"],"interval":"15m","enabled":false,"description":"A machine learning job detected an AWS API command that, while not inherently suspicious or abnormal, is being made by a user context that does not normally use the command. This can be the result of compromised credentials or keys as someone uses a valid account to persist, move laterally, or exfil data.","risk_score":21,"severity":"low","note":"### Investigating an Unusual CloudTrail Event ###\nDetection alerts from this rule indicate an AWS API command or method call that is rare and unusual for the calling IAM user. Here are some possible avenues of investigation:\n- Consider the user as identified by the `user.name` field. Is this command part of an expected workflow for the user context? Examine the user identity in the `aws.cloudtrail.user_identity.arn` field and the access key id in the `aws.cloudtrail.user_identity.access_key_id` field which can help identify the precise user context. The user agent details in the `user_agent.original` field may also indicate what kind of a client made the request.\n- Consider the source IP address and geolocation for the calling user who issued the command. Do they look normal for the calling user? If the source is an EC2 IP address, is it associated with an EC2 instance in one of your accounts or could it be sourcing from an EC2 instance not under your control? If it is an authorized EC2 instance, is the activity associated with normal behavior for the instance role or roles? Are there any other alerts or signs of suspicious activity involving this instance?\n- Consider the time of day. If the user is a human, not a program or script, did the activity take place during a normal time of day?\n- Examine the history of the command. If the command, which is visible in the `event.action field`, manifested only very recently, it might be part of a new automation module or script. If it has a consistent cadence - for example, if it appears in small numbers on a weekly or monthly cadence it might be part of a housekeeping or maintenance process.\n- Examine the request parameters. These may provide indications as to the source of the program or the nature of the tasks it is performing.","license":"Elastic License v2","output_index":".siem-signals-default","meta":{"from":"45m"},"author":["Elastic"],"false_positives":["New or unusual user command activity can be due to manual troubleshooting or reconfiguration; changes in cloud automation scripts or workflows; adoption of new services; or changes in the way services are used."],"from":"now-3600s","rule_id":"3c1f9a3d-b9f2-447a-8c3d-7bf0710b8b44","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[],"to":"now","references":["https://www.elastic.co/guide/en/security/current/prebuilt-ml-jobs.html"],"version":4,"exceptions_list":[],"immutable":false,"type":"machine_learning","anomaly_threshold":75,"machine_learning_job_id":["rare_method_for_a_username"],"throttle":"no_actions","actions":[]}
{"id":"cd45df00-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2022-02-23T16:12:39.695Z","updated_by":"admin","created_at":"2021-09-22T15:57:35.845Z","created_by":"admin","name":"Tanium Recorded Future Hash Threat Match","tags":["Tanium","GD"],"interval":"5m","enabled":false,"description":"Correlate Tanium process hashes with Recorded Future threat intelligence data.","risk_score":73,"severity":"high","license":"","output_index":".siem-signals-default","timeline_id":"11ac165d-d800-4290-9c70-cfb5c545f2c3","timeline_title":"Tanium Hash Indicator Match","meta":{"from":"6000h","kibana_siem_app_url":"https://cbbf317cf62e4dd9b9913c1cc96ca394.vpce.gdw55e.elastic-cloud.com:9243/app/security"},"author":[],"false_positives":[],"from":"now-21600300s","rule_id":"a5d7e8f8-03fa-4e1d-8665-fc59f3a1f54f","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[],"to":"now","references":[],"version":6,"exceptions_list":[],"immutable":false,"type":"threat_match","language":"kuery","index":["*:tanium-*"],"query":"hash.md5: *","filters":[],"threat_filters":[],"threat_query":"rf.algorithm : MD5","threat_mapping":[{"entries":[{"field":"hash.md5","type":"mapping","value":"threatintel.indicator.file.hash.md5"}]}],"threat_language":"kuery","threat_index":["rf_hash_risklist"],"threat_indicator_path":"","throttle":"no_actions","actions":[]}
{"id":"cd82c0f0-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T15:59:11.923Z","updated_by":"admin","created_at":"2021-09-22T15:57:35.844Z","created_by":"admin","name":"Unusual Low Log Rate for Domain Controller","tags":["GD","Windows"],"interval":"15m","enabled":false,"description":"Unusual Low Log Rate for Domain Controller","risk_score":47,"severity":"medium","license":"","output_index":".siem-signals-default","meta":{"from":"1m","kibana_siem_app_url":"https://cbbf317cf62e4dd9b9913c1cc96ca394.vpce.gdw55e.elastic-cloud.com:9243/app/security"},"author":[],"false_positives":[],"from":"now-960s","rule_id":"846422a0-70bc-46ad-ab5f-820566ff9ec0","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[],"to":"now","references":[],"version":1,"exceptions_list":[],"immutable":false,"type":"machine_learning","anomaly_threshold":90,"machine_learning_job_id":["low-log-rate-for-domain-controller-windows"],"throttle":"no_actions","actions":[]}
{"id":"d6450860-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T16:00:33.735Z","updated_by":"admin","created_at":"2021-09-22T15:57:50.918Z","created_by":"admin","name":"[GD] IIS HTTP Logging Disabled","tags":["Defense Evasion","Elastic","Host","Threat Detection","Windows"],"interval":"5m","enabled":false,"description":"Identifies when Internet Information Services (IIS) HTTP Logging is disabled on a server. An attacker with IIS server access via a webshell or other mechanism can disable HTTP Logging as an effective anti-forensics measure.","risk_score":73,"severity":"high","license":"Elastic License v2","output_index":".siem-signals-default","meta":{"from":"4m"},"timestamp_override":"event.ingested","author":["Elastic"],"false_positives":[],"from":"now-540s","rule_id":"e97a9bd2-9c93-49b5-bef6-100fe02a4ac0","max_signals":33,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","technique":[{"reference":"https://attack.mitre.org/techniques/T1070/","name":"Indicator Removal on Host","subtechnique":[],"id":"T1070"}],"tactic":{"reference":"https://attack.mitre.org/tactics/TA0005/","name":"Defense Evasion","id":"TA0005"}}],"to":"now","references":[],"version":5,"exceptions_list":[],"immutable":false,"type":"query","language":"kuery","index":["windows-*"],"query":"event.category:process and event.type:(start or process_started) and (process.name:appcmd.exe or process.pe.original_file_name:appcmd.exe) and process.args:/dontLog\\:\\\"True\\\" and not process.parent.name:iissetup.exe","filters":[],"throttle":"no_actions","actions":[]}
{"id":"d648d8f0-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T16:00:33.911Z","updated_by":"admin","created_at":"2021-09-22T15:57:50.932Z","created_by":"admin","name":"[GD] AWS IAM User Addition to Group","tags":["AWS","Cloud","Continuous Monitoring","Elastic","Identity and Access","SecOps"],"interval":"10m","enabled":false,"description":"Identifies the addition of a user to a specified group in AWS Identity and Access Management (IAM).","risk_score":21,"severity":"low","note":"The AWS Filebeat module must be enabled to use this rule.","license":"Elastic License v2","output_index":".siem-signals-default","meta":{"from":"50m"},"timestamp_override":"event.ingested","author":["Elastic"],"false_positives":["Adding users to a specified group may be done by a system or network administrator. Verify whether the user identity, user agent, and/or hostname should be making changes in your environment. User additions from unfamiliar users or hosts should be investigated. If known behavior is causing false positives, it can be exempted from the rule."],"from":"now-3600s","rule_id":"3061e022-891d-42c8-804f-2192f12cc6ce","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","technique":[],"tactic":{"reference":"https://attack.mitre.org/tactics/TA0006/","name":"Credential Access","id":"TA0006"}},{"framework":"MITRE ATT&CK","technique":[{"reference":"https://attack.mitre.org/techniques/T1098/","name":"Account Manipulation","subtechnique":[],"id":"T1098"}],"tactic":{"reference":"https://attack.mitre.org/tactics/TA0003/","name":"Persistence","id":"TA0003"}}],"to":"now","references":["https://docs.aws.amazon.com/IAM/latest/APIReference/API_AddUserToGroup.html"],"version":6,"exceptions_list":[],"immutable":false,"type":"query","language":"kuery","index":["aws-cloudtrail-*","aws-config-*"],"query":"event.action:AddUserToGroup and event.dataset:aws.cloudtrail and event.provider:iam.amazonaws.com and event.outcome:success","filters":[],"throttle":"no_actions","actions":[]}
{"id":"d1b19d90-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T15:59:30.307Z","updated_by":"admin","created_at":"2021-09-22T15:57:42.872Z","created_by":"admin","name":"[GD] Microsoft Build Engine Started by a System Process","tags":["Defense Evasion","Elastic","Host","Threat Detection","Windows"],"interval":"5m","enabled":false,"description":"An instance of MSBuild, the Microsoft Build Engine, was started by Explorer or the WMI (Windows Management Instrumentation) subsystem. This behavior is unusual and is sometimes used by malicious payloads.","risk_score":47,"severity":"medium","license":"Elastic License v2","output_index":".siem-signals-default","meta":{"from":"4m"},"timestamp_override":"event.ingested","author":["Elastic"],"false_positives":["The Build Engine is commonly used by Windows developers but use by non-engineers is unusual."],"from":"now-540s","rule_id":"5aa87c72-39cf-40d3-ab6e-4662840734e3","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","technique":[{"reference":"https://attack.mitre.org/techniques/T1127/","name":"Trusted Developer Utilities Proxy Execution","subtechnique":[],"id":"T1127"}],"tactic":{"reference":"https://attack.mitre.org/tactics/TA0005/","name":"Defense Evasion","id":"TA0005"}},{"framework":"MITRE ATT&CK","technique":[],"tactic":{"reference":"https://attack.mitre.org/tactics/TA0002/","name":"Execution","id":"TA0002"}}],"to":"now","references":[],"version":8,"exceptions_list":[],"immutable":false,"type":"query","language":"kuery","index":["windows-*"],"query":"event.category:process and event.type:(start or process_started) and process.name:MSBuild.exe and process.parent.name:(explorer.exe or wmiprvse.exe)","filters":[],"throttle":"no_actions","actions":[]}
{"id":"cd49af90-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T15:57:34.867Z","updated_by":"admin","created_at":"2021-09-22T15:57:34.867Z","created_by":"admin","name":"Sensitive Files Compression [Duplicate]","tags":["Collection","Credential Access","Elastic","Host","Linux","Threat Detection"],"interval":"5m","enabled":false,"description":"Identifies the use of a compression utility to collect known files containing sensitive information, such as credentials and system configurations.","risk_score":47,"severity":"medium","license":"Elastic License v2","output_index":".siem-signals-default","timestamp_override":"event.ingested","author":["Elastic"],"false_positives":[],"from":"now-9m","rule_id":"674f0b55-50e4-45bb-86c7-a14ee31b5603","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0006","name":"Credential Access","reference":"https://attack.mitre.org/tactics/TA0006/"},"technique":[{"id":"T1552","name":"Unsecured Credentials","reference":"https://attack.mitre.org/techniques/T1552/","subtechnique":[{"id":"T1552.001","name":"Credentials In Files","reference":"https://attack.mitre.org/techniques/T1552/001/"}]}]},{"framework":"MITRE ATT&CK","tactic":{"id":"TA0009","name":"Collection","reference":"https://attack.mitre.org/tactics/TA0009/"},"technique":[{"id":"T1560","name":"Archive Collected Data","reference":"https://attack.mitre.org/techniques/T1560/","subtechnique":[{"id":"T1560.001","name":"Archive via Utility","reference":"https://attack.mitre.org/techniques/T1560/001/"}]}]}],"to":"now","references":["https://www.trendmicro.com/en_ca/research/20/l/teamtnt-now-deploying-ddos-capable-irc-bot-tntbotinger.html"],"version":1,"exceptions_list":[],"immutable":false,"type":"query","language":"kuery","index":["auditbeat-*","logs-endpoint.events.*"],"query":"event.category:process and event.type:start and process.name:(zip or tar or gzip or hdiutil or 7z) and process.args: ( /root/.ssh/id_rsa or /root/.ssh/id_rsa.pub or /root/.ssh/id_ed25519 or /root/.ssh/id_ed25519.pub or /root/.ssh/authorized_keys or /root/.ssh/authorized_keys2 or /root/.ssh/known_hosts or /root/.bash_history or /etc/hosts or /home/*/.ssh/id_rsa or /home/*/.ssh/id_rsa.pub or /home/*/.ssh/id_ed25519 or /home/*/.ssh/id_ed25519.pub or /home/*/.ssh/authorized_keys or /home/*/.ssh/authorized_keys2 or /home/*/.ssh/known_hosts or /home/*/.bash_history or /root/.aws/credentials or /root/.aws/config or /home/*/.aws/credentials or /home/*/.aws/config or /root/.docker/config.json or /home/*/.docker/config.json or /etc/group or /etc/passwd or /etc/shadow or /etc/gshadow )","throttle":"no_actions","actions":[]}
{"id":"d82e3ac1-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T16:01:21.506Z","updated_by":"admin","created_at":"2021-09-22T15:57:53.946Z","created_by":"admin","name":"[GD] Attempt to Modify an Okta Application","tags":["Continuous Monitoring","Elastic","Identity","Monitoring","Okta","SecOps"],"interval":"5m","enabled":false,"description":"Detects attempts to modify an Okta application. An adversary may attempt to modify, deactivate, or delete an Okta application in order to weaken an organization's security controls or disrupt their business operations.","risk_score":21,"severity":"low","note":"The Okta Fleet integration or Filebeat module must be enabled to use this rule.","license":"Elastic License v2","output_index":".siem-signals-default","meta":{"from":"1m"},"timestamp_override":"event.ingested","author":["Elastic"],"false_positives":["Consider adding exceptions to this rule to filter false positives if your organization's Okta applications are regularly modified and the behavior is expected."],"from":"now-360s","rule_id":"5f663d57-2606-4d7b-9148-0e521586452b","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[],"to":"now","references":["https://help.okta.com/en/prod/Content/Topics/Apps/Apps_Apps.htm","https://developer.okta.com/docs/reference/api/system-log/","https://developer.okta.com/docs/reference/api/event-types/"],"version":4,"exceptions_list":[],"immutable":false,"type":"query","language":"kuery","index":["okta-*"],"query":"event.dataset:okta.system and event.action:application.lifecycle.update","filters":[],"throttle":"no_actions","actions":[]}
{"id":"d82eaff0-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T16:01:21.507Z","updated_by":"admin","created_at":"2021-09-22T15:57:53.953Z","created_by":"admin","name":"[GD] AWS EC2 Network Access Control List Creation","tags":["AWS","Cloud","Continuous Monitoring","Elastic","Network Security","SecOps"],"interval":"10m","enabled":false,"description":"Identifies the creation of an AWS Elastic Compute Cloud (EC2) network access control list (ACL) or an entry in a network ACL with a specified rule number.","risk_score":21,"severity":"low","note":"The AWS Filebeat module must be enabled to use this rule.","license":"Elastic License v2","output_index":".siem-signals-default","meta":{"from":"50m"},"timestamp_override":"event.ingested","author":["Elastic"],"false_positives":["Network ACL's may be created by a network administrator. Verify whether the user identity, user agent, and/or hostname should be making changes in your environment. Network ACL creations from unfamiliar users or hosts should be investigated. If known behavior is causing false positives, it can be exempted from the rule."],"from":"now-3600s","rule_id":"4a61c4c8-5761-40f6-b47e-7729ab729321","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","technique":[{"reference":"https://attack.mitre.org/techniques/T1133/","name":"External Remote Services","subtechnique":[],"id":"T1133"}],"tactic":{"reference":"https://attack.mitre.org/tactics/TA0003/","name":"Persistence","id":"TA0003"}}],"to":"now","references":["https://awscli.amazonaws.com/v2/documentation/api/latest/reference/ec2/create-network-acl.html","https://docs.aws.amazon.com/AWSEC2/latest/APIReference/API_CreateNetworkAcl.html","https://awscli.amazonaws.com/v2/documentation/api/latest/reference/ec2/create-network-acl-entry.html","https://docs.aws.amazon.com/AWSEC2/latest/APIReference/API_CreateNetworkAclEntry.html"],"version":6,"exceptions_list":[],"immutable":false,"type":"query","language":"kuery","index":["aws-cloudtrail-*","aws-config-*"],"query":"event.action:(CreateNetworkAcl or CreateNetworkAclEntry) and event.dataset:aws.cloudtrail and event.provider:ec2.amazonaws.com and event.outcome:success","filters":[],"throttle":"no_actions","actions":[]}
{"id":"cd4a4bd1-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T15:59:11.875Z","updated_by":"admin","created_at":"2021-09-22T15:57:35.839Z","created_by":"admin","name":"Okta: New Device Enrolled","tags":["Okta","GD"],"interval":"5m","enabled":false,"description":"This rule triggers when a \"device.enrollment.create\" event is detection. This event is fired during Okta Device Authenticator enrollment when the device used to enroll is unknown. This can be used by any admin to monitor when a new device is registered successfully for Okta Verify. The user must have below the max allowed devices and a valid device state (not suspended or deactivated).The targets field contains key details of the enrolled device including name, status, serialNumber, imei, meid, osVersion, osPlatform. which may be useful for identifying the device, tracking which device platforms and OS versions that enrolled in Okta Device Authenticator.","risk_score":21,"severity":"low","license":"","output_index":".siem-signals-default","meta":{"from":"1m","kibana_siem_app_url":"https://cbbf317cf62e4dd9b9913c1cc96ca394.vpce.gdw55e.elastic-cloud.com:9243/app/security"},"timestamp_override":"event.ingested","author":[],"false_positives":[],"from":"now-360s","rule_id":"2bb96c86-b70e-46a2-abf6-5eebae9d289f","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[],"to":"now","references":["https://developer.okta.com/docs/reference/api/event-types/#catalog"],"version":4,"exceptions_list":[],"immutable":false,"type":"query","language":"kuery","index":["okta-*"],"query":"event.action: \"system.email.new_device_notification.sent_message\"","filters":[],"throttle":"no_actions","actions":[]}
{"id":"d1a40900-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T15:59:11.886Z","updated_by":"admin","created_at":"2021-09-22T15:57:42.868Z","created_by":"admin","name":"[GD] Microsoft Build Engine Started an Unusual Process","tags":["Defense Evasion","Elastic","Host","Threat Detection","Windows"],"interval":"5m","enabled":false,"description":"An instance of MSBuild, the Microsoft Build Engine, started a PowerShell script or the Visual C# Command Line Compiler. This technique is sometimes used to deploy a malicious payload using the Build Engine.","risk_score":21,"severity":"low","license":"Elastic License v2","output_index":".siem-signals-default","meta":{"from":"4m"},"timestamp_override":"event.ingested","author":["Elastic"],"false_positives":["The Build Engine is commonly used by Windows developers but use by non-engineers is unusual. If a build system triggers this rule it can be exempted by process, user or host name."],"from":"now-540s","rule_id":"ca6a8e8b-8a1f-4d97-aae3-412befe2ac04","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","technique":[{"reference":"https://attack.mitre.org/techniques/T1027/","name":"Obfuscated Files or Information","subtechnique":[{"reference":"https://attack.mitre.org/techniques/T1027/004/","name":"Compile After Delivery","id":"T1027.004"}],"id":"T1027"}],"tactic":{"reference":"https://attack.mitre.org/tactics/TA0005/","name":"Defense Evasion","id":"TA0005"}}],"to":"now","references":["https://blog.talosintelligence.com/2020/02/building-bypass-with-msbuild.html"],"version":8,"exceptions_list":[],"immutable":false,"type":"query","language":"kuery","index":["windows-*"],"query":"event.category:process and event.type:(start or process_started) and process.parent.name:MSBuild.exe and process.name:(csc.exe or iexplore.exe or powershell.exe)","filters":[],"throttle":"no_actions","actions":[]}
{"id":"cd4569d0-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T15:59:11.902Z","updated_by":"admin","created_at":"2021-09-22T15:57:35.841Z","created_by":"admin","name":"Carbon Black Rule Description (New File or First Execution)","tags":["Carbon Black","POC","GD"],"interval":"5m","enabled":false,"description":"CB rule to hit on rule.description looking for two different descriptions related to the first time seeing / executing a file in the network.","risk_score":55,"severity":"medium","license":"","output_index":".siem-signals-default","meta":{"from":"1m","kibana_siem_app_url":"https://cbbf317cf62e4dd9b9913c1cc96ca394.vpce.gdw55e.elastic-cloud.com:9243/app/security"},"timestamp_override":"event.ingested","author":[],"false_positives":[],"from":"now-360s","rule_id":"df3fa4c8-d6de-4489-be6e-474137129774","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[],"to":"now","references":[],"version":4,"exceptions_list":[],"immutable":false,"type":"query","language":"kuery","index":["carbon-black-*"],"query":"rule.description : (\"First execution on network\" or \"New file on network\")","filters":[],"throttle":"no_actions","actions":[]}
{"id":"cf891841-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T15:57:38.661Z","updated_by":"admin","created_at":"2021-09-22T15:57:38.661Z","created_by":"admin","name":"Bash Shell Profile Modification [Duplicate]","tags":["Elastic","Host","Linux","macOS","Persistence","Threat Detection"],"interval":"5m","enabled":false,"description":"Both ~/.bash_profile and ~/.bashrc are files containing shell commands that are run when Bash is invoked. These files are executed in a user's context, either interactively or non-interactively, when a user logs in so that their environment is set correctly. Adversaries may abuse this to establish persistence by executing malicious content triggered by a users shell.","risk_score":47,"severity":"medium","license":"Elastic License v2","output_index":".siem-signals-default","timestamp_override":"event.ingested","author":["Elastic"],"false_positives":["Changes to the Shell Profile tend to be noisy, a tuning per your environment will be required."],"from":"now-9m","rule_id":"896f09d1-42fc-4c1a-8dae-4057488abde5","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0003","name":"Persistence","reference":"https://attack.mitre.org/tactics/TA0003/"},"technique":[{"id":"T1546","name":"Event Triggered Execution","reference":"https://attack.mitre.org/techniques/T1546/","subtechnique":[{"id":"T1546.004","name":".bash_profile and .bashrc","reference":"https://attack.mitre.org/techniques/T1546/004/"}]}]}],"to":"now","references":["https://www.anomali.com/blog/pulling-linux-rabbit-rabbot-malware-out-of-a-hat"],"version":1,"exceptions_list":[],"immutable":false,"type":"query","language":"kuery","index":["logs-endpoint.events.*","auditbeat-*"],"query":"event.category:file and event.type:change and process.name:(* and not (sudo or vim or zsh or env or nano or bash or Terminal or xpcproxy or login or cat or cp or launchctl or java)) and not process.executable:(/Applications/* or /private/var/folders/* or /usr/local/*) and file.path:(/private/etc/rc.local or /etc/rc.local or /home/*/.profile or /home/*/.profile1 or /home/*/.bash_profile or /home/*/.bash_profile1 or /home/*/.bashrc or /Users/*/.bash_profile or /Users/*/.zshenv)","throttle":"no_actions","actions":[]}
{"id":"cf8a77d0-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T15:57:38.667Z","updated_by":"admin","created_at":"2021-09-22T15:57:38.667Z","created_by":"admin","name":"Potential Reverse Shell Activity via Terminal [Duplicate]","tags":["Elastic","Execution","Host","Linux","macOS","Threat Detection"],"interval":"5m","enabled":false,"description":"Identifies the execution of a shell process with suspicious arguments which may be indicative of reverse shell activity.","risk_score":73,"severity":"high","license":"Elastic License v2","output_index":".siem-signals-default","timestamp_override":"event.ingested","author":["Elastic"],"false_positives":[],"from":"now-9m","rule_id":"ed520249-b55d-4a91-8ad4-5868e1a87e7b","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0002","name":"Execution","reference":"https://attack.mitre.org/tactics/TA0002/"},"technique":[{"id":"T1059","name":"Command and Scripting Interpreter","reference":"https://attack.mitre.org/techniques/T1059/"}]}],"to":"now","references":["https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Methodology%20and%20Resources/Reverse%20Shell%20Cheatsheet.md","https://github.com/WangYihang/Reverse-Shell-Manager","https://www.netsparker.com/blog/web-security/understanding-reverse-shells/"],"version":1,"exceptions_list":[],"immutable":false,"type":"eql","language":"eql","index":["auditbeat-*","logs-endpoint.events.*"],"query":"process where event.type in (\"start\", \"process_started\") and\n  process.name in (\"sh\", \"bash\", \"zsh\", \"dash\", \"zmodload\") and\n  process.args:(\"*/dev/tcp/*\", \"*/dev/udp/*\", \"zsh/net/tcp\", \"zsh/net/udp\")\n","throttle":"no_actions","actions":[]}
{"id":"cf8a77d1-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T15:57:38.664Z","updated_by":"admin","created_at":"2021-09-22T15:57:38.664Z","created_by":"admin","name":"Modification of OpenSSH Binaries [Duplicate]","tags":["Credential Access","Elastic","Host","Linux","Persistence","Threat Detection"],"interval":"5m","enabled":false,"description":"Adversaries may modify SSH related binaries for persistence or credential access by patching sensitive functions to enable unauthorized access or by logging SSH credentials for exfiltration.","risk_score":47,"severity":"medium","license":"Elastic License v2","output_index":".siem-signals-default","timestamp_override":"event.ingested","author":["Elastic"],"false_positives":["Trusted OpenSSH executable updates. It's recommended to verify the integrity of OpenSSH binary changes."],"from":"now-9m","rule_id":"69341e2a-6919-48a6-be96-a86392396c00","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0003","name":"Persistence","reference":"https://attack.mitre.org/tactics/TA0003/"},"technique":[{"id":"T1543","name":"Create or Modify System Process","reference":"https://attack.mitre.org/techniques/T1543/"}]},{"framework":"MITRE ATT&CK","tactic":{"id":"TA0006","name":"Credential Access","reference":"https://attack.mitre.org/tactics/TA0006/"},"technique":[{"id":"T1556","name":"Modify Authentication Process","reference":"https://attack.mitre.org/techniques/T1556/"}]}],"to":"now","references":["https://blog.angelalonso.es/2016/09/anatomy-of-real-linux-intrusion-part-ii.html"],"version":1,"exceptions_list":[],"immutable":false,"type":"query","language":"kuery","index":["auditbeat-*","logs-endpoint.events.*"],"query":"event.category:file and event.type:change and process.name:* and (file.path:(/usr/sbin/sshd or /usr/bin/ssh or /usr/bin/sftp or /usr/bin/scp) or file.name:libkeyutils.so) and not process.executable:/usr/bin/dpkg","throttle":"no_actions","actions":[]}
{"id":"d8320b50-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T16:01:21.625Z","updated_by":"admin","created_at":"2021-09-22T15:57:53.951Z","created_by":"admin","name":"[GD] Modification or Removal of an Okta Application Sign-On Policy","tags":["Continuous Monitoring","Elastic","Identity","Identity and Access","Okta","SecOps"],"interval":"5m","enabled":false,"description":"Detects attempts to modify or delete a sign on policy for an Okta application. An adversary may attempt to modify or delete the sign on policy for an Okta application in order to remove or weaken an organization's security controls.","risk_score":47,"severity":"medium","note":"The Okta Fleet integration or Filebeat module must be enabled to use this rule.","license":"Elastic License v2","output_index":".siem-signals-default","meta":{"from":"1m"},"timestamp_override":"event.ingested","author":["Elastic"],"false_positives":["Consider adding exceptions to this rule to filter false positives if sign on policies for Okta applications are regularly modified or deleted in your organization."],"from":"now-360s","rule_id":"bf5a2045-2a50-440d-9218-e6ee9cc75bfa","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[],"to":"now","references":["https://help.okta.com/en/prod/Content/Topics/Security/App_Based_Signon.htm","https://developer.okta.com/docs/reference/api/system-log/","https://developer.okta.com/docs/reference/api/event-types/"],"version":6,"exceptions_list":[],"immutable":false,"type":"query","language":"kuery","index":["okta-*"],"query":"event.dataset:okta.system and event.action:(application.policy.sign_on.update or application.policy.sign_on.rule.delete)","filters":[],"throttle":"no_actions","actions":[]}
{"id":"cd82e800-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T15:57:35.247Z","updated_by":"admin","created_at":"2021-09-22T15:57:35.247Z","created_by":"admin","name":"Unusual Process For a Linux Host [Duplicate]","tags":["Elastic","Host","Linux","ML","Threat Detection"],"interval":"15m","enabled":false,"description":"Identifies rare processes that do not usually run on individual hosts, which can indicate execution of unauthorized services, malware, or persistence mechanisms. Processes are considered rare when they only run occasionally as compared with other processes running on the host.","risk_score":21,"severity":"low","note":"### Investigating an Unusual Linux Process ###\nDetection alerts from this rule indicate the presence of a Linux process that is rare and unusual for the host it ran on. Here are some possible avenues of investigation:\n- Consider the user as identified by the username field. Is this program part of an expected workflow for the user who ran this program on this host?\n- Examine the history of execution. If this process manifested only very recently, it might be part of a new software package. If it has a consistent cadence - for example if it runs monthly or quarterly - it might be part of a monthly or quarterly business process.\n- Examine the process arguments, title and working directory. These may provide indications as to the source of the program or the nature of the tasks it is performing.","license":"Elastic License v2","output_index":".siem-signals-default","author":["Elastic"],"false_positives":["A newly installed program or one that runs rarely as part of a monthly or quarterly workflow could trigger this alert."],"from":"now-45m","rule_id":"33ce5a96-809a-4463-bc5a-2c847b918ed2","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[],"to":"now","references":["https://www.elastic.co/guide/en/security/current/prebuilt-ml-jobs.html"],"version":4,"exceptions_list":[],"immutable":false,"type":"machine_learning","anomaly_threshold":50,"machine_learning_job_id":["rare_process_by_host_linux_ecs"],"throttle":"no_actions","actions":[]}
{"id":"cd7ef060-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T15:57:35.215Z","updated_by":"admin","created_at":"2021-09-22T15:57:35.215Z","created_by":"admin","name":"Unusual Linux System Owner or User Discovery Activity [Duplicate]","tags":["Elastic","Host","Linux","ML","Threat Detection"],"interval":"15m","enabled":false,"description":"Looks for commands related to system user or owner discovery from an unusual user context. This can be due to uncommon troubleshooting activity or due to a compromised account. A compromised account may be used to engage in system owner or user discovery in order to identify currently active or primary users of a system. This may be a precursor to additional discovery, credential dumping or privilege elevation activity.","risk_score":21,"severity":"low","license":"Elastic License v2","output_index":".siem-signals-default","author":["Elastic"],"false_positives":["Uncommon user command activity can be due to an engineer logging onto a server instance in order to perform manual troubleshooting or reconfiguration."],"from":"now-45m","rule_id":"f180a88b-f584-4aaf-8d41-0bbffcf1f84d","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0007","name":"Discovery","reference":"https://attack.mitre.org/tactics/TA0007/"},"technique":[{"id":"T1033","name":"System Owner/User Discovery","reference":"https://attack.mitre.org/techniques/T1033/"}]}],"to":"now","references":[],"version":2,"exceptions_list":[],"immutable":false,"type":"machine_learning","anomaly_threshold":75,"machine_learning_job_id":["linux_system_user_discovery"],"throttle":"no_actions","actions":[]}
{"id":"cd813a50-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T15:57:35.227Z","updated_by":"admin","created_at":"2021-09-22T15:57:35.227Z","created_by":"admin","name":"Unusual Linux Process Discovery Activity [Duplicate]","tags":["Elastic","Host","Linux","ML","Threat Detection"],"interval":"15m","enabled":false,"description":"Looks for commands related to system process discovery from an unusual user context. This can be due to uncommon troubleshooting activity or due to a compromised account. A compromised account may be used by a threat actor to engage in system process discovery in order to increase their understanding of software applications running on a target host or network. This may be a precursor to selection of a persistence mechanism or a method of privilege elevation.","risk_score":21,"severity":"low","license":"Elastic License v2","output_index":".siem-signals-default","author":["Elastic"],"false_positives":["Uncommon user command activity can be due to an engineer logging onto a server instance in order to perform manual troubleshooting or reconfiguration."],"from":"now-45m","rule_id":"dbee2dc9-df2c-45e0-acfc-30a2c5a62b16","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0007","name":"Discovery","reference":"https://attack.mitre.org/tactics/TA0007/"},"technique":[{"id":"T1057","name":"Process Discovery","reference":"https://attack.mitre.org/techniques/T1057/"}]}],"to":"now","references":[],"version":2,"exceptions_list":[],"immutable":false,"type":"machine_learning","anomaly_threshold":50,"machine_learning_job_id":["linux_system_process_discovery"],"throttle":"no_actions","actions":[]}
{"id":"cd82e801-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T15:57:35.249Z","updated_by":"admin","created_at":"2021-09-22T15:57:35.249Z","created_by":"admin","name":"Unusual Linux User Calling the Metadata Service [Duplicate]","tags":["Elastic","Host","Linux","ML","Threat Detection"],"interval":"15m","enabled":false,"description":"Looks for anomalous access to the cloud platform metadata service by an unusual user. The metadata service may be targeted in order to harvest credentials or user data scripts containing secrets.","risk_score":21,"severity":"low","license":"Elastic License v2","output_index":".siem-signals-default","author":["Elastic"],"false_positives":["A newly installed program, or one that runs under a new or rarely used user context, could trigger this detection rule. Manual interrogation of the metadata service during debugging or troubleshooting could trigger this rule."],"from":"now-45m","rule_id":"6cafa87b-6a94-4439-bd4d-1f60dd7d0a30","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[],"to":"now","references":[],"version":2,"exceptions_list":[],"immutable":false,"type":"machine_learning","anomaly_threshold":75,"machine_learning_job_id":["linux_rare_metadata_user"],"throttle":"no_actions","actions":[]}
{"id":"cf8b6230-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T15:57:38.685Z","updated_by":"admin","created_at":"2021-09-22T15:57:38.685Z","created_by":"admin","name":"Mknod Process Activity [Duplicate]","tags":["Elastic","Host","Linux","Threat Detection"],"interval":"5m","enabled":false,"description":"The Linux mknod program is sometimes used in the command payload of a remote command injection (RCI) and other exploits. It is used to export a command shell when the traditional version of netcat is not available to the payload.","risk_score":21,"severity":"low","license":"Elastic License v2","output_index":".siem-signals-default","timestamp_override":"event.ingested","author":["Elastic"],"false_positives":["Mknod is a Linux system program. Some normal use of this program, at varying levels of frequency, may originate from scripts, automation tools, and frameworks. Usage by web servers is more likely to be suspicious."],"from":"now-9m","rule_id":"4c245f43-4621-447b-826b-ee08aa96e8f7","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[],"to":"now","references":["https://web.archive.org/web/20191218024607/https://pen-testing.sans.org/blog/2013/05/06/netcat-without-e-no-problem/"],"version":7,"exceptions_list":[],"immutable":false,"type":"query","language":"kuery","index":["auditbeat-*","logs-endpoint.events.*"],"query":"event.category:process and event.type:(start or process_started) and process.name:mknod","throttle":"no_actions","actions":[]}
{"id":"d3da49f1-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T15:59:47.294Z","updated_by":"admin","created_at":"2021-09-22T15:57:46.913Z","created_by":"admin","name":"[GD] Net command via SYSTEM account","tags":["Discovery","Elastic","Host","Threat Detection","Windows"],"interval":"5m","enabled":false,"description":"Identifies the SYSTEM account using an account discovery utility. This could be a sign of discovery activity after an adversary has achieved privilege escalation.","risk_score":21,"severity":"low","license":"Elastic License v2","output_index":".siem-signals-default","meta":{"from":"4m"},"timestamp_override":"event.ingested","author":["Elastic"],"false_positives":[],"from":"now-540s","rule_id":"e928067e-790e-46ab-8614-b211e5579716","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","technique":[{"reference":"https://attack.mitre.org/techniques/T1087/","name":"Account Discovery","subtechnique":[],"id":"T1087"}],"tactic":{"reference":"https://attack.mitre.org/tactics/TA0007/","name":"Discovery","id":"TA0007"}}],"to":"now","references":[],"version":7,"exceptions_list":[],"immutable":false,"type":"query","language":"kuery","index":["windows-*"],"query":"event.category:process and event.type:(start or process_started) and (process.name:(whoami.exe or net.exe) or process.name:net1.exe and not process.parent.name:net.exe) and user.name:SYSTEM","filters":[],"throttle":"no_actions","actions":[]}
{"id":"d1b12860-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T15:59:30.244Z","updated_by":"admin","created_at":"2021-09-22T15:57:42.885Z","created_by":"admin","name":"[GD] Adding Hidden File Attribute via Attrib","tags":["Defense Evasion","Elastic","Host","Threat Detection","Windows"],"interval":"5m","enabled":false,"description":"Adversaries can add the 'hidden' attribute to files to hide them from the user in an attempt to evade detection.","risk_score":21,"severity":"low","license":"Elastic License v2","output_index":".siem-signals-default","meta":{"from":"4m"},"timestamp_override":"event.ingested","author":["Elastic"],"false_positives":[],"from":"now-540s","rule_id":"40cd13a6-e805-414e-b614-b8763a9a8dd4","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","technique":[{"reference":"https://attack.mitre.org/techniques/T1564/","name":"Hide Artifacts","subtechnique":[{"reference":"https://attack.mitre.org/techniques/T1564/001/","name":"Hidden Files and Directories","id":"T1564.001"}],"id":"T1564"}],"tactic":{"reference":"https://attack.mitre.org/tactics/TA0005/","name":"Defense Evasion","id":"TA0005"}},{"framework":"MITRE ATT&CK","technique":[],"tactic":{"reference":"https://attack.mitre.org/tactics/TA0003/","name":"Persistence","id":"TA0003"}}],"to":"now","references":[],"version":9,"exceptions_list":[],"immutable":false,"type":"query","language":"kuery","index":["windows-*"],"query":"event.category:process and event.type:(start or process_started) and process.name:attrib.exe and process.args:+h","filters":[],"throttle":"no_actions","actions":[]}
{"id":"d1b212c1-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T15:59:30.281Z","updated_by":"admin","created_at":"2021-09-22T15:57:42.888Z","created_by":"admin","name":"[GD] Microsoft IIS Service Account Password Dumped","tags":["Credential Access","Elastic","Host","Threat Detection","Windows"],"interval":"5m","enabled":false,"description":"Identifies the Internet Information Services (IIS) command-line tool, AppCmd, being used to list passwords. An attacker with IIS web server access via a web shell can decrypt and dump the IIS AppPool service account password using AppCmd.","risk_score":73,"severity":"high","license":"Elastic License v2","output_index":".siem-signals-default","meta":{"from":"4m"},"timestamp_override":"event.ingested","author":["Elastic"],"false_positives":[],"from":"now-540s","rule_id":"603a5c97-6909-448f-92b0-72dd493a8b6e","max_signals":33,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","technique":[{"reference":"https://attack.mitre.org/techniques/T1003/","name":"OS Credential Dumping","subtechnique":[],"id":"T1003"}],"tactic":{"reference":"https://attack.mitre.org/tactics/TA0006/","name":"Credential Access","id":"TA0006"}}],"to":"now","references":["https://blog.netspi.com/decrypting-iis-passwords-to-break-out-of-the-dmz-part-1/"],"version":5,"exceptions_list":[],"immutable":false,"type":"eql","language":"eql","index":["windows-*"],"query":"process where event.type in (\"start\", \"process_started\") and\n   (process.name : \"appcmd.exe\" or process.pe.original_file_name == \"appcmd.exe\") and \n   process.args : \"/list\" and process.args : \"/text*password\"\n","filters":[],"throttle":"no_actions","actions":[]}
{"id":"d1b56e20-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T15:59:30.270Z","updated_by":"admin","created_at":"2021-09-22T15:57:42.904Z","created_by":"admin","name":"[GD] Potential DLL SideLoading via Trusted Microsoft Programs","tags":["Defense Evasion","Elastic","Host","Threat Detection","Windows"],"interval":"5m","enabled":false,"description":"Identifies an instance of a Windows trusted program that is known to be vulnerable to DLL Search Order Hijacking starting after being renamed or from a non-standard path. This is uncommon behavior and may indicate an attempt to evade defenses via side loading a malicious DLL within the memory space of one of those processes.","risk_score":73,"severity":"high","license":"Elastic License v2","output_index":".siem-signals-default","meta":{"from":"4m"},"timestamp_override":"event.ingested","author":["Elastic"],"false_positives":[],"from":"now-540s","rule_id":"00b13a30-9841-4552-86c6-466133a8e93a","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","technique":[{"reference":"https://attack.mitre.org/techniques/T1036/","name":"Masquerading","subtechnique":[],"id":"T1036"}],"tactic":{"reference":"https://attack.mitre.org/tactics/TA0005/","name":"Defense Evasion","id":"TA0005"}}],"to":"now","references":[],"version":5,"exceptions_list":[],"immutable":false,"type":"query","language":"kuery","index":["windows-*"],"query":"event.category:process and event.type:(start or process_started) and process.pe.original_file_name:(WinWord.exe or EXPLORER.EXE or w3wp.exe or DISM.EXE) and not (process.name:(winword.exe or WINWORD.EXE or explorer.exe or w3wp.exe or Dism.exe) or process.executable:(\"C:\\Windows\\explorer.exe\" or C\\:\\\\Program?Files\\\\Microsoft?Office\\\\root\\\\Office*\\\\WINWORD.EXE or C\\:\\\\Program?Files?\\(x86\\)\\\\Microsoft?Office\\\\root\\\\Office*\\\\WINWORD.EXE or \"C:\\Windows\\System32\\Dism.exe\" or \"C:\\Windows\\SysWOW64\\Dism.exe\" or \"C:\\Windows\\System32\\inetsrv\\w3wp.exe\"))","filters":[],"throttle":"no_actions","actions":[]}
{"id":"d1b52000-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T16:00:33.808Z","updated_by":"admin","created_at":"2021-09-22T15:57:42.889Z","created_by":"admin","name":"[GD] Potential Modification of Accessibility Binaries","tags":["Elastic","Host","Persistence","Threat Detection","Windows"],"interval":"5m","enabled":false,"description":"Windows contains accessibility features that may be launched with a key combination before a user has logged in. An adversary can modify the way these programs are launched to get a command prompt or backdoor without logging in to the system.","risk_score":73,"severity":"high","license":"Elastic License v2","output_index":".siem-signals-default","meta":{"from":"4m"},"timestamp_override":"event.ingested","author":["Elastic"],"false_positives":[],"from":"now-540s","rule_id":"cbaed535-b267-4b64-808c-d16d47d5512d","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","technique":[{"reference":"https://attack.mitre.org/techniques/T1546/","name":"Event Triggered Execution","subtechnique":[{"reference":"https://attack.mitre.org/techniques/T1546/008/","name":"Accessibility Features","id":"T1546.008"}],"id":"T1546"}],"tactic":{"reference":"https://attack.mitre.org/tactics/TA0003/","name":"Persistence","id":"TA0003"}},{"framework":"MITRE ATT&CK","technique":[{"reference":"https://attack.mitre.org/techniques/T1546/","name":"Event Triggered Execution","subtechnique":[{"reference":"https://attack.mitre.org/techniques/T1546/008/","name":"Accessibility Features","id":"T1546.008"}],"id":"T1546"}],"tactic":{"reference":"https://attack.mitre.org/tactics/TA0004/","name":"Privilege Escalation","id":"TA0004"}}],"to":"now","references":["https://www.elastic.co/blog/practical-security-engineering-stateful-detection"],"version":8,"exceptions_list":[],"immutable":false,"type":"eql","language":"eql","index":["windows-*"],"query":"process where event.type in (\"start\", \"process_started\", \"info\") and\n process.parent.name : (\"Utilman.exe\", \"winlogon.exe\") and user.name == \"SYSTEM\" and\n process.args :\n    (\n    \"C:\\\\Windows\\\\System32\\\\osk.exe\",\n    \"C:\\\\Windows\\\\System32\\\\Magnify.exe\",\n    \"C:\\\\Windows\\\\System32\\\\Narrator.exe\",\n    \"C:\\\\Windows\\\\System32\\\\Sethc.exe\",\n    \"utilman.exe\",\n    \"ATBroker.exe\",\n    \"DisplaySwitch.exe\",\n    \"sethc.exe\"\n    )\n and not process.pe.original_file_name in\n    (\n    \"osk.exe\",\n    \"sethc.exe\",\n    \"utilman2.exe\",\n    \"DisplaySwitch.exe\",\n    \"ATBroker.exe\",\n    \"ScreenMagnifier.exe\",\n    \"SR.exe\",\n    \"Narrator.exe\",\n    \"magnify.exe\",\n    \"MAGNIFY.EXE\"\n    )\n\n/* uncomment once in winlogbeat to avoid bypass with rogue process with matching pe original file name */\n/* and process.code_signature.subject_name == \"Microsoft Windows\" and process.code_signature.status == \"trusted\" */\n","filters":[],"throttle":"no_actions","actions":[]}
{"id":"cf8b1411-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T15:57:38.687Z","updated_by":"admin","created_at":"2021-09-22T15:57:38.687Z","created_by":"admin","name":"[GD] External Alerts","tags":["APM","Elastic","Linux","macOS","Network","Windows"],"interval":"5m","enabled":false,"description":"Generates a detection alert for each external alert written to the configured indices. Enabling this rule allows you to immediately begin investigating external alerts in the app.","risk_score":47,"severity":"medium","license":"Elastic License v2","output_index":".siem-signals-default","meta":{"from":"1m"},"rule_name_override":"message","timestamp_override":"event.ingested","author":["Elastic"],"false_positives":[],"from":"now-360s","rule_id":"c5e07e3e-fa60-45da-9298-7d6c5bfb8636","max_signals":10000,"risk_score_mapping":[{"field":"event.risk_score","value":"","operator":"equals"}],"severity_mapping":[{"severity":"low","field":"event.severity","value":"21","operator":"equals"},{"severity":"medium","field":"event.severity","value":"47","operator":"equals"},{"severity":"high","field":"event.severity","value":"73","operator":"equals"},{"severity":"critical","field":"event.severity","value":"99","operator":"equals"}],"threat":[],"to":"now","references":[],"version":5,"exceptions_list":[{"list_id":"51420a42-9597-47c6-9ca4-0061d362e476","namespace_type":"single","id":"d2c21610-be9d-11eb-8d42-f725f3c7ec37","type":"detection"}],"immutable":false,"type":"query","language":"kuery","index":["carbon-black-*","tanium-*"],"query":"event.kind:alert and not event.module:(endgame or endpoint)","filters":[],"throttle":"no_actions","actions":[]}
{"id":"cf8b3b21-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T15:57:38.738Z","updated_by":"admin","created_at":"2021-09-22T15:57:38.738Z","created_by":"admin","name":"Auditd Max Failed Login Attempts [Duplicate]","tags":["Elastic","Host","Initial Access","Linux","Threat Detection"],"interval":"5m","enabled":false,"description":"Identifies that the maximum number of failed login attempts has been reached for a user.","risk_score":47,"severity":"medium","license":"Elastic License v2","output_index":".siem-signals-default","timestamp_override":"event.ingested","author":["Elastic"],"false_positives":[],"from":"now-6m","rule_id":"d6cebd1e-70b3-48c9-b66c-97750e6d9040","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0001","name":"Initial Access","reference":"https://attack.mitre.org/tactics/TA0001/"},"technique":[{"id":"T1078","name":"Valid Accounts","reference":"https://attack.mitre.org/techniques/T1078/"}]},{"framework":"MITRE ATT&CK","tactic":{"id":"TA0003","name":"Persistence","reference":"https://attack.mitre.org/tactics/TA0003/"},"technique":[{"id":"T1078","name":"Valid Accounts","reference":"https://attack.mitre.org/techniques/T1078/"}]}],"to":"now","references":["https://github.com/linux-pam/linux-pam/blob/0adbaeb273da1d45213134aa271e95987103281c/modules/pam_faillock/pam_faillock.c#L574"],"version":1,"exceptions_list":[],"immutable":false,"type":"query","language":"kuery","index":["auditbeat-*"],"query":"event.module:auditd and event.action:\"failed-log-in-too-many-times-to\"","throttle":"no_actions","actions":[]}
{"id":"d6483cb1-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T16:00:33.436Z","updated_by":"admin","created_at":"2021-09-22T15:57:50.925Z","created_by":"admin","name":"[GD] AWS IAM Deactivation of MFA Device","tags":["AWS","Cloud","Continuous Monitoring","Elastic","Monitoring","SecOps"],"interval":"10m","enabled":false,"description":"Identifies the deactivation of a specified multi-factor authentication (MFA) device and removes it from association with the user name for which it was originally enabled. In AWS Identity and Access Management (IAM), a device must be deactivated before it can be deleted.","risk_score":47,"severity":"medium","note":"The AWS Filebeat module must be enabled to use this rule.","license":"Elastic License v2","output_index":".siem-signals-default","meta":{"from":"50m"},"timestamp_override":"event.ingested","author":["Elastic"],"false_positives":["A MFA device may be deactivated by a system or network administrator. Verify whether the user identity, user agent, and/or hostname should be making changes in your environment. MFA device deactivations from unfamiliar users or hosts should be investigated. If known behavior is causing false positives, it can be exempted from the rule."],"from":"now-3600s","rule_id":"b62f48b6-e766-4a35-819c-0835ed5c7526","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","technique":[{"reference":"https://attack.mitre.org/techniques/T1531/","name":"Account Access Removal","subtechnique":[],"id":"T1531"}],"tactic":{"reference":"https://attack.mitre.org/tactics/TA0040/","name":"Impact","id":"TA0040"}}],"to":"now","references":["https://awscli.amazonaws.com/v2/documentation/api/latest/reference/iam/deactivate-mfa-device.html","https://docs.aws.amazon.com/IAM/latest/APIReference/API_DeactivateMFADevice.html"],"version":5,"exceptions_list":[],"immutable":false,"type":"query","language":"kuery","index":["aws-cloudtrail-*","aws-config-*"],"query":"event.action:DeactivateMFADevice and event.dataset:aws.cloudtrail and event.provider:iam.amazonaws.com and event.outcome:success","filters":[],"throttle":"no_actions","actions":[]}
{"id":"d1b287f0-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T16:00:34.214Z","updated_by":"admin","created_at":"2021-09-22T15:57:42.870Z","created_by":"admin","name":"[GD] Renamed AutoIt Scripts Interpreter","tags":["Defense Evasion","Elastic","Host","Threat Detection","Windows"],"interval":"5m","enabled":false,"description":"Identifies a suspicious AutoIt process execution. Malware written as an AutoIt script tends to rename the AutoIt executable to avoid detection.","risk_score":47,"severity":"medium","license":"Elastic License v2","output_index":".siem-signals-default","meta":{"from":"4m"},"timestamp_override":"event.ingested","author":["Elastic"],"false_positives":[],"from":"now-540s","rule_id":"d402f467-3e41-4160-8aff-6a6af44c2891","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","technique":[{"reference":"https://attack.mitre.org/techniques/T1036/","name":"Masquerading","subtechnique":[],"id":"T1036"}],"tactic":{"reference":"https://attack.mitre.org/tactics/TA0005/","name":"Defense Evasion","id":"TA0005"}}],"to":"now","references":[],"version":5,"exceptions_list":[],"immutable":false,"type":"eql","language":"eql","index":["windows-*"],"query":"process where event.type in (\"start\", \"process_started\", \"info\") and\n  process.pe.original_file_name : \"AutoIt*.exe\" and not process.name : \"AutoIt*.exe\"\n","filters":[],"throttle":"no_actions","actions":[]}
{"id":"d3dabf20-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T16:00:34.209Z","updated_by":"admin","created_at":"2021-09-22T15:57:46.902Z","created_by":"admin","name":"[GD] Suspicious Process from Conhost","tags":["Defense Evasion","Elastic","Host","Threat Detection","Windows"],"interval":"5m","enabled":false,"description":"Identifies a suspicious Conhost child process which may be an indication of code injection activity.","risk_score":73,"severity":"high","license":"Elastic License v2","output_index":".siem-signals-default","meta":{"from":"4m"},"timestamp_override":"event.ingested","author":["Elastic"],"false_positives":[],"from":"now-540s","rule_id":"49309610-1c87-4616-a45e-a7c66482df01","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","technique":[{"reference":"https://attack.mitre.org/techniques/T1055/","name":"Process Injection","subtechnique":[],"id":"T1055"}],"tactic":{"reference":"https://attack.mitre.org/tactics/TA0005/","name":"Defense Evasion","id":"TA0005"}}],"to":"now","references":["https://modexp.wordpress.com/2018/09/12/process-injection-user-data/","https://github.com/sbousseaden/EVTX-ATTACK-SAMPLES/blob/master/Defense%20Evasion/evasion_codeinj_odzhan_conhost_sysmon_10_1.evtx"],"version":4,"exceptions_list":[],"immutable":false,"type":"query","language":"kuery","index":["windows-*"],"query":"event.category:process and event.type:(start or process_started) and process.parent.name:conhost.exe and not process.executable:(\"C:\\Windows\\splwow64.exe\" or \"C:\\Windows\\System32\\WerFault.exe\" or \"C:\\\\Windows\\System32\\conhost.exe\")","filters":[],"throttle":"no_actions","actions":[]}
{"id":"d82f7340-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T16:01:21.484Z","updated_by":"admin","created_at":"2021-09-22T15:57:53.955Z","created_by":"admin","name":"[GD] Attempt to Delete an Okta Policy Rule","tags":["Continuous Monitoring","Elastic","Identity","Monitoring","Okta","SecOps"],"interval":"5m","enabled":false,"description":"Detects attempts to delete a rule within an Okta policy. An adversary may attempt to delete an Okta policy rule in order to weaken an organization's security controls.","risk_score":21,"severity":"low","note":"The Okta Fleet integration or Filebeat module must be enabled to use this rule.","license":"Elastic License v2","output_index":".siem-signals-default","meta":{"from":"1m"},"timestamp_override":"event.ingested","author":["Elastic"],"false_positives":["Consider adding exceptions to this rule to filter false positives if Okta MFA rules are regularly modified in your organization."],"from":"now-360s","rule_id":"27bc488a-d2f6-4d41-b616-064614c76ac4","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[],"to":"now","references":["https://help.okta.com/en/prod/Content/Topics/Security/Security_Policies.htm","https://developer.okta.com/docs/reference/api/system-log/","https://developer.okta.com/docs/reference/api/event-types/"],"version":4,"exceptions_list":[],"immutable":false,"type":"query","language":"kuery","index":["okta-*"],"query":"event.dataset:okta.system and event.action:policy.rule.delete","filters":[],"throttle":"no_actions","actions":[]}
{"id":"d646b610-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T16:01:21.629Z","updated_by":"admin","created_at":"2021-09-22T15:57:50.920Z","created_by":"admin","name":"[GD] AWS RDS Cluster Deletion","tags":["Asset Visibility","AWS","Cloud","Continuous Monitoring","Elastic","SecOps"],"interval":"10m","enabled":false,"description":"Identifies the deletion of an Amazon Relational Database Service (RDS) Aurora database cluster or global database cluster.","risk_score":47,"severity":"medium","note":"The AWS Filebeat module must be enabled to use this rule.","license":"Elastic License v2","output_index":".siem-signals-default","meta":{"from":"50m"},"timestamp_override":"event.ingested","author":["Elastic"],"false_positives":["Clusters may be deleted by a system administrator. Verify whether the user identity, user agent, and/or hostname should be making changes in your environment. Cluster deletions from unfamiliar users or hosts should be investigated. If known behavior is causing false positives, it can be exempted from the rule."],"from":"now-3600s","rule_id":"adafeac3-b3bf-4024-b16c-0eda9c0e04c7","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","technique":[{"reference":"https://attack.mitre.org/techniques/T1485/","name":"Data Destruction","subtechnique":[],"id":"T1485"}],"tactic":{"reference":"https://attack.mitre.org/tactics/TA0040/","name":"Impact","id":"TA0040"}}],"to":"now","references":["https://awscli.amazonaws.com/v2/documentation/api/latest/reference/rds/delete-db-cluster.html","https://docs.aws.amazon.com/AmazonRDS/latest/APIReference/API_DeleteDBCluster.html","https://awscli.amazonaws.com/v2/documentation/api/latest/reference/rds/delete-global-cluster.html","https://docs.aws.amazon.com/AmazonRDS/latest/APIReference/API_DeleteGlobalCluster.html"],"version":5,"exceptions_list":[],"immutable":false,"type":"query","language":"kuery","index":["aws-cloudtrail-*","aws-config-*"],"query":"event.action:(DeleteDBCluster or DeleteGlobalCluster) and event.dataset:aws.cloudtrail and event.provider:rds.amazonaws.com and event.outcome:success","filters":[],"throttle":"no_actions","actions":[]}
{"id":"d832a790-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T16:01:21.632Z","updated_by":"admin","created_at":"2021-09-22T15:57:53.949Z","created_by":"admin","name":"[GD] Attempt to Deactivate MFA for an Okta User Account","tags":["Continuous Monitoring","Elastic","Identity","Identity and Access","Okta","SecOps"],"interval":"5m","enabled":false,"description":"Detects attempts to deactivate multi-factor authentication (MFA) for an Okta user. An adversary may deactivate MFA for an Okta user account in order to weaken the authentication requirements for the account.","risk_score":21,"severity":"low","note":"The Okta Fleet integration or Filebeat module must be enabled to use this rule.","license":"Elastic License v2","output_index":".siem-signals-default","meta":{"from":"1m"},"timestamp_override":"event.ingested","author":["Elastic"],"false_positives":["If the behavior of deactivating MFA for Okta user accounts is expected, consider adding exceptions to this rule to filter false positives."],"from":"now-360s","rule_id":"21be6576-bffd-468b-ba14-a202f9b0e4b5","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","technique":[{"reference":"https://attack.mitre.org/techniques/T1098/","name":"Account Manipulation","subtechnique":[],"id":"T1098"}],"tactic":{"reference":"https://attack.mitre.org/tactics/TA0003/","name":"Persistence","id":"TA0003"}}],"to":"now","references":["https://developer.okta.com/docs/reference/api/system-log/","https://developer.okta.com/docs/reference/api/event-types/"],"version":6,"exceptions_list":[],"immutable":false,"type":"query","language":"kuery","index":["okta-*"],"query":"event.dataset:okta.system and event.action:user.mfa.factor.deactivate","filters":[],"throttle":"no_actions","actions":[]}
{"id":"d82d9e81-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T16:01:21.498Z","updated_by":"admin","created_at":"2021-09-22T15:57:53.942Z","created_by":"admin","name":"[GD] AWS IAM Brute Force of Assume Role Policy","tags":["AWS","Cloud","Continuous Monitoring","Elastic","Identity and Access","SecOps"],"interval":"5m","enabled":false,"description":"Identifies a high number of failed attempts to assume an AWS Identity and Access Management (IAM) role. IAM roles are used to delegate access to users or services. An adversary may attempt to enumerate IAM roles in order to determine if a role exists before attempting to assume or hijack the discovered role.","risk_score":47,"severity":"medium","note":"The AWS Filebeat module must be enabled to use this rule.","license":"Elastic License v2","output_index":".siem-signals-default","meta":{"from":"15m"},"author":["Elastic"],"false_positives":[],"from":"now-1200s","rule_id":"57d55e2e-d8fe-4c7a-9161-626b088c5e9e","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","technique":[{"reference":"https://attack.mitre.org/techniques/T1110/","name":"Brute Force","subtechnique":[],"id":"T1110"}],"tactic":{"reference":"https://attack.mitre.org/tactics/TA0006/","name":"Credential Access","id":"TA0006"}}],"to":"now","references":["https://www.praetorian.com/blog/aws-iam-assume-role-vulnerabilities","https://rhinosecuritylabs.com/aws/assume-worst-aws-assume-role-enumeration/"],"version":4,"exceptions_list":[],"immutable":false,"type":"threshold","language":"kuery","index":["aws-cloudtrail-*","aws-config-*"],"query":"event.dataset:aws.cloudtrail and event.provider:iam.amazonaws.com and event.action:UpdateAssumeRolePolicy and aws.cloudtrail.error_code:MalformedPolicyDocumentException and event.outcome:failure","filters":[],"threshold":{"field":[""],"value":25,"cardinality":[]},"throttle":"no_actions","actions":[]}
{"id":"d82efe10-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T16:01:21.542Z","updated_by":"admin","created_at":"2021-09-22T15:57:53.951Z","created_by":"admin","name":"[GD] Attempt to Delete an Okta Policy","tags":["Continuous Monitoring","Elastic","Identity","Monitoring","Okta","SecOps"],"interval":"5m","enabled":false,"description":"Detects attempts to delete an Okta policy. An adversary may attempt to delete an Okta policy in order to weaken an organization's security controls. For example, an adversary may attempt to delete an Okta multi-factor authentication (MFA) policy in order to weaken the authentication requirements for user accounts.","risk_score":47,"severity":"medium","note":"The Okta Fleet integration or Filebeat module must be enabled to use this rule.","license":"Elastic License v2","output_index":".siem-signals-default","meta":{"from":"1m"},"timestamp_override":"event.ingested","author":["Elastic"],"false_positives":["Consider adding exceptions to this rule to filter false positives if Okta policies are regularly deleted in your organization."],"from":"now-360s","rule_id":"b24872fa-7004-4bdc-bdad-348d20089ea7","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[],"to":"now","references":["https://help.okta.com/en/prod/Content/Topics/Security/Security_Policies.htm","https://developer.okta.com/docs/reference/api/system-log/","https://developer.okta.com/docs/reference/api/event-types/"],"version":6,"exceptions_list":[],"immutable":false,"type":"query","language":"kuery","index":["okta-*"],"query":"event.dataset:okta.system and event.action:policy.lifecycle.delete","filters":[],"throttle":"no_actions","actions":[]}
{"id":"d82e3ac0-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T16:01:21.550Z","updated_by":"admin","created_at":"2021-09-22T15:57:53.953Z","created_by":"admin","name":"[GD] AWS Execution via System Manager ","tags":["AWS","Cloud","Continuous Monitoring","Elastic","Log Auditing","SecOps"],"interval":"10m","enabled":false,"description":"Identifies the execution of commands and scripts via System Manager. Execution methods such as RunShellScript, RunPowerShellScript, and alike can be abused by an authenticated attacker to install a backdoor or to interact with a compromised instance via reverse-shell using system only commands.","risk_score":21,"severity":"low","note":"The AWS Filebeat module must be enabled to use this rule.","license":"Elastic License v2","output_index":".siem-signals-default","meta":{"from":"50m"},"timestamp_override":"event.ingested","author":["Elastic"],"false_positives":["Verify whether the user identity, user agent, and/or hostname should be making changes in your environment. Suspicious commands from unfamiliar users or hosts should be investigated. If known behavior is causing false positives, it can be exempted from the rule."],"from":"now-3600s","rule_id":"125e2f43-d19a-4309-8f16-851eba9b11b3","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","technique":[{"reference":"https://attack.mitre.org/techniques/T1566/","name":"Phishing","subtechnique":[{"reference":"https://attack.mitre.org/techniques/T1566/002/","name":"Spearphishing Link","id":"T1566.002"}],"id":"T1566"}],"tactic":{"reference":"https://attack.mitre.org/tactics/TA0001/","name":"Initial Access","id":"TA0001"}}],"to":"now","references":["https://docs.aws.amazon.com/systems-manager/latest/userguide/ssm-plugins.html"],"version":7,"exceptions_list":[],"immutable":false,"type":"query","language":"kuery","index":["aws-config-*","aws-cloudtrail-*"],"query":"event.dataset:aws.cloudtrail and event.provider:ssm.amazonaws.com and event.action:SendCommand and event.outcome:success","filters":[],"throttle":"no_actions","actions":[]}
{"id":"d82ed700-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T16:01:21.590Z","updated_by":"admin","created_at":"2021-09-22T15:57:53.944Z","created_by":"admin","name":"[GD] Attempt to Deactivate an Okta Network Zone","tags":["Continuous Monitoring","Elastic","Identity","Network Security","Okta","SecOps"],"interval":"5m","enabled":false,"description":"Detects attempts to deactivate an Okta network zone. Okta network zones can be configured to limit or restrict access to a network based on IP addresses or geolocations. An adversary may attempt to modify, delete, or deactivate an Okta network zone in order to remove or weaken an organization's security controls.","risk_score":47,"severity":"medium","note":"The Okta Fleet integration or Filebeat module must be enabled to use this rule.","license":"Elastic License v2","output_index":".siem-signals-default","meta":{"from":"1m"},"timestamp_override":"event.ingested","author":["Elastic"],"false_positives":["Consider adding exceptions to this rule to filter false positives if your organization's Okta network zones are regularly modified."],"from":"now-360s","rule_id":"4a5e93f1-96c8-494d-9df7-cf6fcef8e8c2","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[],"to":"now","references":["https://help.okta.com/en/prod/Content/Topics/Security/network/network-zones.htm","https://developer.okta.com/docs/reference/api/system-log/","https://developer.okta.com/docs/reference/api/event-types/"],"version":4,"exceptions_list":[],"immutable":false,"type":"query","language":"kuery","index":["okta-*"],"query":"event.dataset:okta.system and event.action:zone.deactivate","filters":[],"throttle":"no_actions","actions":[]}
{"id":"d1b54710-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T15:59:30.258Z","updated_by":"admin","created_at":"2021-09-22T15:57:42.892Z","created_by":"admin","name":"[GD] Suspicious PDF Reader Child Process","tags":["Elastic","Execution","Host","Threat Detection","Windows"],"interval":"5m","enabled":false,"description":"Identifies suspicious child processes of PDF reader applications. These child processes are often launched via exploitation of PDF applications or social engineering.","risk_score":21,"severity":"low","license":"Elastic License v2","output_index":".siem-signals-default","meta":{"from":"4m"},"timestamp_override":"event.ingested","author":["Elastic"],"false_positives":[],"from":"now-540s","rule_id":"149adcc4-dba6-4e09-accd-49030adad2cc","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","technique":[{"reference":"https://attack.mitre.org/techniques/T1204/","name":"User Execution","subtechnique":[],"id":"T1204"}],"tactic":{"reference":"https://attack.mitre.org/tactics/TA0002/","name":"Execution","id":"TA0002"}}],"to":"now","references":[],"version":7,"exceptions_list":[],"immutable":false,"type":"query","language":"kuery","index":["windows-*"],"query":"event.category:process and event.type:(start or process_started) and process.parent.name:(AcroRd32.exe or Acrobat.exe or FoxitPhantomPDF.exe or FoxitReader.exe) and process.name:(arp.exe or dsquery.exe or dsget.exe or gpresult.exe or hostname.exe or ipconfig.exe or nbtstat.exe or net.exe or net1.exe or netsh.exe or netstat.exe or nltest.exe or ping.exe or qprocess.exe or quser.exe or qwinsta.exe or reg.exe or sc.exe or systeminfo.exe or tasklist.exe or tracert.exe or whoami.exe or bginfo.exe or cdb.exe or cmstp.exe or csi.exe or dnx.exe or fsi.exe or ieexec.exe or iexpress.exe or installutil.exe or Microsoft.Workflow.Compiler.exe or msbuild.exe or mshta.exe or msxsl.exe or odbcconf.exe or rcsi.exe or regsvr32.exe or xwizard.exe or atbroker.exe or forfiles.exe or schtasks.exe or regasm.exe or regsvcs.exe or cmd.exe or cscript.exe or powershell.exe or pwsh.exe or wmic.exe or wscript.exe or bitsadmin.exe or certutil.exe or ftp.exe)","filters":[],"throttle":"no_actions","actions":[]}
{"id":"d1b2d611-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T15:59:30.248Z","updated_by":"admin","created_at":"2021-09-22T15:57:42.887Z","created_by":"admin","name":"[GD] Suspicious Execution via Scheduled Task","tags":["Elastic","Host","Persistence","Threat Detection","Windows"],"interval":"5m","enabled":false,"description":"Identifies execution of a suspicious program via scheduled tasks by looking at process lineage and command line usage.","risk_score":47,"severity":"medium","license":"Elastic License v2","output_index":".siem-signals-default","meta":{"from":"4m"},"timestamp_override":"event.ingested","author":["Elastic"],"false_positives":["Legitimate scheduled tasks running third party software."],"from":"now-540s","rule_id":"90f97304-87e1-453a-a3a7-a115aa66dae6","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","technique":[{"reference":"https://attack.mitre.org/techniques/T1053/","name":"Scheduled Task/Job","subtechnique":[],"id":"T1053"}],"tactic":{"reference":"https://attack.mitre.org/tactics/TA0003/","name":"Persistence","id":"TA0003"}}],"to":"now","references":[],"version":4,"exceptions_list":[],"immutable":false,"type":"eql","language":"eql","index":["windows-*"],"query":"process where event.type == \"start\" and\n    /* Schedule service cmdline on Win10+ */\n    process.parent.name : \"svchost.exe\" and process.parent.args : \"Schedule\" and\n    /* add suspicious programs here */\n    process.pe.original_file_name in\n                                (\n                                  \"cscript.exe\",\n                                  \"wscript.exe\",\n                                  \"PowerShell.EXE\",\n                                  \"Cmd.Exe\",\n                                  \"MSHTA.EXE\",\n                                  \"RUNDLL32.EXE\",\n                                  \"REGSVR32.EXE\",\n                                  \"MSBuild.exe\",\n                                  \"InstallUtil.exe\",\n                                  \"RegAsm.exe\",\n                                  \"RegSvcs.exe\",\n                                  \"msxsl.exe\",\n                                  \"CONTROL.EXE\",\n                                  \"EXPLORER.EXE\",\n                                  \"Microsoft.Workflow.Compiler.exe\",\n                                  \"msiexec.exe\"\n                                  ) and\n    /* add suspicious paths here */\n    process.args : (\n       \"C:\\\\Users\\\\*\",\n       \"C:\\\\ProgramData\\\\*\", \n       \"C:\\\\Windows\\\\Temp\\\\*\", \n       \"C:\\\\Windows\\\\Tasks\\\\*\", \n       \"C:\\\\PerfLogs\\\\*\", \n       \"C:\\\\Intel\\\\*\", \n       \"C:\\\\Windows\\\\Debug\\\\*\", \n       \"C:\\\\HP\\\\*\")\n","filters":[],"throttle":"no_actions","actions":[]}
{"id":"4b389f40-9a3c-11ec-ab18-0d51419cd75c","updated_at":"2022-03-18T02:26:10.782Z","updated_by":"jprentice1@godaddy.com","created_at":"2022-03-02T15:20:29.813Z","created_by":"admin","name":"[GD] Carbon Black File Unauthorized Run Alert Rule - Daily Link to Saved Search","tags":["GD","Security"],"interval":"24h","enabled":true,"description":"This rule should fire only once per day. Once you're ready to enable the webhook action for this rule. Include the following saved search link in the ServiceNow case or Email notification: https://827ebd6fd06146bea2d2ad3a453d7e43.vpce.gdw55e.elastic-cloud.com:9243/app/discover#/view/f890e9b0-9a3a-11ec-ab18-0d51419cd75c","risk_score":21,"severity":"low","license":"","output_index":".siem-signals-default","meta":{"from":"10m","kibana_siem_app_url":"https://security-prod.kibana.int.gdcorp.tools/app/security"},"author":[],"false_positives":[],"from":"now-87000s","rule_id":"6b166fbe-50c0-4871-9e20-5e005f117de9","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[],"to":"now","references":[],"version":5,"exceptions_list":[],"immutable":false,"type":"threshold","language":"kuery","index":["*:windows-*","*:aws-syslog*","*:onprem*"],"query":"(aws.fluent_tags: \"CARBONBLACK\"  and (rule.description: \"New unapproved file to computer\" or rule.description: \"Execution block \\(unapproved file\\)\" or rule.description: \"Process demoted\")) or (winlog.event_id: \"4688\" or winlog.event_id: \"4663\" )","filters":[],"threshold":{"field":["ecs.version"],"value":1000,"cardinality":[]},"throttle":"1d","actions":[{"group":"default","id":"elastic-cloud-email","params":{"message":"The alert condition for '{{context.rule.name}}' was triggered.\n\nLink to results: https://security-prod.kibana.int.gdcorp.tools/app/discover#/view/f890e9b0-9a3a-11ec-ab18-0d51419cd75c","to":["twhipple1@godaddy.com","ntorga@godaddy.com"],"subject":"Elastic Alert: {{context.rule.name}}"},"action_type_id":".email"}]}
{"id":"d647ee91-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T16:00:33.924Z","updated_by":"admin","created_at":"2021-09-22T15:57:50.933Z","created_by":"admin","name":"[GD] AWS EC2 Snapshot Activity","tags":["Asset Visibility","AWS","Cloud","Continuous Monitoring","Elastic","SecOps"],"interval":"10m","enabled":false,"description":"An attempt was made to modify AWS EC2 snapshot attributes. Snapshots are sometimes shared by threat actors in order to exfiltrate bulk data from an EC2 fleet. If the permissions were modified, verify the snapshot was not shared with an unauthorized or unexpected AWS account.","risk_score":47,"severity":"medium","note":"The AWS Filebeat module must be enabled to use this rule.","license":"Elastic License v2","output_index":".siem-signals-default","meta":{"from":"50m"},"timestamp_override":"event.ingested","author":["Elastic"],"false_positives":["IAM users may occasionally share EC2 snapshots with another AWS account belonging to the same organization. If known behavior is causing false positives, it can be exempted from the rule."],"from":"now-3600s","rule_id":"c1436428-cc3d-4d91-8ae8-b94d0612163d","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","technique":[{"reference":"https://attack.mitre.org/techniques/T1537/","name":"Transfer Data to Cloud Account","subtechnique":[],"id":"T1537"}],"tactic":{"reference":"https://attack.mitre.org/tactics/TA0010/","name":"Exfiltration","id":"TA0010"}}],"to":"now","references":["https://awscli.amazonaws.com/v2/documentation/api/latest/reference/ec2/modify-snapshot-attribute.html","https://docs.aws.amazon.com/AWSEC2/latest/APIReference/API_ModifySnapshotAttribute.html"],"version":5,"exceptions_list":[],"immutable":false,"type":"query","language":"kuery","index":["aws-cloudtrail-*","aws-config-*"],"query":"event.dataset:aws.cloudtrail and event.provider:ec2.amazonaws.com and event.action:ModifySnapshotAttribute","filters":[],"throttle":"no_actions","actions":[]}
{"id":"d82e61d1-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T16:01:21.604Z","updated_by":"admin","created_at":"2021-09-22T15:57:53.955Z","created_by":"admin","name":"[GD] Administrator Role Assigned to an Okta User","tags":["Continuous Monitoring","Elastic","Monitoring","Okta","SecOps"],"interval":"5m","enabled":false,"description":"Identifies when an administrator role is assigned to an Okta user. An adversary may attempt to assign an administrator role to an Okta user in order to assign additional permissions to a user account and maintain access to their target's environment.","risk_score":47,"severity":"medium","note":"The Okta Fleet integration or Filebeat module must be enabled to use this rule.","license":"Elastic License v2","output_index":".siem-signals-default","meta":{"from":"1m"},"timestamp_override":"event.ingested","author":["Elastic"],"false_positives":["Administrator roles may be assigned to Okta users by a Super Admin user. Verify that the behavior was expected. Exceptions can be added to this rule to filter expected behavior."],"from":"now-360s","rule_id":"15a3b36d-9856-471b-b5a0-38d2c7a7d686","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","technique":[{"reference":"https://attack.mitre.org/techniques/T1098/","name":"Account Manipulation","subtechnique":[],"id":"T1098"}],"tactic":{"reference":"https://attack.mitre.org/tactics/TA0003/","name":"Persistence","id":"TA0003"}}],"to":"now","references":["https://help.okta.com/en/prod/Content/Topics/Security/administrators-admin-comparison.htm","https://developer.okta.com/docs/reference/api/system-log/","https://developer.okta.com/docs/reference/api/event-types/"],"version":4,"exceptions_list":[],"immutable":false,"type":"query","language":"kuery","index":["okta-*"],"query":"event.dataset:okta.system and event.action:user.account.privilege.grant","filters":[],"throttle":"no_actions","actions":[]}
{"id":"d82deca0-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T16:01:21.610Z","updated_by":"admin","created_at":"2021-09-22T15:57:53.952Z","created_by":"admin","name":"[GD] Possible Okta DoS Attack","tags":["Continuous Monitoring","Elastic","Identity","Monitoring","Okta","SecOps"],"interval":"5m","enabled":false,"description":"Detects possible Denial of Service (DoS) attacks against an Okta organization. An adversary may attempt to disrupt an organization's business operations by performing a DoS attack against its Okta service.","risk_score":47,"severity":"medium","note":"The Okta Fleet integration or Filebeat module must be enabled to use this rule.","license":"Elastic License v2","output_index":".siem-signals-default","meta":{"from":"1m"},"timestamp_override":"event.ingested","author":["Elastic"],"false_positives":[],"from":"now-360s","rule_id":"a0d0531c-55b4-4716-bf53-17b54accce28","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","technique":[{"reference":"https://attack.mitre.org/techniques/T1498/","name":"Network Denial of Service","subtechnique":[],"id":"T1498"},{"reference":"https://attack.mitre.org/techniques/T1499/","name":"Endpoint Denial of Service","subtechnique":[],"id":"T1499"}],"tactic":{"reference":"https://attack.mitre.org/tactics/TA0040/","name":"Impact","id":"TA0040"}}],"to":"now","references":["https://developer.okta.com/docs/reference/api/system-log/","https://developer.okta.com/docs/reference/api/event-types/"],"version":6,"exceptions_list":[],"immutable":false,"type":"query","language":"kuery","index":["okta-*"],"query":"event.dataset:okta.system and event.action:(application.integration.rate_limit_exceeded or system.org.rate_limit.warning or system.org.rate_limit.violation or core.concurrency.org.limit.violation)","filters":[],"throttle":"no_actions","actions":[]}
{"id":"d1b2fd21-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T15:57:42.309Z","updated_by":"admin","created_at":"2021-09-22T15:57:42.309Z","created_by":"admin","name":"[GD] InstallUtil Process Making Network Connections","tags":["Defense Evasion","Elastic","Host","Threat Detection","Windows"],"interval":"5m","enabled":false,"description":"Identifies InstallUtil.exe making outbound network connections. This may indicate adversarial activity as InstallUtil is often leveraged by adversaries to execute code and evade detection.","risk_score":21,"severity":"medium","license":"Elastic License v2","output_index":".siem-signals-default","meta":{"from":"4m"},"author":["Elastic"],"false_positives":[],"from":"now-540s","rule_id":"93e5d000-3f70-41f5-93d6-237e076f5b4c","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"reference":"https://attack.mitre.org/tactics/TA0005/","name":"Defense Evasion","id":"TA0005"},"technique":[{"reference":"https://attack.mitre.org/techniques/T1218/","name":"Signed Binary Proxy Execution","id":"T1218","subtechnique":[{"reference":"https://attack.mitre.org/techniques/T1218/004/","name":"InstallUtil","id":"T1218.004"}]}]}],"to":"now","references":[],"version":4,"exceptions_list":[],"immutable":false,"type":"eql","language":"eql","index":["windows-*"],"query":"/* the benefit of doing this as an eql sequence vs kql is this will limit to alerting only on the first network connection */\n\nsequence by process.entity_id\n  [process where event.type in (\"start\", \"process_started\") and process.name : \"installutil.exe\"]\n  [network where process.name : \"installutil.exe\" and network.direction == \"outgoing\"]\n","filters":[],"throttle":"no_actions","actions":[]}
{"id":"cd824bc0-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T15:57:35.234Z","updated_by":"admin","created_at":"2021-09-22T15:57:35.234Z","created_by":"admin","name":"Unusual Linux Network Activity [Duplicate]","tags":["Elastic","Host","Linux","ML","Threat Detection"],"interval":"15m","enabled":false,"description":"Identifies Linux processes that do not usually use the network but have unexpected network activity, which can indicate command-and-control, lateral movement, persistence, or data exfiltration activity. A process with unusual network activity can denote process exploitation or injection, where the process is used to run persistence mechanisms that allow a malicious actor remote access or control of the host, data exfiltration, and execution of unauthorized network applications.","risk_score":21,"severity":"low","note":"### Investigating Unusual Network Activity ###\nDetection alerts from this rule indicate the presence of network activity from a Linux process for which network activity is rare and unusual.  Here are some possible avenues of investigation:\n- Consider the IP addresses and ports. Are these used by normal but infrequent network workflows? Are they expected or unexpected?\n- If the destination IP address is remote or external, does it associate with an expected domain, organization or geography? Note: avoid interacting directly with suspected malicious IP addresses.\n- Consider the user as identified by the username field. Is this network activity part of an expected workflow for the user who ran the program?\n- Examine the history of execution. If this process manifested only very recently, it might be part of a new software package. If it has a consistent cadence - for example if it runs monthly or quarterly - it might be part of a monthly or quarterly business or maintenance process.\n- Examine the process arguments, title and working directory. These may provide indications as to the source of the program or the nature of the tasks it is performing.","license":"Elastic License v2","output_index":".siem-signals-default","author":["Elastic"],"false_positives":[],"from":"now-45m","rule_id":"c0cab95a-6f37-4344-8840-2fa989995a0a","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[],"to":"now","references":["https://www.elastic.co/guide/en/security/current/prebuilt-ml-jobs.html"],"version":4,"exceptions_list":[],"immutable":false,"type":"machine_learning","anomaly_threshold":50,"machine_learning_job_id":["linux_anomalous_network_activity_ecs"],"throttle":"no_actions","actions":[]}
{"id":"cd49fdb1-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T15:57:34.901Z","updated_by":"admin","created_at":"2021-09-22T15:57:34.901Z","created_by":"admin","name":"Enumeration of Kernel Modules [Duplicate]","tags":["Discovery","Elastic","Host","Linux","Threat Detection"],"interval":"5m","enabled":false,"description":"Loadable Kernel Modules (or LKMs) are pieces of code that can be loaded and unloaded into the kernel upon demand. They extend the functionality of the kernel without the need to reboot the system. This identifies attempts to enumerate information about a kernel module.","risk_score":47,"severity":"medium","license":"Elastic License v2","output_index":".siem-signals-default","timestamp_override":"event.ingested","author":["Elastic"],"false_positives":["Security tools and device drivers may run these programs in order to enumerate kernel modules. Use of these programs by ordinary users is uncommon. These can be exempted by process name or username."],"from":"now-9m","rule_id":"f7e0da34-661f-487a-bd6f-a221b57c0de4","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0007","name":"Discovery","reference":"https://attack.mitre.org/tactics/TA0007/"},"technique":[{"id":"T1082","name":"System Information Discovery","reference":"https://attack.mitre.org/techniques/T1082/"}]}],"to":"now","references":[],"version":6,"exceptions_list":[],"immutable":false,"type":"query","language":"kuery","index":["auditbeat-*","logs-endpoint.events.*"],"query":"event.category:process and event.type:(start or process_started) and process.args:(kmod and list and sudo or sudo and (depmod or lsmod or modinfo))","throttle":"no_actions","actions":[]}
{"id":"d648b1e0-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T16:00:33.916Z","updated_by":"admin","created_at":"2021-09-22T15:57:50.929Z","created_by":"admin","name":"[GD] AWS WAF Rule or Rule Group Deletion","tags":["AWS","Cloud","Continuous Monitoring","Elastic","Network Security","SecOps"],"interval":"10m","enabled":false,"description":"Identifies the deletion of a specified AWS Web Application Firewall (WAF) rule or rule group.","risk_score":47,"severity":"medium","note":"The AWS Filebeat module must be enabled to use this rule.","license":"Elastic License v2","output_index":".siem-signals-default","meta":{"from":"50m"},"timestamp_override":"event.ingested","author":["Elastic"],"false_positives":["WAF rules or rule groups may be deleted by a system or network administrator. Verify whether the user identity, user agent, and/or hostname should be making changes in your environment. Rule deletions from unfamiliar users or hosts should be investigated. If known behavior is causing false positives, it can be exempted from the rule."],"from":"now-3600s","rule_id":"e41e5ed3-a804-4374-8ed7-8a55f2afd3d9","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","technique":[{"reference":"https://attack.mitre.org/techniques/T1562/","name":"Impair Defenses","subtechnique":[{"reference":"https://attack.mitre.org/techniques/T1562/001/","name":"Disable or Modify Tools","id":"T1562.001"}],"id":"T1562"}],"tactic":{"reference":"https://attack.mitre.org/tactics/TA0005/","name":"Defense Evasion","id":"TA0005"}}],"to":"now","references":["https://awscli.amazonaws.com/v2/documentation/api/latest/reference/waf/delete-rule-group.html","https://docs.aws.amazon.com/waf/latest/APIReference/API_waf_DeleteRuleGroup.html"],"version":6,"exceptions_list":[],"immutable":false,"type":"query","language":"kuery","index":["aws-config-*","aws-cloudtrail-*"],"query":"event.dataset:aws.cloudtrail and event.action:(DeleteRule or DeleteRuleGroup) and event.outcome:success","filters":[],"throttle":"no_actions","actions":[]}
{"id":"d8331cc0-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T16:01:21.602Z","updated_by":"admin","created_at":"2021-09-22T15:57:53.955Z","created_by":"admin","name":"[GD] Attempt to Deactivate an Okta Policy","tags":["Continuous Monitoring","Elastic","Identity","Monitoring","Okta","SecOps"],"interval":"5m","enabled":false,"description":"Detects attempts to deactivate an Okta policy. An adversary may attempt to deactivate an Okta policy in order to weaken an organization's security controls. For example, an adversary may attempt to deactivate an Okta multi-factor authentication (MFA) policy in order to weaken the authentication requirements for user accounts.","risk_score":21,"severity":"low","note":"The Okta Fleet integration or Filebeat module must be enabled to use this rule.","license":"Elastic License v2","output_index":".siem-signals-default","meta":{"from":"1m"},"timestamp_override":"event.ingested","author":["Elastic"],"false_positives":["If the behavior of deactivating Okta policies is expected, consider adding exceptions to this rule to filter false positives."],"from":"now-360s","rule_id":"59234778-b2df-41d6-af39-dddbb0c71e24","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[],"to":"now","references":["https://help.okta.com/en/prod/Content/Topics/Security/Security_Policies.htm","https://developer.okta.com/docs/reference/api/system-log/","https://developer.okta.com/docs/reference/api/event-types/"],"version":6,"exceptions_list":[],"immutable":false,"type":"query","language":"kuery","index":["okta-*"],"query":"event.dataset:okta.system and event.action:policy.lifecycle.deactivate","filters":[],"throttle":"no_actions","actions":[]}
{"id":"d82dc590-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T16:01:21.617Z","updated_by":"admin","created_at":"2021-09-22T15:57:53.947Z","created_by":"admin","name":"[GD] AWS Management Console Brute Force of Root User Identity","tags":["AWS","Cloud","Continuous Monitoring","Elastic","Identity and Access","SecOps"],"interval":"5m","enabled":false,"description":"Identifies a high number of failed authentication attempts to the AWS management console for the Root user identity. An adversary may attempt to brute force the password for the Root user identity, as it has complete access to all services and resources for the AWS account.","risk_score":73,"severity":"high","note":"The AWS Filebeat module must be enabled to use this rule.","license":"Elastic License v2","output_index":".siem-signals-default","meta":{"from":"15m"},"author":["Elastic"],"false_positives":["Automated processes that attempt to authenticate using expired credentials and unbounded retries may lead to false positives."],"from":"now-1200s","rule_id":"d9efe647-4d84-461b-85b0-a62ea65e403a","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","technique":[{"reference":"https://attack.mitre.org/techniques/T1110/","name":"Brute Force","subtechnique":[],"id":"T1110"}],"tactic":{"reference":"https://attack.mitre.org/tactics/TA0006/","name":"Credential Access","id":"TA0006"}}],"to":"now","references":["https://docs.aws.amazon.com/IAM/latest/UserGuide/id_root-user.html"],"version":3,"exceptions_list":[],"immutable":false,"type":"threshold","language":"kuery","index":["aws-config-*","aws-cloudtrail-*"],"query":"event.dataset:aws.cloudtrail and event.provider:signin.amazonaws.com and event.action:ConsoleLogin and aws.cloudtrail.user_identity.type:Root and event.outcome:failure","filters":[],"threshold":{"field":["cloud.account.id"],"value":10,"cardinality":[]},"throttle":"no_actions","actions":[]}
{"id":"d3dae630-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T15:59:11.879Z","updated_by":"admin","created_at":"2021-09-22T15:57:46.911Z","created_by":"admin","name":"[GD] Suspicious Explorer Child Process","tags":["Elastic","Host","Initial Access","Threat Detection","Windows"],"interval":"5m","enabled":false,"description":"Identifies a suspicious Windows explorer child process. Explorer.exe can be abused to launch malicious scripts or executables from a trusted parent process.","risk_score":47,"severity":"medium","license":"Elastic License v2","output_index":".siem-signals-default","meta":{"from":"4m"},"timestamp_override":"event.ingested","author":["Elastic"],"false_positives":[],"from":"now-540s","rule_id":"82662dbb-cdff-4100-8b48-8268ad387020","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","technique":[{"reference":"https://attack.mitre.org/techniques/T1566/","name":"Phishing","subtechnique":[{"reference":"https://attack.mitre.org/techniques/T1566/001/","name":"Spearphishing Attachment","id":"T1566.001"},{"reference":"https://attack.mitre.org/techniques/T1566/002/","name":"Spearphishing Link","id":"T1566.002"}],"id":"T1566"}],"tactic":{"reference":"https://attack.mitre.org/tactics/TA0001/","name":"Initial Access","id":"TA0001"}}],"to":"now","references":[],"version":4,"exceptions_list":[],"immutable":false,"type":"eql","language":"eql","index":["windows-*"],"query":"process where event.type in (\"start\", \"process_started\") and\n  process.name : (\"cscript.exe\", \"wscript.exe\", \"powershell.exe\", \"rundll32.exe\", \"cmd.exe\", \"mshta.exe\", \"regsvr32.exe\") and\n  /* Explorer started via DCOM */\n  process.parent.name : \"explorer.exe\" and process.parent.args : \"-Embedding\"\n","filters":[],"throttle":"no_actions","actions":[]}
{"id":"cf8d36f0-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T15:57:38.727Z","updated_by":"admin","created_at":"2021-09-22T15:57:38.727Z","created_by":"admin","name":"Unusual Process Execution - Temp [Duplicate]","tags":["Elastic","Host","Linux","Threat Detection"],"interval":"5m","enabled":false,"description":"Identifies processes running in a temporary folder. This is sometimes done by adversaries to hide malware.","risk_score":47,"severity":"medium","license":"Elastic License v2","output_index":".siem-signals-default","timestamp_override":"event.ingested","author":["Elastic"],"false_positives":["Build systems, like Jenkins, may start processes in the `/tmp` directory. These can be exempted by name or by username."],"from":"now-9m","rule_id":"2b2facad-9e00-460d-a8d4-5102ddabd807","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[],"to":"now","references":[],"version":7,"exceptions_list":[],"immutable":false,"type":"query","language":"kuery","index":["auditbeat-*","logs-endpoint.events.*"],"query":"event.category:process and event.type:(start or process_started) and process.working_directory:/tmp","throttle":"no_actions","actions":[]}
{"id":"d1b2d610-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T15:59:30.194Z","updated_by":"admin","created_at":"2021-09-22T15:57:42.889Z","created_by":"admin","name":"[GD] Exporting Exchange Mailbox via PowerShell","tags":["Collection","Elastic","Host","Threat Detection","Windows"],"interval":"5m","enabled":false,"description":"Identifies the use of the Exchange PowerShell cmdlet, New-MailBoxExportRequest, to export the contents of a primary mailbox or archive to a .pst file. Adversaries may target user email to collect sensitive information.","risk_score":47,"severity":"medium","license":"Elastic License v2","output_index":".siem-signals-default","meta":{"from":"4m"},"timestamp_override":"event.ingested","author":["Elastic"],"false_positives":["Legitimate exchange system administration activity."],"from":"now-540s","rule_id":"bcb3c765-82bf-4a23-a2d7-2a29877eb6f5","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","technique":[{"reference":"https://attack.mitre.org/techniques/T1114/","name":"Email Collection","subtechnique":[],"id":"T1114"}],"tactic":{"reference":"https://attack.mitre.org/tactics/TA0009/","name":"Collection","id":"TA0009"}}],"to":"now","references":["https://www.volexity.com/blog/2020/12/14/dark-halo-leverages-solarwinds-compromise-to-breach-organizations/","https://docs.microsoft.com/en-us/powershell/module/exchange/new-mailboxexportrequest?view=exchange-ps"],"version":4,"exceptions_list":[],"immutable":false,"type":"eql","language":"eql","index":["windows-*"],"query":"process where event.type in (\"start\", \"process_started\") and\n  process.name: (\"powershell.exe\", \"pwsh.exe\") and process.args : \"New-MailboxExportRequest*\"\n","filters":[],"throttle":"no_actions","actions":[]}
{"id":"d1b17681-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T15:59:30.225Z","updated_by":"admin","created_at":"2021-09-22T15:57:42.867Z","created_by":"admin","name":"[GD] Command Execution via SolarWinds Process","tags":["Elastic","Execution","Host","Threat Detection","Windows"],"interval":"5m","enabled":false,"description":"A suspicious SolarWinds child process (Cmd.exe or Powershell.exe) was detected.","risk_score":47,"severity":"medium","license":"Elastic License v2","output_index":".siem-signals-default","meta":{"from":"4m"},"timestamp_override":"event.ingested","author":["Elastic"],"false_positives":["Trusted SolarWinds child processes. Verify process details such as network connections and file writes."],"from":"now-540s","rule_id":"32cd932e-7ecc-4da2-8ae5-1f2f868bf18b","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","technique":[{"reference":"https://attack.mitre.org/techniques/T1059/","name":"Command and Scripting Interpreter","subtechnique":[],"id":"T1059"}],"tactic":{"reference":"https://attack.mitre.org/tactics/TA0002/","name":"Execution","id":"TA0002"}},{"framework":"MITRE ATT&CK","technique":[{"reference":"https://attack.mitre.org/techniques/T1195/","name":"Supply Chain Compromise","subtechnique":[{"reference":"https://attack.mitre.org/techniques/T1195/002/","name":"Compromise Software Supply Chain","id":"T1195.002"}],"id":"T1195"}],"tactic":{"reference":"https://attack.mitre.org/tactics/TA0001/","name":"Initial Access","id":"TA0001"}}],"to":"now","references":["https://www.fireeye.com/blog/threat-research/2020/12/evasive-attacker-leverages-solarwinds-supply-chain-compromises-with-sunburst-backdoor.html","https://github.com/fireeye/sunburst_countermeasures/blob/main/rules/SUNBURST/hxioc/SOLARWINDS%20SUSPICIOUS%20FILEWRITES%20(METHODOLOGY).ioc"],"version":4,"exceptions_list":[],"immutable":false,"type":"eql","language":"eql","index":["windows-*"],"query":"process where event.type in (\"start\", \"process_started\") and process.name: (\"cmd.exe\", \"powershell.exe\") and\nprocess.parent.name: (\n     \"ConfigurationWizard*.exe\",\n     \"NetflowDatabaseMaintenance*.exe\",\n     \"NetFlowService*.exe\",\n     \"SolarWinds.Administration*.exe\",\n     \"SolarWinds.Collector.Service*.exe\",\n     \"SolarwindsDiagnostics*.exe\"\n     )\n","filters":[],"throttle":"no_actions","actions":[]}
{"id":"d1ae1b20-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T15:59:30.243Z","updated_by":"admin","created_at":"2021-09-22T15:57:42.870Z","created_by":"admin","name":"[GD] System Shells via Services","tags":["Elastic","Host","Persistence","Threat Detection","Windows"],"interval":"5m","enabled":false,"description":"Windows services typically run as SYSTEM and can be used as a privilege escalation opportunity. Malware or penetration testers may run a shell as a service to gain SYSTEM permissions.","risk_score":47,"severity":"medium","license":"Elastic License v2","output_index":".siem-signals-default","meta":{"from":"4m"},"timestamp_override":"event.ingested","author":["Elastic"],"false_positives":[],"from":"now-540s","rule_id":"caf7c776-dc33-420c-820a-3df1da3d1382","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","technique":[{"reference":"https://attack.mitre.org/techniques/T1543/","name":"Create or Modify System Process","subtechnique":[{"reference":"https://attack.mitre.org/techniques/T1543/003/","name":"Windows Service","id":"T1543.003"}],"id":"T1543"}],"tactic":{"reference":"https://attack.mitre.org/tactics/TA0003/","name":"Persistence","id":"TA0003"}}],"to":"now","references":[],"version":9,"exceptions_list":[],"immutable":false,"type":"query","language":"kuery","index":["windows-*"],"query":"event.category:process and event.type:(start or process_started) and process.parent.name:services.exe and process.name:(cmd.exe or powershell.exe)","filters":[],"throttle":"no_actions","actions":[]}
{"id":"d6470430-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T16:00:33.984Z","updated_by":"admin","created_at":"2021-09-22T15:57:50.924Z","created_by":"admin","name":"[GD] Rare AWS Error Code","tags":["AWS","Cloud","Elastic","ML"],"interval":"15m","enabled":false,"description":"A machine learning job detected an unusual error in a CloudTrail message. These can be byproducts of attempted or successful persistence, privilege escalation, defense evasion, discovery, lateral movement, or collection.","risk_score":21,"severity":"low","note":"### Investigating Unusual CloudTrail Error Activity ###\nDetection alerts from this rule indicate a rare and unusual error code that was associated with the response to an AWS API command or method call. Here are some possible avenues of investigation:\n- Examine the history of the error. Has it manifested before? If the error, which is visible in the `aws.cloudtrail.error_code field`, manifested only very recently, it might be related to recent changes in an automation module or script.\n- Examine the request parameters. These may provide indications as to the nature of the task being performed when the error occurred. Is the error related to unsuccessful attempts to enumerate or access objects, data, or secrets? If so, this can sometimes be a byproduct of discovery, privilege escalation, or lateral movement attempts.\n- Consider the user as identified by the `user.name` field. Is this activity part of an expected workflow for the user context? Examine the user identity in the `aws.cloudtrail.user_identity.arn` field and the access key id in the `aws.cloudtrail.user_identity.access_key_id` field which can help identify the precise user context. The user agent details in the `user_agent.original` field may also indicate what kind of a client made the request.\n- Consider the source IP address and geolocation for the calling user who issued the command. Do they look normal for the calling user? If the source is an EC2 IP address, is it associated with an EC2 instance in one of your accounts or could it be sourcing from an EC2 instance not under your control? If it is an authorized EC2 instance, is the activity associated with normal behavior for the instance role or roles? Are there any other alerts or signs of suspicious activity involving this instance?","license":"Elastic License v2","output_index":".siem-signals-default","meta":{"from":"45m"},"author":["Elastic"],"false_positives":["Rare and unusual errors may indicate an impending service failure state. Rare and unusual user error activity can also be due to manual troubleshooting or reconfiguration attempts by insufficiently privileged users, bugs in cloud automation scripts or workflows, or changes to IAM privileges."],"from":"now-3600s","rule_id":"b36bac93-028a-4d06-9b31-9da1fd2b6d04","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[],"to":"now","references":["https://www.elastic.co/guide/en/security/current/prebuilt-ml-jobs.html"],"version":5,"exceptions_list":[],"immutable":false,"type":"machine_learning","anomaly_threshold":50,"machine_learning_job_id":["rare_error_code"],"throttle":"no_actions","actions":[]}
{"id":"d645cbb0-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T16:00:34.027Z","updated_by":"admin","created_at":"2021-09-22T15:57:50.918Z","created_by":"admin","name":"[GD] File and Directory Discovery","tags":["Discovery","Elastic","Host","Threat Detection","Windows"],"interval":"5m","enabled":false,"description":"Enumeration of files and directories using built-in tools. Adversaries may use the information discovered to plan follow-on activity.","risk_score":21,"severity":"low","license":"Elastic License v2","output_index":".siem-signals-default","meta":{"from":"4m"},"timestamp_override":"event.ingested","author":["Elastic"],"false_positives":["Enumeration of files and directories may not be inherently malicious and noise may come from scripts, automation tools, or normal command line usage. It's important to baseline your environment to determine the amount of expected noise and exclude any known FP's from the rule."],"from":"now-540s","rule_id":"4a67e246-b5e2-4043-b4fb-fb9f39f60d3e","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","technique":[{"reference":"https://attack.mitre.org/techniques/T1083/","name":"File and Directory Discovery","subtechnique":[],"id":"T1083"}],"tactic":{"reference":"https://attack.mitre.org/tactics/TA0007/","name":"Discovery","id":"TA0007"}}],"to":"now","references":[],"version":4,"exceptions_list":[],"immutable":false,"type":"eql","language":"eql","index":["windows-*"],"query":"sequence by agent.id, user.name with maxspan=1m\n[process where event.type in (\"start\", \"process_started\") and\n  ((process.name : \"cmd.exe\" or process.pe.original_file_name == \"Cmd.Exe\") and process.args : \"dir\") or\n    process.name : \"tree.com\"]\n[process where event.type in (\"start\", \"process_started\") and\n  ((process.name : \"cmd.exe\" or process.pe.original_file_name == \"Cmd.Exe\") and process.args : \"dir\") or\n    process.name : \"tree.com\"]\n[process where event.type in (\"start\", \"process_started\") and\n  ((process.name : \"cmd.exe\" or process.pe.original_file_name == \"Cmd.Exe\") and process.args : \"dir\") or\n    process.name : \"tree.com\"]\n","filters":[],"throttle":"no_actions","actions":[]}
{"id":"d6497530-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T16:00:33.378Z","updated_by":"admin","created_at":"2021-09-22T15:57:50.931Z","created_by":"admin","name":"[GD] AWS IAM Group Deletion","tags":["AWS","Cloud","Continuous Monitoring","Elastic","Monitoring","SecOps"],"interval":"10m","enabled":false,"description":"Identifies the deletion of a specified AWS Identity and Access Management (IAM) resource group. Deleting a resource group does not delete resources that are members of the group; it only deletes the group structure.","risk_score":21,"severity":"low","note":"The AWS Filebeat module must be enabled to use this rule.","license":"Elastic License v2","output_index":".siem-signals-default","meta":{"from":"50m"},"timestamp_override":"event.ingested","author":["Elastic"],"false_positives":["A resource group may be deleted by a system administrator. Verify whether the user identity, user agent, and/or hostname should be making changes in your environment. Resource group deletions from unfamiliar users or hosts should be investigated. If known behavior is causing false positives, it can be exempted from the rule."],"from":"now-3600s","rule_id":"1ffd5fc4-961f-40b3-bcbb-ad29646b8467","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","technique":[{"reference":"https://attack.mitre.org/techniques/T1531/","name":"Account Access Removal","subtechnique":[],"id":"T1531"}],"tactic":{"reference":"https://attack.mitre.org/tactics/TA0040/","name":"Impact","id":"TA0040"}}],"to":"now","references":["https://awscli.amazonaws.com/v2/documentation/api/latest/reference/iam/delete-group.html","https://docs.aws.amazon.com/IAM/latest/APIReference/API_DeleteGroup.html"],"version":5,"exceptions_list":[],"immutable":false,"type":"query","language":"kuery","index":["aws-cloudtrail-*","aws-config-*"],"query":"event.action:DeleteGroup and event.dataset:aws.cloudtrail and event.provider:iam.amazonaws.com and event.outcome:success","filters":[],"throttle":"no_actions","actions":[]}
{"id":"d3d763c1-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T16:00:33.426Z","updated_by":"admin","created_at":"2021-09-22T15:57:46.923Z","created_by":"admin","name":"[GD] UAC Bypass via Windows Firewall Snap-In Hijack","tags":["Elastic","Host","Privilege Escalation","Threat Detection","Windows"],"interval":"5m","enabled":false,"description":"Identifies attempts to bypass User Account Control (UAC) by hijacking the Microsoft Management Console (MMC) Windows Firewall snap-in. Attackers bypass UAC to stealthily execute code with elevated permissions.","risk_score":47,"severity":"medium","license":"Elastic License v2","output_index":".siem-signals-default","meta":{"from":"4m"},"timestamp_override":"event.ingested","author":["Elastic"],"false_positives":[],"from":"now-540s","rule_id":"7a58da57-1e0e-414d-abed-a0e75be1e241","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","technique":[{"reference":"https://attack.mitre.org/techniques/T1548/","name":"Abuse Elevation Control Mechanism","subtechnique":[{"reference":"https://attack.mitre.org/techniques/T1548/002/","name":"Bypass User Access Control","id":"T1548.002"}],"id":"T1548"}],"tactic":{"reference":"https://attack.mitre.org/tactics/TA0004/","name":"Privilege Escalation","id":"TA0004"}}],"to":"now","references":["https://github.com/AzAgarampur/byeintegrity-uac"],"version":4,"exceptions_list":[],"immutable":false,"type":"eql","language":"eql","index":["windows-*"],"query":"process where event.type in (\"start\", \"process_started\") and\n process.parent.name == \"mmc.exe\" and\n /* process.Ext.token.integrity_level_name == \"high\" can be added in future for tuning */\n /* args of the Windows Firewall SnapIn */\n  process.parent.args == \"WF.msc\" and process.name != \"WerFault.exe\"\n","filters":[],"throttle":"no_actions","actions":[]}
{"id":"d645a4a1-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T16:00:33.432Z","updated_by":"admin","created_at":"2021-09-22T15:57:50.915Z","created_by":"admin","name":"[GD] AWS IAM Assume Role Policy Update","tags":["AWS","Cloud","Continuous Monitoring","Elastic","Identity and Access","SecOps"],"interval":"10m","enabled":false,"description":"Identifies attempts to modify an AWS IAM Assume Role Policy. An adversary may attempt to modify the AssumeRolePolicy of a misconfigured role in order to gain the privileges of that role.","risk_score":21,"severity":"low","note":"The AWS Filebeat module must be enabled to use this rule.","license":"Elastic License v2","output_index":".siem-signals-default","meta":{"from":"50m"},"timestamp_override":"event.ingested","author":["Elastic"],"false_positives":["Verify whether the user identity, user agent, and/or hostname should be making changes in your environment. Policy updates from unfamiliar users or hosts should be investigated. If known behavior is causing false positives, it can be exempted from the rule."],"from":"now-3600s","rule_id":"6c7e51bf-127f-4a40-8d5f-f9556460b82d","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","technique":[{"reference":"https://attack.mitre.org/techniques/T1078/","name":"Valid Accounts","subtechnique":[],"id":"T1078"}],"tactic":{"reference":"https://attack.mitre.org/tactics/TA0004/","name":"Privilege Escalation","id":"TA0004"}}],"to":"now","references":["https://labs.bishopfox.com/tech-blog/5-privesc-attack-vectors-in-aws"],"version":5,"exceptions_list":[],"immutable":false,"type":"query","language":"kuery","index":["aws-cloudtrail-*","aws-config-*"],"query":"event.dataset:aws.cloudtrail and event.provider:iam.amazonaws.com and event.action:UpdateAssumeRolePolicy and event.outcome:success","filters":[],"throttle":"no_actions","actions":[]}
{"id":"d644e151-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T16:00:33.815Z","updated_by":"admin","created_at":"2021-09-22T15:57:50.912Z","created_by":"admin","name":"[GD] Microsoft Build Engine Started by a Script Process","tags":["Defense Evasion","Elastic","Host","Threat Detection","Windows"],"interval":"5m","enabled":false,"description":"An instance of MSBuild, the Microsoft Build Engine, was started by a script or the Windows command interpreter. This behavior is unusual and is sometimes used by malicious payloads.","risk_score":21,"severity":"low","license":"Elastic License v2","output_index":".siem-signals-default","meta":{"from":"4m"},"timestamp_override":"event.ingested","author":["Elastic"],"false_positives":["The Build Engine is commonly used by Windows developers but use by non-engineers is unusual."],"from":"now-540s","rule_id":"139030bd-351b-493b-b84d-6f44b4ae37c4","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","technique":[{"reference":"https://attack.mitre.org/techniques/T1127/","name":"Trusted Developer Utilities Proxy Execution","subtechnique":[],"id":"T1127"}],"tactic":{"reference":"https://attack.mitre.org/tactics/TA0005/","name":"Defense Evasion","id":"TA0005"}},{"framework":"MITRE ATT&CK","technique":[],"tactic":{"reference":"https://attack.mitre.org/tactics/TA0002/","name":"Execution","id":"TA0002"}}],"to":"now","references":[],"version":8,"exceptions_list":[],"immutable":false,"type":"query","language":"kuery","index":["windows-*"],"query":"event.category:process and event.type: start and process.name:MSBuild.exe and process.parent.name:(cmd.exe or powershell.exe or cscript.exe or wscript.exe)","filters":[],"throttle":"no_actions","actions":[]}
{"id":"d3db3450-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T15:59:11.903Z","updated_by":"admin","created_at":"2021-09-22T15:57:46.907Z","created_by":"admin","name":"[GD] Security Software Discovery using WMIC","tags":["Discovery","Elastic","Host","Threat Detection","Windows"],"interval":"5m","enabled":false,"description":"Identifies the use of Windows Management Instrumentation Command (WMIC) to discover certain System Security Settings such as AntiVirus or Host Firewall details.","risk_score":47,"severity":"medium","license":"Elastic License v2","output_index":".siem-signals-default","meta":{"from":"4m"},"timestamp_override":"event.ingested","author":["Elastic"],"false_positives":[],"from":"now-540s","rule_id":"fd499759-dca4-4446-82ff-8b8e116426e8","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","technique":[{"reference":"https://attack.mitre.org/techniques/T1518/","name":"Software Discovery","subtechnique":[],"id":"T1518"}],"tactic":{"reference":"https://attack.mitre.org/tactics/TA0007/","name":"Discovery","id":"TA0007"}}],"to":"now","references":[],"version":4,"exceptions_list":[],"immutable":false,"type":"eql","language":"eql","index":["windows-*"],"query":"process where event.type in (\"start\", \"process_started\") and\n   (process.name:\"wmic.exe\" or process.pe.original_file_name:\"wmic.exe\") and\n    process.args:\"/namespace:\\\\\\\\root\\\\SecurityCenter2\" and process.args:\"Get\"\n","filters":[],"throttle":"no_actions","actions":[]}
{"id":"d3da7100-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T15:59:11.907Z","updated_by":"admin","created_at":"2021-09-22T15:57:46.905Z","created_by":"admin","name":"[GD] AdFind Command Activity","tags":["Discovery","Elastic","Host","Threat Detection","Windows"],"interval":"5m","enabled":false,"description":"This rule detects the Active Directory query tool, AdFind.exe. AdFind has legitimate purposes, but it is frequently leveraged by threat actors to perform post-exploitation Active Directory reconnaissance. The AdFind tool has been observed in Trickbot, Ryuk, Maze, and FIN6 campaigns. For Winlogbeat, this rule requires Sysmon.","risk_score":21,"severity":"low","note":"`AdFind.exe` is a legitimate domain query tool. Rule alerts should be investigated to identify if the user has a role that would explain using this tool and that it is being run from an expected directory and endpoint. Leverage the exception workflow in the Kibana Security App or Elasticsearch API to tune this rule to your environment.","license":"Elastic License v2","output_index":".siem-signals-default","meta":{"from":"4m"},"timestamp_override":"event.ingested","author":["Elastic"],"false_positives":[],"from":"now-540s","rule_id":"1812c1b0-2188-4cec-b564-5790b67dca66","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","technique":[{"reference":"https://attack.mitre.org/techniques/T1069/","name":"Permission Groups Discovery","subtechnique":[{"reference":"https://attack.mitre.org/techniques/T1069/002/","name":"Domain Groups","id":"T1069.002"}],"id":"T1069"},{"reference":"https://attack.mitre.org/techniques/T1087/","name":"Account Discovery","subtechnique":[{"reference":"https://attack.mitre.org/techniques/T1087/002/","name":"Domain Account","id":"T1087.002"}],"id":"T1087"},{"reference":"https://attack.mitre.org/techniques/T1482/","name":"Domain Trust Discovery","subtechnique":[],"id":"T1482"}],"tactic":{"reference":"https://attack.mitre.org/tactics/TA0007/","name":"Discovery","id":"TA0007"}}],"to":"now","references":["http://www.joeware.net/freetools/tools/adfind/","https://thedfirreport.com/2020/05/08/adfind-recon/","https://www.fireeye.com/blog/threat-research/2020/05/tactics-techniques-procedures-associated-with-maze-ransomware-incidents.html","https://www.cybereason.com/blog/dropping-anchor-from-a-trickbot-infection-to-the-discovery-of-the-anchor-malware","https://www.fireeye.com/blog/threat-research/2019/04/pick-six-intercepting-a-fin6-intrusion.html","https://usa.visa.com/dam/VCOM/global/support-legal/documents/fin6-cybercrime-group-expands-threat-To-ecommerce-merchants.pdf"],"version":4,"exceptions_list":[],"immutable":false,"type":"eql","language":"eql","index":["windows-*"],"query":"process where event.type in (\"start\", \"process_started\") and \n  (process.name : \"AdFind.exe\" or process.pe.original_file_name == \"AdFind.exe\") and \n  process.args : (\"objectcategory=computer\", \"(objectcategory=computer)\", \n                  \"objectcategory=person\", \"(objectcategory=person)\",\n                  \"objectcategory=subnet\", \"(objectcategory=subnet)\",\n                  \"objectcategory=group\", \"(objectcategory=group)\", \n                  \"objectcategory=organizationalunit\", \"(objectcategory=organizationalunit)\",\n                  \"objectcategory=attributeschema\", \"(objectcategory=attributeschema)\",\n                  \"domainlist\", \"dcmodes\", \"adinfo\", \"dclist\", \"computers_pwnotreqd\", \"trustdmp\")\n","filters":[],"throttle":"no_actions","actions":[]}
{"id":"d1b54711-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T15:59:30.260Z","updated_by":"admin","created_at":"2021-09-22T15:57:42.876Z","created_by":"admin","name":"[GD] Potential DNS Tunneling via NsLookup","tags":["Command and Control","Elastic","Host","Threat Detection","Windows"],"interval":"5m","enabled":false,"description":"This rule identifies a large number (15) of nslookup.exe executions with an explicit query type from the same host. This may indicate command and control activity utilizing the DNS protocol.","risk_score":47,"severity":"medium","license":"Elastic License v2","output_index":".siem-signals-default","meta":{"from":"4m"},"author":["Elastic"],"false_positives":[],"from":"now-540s","rule_id":"b507a23c-1a55-444e-9c82-0a1255c95a55","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","technique":[{"reference":"https://attack.mitre.org/techniques/T1071/","name":"Application Layer Protocol","subtechnique":[],"id":"T1071"}],"tactic":{"reference":"https://attack.mitre.org/tactics/TA0011/","name":"Command and Control","id":"TA0011"}}],"to":"now","references":["https://unit42.paloaltonetworks.com/dns-tunneling-in-the-wild-overview-of-oilrigs-dns-tunneling/"],"version":3,"exceptions_list":[],"immutable":false,"type":"threshold","language":"kuery","index":["windows-*"],"query":"event.category:process and event.type:start and process.name:nslookup.exe and process.args:(-querytype=* or -qt=* or -q=* or -type=*)","filters":[],"threshold":{"field":["host.id"],"value":15,"cardinality":[]},"throttle":"no_actions","actions":[]}
{"id":"d1b87b60-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T15:59:30.264Z","updated_by":"admin","created_at":"2021-09-22T15:57:42.878Z","created_by":"admin","name":"[GD] Persistence via WMI Event Subscription","tags":["Elastic","Host","Persistence","Threat Detection","Windows"],"interval":"5m","enabled":false,"description":"An adversary can use Windows Management Instrumentation (WMI) to install event filters, providers, consumers, and bindings that execute code when a defined event occurs. Adversaries may use the capabilities of WMI to subscribe to an event and execute arbitrary code when that event occurs, providing persistence on a system.","risk_score":21,"severity":"low","license":"Elastic License v2","output_index":".siem-signals-default","meta":{"from":"4m"},"timestamp_override":"event.ingested","author":["Elastic"],"false_positives":[],"from":"now-540s","rule_id":"7fcc4f27-c3f6-4c2e-805a-59c255900ca6","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","technique":[{"reference":"https://attack.mitre.org/techniques/T1546/","name":"Event Triggered Execution","subtechnique":[],"id":"T1546"}],"tactic":{"reference":"https://attack.mitre.org/tactics/TA0003/","name":"Persistence","id":"TA0003"}}],"to":"now","references":[],"version":4,"exceptions_list":[],"immutable":false,"type":"eql","language":"eql","index":["windows-*"],"query":"process where event.type in (\"start\", \"process_started\") and\n  (process.name : \"wmic.exe\" or process.pe.original_file_name == \"wmic.exe\") and\n  process.args : \"create\" and\n  process.args : (\"ActiveScriptEventConsumer\", \"CommandLineEventConsumer\")\n","filters":[],"throttle":"no_actions","actions":[]}
{"id":"d1b2fd20-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T15:59:30.265Z","updated_by":"admin","created_at":"2021-09-22T15:57:42.878Z","created_by":"admin","name":"[GD] Svchost spawning Cmd","tags":["Elastic","Execution","Host","Threat Detection","Windows"],"interval":"5m","enabled":false,"description":"Identifies a suspicious parent child process relationship with cmd.exe descending from svchost.exe","risk_score":21,"severity":"low","license":"Elastic License v2","output_index":".siem-signals-default","meta":{"from":"4m"},"timestamp_override":"event.ingested","author":["Elastic"],"false_positives":[],"from":"now-540s","rule_id":"eaf50ad3-f2d1-4b4c-b6c9-d458e9a8e346","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","technique":[{"reference":"https://attack.mitre.org/techniques/T1059/","name":"Command and Scripting Interpreter","subtechnique":[],"id":"T1059"}],"tactic":{"reference":"https://attack.mitre.org/tactics/TA0002/","name":"Execution","id":"TA0002"}}],"to":"now","references":[],"version":8,"exceptions_list":[],"immutable":false,"type":"query","language":"kuery","index":["windows-*"],"query":"event.category:process and event.type:(start or process_started) and process.parent.name:svchost.exe and process.name:cmd.exe","filters":[],"throttle":"no_actions","actions":[]}
{"id":"d1b0da40-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T15:59:30.268Z","updated_by":"admin","created_at":"2021-09-22T15:57:42.873Z","created_by":"admin","name":"[GD] Suspicious SolarWinds Child Process","tags":["Elastic","Execution","Host","Threat Detection","Windows"],"interval":"5m","enabled":false,"description":"A suspicious SolarWinds child process was detected, which may indicate an attempt to execute malicious programs.","risk_score":47,"severity":"medium","license":"Elastic License v2","output_index":".siem-signals-default","meta":{"from":"4m"},"timestamp_override":"event.ingested","author":["Elastic"],"false_positives":["Trusted SolarWinds child processes, verify process details such as network connections and file writes."],"from":"now-540s","rule_id":"527af061-d3a6-4174-8719-a554d07b3046","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","technique":[{"reference":"https://attack.mitre.org/techniques/T1106/","name":"Native API","subtechnique":[],"id":"T1106"}],"tactic":{"reference":"https://attack.mitre.org/tactics/TA0002/","name":"Execution","id":"TA0002"}},{"framework":"MITRE ATT&CK","technique":[{"reference":"https://attack.mitre.org/techniques/T1195/","name":"Supply Chain Compromise","subtechnique":[{"reference":"https://attack.mitre.org/techniques/T1195/002/","name":"Compromise Software Supply Chain","id":"T1195.002"}],"id":"T1195"}],"tactic":{"reference":"https://attack.mitre.org/tactics/TA0001/","name":"Initial Access","id":"TA0001"}}],"to":"now","references":["https://www.fireeye.com/blog/threat-research/2020/12/evasive-attacker-leverages-solarwinds-supply-chain-compromises-with-sunburst-backdoor.html","https://github.com/fireeye/sunburst_countermeasures/blob/main/rules/SUNBURST/hxioc/SOLARWINDS%20SUSPICIOUS%20CHILD%20PROCESSES%20(METHODOLOGY).ioc"],"version":4,"exceptions_list":[],"immutable":false,"type":"eql","language":"eql","index":["windows-*"],"query":"process where event.type in (\"start\", \"process_started\") and\n process.parent.name: (\"SolarWinds.BusinessLayerHost.exe\", \"SolarWinds.BusinessLayerHostx64.exe\") and\n not process.name : (\n        \"APMServiceControl*.exe\",\n        \"ExportToPDFCmd*.Exe\",\n        \"SolarWinds.Credentials.Orion.WebApi*.exe\",\n        \"SolarWinds.Orion.Topology.Calculator*.exe\",\n        \"Database-Maint.exe\",\n        \"SolarWinds.Orion.ApiPoller.Service.exe\",\n        \"WerFault.exe\",\n        \"WerMgr.exe\")\n","filters":[],"throttle":"no_actions","actions":[]}
{"id":"d3d7b1e1-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T15:59:47.207Z","updated_by":"admin","created_at":"2021-09-22T15:57:46.913Z","created_by":"admin","name":"[GD] Conhost Spawned By Suspicious Parent Process","tags":["Elastic","Execution","Host","Threat Detection","Windows"],"interval":"5m","enabled":false,"description":"Detects when the Console Window Host (conhost.exe) process is spawned by a suspicious parent process, which could be indicative of code injection.","risk_score":73,"severity":"high","license":"Elastic License v2","output_index":".siem-signals-default","meta":{"from":"4m"},"timestamp_override":"event.ingested","author":["Elastic"],"false_positives":[],"from":"now-540s","rule_id":"d10672cd-71b4-4895-9188-7480133a9656","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","technique":[{"reference":"https://attack.mitre.org/techniques/T1059/","name":"Command and Scripting Interpreter","subtechnique":[],"id":"T1059"}],"tactic":{"reference":"https://attack.mitre.org/tactics/TA0002/","name":"Execution","id":"TA0002"}}],"to":"now","references":["https://www.fireeye.com/blog/threat-research/2017/08/monitoring-windows-console-activity-part-one.html"],"version":4,"exceptions_list":[],"immutable":false,"type":"query","language":"kuery","index":["windows-*"],"query":"event.category:process and event.type:(start or process_started) and process.name:conhost.exe and process.parent.name:(svchost.exe or lsass.exe or services.exe or smss.exe or winlogon.exe or explorer.exe or dllhost.exe or rundll32.exe or regsvr32.exe or userinit.exe or wininit.exe or spoolsv.exe or wermgr.exe or csrss.exe or ctfmon.exe)","filters":[],"throttle":"no_actions","actions":[]}
{"id":"d3df7a10-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T15:59:47.209Z","updated_by":"admin","created_at":"2021-09-22T15:57:46.910Z","created_by":"admin","name":"[GD] PowerShell spawning Cmd","tags":["Elastic","Execution","Host","Threat Detection","Windows"],"interval":"5m","enabled":false,"description":"Identifies a suspicious parent child process relationship with cmd.exe descending from PowerShell.exe.","risk_score":21,"severity":"low","license":"Elastic License v2","output_index":".siem-signals-default","meta":{"from":"4m"},"timestamp_override":"event.ingested","author":["Elastic"],"false_positives":[],"from":"now-540s","rule_id":"95330352-b7b8-4e08-a67a-089aac06461c","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","technique":[{"reference":"https://attack.mitre.org/techniques/T1059/","name":"Command and Scripting Interpreter","subtechnique":[{"reference":"https://attack.mitre.org/techniques/T1059/001/","name":"PowerShell","id":"T1059.001"}],"id":"T1059"}],"tactic":{"reference":"https://attack.mitre.org/tactics/TA0002/","name":"Execution","id":"TA0002"}}],"to":"now","references":[],"version":9,"exceptions_list":[],"immutable":false,"type":"query","language":"kuery","index":["windows-*"],"query":"event.category:process and event.type:(start or process_started) and process.parent.name:powershell.exe and process.name:cmd.exe","filters":[],"throttle":"no_actions","actions":[]}
{"id":"d3d8ea60-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T15:59:47.211Z","updated_by":"admin","created_at":"2021-09-22T15:57:46.900Z","created_by":"admin","name":"[GD] Whoami Process Activity","tags":["Discovery","Elastic","Host","Threat Detection","Windows"],"interval":"5m","enabled":false,"description":"Identifies use of whoami.exe which displays user, group, and privileges information for the user who is currently logged on to the local system.","risk_score":21,"severity":"low","license":"Elastic License v2","output_index":".siem-signals-default","meta":{"from":"4m"},"timestamp_override":"event.ingested","author":["Elastic"],"false_positives":["Some normal use of this program, at varying levels of frequency, may originate from scripts, automation tools and frameworks. Usage by non-engineers and ordinary users is unusual."],"from":"now-540s","rule_id":"8d7e3986-1926-4bec-adfe-6cb616ac3f03","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","technique":[{"reference":"https://attack.mitre.org/techniques/T1033/","name":"System Owner/User Discovery","subtechnique":[],"id":"T1033"}],"tactic":{"reference":"https://attack.mitre.org/tactics/TA0007/","name":"Discovery","id":"TA0007"}}],"to":"now","references":[],"version":7,"exceptions_list":[],"immutable":false,"type":"query","language":"kuery","index":["windows-*"],"query":"event.category:process and event.type:(start or process_started) and process.name:whoami.exe","filters":[],"throttle":"no_actions","actions":[]}
{"id":"d3d9adb0-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T15:59:47.214Z","updated_by":"admin","created_at":"2021-09-22T15:57:46.904Z","created_by":"admin","name":"[GD] Encoding or Decoding Files via CertUtil","tags":["Defense Evasion","Elastic","Host","Threat Detection","Windows"],"interval":"5m","enabled":false,"description":"Identifies the use of certutil.exe to encode or decode data. CertUtil is a native Windows component which is part of Certificate Services. CertUtil is often abused by attackers to encode or decode base64 data for stealthier command and control or exfiltration.","risk_score":47,"severity":"medium","license":"Elastic License v2","output_index":".siem-signals-default","meta":{"from":"4m"},"timestamp_override":"event.ingested","author":["Elastic"],"false_positives":[],"from":"now-540s","rule_id":"51beddec-0664-4a12-bd8c-7c24d41d5c52","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","technique":[{"reference":"https://attack.mitre.org/techniques/T1140/","name":"Deobfuscate/Decode Files or Information","subtechnique":[],"id":"T1140"}],"tactic":{"reference":"https://attack.mitre.org/tactics/TA0005/","name":"Defense Evasion","id":"TA0005"}}],"to":"now","references":[],"version":8,"exceptions_list":[],"immutable":false,"type":"query","language":"kuery","index":["windows-*"],"query":"event.category:process and event.type:(start or process_started) and process.name:certutil.exe and process.args:(-decode or -encode or /decode or /encode)","filters":[],"throttle":"no_actions","actions":[]}
{"id":"cf865920-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T15:57:38.634Z","updated_by":"admin","created_at":"2021-09-22T15:57:38.634Z","created_by":"admin","name":"Kernel Module Removal [Duplicate]","tags":["Defense Evasion","Elastic","Host","Linux","Threat Detection"],"interval":"5m","enabled":false,"description":"Kernel modules are pieces of code that can be loaded and unloaded into the kernel upon demand. They extend the functionality of the kernel without the need to reboot the system. This rule identifies attempts to remove a kernel module.","risk_score":73,"severity":"high","license":"Elastic License v2","output_index":".siem-signals-default","timestamp_override":"event.ingested","author":["Elastic"],"false_positives":["There is usually no reason to remove modules, but some buggy modules require it. These can be exempted by username. Note that some Linux distributions are not built to support the removal of modules at all."],"from":"now-9m","rule_id":"c275f559-dd58-43a1-9e27-bad44a0e346a","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0005","name":"Defense Evasion","reference":"https://attack.mitre.org/tactics/TA0005/"},"technique":[{"id":"T1562","name":"Impair Defenses","reference":"https://attack.mitre.org/techniques/T1562/","subtechnique":[{"id":"T1562.001","name":"Disable or Modify Tools","reference":"https://attack.mitre.org/techniques/T1562/001/"}]}]},{"framework":"MITRE ATT&CK","tactic":{"id":"TA0003","name":"Persistence","reference":"https://attack.mitre.org/tactics/TA0003/"},"technique":[{"id":"T1547","name":"Boot or Logon Autostart Execution","reference":"https://attack.mitre.org/techniques/T1547/","subtechnique":[{"id":"T1547.006","name":"Kernel Modules and Extensions","reference":"https://attack.mitre.org/techniques/T1547/006/"}]}]}],"to":"now","references":["http://man7.org/linux/man-pages/man8/modprobe.8.html"],"version":7,"exceptions_list":[],"immutable":false,"type":"query","language":"kuery","index":["auditbeat-*","logs-endpoint.events.*"],"query":"event.category:process and event.type:(start or process_started) and process.args:((rmmod and sudo) or (modprobe and sudo and (\"--remove\" or \"-r\")))","throttle":"no_actions","actions":[]}
{"id":"cf891840-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T15:57:38.660Z","updated_by":"admin","created_at":"2021-09-22T15:57:38.660Z","created_by":"admin","name":"Connection to External Network via Telnet [Duplicate]","tags":["Elastic","Host","Lateral Movement","Linux","Threat Detection"],"interval":"5m","enabled":false,"description":"Telnet provides a command line interface for communication with a remote device or server. This rule identifies Telnet network connections to publicly routable IP addresses.","risk_score":47,"severity":"medium","license":"Elastic License v2","output_index":".siem-signals-default","author":["Elastic"],"false_positives":["Telnet can be used for both benign or malicious purposes. Telnet is included by default in some Linux distributions, so its presence is not inherently suspicious. The use of Telnet to manage devices remotely has declined in recent years in favor of more secure protocols such as SSH. Telnet usage by non-automated tools or frameworks may be suspicious."],"from":"now-9m","rule_id":"3cb2f67d-8557-4913-9011-2357b4f75929","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0008","name":"Lateral Movement","reference":"https://attack.mitre.org/tactics/TA0008/"},"technique":[{"id":"T1021","name":"Remote Services","reference":"https://attack.mitre.org/techniques/T1021/"}]}],"to":"now","references":[],"version":5,"exceptions_list":[],"immutable":false,"type":"eql","language":"eql","index":["auditbeat-*","logs-endpoint.events.*"],"query":"sequence by process.entity_id\n  [process where process.name == \"telnet\" and event.type == \"start\"]\n  [network where process.name == \"telnet\" and\n    not cidrmatch(destination.ip, \"127.0.0.0/8\", \"10.0.0.0/8\", \"172.16.0.0/12\",\n                                  \"192.168.0.0/16\", \"FE80::/10\", \"::1/128\")]\n","throttle":"no_actions","actions":[]}
{"id":"cf8a50c1-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T15:57:38.663Z","updated_by":"admin","created_at":"2021-09-22T15:57:38.663Z","created_by":"admin","name":"Tampering of Bash Command-Line History [Duplicate]","tags":["Defense Evasion","Elastic","Host","Linux","Threat Detection"],"interval":"5m","enabled":false,"description":"Adversaries may attempt to clear or disable the Bash command-line history in an attempt to evade detection or forensic investigations.","risk_score":47,"severity":"medium","license":"Elastic License v2","output_index":".siem-signals-default","timestamp_override":"event.ingested","author":["Elastic"],"false_positives":[],"from":"now-9m","rule_id":"1470e6df-154d-4312-8d12-7b276e12e4fd","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0005","name":"Defense Evasion","reference":"https://attack.mitre.org/tactics/TA0005/"},"technique":[{"id":"T1070","name":"Indicator Removal on Host","reference":"https://attack.mitre.org/techniques/T1070/","subtechnique":[{"id":"T1070.003","name":"Clear Command History","reference":"https://attack.mitre.org/techniques/T1070/003/"}]}]}],"to":"now","references":[],"version":6,"exceptions_list":[],"immutable":false,"type":"eql","language":"eql","index":["auditbeat-*","logs-endpoint.events.*"],"query":"process where event.type in (\"start\", \"process_started\") and\n (\n  (process.args : (\"rm\", \"echo\") and process.args : (\".bash_history\", \"/root/.bash_history\", \"/home/*/.bash_history\")) or\n  (process.name : \"history\" and process.args : \"-c\") or\n  (process.args : \"export\" and process.args : (\"HISTFILE=/dev/null\", \"HISTFILESIZE=0\")) or\n  (process.args : \"unset\" and process.args : \"HISTFILE\") or\n  (process.args : \"set\" and process.args : \"history\" and process.args : \"+o\")\n )\n","throttle":"no_actions","actions":[]}
{"id":"cf8e4860-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T15:57:38.724Z","updated_by":"admin","created_at":"2021-09-22T15:57:38.724Z","created_by":"admin","name":"Unusual Windows Process Calling the Metadata Service [Duplicate]","tags":["Elastic","Host","ML","Threat Detection","Windows"],"interval":"15m","enabled":false,"description":"Looks for anomalous access to the metadata service by an unusual process. The metadata service may be targeted in order to harvest credentials or user data scripts containing secrets.","risk_score":21,"severity":"low","license":"Elastic License v2","output_index":".siem-signals-default","author":["Elastic"],"false_positives":["A newly installed program or one that runs very rarely as part of a monthly or quarterly workflow could trigger this detection rule."],"from":"now-45m","rule_id":"ebb0f037-0419-4221-abc6-b48348d93fd7","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[],"to":"now","references":[],"version":2,"exceptions_list":[],"immutable":false,"type":"machine_learning","anomaly_threshold":50,"machine_learning_job_id":["windows_rare_metadata_process"],"throttle":"no_actions","actions":[]}
{"id":"cf8bb050-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T15:57:38.692Z","updated_by":"admin","created_at":"2021-09-22T15:57:38.692Z","created_by":"admin","name":"Netcat Network Activity [Duplicate]","tags":["Elastic","Host","Linux","Threat Detection"],"interval":"5m","enabled":false,"description":"A netcat process is engaging in network activity on a Linux host. Netcat is often used as a persistence mechanism by exporting a reverse shell or by serving a shell on a listening port. Netcat is also sometimes used for data exfiltration.","risk_score":47,"severity":"medium","license":"Elastic License v2","output_index":".siem-signals-default","author":["Elastic"],"false_positives":["Netcat is a dual-use tool that can be used for benign or malicious activity. Netcat is included in some Linux distributions so its presence is not necessarily suspicious. Some normal use of this program, while uncommon, may originate from scripts, automation tools, and frameworks."],"from":"now-9m","rule_id":"1ebd0e57-0f8b-46f1-b39c-87a284313ade","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[],"to":"now","references":["http://pentestmonkey.net/cheat-sheet/shells/reverse-shell-cheat-sheet","https://www.sans.org/security-resources/sec560/netcat_cheat_sheet_v1.pdf","https://en.wikipedia.org/wiki/Netcat"],"version":6,"exceptions_list":[],"immutable":false,"type":"eql","language":"eql","index":["auditbeat-*","logs-endpoint.events.*"],"query":"sequence by process.entity_id\n  [process where (process.name == \"nc\" or process.name == \"ncat\" or process.name == \"netcat\" or\n                  process.name == \"netcat.openbsd\" or process.name == \"netcat.traditional\") and\n     event.type == \"start\"]\n  [network where (process.name == \"nc\" or process.name == \"ncat\" or process.name == \"netcat\" or\n                  process.name == \"netcat.openbsd\" or process.name == \"netcat.traditional\")]\n","throttle":"no_actions","actions":[]}
{"id":"cd4a99f1-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T15:59:11.932Z","updated_by":"admin","created_at":"2021-09-22T15:57:35.846Z","created_by":"admin","name":"Carbon Black: Execution block (unapproved file)","tags":["Carbon Black","GD","POC"],"interval":"5m","enabled":false,"description":"This rules triggers when Carbon Black detects an Execution block (unapproved file) event.","risk_score":47,"severity":"medium","license":"","output_index":".siem-signals-default","meta":{"from":"1m","kibana_siem_app_url":"https://cbbf317cf62e4dd9b9913c1cc96ca394.vpce.gdw55e.elastic-cloud.com:9243/app/security"},"timestamp_override":"event.ingested","author":[],"false_positives":[],"from":"now-360s","rule_id":"546a136f-5644-4fa5-8c3b-ca80b7f71475","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[],"to":"now","references":[],"version":8,"exceptions_list":[],"immutable":false,"type":"query","language":"kuery","index":["carbon-black-*"],"query":"rule.description : \"Execution block (still analyzing)\" or rule.description : \"Execution block (unapproved file)\"","filters":[],"throttle":"no_actions","actions":[]}
{"id":"29075bc0-6295-11ec-9d1e-5b56ec0d9762","updated_at":"2022-03-02T02:16:29.435Z","updated_by":"jprentice1@godaddy.com","created_at":"2021-12-21T19:35:32.863Z","created_by":"admin","name":"PKI System Logging Check","tags":[],"interval":"24h","enabled":true,"description":"Alerts if any *pki.gdg servers stop sending events for more than 24 hours","risk_score":21,"severity":"low","license":"","output_index":".siem-signals-default","meta":{"from":"144h","kibana_siem_app_url":"https://security-prod.kibana.int.gdcorp.tools/app/security"},"author":[],"false_positives":[],"from":"now-604800s","rule_id":"a852526c-9d05-49bb-be68-8ab2c228acd8","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[],"to":"now","references":[],"version":6,"exceptions_list":[],"immutable":false,"type":"query","language":"kuery","index":["*:host-tracker-*","host-tracker-*"],"query":"host.logging: false AND (((_index: GD-AWS-USA-GD-secesspmed-ESSP\\:host-tracker-onprem-10m OR _index: host-tracker-linux-*) AND aws.fluent_data: *.PKI.*) OR (_index: host-tracker-windows-* AND host.hostname: *pki*))","filters":[{"meta":{"alias":null,"negate":false,"disabled":false,"type":"exists","key":"host.hostname","value":"exists"},"query":{"exists":{"field":"host.hostname"}},"$state":{"store":"appState"}},{"query":{"range":{"@timestamp":{"gte":"now-3d"}}},"meta":{"type":"range","disabled":false,"negate":true,"alias":null,"key":"@timestamp","params":{"gte":"now-3d"}},"$state":{"store":"appState"}}],"throttle":"rule","actions":[{"group":"default","id":"elastic-cloud-email","params":{"message":"The alert condition for '{{context.rule.name}}' was triggered.\n\nLink to results:\n{{context.results_link}}","to":["productsecurity@godaddy.com"],"subject":"Elastic Alert: {{context.rule.name}}"},"action_type_id":".email"}]}
{"id":"02ab14d0-5151-11ec-9cfc-af15db683ef5","updated_at":"2022-05-16T19:26:33.286Z","updated_by":"jprentice1@godaddy.com","created_at":"2021-11-29T20:14:52.779Z","created_by":"admin","name":"Okta - Admin App Access","tags":["GD","Okta"],"interval":"1h","enabled":false,"description":"User has accessed Admin Application","risk_score":47,"severity":"medium","license":"","output_index":".siem-signals-default","meta":{"from":"10m","kibana_siem_app_url":"https://security-prod.kibana.int.gdcorp.tools/app/security"},"author":[],"false_positives":[],"from":"now-4200s","rule_id":"412b18a2-a81f-42b3-8e1a-12cbe7d66b9e","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[],"to":"now","references":[],"version":21,"exceptions_list":[],"immutable":false,"type":"query","language":"kuery","index":["*:okta-*"],"query":"okta.display_message: \"User accessing Okta admin app\" ","filters":[{"$state":{"store":"appState"},"meta":{"negate":true,"alias":null,"disabled":false,"type":"phrases","params":["system@okta.com"],"key":"okta.actor.alternate_id"},"query":{"bool":{"should":[{"match_phrase":{"okta.actor.alternate_id":"system@okta.com"}}],"minimum_should_match":1}}}],"throttle":"1h","actions":[{"group":"default","id":"56fd1b40-5f85-11ec-9d1e-5b56ec0d9762","params":{"body":"{\n  \"short_description\": \"Okta - Admin App Access\",\n  \"assignment_group\": \"OPS-GCSO\",\n  \"category\": \"Unauthorized access\",\n  \"contact_type\": \"siem\",\n  \"description\": \"To identify access to the okta admin app, if any user is deemed to have a valid reason using this admin app, please notify twhipple1@godaddy.com to get this rule tuned \\n \\nSee following Info:\\n{{#context.alerts}}\\n@timestamp: {{signal.original_time}}\\nokta.actor.alternate_id: {{okta.actor.alternate_id}}\\nokta.profile.title: {{okta.profile.title}}\\nokta.profile.department: {{okta.profile.department}}\\n{{/context.alerts}}\\n \\n{{context.results_link}}\",\n  \"priority\": \"3\",\n  \"severity\": \"3\",\n  \"state\": \"10\"\n}"},"action_type_id":".webhook"}]}
{"id":"6e4c27b0-5c4b-11ec-9fcb-3bc48f034fff","updated_at":"2021-12-13T19:32:39.354Z","updated_by":"admin","created_at":"2021-12-13T19:32:39.354Z","created_by":"admin","name":"[GD] Customer API Key add Dashboard - IPs above limit","tags":["GD","SSO"],"interval":"24h","enabled":true,"description":"Generates events if count by IP is above 50 over the last 24 hours","risk_score":21,"severity":"low","building_block_type":"default","license":"","output_index":".siem-signals-default","meta":{"from":"24h","kibana_siem_app_url":"https://827ebd6fd06146bea2d2ad3a453d7e43.vpce.gdw55e.elastic-cloud.com:9243/app/security"},"author":[],"false_positives":[],"from":"now-172800s","rule_id":"e3840362-af02-41a1-b9db-be77d6c79ba3","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[],"to":"now","references":[],"version":1,"exceptions_list":[],"immutable":false,"type":"threshold","language":"kuery","index":["onprem-*"],"query":"aws.fluent_tags: \"SSO\" and event.action: \"add_apikey\"","filters":[],"threshold":{"field":["source.ip.keyword"],"value":50,"cardinality":[]},"throttle":"no_actions","actions":[]}
{"id":"d645a4a0-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T16:00:32.800Z","updated_by":"admin","created_at":"2021-09-22T15:57:50.915Z","created_by":"admin","name":"[GD] AWS EC2 Network Access Control List Deletion","tags":["AWS","Cloud","Continuous Monitoring","Elastic","Network Security","SecOps"],"interval":"10m","enabled":false,"description":"Identifies the deletion of an Amazon Elastic Compute Cloud (EC2) network access control list (ACL) or one of its ingress/egress entries.","risk_score":47,"severity":"medium","note":"The AWS Filebeat module must be enabled to use this rule.","license":"Elastic License v2","output_index":".siem-signals-default","meta":{"from":"50m"},"timestamp_override":"event.ingested","author":["Elastic"],"false_positives":["Network ACL's may be deleted by a network administrator. Verify whether the user identity, user agent, and/or hostname should be making changes in your environment. Network ACL deletions from unfamiliar users or hosts should be investigated. If known behavior is causing false positives, it can be exempted from the rule."],"from":"now-3600s","rule_id":"42569ffb-37de-4977-9512-a759f04d0caa","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","technique":[{"reference":"https://attack.mitre.org/techniques/T1562/","name":"Impair Defenses","subtechnique":[{"reference":"https://attack.mitre.org/techniques/T1562/001/","name":"Disable or Modify Tools","id":"T1562.001"}],"id":"T1562"}],"tactic":{"reference":"https://attack.mitre.org/tactics/TA0005/","name":"Defense Evasion","id":"TA0005"}}],"to":"now","references":["https://awscli.amazonaws.com/v2/documentation/api/latest/reference/ec2/delete-network-acl.html","https://docs.aws.amazon.com/AWSEC2/latest/APIReference/API_DeleteNetworkAcl.html","https://awscli.amazonaws.com/v2/documentation/api/latest/reference/ec2/delete-network-acl-entry.html","https://docs.aws.amazon.com/AWSEC2/latest/APIReference/API_DeleteNetworkAclEntry.html"],"version":6,"exceptions_list":[],"immutable":false,"type":"query","language":"kuery","index":["aws-cloudtrail-*","aws-config-*"],"query":"event.action:(DeleteNetworkAcl or DeleteNetworkAclEntry) and event.dataset:aws.cloudtrail and event.provider:ec2.amazonaws.com and event.outcome:success","filters":[],"throttle":"no_actions","actions":[]}
{"id":"d81ef880-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T16:01:20.531Z","updated_by":"admin","created_at":"2021-09-22T15:57:53.948Z","created_by":"admin","name":"[GD] AWS Configuration Recorder Stopped","tags":["AWS","Cloud","Continuous Monitoring","Elastic","Monitoring","SecOps"],"interval":"10m","enabled":false,"description":"Identifies an AWS configuration change to stop recording a designated set of resources.","risk_score":73,"severity":"high","note":"The AWS Filebeat module must be enabled to use this rule.","license":"Elastic License v2","output_index":".siem-signals-default","meta":{"from":"50m"},"timestamp_override":"event.ingested","author":["Elastic"],"false_positives":["Verify whether the user identity, user agent, and/or hostname should be making changes in your environment. Recording changes from unfamiliar users or hosts should be investigated. If known behavior is causing false positives, it can be exempted from the rule."],"from":"now-3600s","rule_id":"22e5ab17-51b6-4241-9876-cae7075b1e0b","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","technique":[{"reference":"https://attack.mitre.org/techniques/T1562/","name":"Impair Defenses","subtechnique":[{"reference":"https://attack.mitre.org/techniques/T1562/001/","name":"Disable or Modify Tools","id":"T1562.001"}],"id":"T1562"}],"tactic":{"reference":"https://attack.mitre.org/tactics/TA0005/","name":"Defense Evasion","id":"TA0005"}}],"to":"now","references":["https://awscli.amazonaws.com/v2/documentation/api/latest/reference/configservice/stop-configuration-recorder.html","https://docs.aws.amazon.com/config/latest/APIReference/API_StopConfigurationRecorder.html"],"version":6,"exceptions_list":[],"immutable":false,"type":"query","language":"kuery","index":["aws-cloudtrail-*","aws-config-*"],"query":"event.action:StopConfigurationRecorder and event.dataset:aws.cloudtrail and event.provider:config.amazonaws.com and event.outcome:success","filters":[],"throttle":"no_actions","actions":[]}
{"id":"d647a070-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T16:01:20.539Z","updated_by":"admin","created_at":"2021-09-22T15:57:50.931Z","created_by":"admin","name":"[GD] Suspicious Process Execution via Renamed PsExec Executable","tags":["Elastic","Execution","Host","Threat Detection","Windows"],"interval":"5m","enabled":false,"description":"Identifies suspicious psexec activity which is executing from the psexec service that has been renamed, possibly to evade detection.","risk_score":47,"severity":"medium","license":"Elastic License v2","output_index":".siem-signals-default","meta":{"from":"4m"},"timestamp_override":"event.ingested","author":["Elastic"],"false_positives":[],"from":"now-540s","rule_id":"22b1b22a-8ec6-4ac1-bd56-5d097018b943","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","technique":[{"reference":"https://attack.mitre.org/techniques/T1569/","name":"System Services","subtechnique":[{"reference":"https://attack.mitre.org/techniques/T1569/002/","name":"Service Execution","id":"T1569.002"}],"id":"T1569"}],"tactic":{"reference":"https://attack.mitre.org/tactics/TA0002/","name":"Execution","id":"TA0002"}}],"to":"now","references":[],"version":5,"exceptions_list":[],"immutable":false,"type":"eql","language":"eql","index":["windows-*"],"query":"process where event.type in (\"start\", \"process_started\", \"info\") and\n  process.pe.original_file_name : \"psexesvc.exe\" and not process.name : \"PSEXESVC.exe\"\n","filters":[],"throttle":"no_actions","actions":[]}
{"id":"cf8ce8d0-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T15:57:38.723Z","updated_by":"admin","created_at":"2021-09-22T15:57:38.723Z","created_by":"admin","name":"Network Sniffing via Tcpdump [Duplicate]","tags":["Credential Access","Elastic","Host","Linux","Threat Detection"],"interval":"5m","enabled":false,"description":"The Tcpdump program ran on a Linux host. Tcpdump is a network monitoring or packet sniffing tool that can be used to capture insecure credentials or data in motion. Sniffing can also be used to discover details of network services as a prelude to lateral movement or defense evasion.","risk_score":21,"severity":"low","license":"Elastic License v2","output_index":".siem-signals-default","timestamp_override":"event.ingested","author":["Elastic"],"false_positives":["Some normal use of this command may originate from server or network administrators engaged in network troubleshooting."],"from":"now-9m","rule_id":"48edae0f-8827-4b91-8970-cad424d6f5ce","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0006","name":"Credential Access","reference":"https://attack.mitre.org/tactics/TA0006/"},"technique":[{"id":"T1040","name":"Network Sniffing","reference":"https://attack.mitre.org/techniques/T1040/"}]},{"framework":"MITRE ATT&CK","tactic":{"id":"TA0007","name":"Discovery","reference":"https://attack.mitre.org/tactics/TA0007/"},"technique":[{"id":"T1040","name":"Network Sniffing","reference":"https://attack.mitre.org/techniques/T1040/"}]}],"to":"now","references":[],"version":7,"exceptions_list":[],"immutable":false,"type":"query","language":"kuery","index":["auditbeat-*","logs-endpoint.events.*"],"query":"event.category:process and event.type:(start or process_started) and process.name:tcpdump","throttle":"no_actions","actions":[]}
{"id":"cf90e070-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T15:57:38.726Z","updated_by":"admin","created_at":"2021-09-22T15:57:38.726Z","created_by":"admin","name":"File Permission Modification in Writable Directory [Duplicate]","tags":["Defense Evasion","Elastic","Host","Linux","Threat Detection"],"interval":"5m","enabled":false,"description":"Identifies file permission modifications in common writable directories by a non-root user. Adversaries often drop files or payloads into a writable directory and change permissions prior to execution.","risk_score":21,"severity":"low","license":"Elastic License v2","output_index":".siem-signals-default","timestamp_override":"event.ingested","author":["Elastic"],"false_positives":["Certain programs or applications may modify files or change ownership in writable directories. These can be exempted by username."],"from":"now-9m","rule_id":"b9cd9655-c452-40c1-839a-76ecd941acb3","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0005","name":"Defense Evasion","reference":"https://attack.mitre.org/tactics/TA0005/"},"technique":[{"id":"T1222","name":"File and Directory Permissions Modification","reference":"https://attack.mitre.org/techniques/T1222/"}]}],"to":"now","references":[],"version":6,"exceptions_list":[],"immutable":false,"type":"query","language":"kuery","index":["auditbeat-*","logs-endpoint.events.*"],"query":"event.category:process and event.type:(start or process_started) and process.name:(chmod or chown or chattr or chgrp) and process.working_directory:(/tmp or /var/tmp or /dev/shm) and not user.name:root","throttle":"no_actions","actions":[]}
{"id":"d3d91171-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T15:59:11.915Z","updated_by":"admin","created_at":"2021-09-22T15:57:46.909Z","created_by":"admin","name":"[GD] Potential Remote Desktop Tunneling Detected","tags":["Elastic","Host","Lateral Movement","Threat Detection","Windows"],"interval":"5m","enabled":false,"description":"Identifies potential use of an SSH utility to establish RDP over a reverse SSH Tunnel. This could be indicative of adversary lateral movement to interactively access restricted networks.","risk_score":73,"severity":"high","license":"Elastic License v2","output_index":".siem-signals-default","meta":{"from":"4m"},"timestamp_override":"event.ingested","author":["Elastic"],"false_positives":[],"from":"now-540s","rule_id":"7c4901b9-1ec8-49b6-9a78-7a9ac47ab4ab","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","technique":[{"reference":"https://attack.mitre.org/techniques/T1021/","name":"Remote Services","subtechnique":[],"id":"T1021"}],"tactic":{"reference":"https://attack.mitre.org/tactics/TA0008/","name":"Lateral Movement","id":"TA0008"}}],"to":"now","references":["https://blog.netspi.com/how-to-access-rdp-over-a-reverse-ssh-tunnel/"],"version":4,"exceptions_list":[],"immutable":false,"type":"eql","language":"eql","index":["windows-*"],"query":"process where event.type in (\"start\", \"process_started\") and\n  /* RDP port and usual SSH tunneling related switches in command line */\n  process.args : \"*:3389\" and\n  process.args : (\"-L\", \"-P\", \"-R\", \"-pw\", \"-ssh\")\n","filters":[],"throttle":"no_actions","actions":[]}
{"id":"cf8b8940-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T15:57:38.699Z","updated_by":"admin","created_at":"2021-09-22T15:57:38.699Z","created_by":"admin","name":"Setuid / Setgid Bit Set via chmod [Duplicate]","tags":["Elastic","Host","Linux","macOS","Privilege Escalation","Threat Detection"],"interval":"5m","enabled":false,"description":"An adversary may add the setuid or setgid bit to a file or directory in order to run a file with the privileges of the owning user or group. An adversary can take advantage of this to either do a shell escape or exploit a vulnerability in an application with the setuid or setgid bit to get code running in a different users context. Additionally, adversaries can use this mechanism on their own malware to make sure they're able to execute in elevated contexts in the future.","risk_score":21,"severity":"low","license":"Elastic License v2","output_index":".siem-signals-default","timestamp_override":"event.ingested","author":["Elastic"],"false_positives":[],"from":"now-9m","rule_id":"ae9633a8-0ff8-433e-ab90-1677c0bb024c","max_signals":33,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0004","name":"Privilege Escalation","reference":"https://attack.mitre.org/tactics/TA0004/"},"technique":[{"id":"T1548","name":"Abuse Elevation Control Mechanism","reference":"https://attack.mitre.org/techniques/T1548/","subtechnique":[{"id":"T1548.001","name":"Setuid and Setgid","reference":"https://attack.mitre.org/techniques/T1548/001/"}]}]},{"framework":"MITRE ATT&CK","tactic":{"id":"TA0003","name":"Persistence","reference":"https://attack.mitre.org/tactics/TA0003/"},"technique":[]}],"to":"now","references":[],"version":7,"exceptions_list":[],"immutable":false,"type":"query","language":"lucene","index":["auditbeat-*","logs-endpoint.events.*"],"query":"event.category:process AND event.type:(start OR process_started) AND process.name:chmod AND process.args:(\"+s\" OR \"u+s\" OR /4[0-9]{3}/ OR g+s OR /2[0-9]{3}/)","throttle":"no_actions","actions":[]}
{"id":"cf8bfe70-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T15:57:38.702Z","updated_by":"admin","created_at":"2021-09-22T15:57:38.702Z","created_by":"admin","name":"Unusual Windows Username [Duplicate]","tags":["Elastic","Host","ML","Threat Detection","Windows"],"interval":"15m","enabled":false,"description":"A machine learning job detected activity for a username that is not normally active, which can indicate unauthorized changes, activity by unauthorized users, lateral movement, or compromised credentials. In many organizations, new usernames are not often created apart from specific types of system activities, such as creating new accounts for new employees. These user accounts quickly become active and routine. Events from rarely used usernames can point to suspicious activity. Additionally, automated Linux fleets tend to see activity from rarely used usernames only when personnel log in to make authorized or unauthorized changes, or threat actors have acquired credentials and log in for malicious purposes. Unusual usernames can also indicate pivoting, where compromised credentials are used to try and move laterally from one host to another.","risk_score":21,"severity":"low","note":"### Investigating an Unusual Windows User ###\nDetection alerts from this rule indicate activity for a Windows user name that is rare and unusual. Here are some possible avenues of investigation:\n- Consider the user as identified by the username field. Is this program part of an expected workflow for the user who ran this program on this host? Could this be related to occasional troubleshooting or support activity?\n- Examine the history of user activity. If this user manifested only very recently, it might be a service account for a new software package. If it has a consistent cadence - for example if it runs monthly or quarterly - it might be part of a monthly or quarterly business process.\n- Examine the process arguments, title and working directory. These may provide indications as to the source of the program or the nature of the tasks that the user is performing.\n- Consider the same for the parent process. If the parent process is a legitimate system utility or service, this could be related to software updates or system management. If the parent process is something user-facing like an Office application, this process could be more suspicious.","license":"Elastic License v2","output_index":".siem-signals-default","author":["Elastic"],"false_positives":["Uncommon user activity can be due to an administrator or help desk technician logging onto a workstation or server in order to perform manual troubleshooting or reconfiguration."],"from":"now-45m","rule_id":"9fd2393a-3330-46bd-b227-f323854acc8b","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[],"to":"now","references":["https://www.elastic.co/guide/en/security/current/prebuilt-ml-jobs.html"],"version":4,"exceptions_list":[],"immutable":false,"type":"machine_learning","anomaly_threshold":50,"machine_learning_job_id":["windows_anomalous_user_name_ecs"],"throttle":"no_actions","actions":[]}
{"id":"d3d986a1-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T15:59:11.926Z","updated_by":"admin","created_at":"2021-09-22T15:57:46.905Z","created_by":"admin","name":"[GD] Potential Cookies Theft via Browser Debugging","tags":["Credential Access","Elastic","Host","Linux","macOS","Threat Detection","Windows"],"interval":"5m","enabled":false,"description":"Identifies the execution of a Chromium based browser with the debugging process argument, which may indicate an attempt to steal authentication cookies. An adversary may steal web application or service session cookies and use them to gain access web applications or Internet services as an authenticated user without needing credentials.","risk_score":47,"severity":"medium","license":"Elastic License v2","output_index":".siem-signals-default","meta":{"from":"4m"},"timestamp_override":"event.ingested","author":["Elastic"],"false_positives":["Developers performing browsers plugin or extension debugging."],"from":"now-540s","rule_id":"ee744651-4cf7-42a5-9130-85cb0221429e","max_signals":33,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","technique":[{"reference":"https://attack.mitre.org/techniques/T1539/","name":"Steal Web Session Cookie","subtechnique":[],"id":"T1539"}],"tactic":{"reference":"https://attack.mitre.org/tactics/TA0006/","name":"Credential Access","id":"TA0006"}}],"to":"now","references":["https://github.com/defaultnamehere/cookie_crimes","https://embracethered.com/blog/posts/2020/cookie-crimes-on-mirosoft-edge/","https://github.com/rapid7/metasploit-framework/blob/master/documentation/modules/post/multi/gather/chrome_cookies.md","https://posts.specterops.io/hands-in-the-cookie-jar-dumping-cookies-with-chromiums-remote-debugger-port-34c4f468844e"],"version":2,"exceptions_list":[],"immutable":false,"type":"eql","language":"eql","index":["windows-*"],"query":"process where event.type in (\"start\", \"process_started\", \"info\") and\n  process.name in (\n             \"Microsoft Edge\",\n             \"chrome.exe\",\n             \"Google Chrome\",\n             \"google-chrome-stable\",\n             \"google-chrome-beta\",\n             \"google-chrome\",\n             \"msedge.exe\") and\n   process.args : (\"--remote-debugging-port=*\", \n                   \"--remote-debugging-targets=*\",  \n                   \"--remote-debugging-pipe=*\") and\n   process.args : \"--user-data-dir=*\" and not process.args:\"--remote-debugging-port=0\"\n","filters":[],"throttle":"no_actions","actions":[]}
{"id":"cf8bd761-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T15:57:38.705Z","updated_by":"admin","created_at":"2021-09-22T15:57:38.705Z","created_by":"admin","name":"Anomalous Process For a Windows Population [Duplicate]","tags":["Elastic","Host","ML","Threat Detection","Windows"],"interval":"15m","enabled":false,"description":"Searches for rare processes running on multiple hosts in an entire fleet or network. This reduces the detection of false positives since automated maintenance processes usually only run occasionally on a single machine but are common to all or many hosts in a fleet.","risk_score":21,"severity":"low","note":"### Investigating an Unusual Windows Process ###\nDetection alerts from this rule indicate the presence of a Windows process that is rare and unusual for all of the Windows hosts for which Winlogbeat data is available. Here are some possible avenues of investigation:\n- Consider the user as identified by the username field. Is this program part of an expected workflow for the user who ran this program on this host?\n- Examine the history of execution. If this process manifested only very recently, it might be part of a new software package. If it has a consistent cadence - for example if it runs monthly or quarterly - it might be part of a monthly or quarterly business process.\n- Examine the process metadata like the values of the Company, Description and Product fields which may indicate whether the program is associated with an expected software vendor or package.\n- Examine arguments and working directory. These may provide indications as to the source of the program or the nature of the tasks it is performing.\n- Consider the same for the parent process. If the parent process is a legitimate system utility or service, this could be related to software updates or system management. If the parent process is something user-facing like an Office application, this process could be more suspicious.\n- If you have file hash values in the event data, and you suspect malware, you can optionally run a search for the file hash to see if the file is identified as malware by anti-malware tools. ","license":"Elastic License v2","output_index":".siem-signals-default","author":["Elastic"],"false_positives":["A newly installed program or one that runs rarely as part of a monthly or quarterly workflow could trigger this alert."],"from":"now-45m","rule_id":"5cd714fb-defe-4d23-80cf-021f23388986","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[],"to":"now","references":["https://www.elastic.co/guide/en/security/current/prebuilt-ml-jobs.html"],"version":4,"exceptions_list":[],"immutable":false,"type":"machine_learning","anomaly_threshold":50,"machine_learning_job_id":["windows_anomalous_process_all_hosts_ecs"],"throttle":"no_actions","actions":[]}
{"id":"cf8c4c91-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T15:57:38.707Z","updated_by":"admin","created_at":"2021-09-22T15:57:38.707Z","created_by":"admin","name":"Modification of Standard Authentication Module or Configuration [Duplicate]","tags":["Credential Access","Elastic","Host","Linux","macOS","Persistence","Threat Detection"],"interval":"5m","enabled":false,"description":"Adversaries may modify the standard authentication module for persistence via patching the normal authorization process or modifying the login configuration to allow unauthorized access or elevate privileges.","risk_score":47,"severity":"medium","license":"Elastic License v2","output_index":".siem-signals-default","timestamp_override":"event.ingested","author":["Elastic"],"false_positives":["Trusted system module updates or allowed Pluggable Authentication Module (PAM) daemon configuration changes."],"from":"now-9m","rule_id":"a3de9482-67a8-4b60-b0e6-312d092f33bd","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0003","name":"Persistence","reference":"https://attack.mitre.org/tactics/TA0003/"},"technique":[{"id":"T1543","name":"Create or Modify System Process","reference":"https://attack.mitre.org/techniques/T1543/"}]},{"framework":"MITRE ATT&CK","tactic":{"id":"TA0006","name":"Credential Access","reference":"https://attack.mitre.org/tactics/TA0006/"},"technique":[{"id":"T1556","name":"Modify Authentication Process","reference":"https://attack.mitre.org/techniques/T1556/"}]}],"to":"now","references":["https://github.com/zephrax/linux-pam-backdoor","https://github.com/eurialo/pambd","http://0x90909090.blogspot.com/2016/06/creating-backdoor-in-pam-in-5-line-of.html","https://www.trendmicro.com/en_us/research/19/i/skidmap-linux-malware-uses-rootkit-capabilities-to-hide-cryptocurrency-mining-payload.html"],"version":1,"exceptions_list":[],"immutable":false,"type":"query","language":"kuery","index":["auditbeat-*","logs-endpoint.events.*"],"query":"event.category:file and event.type:change and (file.name:pam_*.so or file.path:(/etc/pam.d/* or /private/etc/pam.d/*)) and process.executable: (* and not ( /bin/yum or \"/usr/sbin/pam-auth-update\" or /usr/libexec/packagekitd or /usr/bin/dpkg or /usr/bin/vim or /usr/libexec/xpcproxy or /usr/bin/bsdtar or /usr/local/bin/brew ) )","throttle":"no_actions","actions":[]}
{"id":"d1b52001-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T15:59:30.164Z","updated_by":"admin","created_at":"2021-09-22T15:57:42.886Z","created_by":"admin","name":"[GD] Remote File Download via MpCmdRun","tags":["Command and Control","Elastic","Host","Threat Detection","Windows"],"interval":"5m","enabled":false,"description":"Identifies the Windows Defender configuration utility (MpCmdRun.exe) being used to download a remote file.","risk_score":47,"severity":"medium","note":"### Investigating Remote File Download via MpCmdRun\nVerify details such as the parent process, URL reputation, and downloaded file details. Additionally, `MpCmdRun` logs this information in the Appdata Temp folder in `MpCmdRun.log`.","license":"Elastic License v2","output_index":".siem-signals-default","meta":{"from":"4m"},"timestamp_override":"event.ingested","author":["Elastic"],"false_positives":[],"from":"now-540s","rule_id":"5ae35dbb-bf8e-47cc-a6f0-a10931866c8c","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","technique":[{"reference":"https://attack.mitre.org/techniques/T1105/","name":"Ingress Tool Transfer","subtechnique":[],"id":"T1105"}],"tactic":{"reference":"https://attack.mitre.org/tactics/TA0011/","name":"Command and Control","id":"TA0011"}}],"to":"now","references":["https://twitter.com/mohammadaskar2/status/1301263551638761477","https://www.bleepingcomputer.com/news/microsoft/microsoft-defender-can-ironically-be-used-to-download-malware/"],"version":5,"exceptions_list":[],"immutable":false,"type":"query","language":"kuery","index":["windows-*"],"query":"event.category:process and event.type:(start or process_started) and (process.name:MpCmdRun.exe or process.pe.original_file_name:MpCmdRun.exe) and process.args:((\"-DownloadFile\" or \"-downloadfile\") and \"-url\" and \"-path\")","filters":[],"throttle":"no_actions","actions":[]}
{"id":"d1b17680-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T15:59:30.306Z","updated_by":"admin","created_at":"2021-09-22T15:57:42.877Z","created_by":"admin","name":"[GD] Microsoft Exchange Worker Spawning Suspicious Processes","tags":["Elastic","Host","Initial Access","Threat Detection","Windows"],"interval":"5m","enabled":false,"description":"Identifies suspicious processes being spawned by the Microsoft Exchange Server worker process (w3wp). This activity may indicate exploitation activity or access to an existing web shell backdoor.","risk_score":73,"severity":"high","license":"Elastic License v2","output_index":".siem-signals-default","meta":{"from":"4m"},"timestamp_override":"event.ingested","author":["Elastic"],"false_positives":[],"from":"now-540s","rule_id":"8a072528-51bd-4934-b32e-f8bdaf5edce6","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","technique":[{"reference":"https://attack.mitre.org/techniques/T1190/","name":"Exploit Public-Facing Application","subtechnique":[],"id":"T1190"}],"tactic":{"reference":"https://attack.mitre.org/tactics/TA0001/","name":"Initial Access","id":"TA0001"}}],"to":"now","references":["https://www.microsoft.com/security/blog/2021/03/02/hafnium-targeting-exchange-servers","https://www.volexity.com/blog/2021/03/02/active-exploitation-of-microsoft-exchange-zero-day-vulnerabilities","https://discuss.elastic.co/t/detection-and-response-for-hafnium-activity/266289"],"version":2,"exceptions_list":[],"immutable":false,"type":"eql","language":"eql","index":["windows-*"],"query":"process where event.type == \"start\" and\n  process.parent.name : \"w3wp.exe\" and process.parent.args : \"MSExchange*AppPool\" and\n  (process.name : (\"cmd.exe\", \"powershell.exe\", \"pwsh.exe\") or\n  process.pe.original_file_name : (\"cmd.exe\", \"powershell.exe\", \"pwsh.exe\"))\n","filters":[],"throttle":"no_actions","actions":[]}
{"id":"d1b5bc40-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T15:59:30.309Z","updated_by":"admin","created_at":"2021-09-22T15:57:42.877Z","created_by":"admin","name":"[GD] Mounting Hidden or WebDav Remote Shares","tags":["Elastic","Host","Lateral Movement","Threat Detection","Windows"],"interval":"5m","enabled":false,"description":"Identifies the use of net.exe to mount a WebDav or hidden remote share. This may indicate lateral movement or preparation for data exfiltration.","risk_score":21,"severity":"medium","license":"Elastic License v2","output_index":".siem-signals-default","meta":{"from":"4m"},"timestamp_override":"event.ingested","author":["Elastic"],"false_positives":[],"from":"now-540s","rule_id":"e5498ebd-ce45-4cfb-9c95-972641ef7a6f","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","technique":[{"reference":"https://attack.mitre.org/techniques/T1021/","name":"Remote Services","subtechnique":[{"reference":"https://attack.mitre.org/techniques/T1021/002/","name":"SMB/Windows Admin Shares","id":"T1021.002"}],"id":"T1021"}],"tactic":{"reference":"https://attack.mitre.org/tactics/TA0008/","name":"Lateral Movement","id":"TA0008"}}],"to":"now","references":[],"version":4,"exceptions_list":[],"immutable":false,"type":"eql","language":"eql","index":["windows-*"],"query":"process where event.type in (\"start\", \"process_started\") and\n ((process.name : \"net.exe\" or process.pe.original_file_name == \"net.exe\") or ((process.name : \"net1.exe\" or process.pe.original_file_name == \"net1.exe\") and\n not process.parent.name : \"net.exe\")) and\n process.args : \"use\" and\n /* including hidden and webdav based online shares such as onedrive  */\n process.args : (\"\\\\\\\\*\\\\*$*\", \"\\\\\\\\*@SSL\\\\*\", \"http*\") and\n /* excluding shares deletion operation */\n not process.args : \"/d*\"\n","filters":[],"throttle":"no_actions","actions":[]}
{"id":"d3da7101-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T15:59:47.218Z","updated_by":"admin","created_at":"2021-09-22T15:57:46.906Z","created_by":"admin","name":"[GD] UAC Bypass via ICMLuaUtil Elevated COM Interface","tags":["Elastic","Host","Privilege Escalation","Threat Detection","Windows"],"interval":"5m","enabled":false,"description":"Identifies User Account Control (UAC) bypass attempts via the ICMLuaUtil Elevated COM interface. Attackers may attempt to bypass UAC to stealthily execute code with elevated permissions.","risk_score":73,"severity":"high","license":"Elastic License v2","output_index":".siem-signals-default","meta":{"from":"4m"},"timestamp_override":"event.ingested","author":["Elastic"],"false_positives":[],"from":"now-540s","rule_id":"5212a650-773d-494b-ad71-23041b550b7c","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","technique":[{"reference":"https://attack.mitre.org/techniques/T1548/","name":"Abuse Elevation Control Mechanism","subtechnique":[{"reference":"https://attack.mitre.org/techniques/T1548/002/","name":"Bypass User Access Control","id":"T1548.002"}],"id":"T1548"}],"tactic":{"reference":"https://attack.mitre.org/tactics/TA0004/","name":"Privilege Escalation","id":"TA0004"}}],"to":"now","references":[],"version":4,"exceptions_list":[],"immutable":false,"type":"eql","language":"eql","index":["windows-*"],"query":"process where event.type in (\"start\", \"process_started\") and\n process.parent.name == \"dllhost.exe\" and\n process.parent.args in (\"/Processid:{3E5FC7F9-9A51-4367-9063-A120244FBEC7}\", \"/Processid:{D2E7041B-2927-42FB-8E9F-7CE93B6DC937}\") and\n process.pe.original_file_name != \"WerFault.exe\"\n","filters":[],"throttle":"no_actions","actions":[]}
{"id":"d3d95f90-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T15:59:47.216Z","updated_by":"admin","created_at":"2021-09-22T15:57:46.915Z","created_by":"admin","name":"[GD] Execution via MSSQL xp_cmdshell Stored Procedure","tags":["Elastic","Execution","Host","Threat Detection","Windows"],"interval":"5m","enabled":false,"description":"Identifies execution via MSSQL xp_cmdshell stored procedure. Malicious users may attempt to elevate their privileges by using xp_cmdshell, which is disabled by default, thus, it's important to review the context of it's use.","risk_score":73,"severity":"high","license":"Elastic License v2","output_index":".siem-signals-default","meta":{"from":"4m"},"timestamp_override":"event.ingested","author":["Elastic"],"false_positives":[],"from":"now-540s","rule_id":"92825812-c7a5-457e-b810-e0108484428b","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","technique":[{"reference":"https://attack.mitre.org/techniques/T1059/","name":"Command and Scripting Interpreter","subtechnique":[],"id":"T1059"}],"tactic":{"reference":"https://attack.mitre.org/tactics/TA0002/","name":"Execution","id":"TA0002"}}],"to":"now","references":[],"version":4,"exceptions_list":[],"immutable":false,"type":"query","language":"kuery","index":["windows-*"],"query":"event.category:process and event.type:(start or process_started) and process.name:cmd.exe and process.parent.name:sqlservr.exe","filters":[],"throttle":"no_actions","actions":[]}
{"id":"d3d281c0-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T15:59:47.219Z","updated_by":"admin","created_at":"2021-09-22T15:57:46.901Z","created_by":"admin","name":"[GD] High Number of Process and/or Service Terminations","tags":["Defense Evasion","Elastic","Host","Threat Detection","Windows"],"interval":"5m","enabled":false,"description":"This rule identifies a high number (10) of process terminations (stop, delete, or suspend) from the same host within a short time period. This may indicate a defense evasion attempt.","risk_score":47,"severity":"medium","license":"Elastic License v2","output_index":".siem-signals-default","meta":{"from":"4m"},"author":["Elastic"],"false_positives":[],"from":"now-540s","rule_id":"5b4c1757-7ef4-4c04-a8f4-672aa7d932d8","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","technique":[{"reference":"https://attack.mitre.org/techniques/T1562/","name":"Impair Defenses","subtechnique":[{"reference":"https://attack.mitre.org/techniques/T1562/001/","name":"Disable or Modify Tools","id":"T1562.001"}],"id":"T1562"}],"tactic":{"reference":"https://attack.mitre.org/tactics/TA0005/","name":"Defense Evasion","id":"TA0005"}}],"to":"now","references":[],"version":3,"exceptions_list":[],"immutable":false,"type":"threshold","language":"kuery","index":["windows-*"],"query":"event.category:process and event.type:start and process.name:(net.exe or sc.exe or taskkill.exe) and process.args:(stop or pause or delete or \"/PID\" or \"/IM\" or \"/T\" or \"/F\" or \"/t\" or \"/f\" or \"/im\" or \"/pid\")","filters":[],"threshold":{"field":["host.name"],"value":10,"cardinality":[]},"throttle":"no_actions","actions":[]}
{"id":"d3da22e0-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T15:59:47.281Z","updated_by":"admin","created_at":"2021-09-22T15:57:46.916Z","created_by":"admin","name":"[GD] Disable Windows Firewall Rules via Netsh","tags":["Defense Evasion","Elastic","Host","Threat Detection","Windows"],"interval":"5m","enabled":false,"description":"Identifies use of the netsh.exe to disable or weaken the local firewall. Attackers will use this command line tool to disable the firewall during troubleshooting or to enable network mobility.","risk_score":47,"severity":"medium","license":"Elastic License v2","output_index":".siem-signals-default","meta":{"from":"4m"},"timestamp_override":"event.ingested","author":["Elastic"],"false_positives":[],"from":"now-540s","rule_id":"8ae856ef-f6fc-4fb8-80c7-9255826f1e38","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","technique":[{"reference":"https://attack.mitre.org/techniques/T1562/","name":"Impair Defenses","subtechnique":[{"reference":"https://attack.mitre.org/techniques/T1562/001/","name":"Disable or Modify Tools","id":"T1562.001"}],"id":"T1562"}],"tactic":{"reference":"https://attack.mitre.org/tactics/TA0005/","name":"Defense Evasion","id":"TA0005"}}],"to":"now","references":[],"version":9,"exceptions_list":[],"immutable":false,"type":"query","language":"kuery","index":["windows-*"],"query":"event.category:process and event.type:(start or process_started) and process.name:netsh.exe and process.args:(disable and firewall and set) or process.args:(advfirewall and off and state)","filters":[],"throttle":"no_actions","actions":[]}
{"id":"d3d986a0-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T15:59:47.284Z","updated_by":"admin","created_at":"2021-09-22T15:57:46.902Z","created_by":"admin","name":"[GD] Unusual Parent-Child Relationship","tags":["Elastic","Host","Privilege Escalation","Threat Detection","Windows"],"interval":"5m","enabled":false,"description":"Identifies Windows programs run from unexpected parent processes. This could indicate masquerading or other strange activity on a system.","risk_score":47,"severity":"medium","license":"Elastic License v2","output_index":".siem-signals-default","meta":{"from":"4m"},"timestamp_override":"event.ingested","author":["Elastic"],"false_positives":[],"from":"now-540s","rule_id":"87a37439-a960-46d3-8686-0885e253837e","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","technique":[{"reference":"https://attack.mitre.org/techniques/T1055/","name":"Process Injection","subtechnique":[{"reference":"https://attack.mitre.org/techniques/T1055/012/","name":"Process Hollowing","id":"T1055.012"}],"id":"T1055"}],"tactic":{"reference":"https://attack.mitre.org/tactics/TA0004/","name":"Privilege Escalation","id":"TA0004"}}],"to":"now","references":["https://github.com/sbousseaden/Slides/blob/master/Hunting MindMaps/PNG/Windows Processes TH.map.png","https://www.andreafortuna.org/2017/06/15/standard-windows-processes-a-brief-reference/"],"version":9,"exceptions_list":[],"immutable":false,"type":"eql","language":"eql","index":["windows-*"],"query":"process where event.type in (\"start\", \"process_started\") and\nprocess.parent.name != null and\n (\n   /* suspicious parent processes */\n   (process.name:\"autochk.exe\" and not process.parent.name:\"smss.exe\") or\n   (process.name:(\"fontdrvhost.exe\", \"dwm.exe\") and not process.parent.name:(\"wininit.exe\", \"winlogon.exe\")) or\n   (process.name:(\"consent.exe\", \"RuntimeBroker.exe\", \"TiWorker.exe\") and not process.parent.name:\"svchost.exe\") or\n   (process.name:\"SearchIndexer.exe\" and not process.parent.name:\"services.exe\") or\n   (process.name:\"SearchProtocolHost.exe\" and not process.parent.name:(\"SearchIndexer.exe\", \"dllhost.exe\")) or\n   (process.name:\"dllhost.exe\" and not process.parent.name:(\"services.exe\", \"svchost.exe\")) or\n   (process.name:\"smss.exe\" and not process.parent.name:(\"System\", \"smss.exe\")) or\n   (process.name:\"csrss.exe\" and not process.parent.name:(\"smss.exe\", \"svchost.exe\")) or\n   (process.name:\"wininit.exe\" and not process.parent.name:\"smss.exe\") or\n   (process.name:\"winlogon.exe\" and not process.parent.name:\"smss.exe\") or\n   (process.name:(\"lsass.exe\", \"LsaIso.exe\") and not process.parent.name:\"wininit.exe\") or\n   (process.name:\"LogonUI.exe\" and not process.parent.name:(\"wininit.exe\", \"winlogon.exe\")) or\n   (process.name:\"services.exe\" and not process.parent.name:\"wininit.exe\") or\n   (process.name:\"svchost.exe\" and not process.parent.name:(\"MsMpEng.exe\", \"services.exe\")) or\n   (process.name:\"spoolsv.exe\" and not process.parent.name:\"services.exe\") or\n   (process.name:\"taskhost.exe\" and not process.parent.name:(\"services.exe\", \"svchost.exe\")) or\n   (process.name:\"taskhostw.exe\" and not process.parent.name:(\"services.exe\", \"svchost.exe\")) or\n   (process.name:\"userinit.exe\" and not process.parent.name:(\"dwm.exe\", \"winlogon.exe\")) or\n   (process.name:(\"wmiprvse.exe\", \"wsmprovhost.exe\", \"winrshost.exe\") and not process.parent.name:\"svchost.exe\") or\n   /* suspicious child processes */\n   (process.parent.name:(\"SearchProtocolHost.exe\", \"taskhost.exe\", \"csrss.exe\") and not process.name:(\"werfault.exe\", \"wermgr.exe\", \"WerFaultSecure.exe\")) or\n   (process.parent.name:\"autochk.exe\" and not process.name:(\"chkdsk.exe\", \"doskey.exe\", \"WerFault.exe\")) or\n   (process.parent.name:\"smss.exe\" and not process.name:(\"autochk.exe\", \"smss.exe\", \"csrss.exe\", \"wininit.exe\", \"winlogon.exe\", \"setupcl.exe\", \"WerFault.exe\")) or\n   (process.parent.name:\"wermgr.exe\" and not process.name:(\"WerFaultSecure.exe\", \"wermgr.exe\", \"WerFault.exe\")) or\n   (process.parent.name:\"conhost.exe\" and not process.name:(\"mscorsvw.exe\", \"wermgr.exe\", \"WerFault.exe\", \"WerFaultSecure.exe\"))\n  )\n","filters":[],"throttle":"no_actions","actions":[]}
{"id":"d3db0d42-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T15:59:47.285Z","updated_by":"admin","created_at":"2021-09-22T15:57:46.914Z","created_by":"admin","name":"[GD] Local Service Commands","tags":["Elastic","Host","Lateral Movement","Threat Detection","Windows"],"interval":"5m","enabled":false,"description":"Identifies use of sc.exe to create, modify, or start services on remote hosts. This could be indicative of adversary lateral movement but will be noisy if commonly done by admins.","risk_score":21,"severity":"low","license":"Elastic License v2","output_index":".siem-signals-default","meta":{"from":"4m"},"timestamp_override":"event.ingested","author":["Elastic"],"false_positives":[],"from":"now-540s","rule_id":"8012ad91-e81b-4eb3-89da-e99ff03caeb4","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","technique":[{"reference":"https://attack.mitre.org/techniques/T1021/","name":"Remote Services","subtechnique":[],"id":"T1021"}],"tactic":{"reference":"https://attack.mitre.org/tactics/TA0008/","name":"Lateral Movement","id":"TA0008"}}],"to":"now","references":[],"version":9,"exceptions_list":[],"immutable":false,"type":"query","language":"kuery","index":["windows-*"],"query":"event.category:process and event.type:(start or process_started) and process.name:sc.exe and process.args:(config or create or failure or start)","filters":[],"throttle":"no_actions","actions":[]}
{"id":"d3db5b60-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T15:59:47.287Z","updated_by":"admin","created_at":"2021-09-22T15:57:46.924Z","created_by":"admin","name":"[GD] Deleting Backup Catalogs with Wbadmin","tags":["Defense Evasion","Elastic","Host","Threat Detection","Windows"],"interval":"5m","enabled":false,"description":"Identifies use of the wbadmin.exe to delete the backup catalog. Ransomware and other malware may do this to prevent system recovery.","risk_score":21,"severity":"low","license":"Elastic License v2","output_index":".siem-signals-default","meta":{"from":"4m"},"timestamp_override":"event.ingested","author":["Elastic"],"false_positives":[],"from":"now-540s","rule_id":"07f32dbe-86c8-44a0-ae51-8f744cc97bcb","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","technique":[{"reference":"https://attack.mitre.org/techniques/T1070/","name":"Indicator Removal on Host","subtechnique":[{"reference":"https://attack.mitre.org/techniques/T1070/004/","name":"File Deletion","id":"T1070.004"}],"id":"T1070"}],"tactic":{"reference":"https://attack.mitre.org/tactics/TA0005/","name":"Defense Evasion","id":"TA0005"}}],"to":"now","references":[],"version":9,"exceptions_list":[],"immutable":false,"type":"query","language":"kuery","index":["windows-*"],"query":"event.category:process and event.type:(start or process_started) and process.name:wbadmin.exe and process.args:(catalog and delete)","filters":[],"throttle":"no_actions","actions":[]}
{"id":"d3db0d40-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T15:59:47.292Z","updated_by":"admin","created_at":"2021-09-22T15:57:46.910Z","created_by":"admin","name":"[GD] Suspicious MS Outlook Child Process","tags":["Elastic","Host","Initial Access","Threat Detection","Windows"],"interval":"5m","enabled":false,"description":"Identifies suspicious child processes of Microsoft Outlook. These child processes are often associated with spear phishing activity.","risk_score":21,"severity":"low","license":"Elastic License v2","output_index":".siem-signals-default","meta":{"from":"4m"},"timestamp_override":"event.ingested","author":["Elastic"],"false_positives":[],"from":"now-540s","rule_id":"68c37e66-fd7f-44fc-bd6e-1be73a62aae8","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","technique":[{"reference":"https://attack.mitre.org/techniques/T1566/","name":"Phishing","subtechnique":[{"reference":"https://attack.mitre.org/techniques/T1566/001/","name":"Spearphishing Attachment","id":"T1566.001"}],"id":"T1566"}],"tactic":{"reference":"https://attack.mitre.org/tactics/TA0001/","name":"Initial Access","id":"TA0001"}}],"to":"now","references":[],"version":9,"exceptions_list":[],"immutable":false,"type":"query","language":"kuery","index":["windows-*"],"query":"event.category:process and event.type:(start or process_started) and process.parent.name:outlook.exe and process.name:(Microsoft.Workflow.Compiler.exe or arp.exe or atbroker.exe or  bginfo.exe or bitsadmin.exe or cdb.exe or certutil.exe or cmd.exe or cmstp.exe or cscript.exe or csi.exe or dnx.exe or dsget.exe or dsquery.exe or forfiles.exe or fsi.exe or ftp.exe or gpresult.exe or hostname.exe or ieexec.exe or iexpress.exe or installutil.exe or ipconfig.exe or mshta.exe or msxsl.exe or nbtstat.exe or net.exe or net1.exe or netsh.exe or netstat.exe or nltest.exe or odbcconf.exe or ping.exe or powershell.exe or pwsh.exe or qprocess.exe or quser.exe or qwinsta.exe or rcsi.exe or reg.exe or regasm.exe or regsvcs.exe or regsvr32.exe or sc.exe or schtasks.exe or systeminfo.exe or tasklist.exe or tracert.exe or whoami.exe or wmic.exe or wscript.exe or xwizard.exe)","filters":[],"throttle":"no_actions","actions":[]}
{"id":"d3dfc830-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T16:00:33.896Z","updated_by":"admin","created_at":"2021-09-22T15:57:46.916Z","created_by":"admin","name":"[GD] Volume Shadow Copy Deletion via WMIC","tags":["Defense Evasion","Elastic","Host","Threat Detection","Windows"],"interval":"5m","enabled":false,"description":"Identifies use of wmic.exe for shadow copy deletion on endpoints. This commonly occurs in tandem with ransomware or other destructive attacks.","risk_score":73,"severity":"high","license":"Elastic License v2","output_index":".siem-signals-default","meta":{"from":"4m"},"timestamp_override":"event.ingested","author":["Elastic"],"false_positives":[],"from":"now-540s","rule_id":"65ab9bc1-5268-4713-a6fa-fecfa9af273b","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","technique":[{"reference":"https://attack.mitre.org/techniques/T1070/","name":"Indicator Removal on Host","subtechnique":[{"reference":"https://attack.mitre.org/techniques/T1070/004/","name":"File Deletion","id":"T1070.004"}],"id":"T1070"}],"tactic":{"reference":"https://attack.mitre.org/tactics/TA0005/","name":"Defense Evasion","id":"TA0005"}}],"to":"now","references":[],"version":9,"exceptions_list":[],"immutable":false,"type":"query","language":"kuery","index":["windows-*"],"query":"event.category:process and event.type:(start or process_started) and process.name:WMIC.exe and process.args:(delete and shadowcopy)","filters":[],"throttle":"no_actions","actions":[]}
{"id":"cd4590e0-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T15:57:34.836Z","updated_by":"admin","created_at":"2021-09-22T15:57:34.836Z","created_by":"admin","name":"[GD] Detect Linux Discovery Commands Running within 24hr","tags":["Linux","Process","POC"],"interval":"5m","enabled":false,"description":"Group command line (e.g. netcat + whoami + uname) and alert on combination within 24 hours.","risk_score":65,"severity":"medium","license":"","output_index":".siem-signals-default","meta":{"from":"1m","kibana_siem_app_url":"https://cbbf317cf62e4dd9b9913c1cc96ca394.vpce.gdw55e.elastic-cloud.com:9243/app/security"},"author":[],"false_positives":[],"from":"now-360s","rule_id":"98621788-13af-4c57-8c6d-75074801b311","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[],"to":"now","references":[],"version":1,"exceptions_list":[],"immutable":false,"type":"eql","language":"eql","index":["linux-secure-*"],"query":"sequence with maxspan=24h\n  [process where event.type in (\"start\", \"process_started\") and process.name:(\"*netcat\", \"*whoami\", \"*uname\")]\n  [process where event.type in (\"start\", \"process_started\") and process.name:(\"*netcat\", \"*whoami\", \"*uname\")]\n  [process where event.type in (\"start\", \"process_started\") and process.name:(\"*netcat\", \"*whoami\", \"*uname\")]","filters":[],"throttle":"no_actions","actions":[]}
{"id":"d645f2c0-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T16:00:33.903Z","updated_by":"admin","created_at":"2021-09-22T15:57:50.932Z","created_by":"admin","name":"[GD] Unusual Child Process of dns.exe","tags":["Elastic","Host","Initial Access","Threat Detection","Windows"],"interval":"5m","enabled":false,"description":"Identifies an unexpected process spawning from dns.exe, the process responsible for Windows DNS server services, which may indicate activity related to remote code execution or other forms of exploitation.","risk_score":73,"severity":"high","note":"### Investigating Unusual Child Process\nDetection alerts from this rule indicate potential suspicious child processes spawned after exploitation from CVE-2020-1350 (SigRed) has occurred. Here are some possible avenues of investigation:\n- Any suspicious or abnormal child process spawned from dns.exe should be reviewed and investigated with care. It's impossible to predict what an adversary may deploy as the follow-on process after the exploit, but built-in discovery/enumeration utilities should be top of mind (whoami.exe, netstat.exe, systeminfo.exe, tasklist.exe).\n- Built-in Windows programs that contain capabilities used to download and execute additional payloads should also be considered. This is not an exhaustive list, but ideal candidates to start out would be: mshta.exe, powershell.exe, regsvr32.exe, rundll32.exe, wscript.exe, wmic.exe.\n- If the DoS exploit is successful and DNS Server service crashes, be mindful of potential child processes related to werfault.exe occurring.\n- Any subsequent activity following the child process spawned related to execution/network activity should be thoroughly reviewed from the endpoint.","license":"Elastic License v2","output_index":".siem-signals-default","meta":{"from":"4m"},"timestamp_override":"event.ingested","author":["Elastic"],"false_positives":["Werfault.exe will legitimately spawn when dns.exe crashes, but the DNS service is very stable and so this is a low occurring event. Denial of Service (DoS) attempts by intentionally crashing the service will also cause werfault.exe to spawn."],"from":"now-540s","rule_id":"90844e5a-3058-4684-a9f0-f77c01c93032","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","technique":[{"reference":"https://attack.mitre.org/techniques/T1133/","name":"External Remote Services","subtechnique":[],"id":"T1133"}],"tactic":{"reference":"https://attack.mitre.org/tactics/TA0001/","name":"Initial Access","id":"TA0001"}}],"to":"now","references":["https://research.checkpoint.com/2020/resolving-your-way-into-domain-admin-exploiting-a-17-year-old-bug-in-windows-dns-servers/","https://msrc-blog.microsoft.com/2020/07/14/july-2020-security-update-cve-2020-1350-vulnerability-in-windows-domain-name-system-dns-server/","https://github.com/maxpl0it/CVE-2020-1350-DoS"],"version":5,"exceptions_list":[],"immutable":false,"type":"query","language":"kuery","index":["windows-*"],"query":"event.category:process and event.type:start and process.parent.name:dns.exe and not process.name:conhost.exe","filters":[],"throttle":"no_actions","actions":[]}
{"id":"cd4590e1-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T15:57:34.845Z","updated_by":"admin","created_at":"2021-09-22T15:57:34.845Z","created_by":"admin","name":"Carbon Black Threshold Exceeded on Rule Description","tags":["Carbon Black","POC","GD"],"interval":"5m","enabled":false,"description":"Threshold rule test.","risk_score":47,"severity":"medium","license":"","output_index":".siem-signals-default","meta":{"from":"1m","kibana_siem_app_url":"https://cbbf317cf62e4dd9b9913c1cc96ca394.vpce.gdw55e.elastic-cloud.com:9243/app/security"},"timestamp_override":"event.ingested","author":[],"false_positives":[],"from":"now-360s","rule_id":"faa79115-cd0a-403a-932b-cec43bd64933","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[],"to":"now","references":[],"version":7,"exceptions_list":[],"immutable":false,"type":"threshold","language":"kuery","index":["carbon-black-*"],"query":"rule.description : \"Report execution (Custom Rule)\"","filters":[],"threshold":{"field":["host.hostname","rule.description"],"value":10,"cardinality":[]},"throttle":"no_actions","actions":[]}
{"id":"d3d80000-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T16:00:33.997Z","updated_by":"admin","created_at":"2021-09-22T15:57:46.899Z","created_by":"admin","name":"[GD] Suspicious PowerShell Engine ImageLoad","tags":["Elastic","Execution","Host","Threat Detection","Windows"],"interval":"5m","enabled":false,"description":"Identifies the PowerShell engine being invoked by unexpected processes. Rather than executing PowerShell functionality with powershell.exe, some attackers do this to operate more stealthily.","risk_score":47,"severity":"medium","license":"Elastic License v2","output_index":".siem-signals-default","meta":{"from":"4m"},"timestamp_override":"event.ingested","author":["Elastic"],"false_positives":[],"from":"now-540s","rule_id":"6fc1da4f-508a-4bc8-b69e-86b3f78f878a","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","technique":[{"reference":"https://attack.mitre.org/techniques/T1059/","name":"Command and Scripting Interpreter","subtechnique":[{"reference":"https://attack.mitre.org/techniques/T1059/001/","name":"PowerShell","id":"T1059.001"}],"id":"T1059"}],"tactic":{"reference":"https://attack.mitre.org/tactics/TA0002/","name":"Execution","id":"TA0002"}}],"to":"now","references":[],"version":4,"exceptions_list":[],"immutable":false,"type":"eql","language":"eql","index":["windows-*"],"query":"library where dll.name : (\"System.Management.Automation.ni.dll\", \"System.Management.Automation.dll\") and\n/* add false positives relevant to your environment here */\nnot process.executable : (\"C:\\\\Windows\\\\System32\\\\RemoteFXvGPUDisablement.exe\", \"C:\\\\Windows\\\\System32\\\\sdiagnhost.exe\", \"C:\\\\Program Files*\\\\*.exe\") and\n  not process.name :\n  (\n    \"Altaro.SubAgent.exe\",\n    \"AppV_Manage.exe\",\n    \"azureadconnect.exe\",\n    \"CcmExec.exe\",\n    \"configsyncrun.exe\",\n    \"choco.exe\",\n    \"ctxappvservice.exe\",\n    \"DVLS.Console.exe\",\n    \"edgetransport.exe\",\n    \"exsetup.exe\",\n    \"forefrontactivedirectoryconnector.exe\",\n    \"InstallUtil.exe\",\n    \"JenkinsOnDesktop.exe\",\n    \"Microsoft.EnterpriseManagement.ServiceManager.UI.Console.exe\",\n    \"mmc.exe\",\n    \"mscorsvw.exe\",\n    \"msexchangedelivery.exe\",\n    \"msexchangefrontendtransport.exe\",\n    \"msexchangehmworker.exe\",\n    \"msexchangesubmission.exe\",\n    \"msiexec.exe\",\n    \"MsiExec.exe\",\n    \"noderunner.exe\",\n    \"NServiceBus.Host.exe\",\n    \"NServiceBus.Host32.exe\",\n    \"NServiceBus.Hosting.Azure.HostProcess.exe\",\n    \"OuiGui.WPF.exe\",\n    \"powershell.exe\",\n    \"powershell_ise.exe\",\n    \"pwsh.exe\",\n    \"SCCMCliCtrWPF.exe\",\n    \"ScriptEditor.exe\",\n    \"ScriptRunner.exe\",\n    \"sdiagnhost.exe\",\n    \"servermanager.exe\",\n    \"setup100.exe\",\n    \"ServiceHub.VSDetouredHost.exe\",\n    \"SPCAF.Client.exe\",\n    \"SPCAF.SettingsEditor.exe\",\n    \"SQLPS.exe\",\n    \"telemetryservice.exe\",\n    \"UMWorkerProcess.exe\",\n    \"w3wp.exe\",\n    \"wsmprovhost.exe\"\n  )\n","filters":[],"throttle":"no_actions","actions":[]}
{"id":"d6457d90-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T16:00:33.991Z","updated_by":"admin","created_at":"2021-09-22T15:57:50.916Z","created_by":"admin","name":"[GD] UAC Bypass Attempt with IEditionUpgradeManager Elevated COM Interface","tags":["Elastic","Host","Privilege Escalation","Threat Detection","Windows"],"interval":"5m","enabled":false,"description":"Identifies attempts to bypass User Account Control (UAC) by abusing an elevated COM Interface to launch a rogue Windows ClipUp program. Attackers may attempt to bypass UAC to stealthily execute code with elevated permissions.","risk_score":73,"severity":"high","license":"Elastic License v2","output_index":".siem-signals-default","meta":{"from":"4m"},"timestamp_override":"event.ingested","author":["Elastic"],"false_positives":[],"from":"now-540s","rule_id":"6b8f77e3-036c-4c33-b70a-9ac70941b3ad","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","technique":[{"reference":"https://attack.mitre.org/techniques/T1548/","name":"Abuse Elevation Control Mechanism","subtechnique":[{"reference":"https://attack.mitre.org/techniques/T1548/002/","name":"Bypass User Access Control","id":"T1548.002"}],"id":"T1548"}],"tactic":{"reference":"https://attack.mitre.org/tactics/TA0004/","name":"Privilege Escalation","id":"TA0004"}}],"to":"now","references":["https://github.com/hfiref0x/UACME"],"version":4,"exceptions_list":[],"immutable":false,"type":"eql","language":"eql","index":["windows-*"],"query":"process where event.type in (\"start\", \"process_started\") and process.name : \"Clipup.exe\" and\n  not process.executable : \"C:\\\\Windows\\\\System32\\\\ClipUp.exe\" and process.parent.name : \"dllhost.exe\" and\n  /* CLSID of the Elevated COM Interface IEditionUpgradeManager */\n  process.parent.args : \"/Processid:{BD54C901-076B-434E-B6C7-17C531F4AB41}\"\n","filters":[],"throttle":"no_actions","actions":[]}
{"id":"d1b2af01-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T16:00:33.999Z","updated_by":"admin","created_at":"2021-09-22T15:57:42.890Z","created_by":"admin","name":"[GD] Suspicious Execution - Short Program Name","tags":["Elastic","Execution","Host","Threat Detection","Windows"],"interval":"5m","enabled":false,"description":"Identifies process execution with a single character process name. This is often done by adversaries while staging or executing temporary utilities.","risk_score":47,"severity":"medium","license":"Elastic License v2","output_index":".siem-signals-default","meta":{"from":"4m"},"timestamp_override":"event.ingested","author":["Elastic"],"false_positives":[],"from":"now-540s","rule_id":"d51d2b92-5995-42c5-b553-cfc5e66c368b","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[],"to":"now","references":[],"version":4,"exceptions_list":[],"immutable":false,"type":"eql","language":"eql","index":["windows-*"],"query":"process where event.type in (\"start\", \"process_started\") and length(process.name) > 0 and\n length(process.name) == 5 and host.os.name == \"Windows\" and length(process.pe.original_file_name) > 5\n","filters":[],"throttle":"no_actions","actions":[]}
{"id":"d1b59530-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T16:00:34.014Z","updated_by":"admin","created_at":"2021-09-22T15:57:42.892Z","created_by":"admin","name":"[GD] Process Injection by the Microsoft Build Engine","tags":["Defense Evasion","Elastic","Host","Threat Detection","Windows"],"interval":"5m","enabled":false,"description":"An instance of MSBuild, the Microsoft Build Engine, created a thread in another process. This technique is sometimes used to evade detection or elevate privileges.","risk_score":21,"severity":"low","license":"Elastic License v2","output_index":".siem-signals-default","meta":{"from":"1m"},"timestamp_override":"event.ingested","author":["Elastic"],"false_positives":["The Build Engine is commonly used by Windows developers but use by non-engineers is unusual."],"from":"now-360s","rule_id":"fbee04bb-e050-438f-b162-4f44a4db29a7","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","technique":[{"reference":"https://attack.mitre.org/techniques/T1055/","name":"Process Injection","subtechnique":[],"id":"T1055"}],"tactic":{"reference":"https://attack.mitre.org/tactics/TA0005/","name":"Defense Evasion","id":"TA0005"}},{"framework":"MITRE ATT&CK","technique":[{"reference":"https://attack.mitre.org/techniques/T1055/","name":"Process Injection","subtechnique":[],"id":"T1055"}],"tactic":{"reference":"https://attack.mitre.org/tactics/TA0004/","name":"Privilege Escalation","id":"TA0004"}}],"to":"now","references":[],"version":6,"exceptions_list":[],"immutable":false,"type":"query","language":"kuery","index":["windows-*"],"query":"process.name:MSBuild.exe and event.action:\"CreateRemoteThread detected (rule: CreateRemoteThread)\"","filters":[],"throttle":"no_actions","actions":[]}
{"id":"d3dfa120-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T16:00:34.012Z","updated_by":"admin","created_at":"2021-09-22T15:57:46.904Z","created_by":"admin","name":"[GD] Suspicious WMIC XSL Script Execution","tags":["Defense Evasion","Elastic","Host","Threat Detection","Windows"],"interval":"5m","enabled":false,"description":"Identifies WMIC whitelisting bypass techniques by alerting on suspicious execution of scripts. When WMIC loads scripting libraries it may be indicative of a whitelist bypass.","risk_score":21,"severity":"medium","license":"Elastic License v2","output_index":".siem-signals-default","meta":{"from":"4m"},"author":["Elastic"],"false_positives":[],"from":"now-540s","rule_id":"a4b8f404-7336-4c6a-9c96-c3f3bdc20a43","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","technique":[{"reference":"https://attack.mitre.org/techniques/T1220/","name":"XSL Script Processing","subtechnique":[],"id":"T1220"}],"tactic":{"reference":"https://attack.mitre.org/tactics/TA0005/","name":"Defense Evasion","id":"TA0005"}}],"to":"now","references":[],"version":3,"exceptions_list":[],"immutable":false,"type":"eql","language":"eql","index":["windows-*"],"query":"sequence by process.entity_id with maxspan = 2m\n[process where event.type in (\"start\", \"process_started\") and\n   (process.name : \"WMIC.exe\" or process.pe.original_file_name : \"wmic.exe\") and\n   process.args : (\"format*:*\", \"/format*:*\", \"*-format*:*\") and\n   not process.command_line : \"* /format:table *\"]\n[library where event.type == \"start\" and dll.name : (\"jscript.dll\", \"vbscript.dll\")]\n","filters":[],"throttle":"no_actions","actions":[]}
{"id":"d6455681-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T16:00:34.222Z","updated_by":"admin","created_at":"2021-09-22T15:57:50.916Z","created_by":"admin","name":"[GD] Query Registry via reg.exe","tags":["Discovery","Elastic","Host","Threat Detection","Windows"],"interval":"5m","enabled":false,"description":"Enumeration or discovery of the Windows registry using reg.exe. This information can be used to perform follow-on activities.","risk_score":21,"severity":"low","license":"Elastic License v2","output_index":".siem-signals-default","meta":{"from":"4m"},"timestamp_override":"event.ingested","author":["Elastic"],"false_positives":[],"from":"now-540s","rule_id":"a5c2328d-bc37-41c2-a855-d5b062667bbe","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","technique":[{"reference":"https://attack.mitre.org/techniques/T1012/","name":"Query Registry","subtechnique":[],"id":"T1012"}],"tactic":{"reference":"https://attack.mitre.org/tactics/TA0007/","name":"Discovery","id":"TA0007"}}],"to":"now","references":[],"version":4,"exceptions_list":[],"immutable":false,"type":"eql","language":"eql","index":["windows-*"],"query":"process where event.type in (\"start\", \"process_started\") and\n  (process.name : \"reg.exe\" or process.pe.original_file_name == \"reg.exe\") and\n  process.args == \"query\"\n","filters":[],"throttle":"no_actions","actions":[]}
{"id":"d3d78ad1-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T16:00:34.207Z","updated_by":"admin","created_at":"2021-09-22T15:57:46.897Z","created_by":"admin","name":"[GD] Windows Script Executing PowerShell","tags":["Elastic","Host","Initial Access","Threat Detection","Windows"],"interval":"5m","enabled":false,"description":"Identifies a PowerShell process launched by either cscript.exe or wscript.exe. Observing Windows scripting processes executing a PowerShell script, may be indicative of malicious activity.","risk_score":21,"severity":"low","license":"Elastic License v2","output_index":".siem-signals-default","meta":{"from":"4m"},"timestamp_override":"event.ingested","author":["Elastic"],"false_positives":[],"from":"now-540s","rule_id":"fe537739-93cc-4235-93c6-5c442b5c290e","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","technique":[{"reference":"https://attack.mitre.org/techniques/T1566/","name":"Phishing","subtechnique":[{"reference":"https://attack.mitre.org/techniques/T1566/001/","name":"Spearphishing Attachment","id":"T1566.001"}],"id":"T1566"}],"tactic":{"reference":"https://attack.mitre.org/tactics/TA0001/","name":"Initial Access","id":"TA0001"}}],"to":"now","references":[],"version":9,"exceptions_list":[],"immutable":false,"type":"query","language":"kuery","index":["windows-*"],"query":"event.category:process and event.type:(start or process_started) and process.parent.name:(cscript.exe or wscript.exe) and process.name:powershell.exe","filters":[],"throttle":"no_actions","actions":[]}
{"id":"d3d80001-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T16:00:34.243Z","updated_by":"admin","created_at":"2021-09-22T15:57:46.899Z","created_by":"admin","name":"[GD] Unusual Service Host Child Process - Childless Service","tags":["Defense Evasion","Elastic","Host","Privilege Escalation","Threat Detection","Windows"],"interval":"5m","enabled":false,"description":"Identifies unusual child processes of Service Host (svchost.exe) that traditionally do not spawn any child processes. This may indicate a code injection or an equivalent form of exploitation.","risk_score":47,"severity":"medium","license":"Elastic License v2","output_index":".siem-signals-default","meta":{"from":"4m"},"timestamp_override":"event.ingested","author":["Elastic"],"false_positives":["Changes to Windows services or a rarely executed child process."],"from":"now-540s","rule_id":"3abd5838-fe08-4bbf-9066-14cfc8dd7a7d","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","technique":[{"reference":"https://attack.mitre.org/techniques/T1055/","name":"Process Injection","subtechnique":[{"reference":"https://attack.mitre.org/techniques/T1055/012/","name":"Process Hollowing","id":"T1055.012"}],"id":"T1055"}],"tactic":{"reference":"https://attack.mitre.org/tactics/TA0004/","name":"Privilege Escalation","id":"TA0004"}},{"framework":"MITRE ATT&CK","technique":[{"reference":"https://attack.mitre.org/techniques/T1055/","name":"Process Injection","subtechnique":[],"id":"T1055"}],"tactic":{"reference":"https://attack.mitre.org/tactics/TA0005/","name":"Defense Evasion","id":"TA0005"}}],"to":"now","references":[],"version":4,"exceptions_list":[],"immutable":false,"type":"eql","language":"eql","index":["windows-*"],"query":"process where event.type in (\"start\", \"process_started\") and\n     process.parent.name : \"svchost.exe\" and\n\n     /* based on svchost service arguments -s svcname where the service is known to be childless */\n\n    process.parent.args : (\"WdiSystemHost\",\"LicenseManager\",\n      \"StorSvc\",\"CDPSvc\",\"cdbhsvc\",\"BthAvctpSvc\",\"SstpSvc\",\"WdiServiceHost\",\n      \"imgsvc\",\"TrkWks\",\"WpnService\",\"IKEEXT\",\"PolicyAgent\",\"CryptSvc\",\n      \"netprofm\",\"ProfSvc\",\"StateRepository\",\"camsvc\",\"LanmanWorkstation\",\n      \"NlaSvc\",\"EventLog\",\"hidserv\",\"DisplayEnhancementService\",\"ShellHWDetection\",\n      \"AppHostSvc\",\"fhsvc\",\"CscService\",\"PushToInstall\") and\n\n      /* unknown FPs can be added here */\n\n     not process.name : (\"WerFault.exe\",\"WerFaultSecure.exe\",\"wermgr.exe\")\n","filters":[],"throttle":"no_actions","actions":[]}
{"id":"d1a3bae1-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T16:00:34.246Z","updated_by":"admin","created_at":"2021-09-22T15:57:42.866Z","created_by":"admin","name":"[GD] Volume Shadow Copy Deletion via VssAdmin","tags":["Elastic","Host","Impact","Threat Detection","Windows"],"interval":"5m","enabled":false,"description":"Identifies use of vssadmin.exe for shadow copy deletion on endpoints. This commonly occurs in tandem with ransomware or other destructive attacks.","risk_score":73,"severity":"high","license":"Elastic License v2","output_index":".siem-signals-default","meta":{"from":"4m"},"timestamp_override":"event.ingested","author":["Elastic"],"false_positives":[],"from":"now-540s","rule_id":"4d05ee7d-7ca3-4412-9625-4c625d57b851","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","technique":[{"reference":"https://attack.mitre.org/techniques/T1490/","name":"Inhibit System Recovery","subtechnique":[],"id":"T1490"}],"tactic":{"reference":"https://attack.mitre.org/tactics/TA0040/","name":"Impact","id":"TA0040"}}],"to":"now","references":[],"version":9,"exceptions_list":[],"immutable":false,"type":"query","language":"kuery","index":["windows-*"],"query":"event.category:process and event.type:(start or process_started) and process.name:vssadmin.exe and process.args:(delete and shadows)","filters":[],"throttle":"no_actions","actions":[]}
{"id":"d1b1ebb0-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T16:00:32.786Z","updated_by":"admin","created_at":"2021-09-22T15:57:42.866Z","created_by":"admin","name":"[GD] Remote File Copy to a Hidden Share","tags":["Elastic","Host","Lateral Movement","Threat Detection","Windows"],"interval":"5m","enabled":false,"description":"Identifies a remote file copy attempt to a hidden network share. This may indicate lateral movement or data staging activity.","risk_score":47,"severity":"medium","license":"Elastic License v2","output_index":".siem-signals-default","meta":{"from":"4m"},"timestamp_override":"event.ingested","author":["Elastic"],"false_positives":[],"from":"now-540s","rule_id":"c03a8fc5-aa3f-471c-8e54-b9a12f6f8411","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","technique":[{"reference":"https://attack.mitre.org/techniques/T1021/","name":"Remote Services","subtechnique":[{"reference":"https://attack.mitre.org/techniques/T1021/002/","name":"SMB/Windows Admin Shares","id":"T1021.002"}],"id":"T1021"}],"tactic":{"reference":"https://attack.mitre.org/tactics/TA0008/","name":"Lateral Movement","id":"TA0008"}}],"to":"now","references":[],"version":4,"exceptions_list":[],"immutable":false,"type":"eql","language":"eql","index":["windows-*"],"query":"process where event.type in (\"start\", \"process_started\") and\n  process.name : (\"cmd.exe\", \"powershell.exe\", \"robocopy.exe\", \"xcopy.exe\") and \n  process.args : (\"copy*\", \"move*\", \"cp\", \"mv\") and process.args : \"*$*\"\n","filters":[],"throttle":"no_actions","actions":[]}
{"id":"d6450861-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T16:00:32.794Z","updated_by":"admin","created_at":"2021-09-22T15:57:50.914Z","created_by":"admin","name":"[GD] Bypass UAC via Event Viewer","tags":["Elastic","Host","Privilege Escalation","Threat Detection","Windows"],"interval":"5m","enabled":false,"description":"Identifies User Account Control (UAC) bypass via eventvwr.exe. Attackers bypass UAC to stealthily execute code with elevated permissions.","risk_score":21,"severity":"low","license":"Elastic License v2","output_index":".siem-signals-default","meta":{"from":"4m"},"timestamp_override":"event.ingested","author":["Elastic"],"false_positives":[],"from":"now-540s","rule_id":"7a608b29-941e-4b75-977e-ec153f7427fa","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","technique":[{"reference":"https://attack.mitre.org/techniques/T1548/","name":"Abuse Elevation Control Mechanism","subtechnique":[{"reference":"https://attack.mitre.org/techniques/T1548/002/","name":"Bypass User Access Control","id":"T1548.002"}],"id":"T1548"}],"tactic":{"reference":"https://attack.mitre.org/tactics/TA0004/","name":"Privilege Escalation","id":"TA0004"}}],"to":"now","references":[],"version":8,"exceptions_list":[],"immutable":false,"type":"query","language":"kuery","index":["windows-*"],"query":"event.category:process and event.type:(start or process_started) and process.parent.name:eventvwr.exe and not process.executable:(\"C:\\Windows\\SysWOW64\\mmc.exe\" or \"C:\\Windows\\System32\\mmc.exe\")","filters":[],"throttle":"no_actions","actions":[]}
{"id":"d6492710-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T16:00:33.125Z","updated_by":"admin","created_at":"2021-09-22T15:57:50.928Z","created_by":"admin","name":"[GD] Microsoft Build Engine Loading Windows Credential Libraries","tags":["Credential Access","Elastic","Host","Threat Detection","Windows"],"interval":"5m","enabled":false,"description":"An instance of MSBuild, the Microsoft Build Engine, loaded DLLs (dynamically linked libraries) responsible for Windows credential management. This technique is sometimes used for credential dumping.","risk_score":73,"severity":"high","license":"Elastic License v2","output_index":".siem-signals-default","meta":{"from":"4m"},"timestamp_override":"event.ingested","author":["Elastic"],"false_positives":["The Build Engine is commonly used by Windows developers but use by non-engineers is unusual."],"from":"now-540s","rule_id":"86cc5e11-88f4-486d-bac8-e7b25152df47","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","technique":[{"reference":"https://attack.mitre.org/techniques/T1003/","name":"OS Credential Dumping","subtechnique":[],"id":"T1003"}],"tactic":{"reference":"https://attack.mitre.org/tactics/TA0006/","name":"Credential Access","id":"TA0006"}}],"to":"now","references":[],"version":8,"exceptions_list":[],"immutable":false,"type":"query","language":"kuery","index":["windows-*"],"query":"event.category:process and event.type:change and (process.pe.original_file_name:(vaultcli.dll or SAMLib.DLL) or dll.name:(vaultcli.dll or SAMLib.DLL)) and process.name: MSBuild.exe","filters":[],"throttle":"no_actions","actions":[]}
{"id":"d6452f70-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T16:00:33.139Z","updated_by":"admin","created_at":"2021-09-22T15:57:50.926Z","created_by":"admin","name":"[GD] Remote File Download via Desktopimgdownldr Utility","tags":["Command and Control","Elastic","Host","Threat Detection","Windows"],"interval":"5m","enabled":false,"description":"Identifies the desktopimgdownldr utility being used to download a remote file. An adversary may use desktopimgdownldr to download arbitrary files as an alternative to certutil.","risk_score":47,"severity":"medium","license":"Elastic License v2","output_index":".siem-signals-default","meta":{"from":"4m"},"timestamp_override":"event.ingested","author":["Elastic"],"false_positives":[],"from":"now-540s","rule_id":"3053b8ce-2ee6-415b-8a72-315c4ef3a0ec","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","technique":[{"reference":"https://attack.mitre.org/techniques/T1105/","name":"Ingress Tool Transfer","subtechnique":[],"id":"T1105"}],"tactic":{"reference":"https://attack.mitre.org/tactics/TA0011/","name":"Command and Control","id":"TA0011"}}],"to":"now","references":["https://labs.sentinelone.com/living-off-windows-land-a-new-native-file-downldr/"],"version":5,"exceptions_list":[],"immutable":false,"type":"query","language":"kuery","index":["windows-*"],"query":"event.category:process and event.type:(start or process_started) and (process.name:desktopimgdownldr.exe or process.pe.original_file_name:desktopimgdownldr.exe) and process.args:/lockscreenurl\\:http*","filters":[],"throttle":"no_actions","actions":[]}
{"id":"d647c780-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T16:00:33.201Z","updated_by":"admin","created_at":"2021-09-22T15:57:50.934Z","created_by":"admin","name":"[GD] User Account Creation","tags":["Elastic","Host","Persistence","Threat Detection","Windows"],"interval":"5m","enabled":false,"description":"Identifies attempts to create new local users. This is sometimes done by attackers to increase access to a system or domain.","risk_score":21,"severity":"low","license":"Elastic License v2","output_index":".siem-signals-default","meta":{"from":"4m"},"timestamp_override":"event.ingested","author":["Elastic"],"false_positives":[],"from":"now-540s","rule_id":"ea7a2b87-3205-4de5-892f-039cd0ee7937","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","technique":[{"reference":"https://attack.mitre.org/techniques/T1136/","name":"Create Account","subtechnique":[],"id":"T1136"}],"tactic":{"reference":"https://attack.mitre.org/tactics/TA0003/","name":"Persistence","id":"TA0003"}}],"to":"now","references":[],"version":8,"exceptions_list":[],"immutable":false,"type":"query","language":"kuery","index":["windows-*"],"query":"event.category:process and event.type:(start or process_started) and process.name:(net.exe or net1.exe) and not process.parent.name:net.exe and process.args:(user and (/ad or /add))","filters":[],"throttle":"no_actions","actions":[]}
{"id":"d649c350-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T16:00:33.222Z","updated_by":"admin","created_at":"2021-09-22T15:57:50.927Z","created_by":"admin","name":"[GD] AWS EC2 Flow Log Deletion","tags":["AWS","Cloud","Continuous Monitoring","Elastic","Log Auditing","SecOps"],"interval":"10m","enabled":false,"description":"Identifies the deletion of one or more flow logs in AWS Elastic Compute Cloud (EC2). An adversary may delete flow logs in an attempt to evade defenses.","risk_score":73,"severity":"high","note":"The AWS Filebeat module must be enabled to use this rule.","license":"Elastic License v2","output_index":".siem-signals-default","meta":{"from":"50m"},"timestamp_override":"event.ingested","author":["Elastic"],"false_positives":["Verify whether the user identity, user agent, and/or hostname should be making changes in your environment. Flow log deletions from unfamiliar users or hosts should be investigated. If known behavior is causing false positives, it can be exempted from the rule."],"from":"now-3600s","rule_id":"c36780a1-350d-4a94-bea1-20c92b4a4fb2","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","technique":[{"reference":"https://attack.mitre.org/techniques/T1562/","name":"Impair Defenses","subtechnique":[{"reference":"https://attack.mitre.org/techniques/T1562/001/","name":"Disable or Modify Tools","id":"T1562.001"}],"id":"T1562"}],"tactic":{"reference":"https://attack.mitre.org/tactics/TA0005/","name":"Defense Evasion","id":"TA0005"}}],"to":"now","references":["https://awscli.amazonaws.com/v2/documentation/api/latest/reference/ec2/delete-flow-logs.html","https://docs.aws.amazon.com/AWSEC2/latest/APIReference/API_DeleteFlowLogs.html"],"version":6,"exceptions_list":[],"immutable":false,"type":"query","language":"kuery","index":["aws-cloudtrail-*","aws-config-*"],"query":"event.action:DeleteFlowLogs and event.dataset:aws.cloudtrail and event.provider:ec2.amazonaws.com and event.outcome:success","filters":[],"throttle":"no_actions","actions":[]}
{"id":"d6490001-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T16:00:34.248Z","updated_by":"admin","created_at":"2021-09-22T15:57:50.933Z","created_by":"admin","name":" [GD] Unusual City For an AWS Command","tags":["AWS","Cloud","Elastic","ML"],"interval":"15m","enabled":false,"description":"A machine learning job detected AWS command activity that, while not inherently suspicious or abnormal, is sourcing from a geolocation (city) that is unusual for the command. This can be the result of compromised credentials or keys being used by a threat actor in a different geography then the authorized user(s).","risk_score":21,"severity":"low","note":"### Investigating an Unusual CloudTrail Event ###\nDetection alerts from this rule indicate an AWS API command or method call that is rare and unusual for the geolocation of the source IP address. Here are some possible avenues of investigation:\n- Consider the source IP address and geolocation for the calling user who issued the command. Do they look normal for the calling user? If the source is an EC2 IP address, is it associated with an EC2 instance in one of your accounts or could it be sourcing from an EC2 instance not under your control? If it is an authorized EC2 instance, is the activity associated with normal behavior for the instance role or roles? Are there any other alerts or signs of suspicious activity involving this instance?\n- Consider the user as identified by the `user.name` field. Is this command part of an expected workflow for the user context? Examine the user identity in the `aws.cloudtrail.user_identity.arn` field and the access key id in the `aws.cloudtrail.user_identity.access_key_id` field which can help identify the precise user context. The user agent details in the `user_agent.original` field may also indicate what kind of a client made the request.\n- Consider the time of day. If the user is a human, not a program or script, did the activity take place during a normal time of day?\n- Examine the history of the command. If the command, which is visible in the `event.action field`, manifested only very recently, it might be part of a new automation module or script. If it has a consistent cadence - for example, if it appears in small numbers on a weekly or monthly cadence it might be part of a housekeeping or maintenance process.\n- Examine the request parameters. These may provide indications as to the source of the program or the nature of the tasks it is performing.","license":"Elastic License v2","output_index":".siem-signals-default","meta":{"from":"45m"},"author":["Elastic"],"false_positives":["New or unusual command and user geolocation activity can be due to manual troubleshooting or reconfiguration; changes in cloud automation scripts or workflows; adoption of new services; expansion into new regions; increased adoption of work from home policies; or users who travel frequently."],"from":"now-3600s","rule_id":"c72a9fc8-3e17-43cc-937a-76d4c6bf0f00","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[],"to":"now","references":["https://www.elastic.co/guide/en/security/current/prebuilt-ml-jobs.html"],"version":4,"exceptions_list":[],"immutable":false,"type":"machine_learning","anomaly_threshold":50,"machine_learning_job_id":["rare_method_for_a_city"],"throttle":"no_actions","actions":[]}
{"id":"d3db0d41-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T16:00:32.809Z","updated_by":"admin","created_at":"2021-09-22T15:57:46.941Z","created_by":"admin","name":"[GD] Microsoft IIS Connection Strings Decryption","tags":["Credential Access","Elastic","Host","Threat Detection","Windows"],"interval":"5m","enabled":false,"description":"Identifies use of aspnet_regiis to decrypt Microsoft IIS connection strings. An attacker with Microsoft IIS web server access via a webshell or alike can decrypt and dump any hardcoded connection strings, such as the MSSQL service account password using aspnet_regiis command.","risk_score":73,"severity":"high","license":"Elastic License v2","output_index":".siem-signals-default","meta":{"from":"4m"},"timestamp_override":"event.ingested","author":["Elastic"],"false_positives":[],"from":"now-540s","rule_id":"470114cd-d901-43b8-ad04-168d2927a671","max_signals":33,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","technique":[{"reference":"https://attack.mitre.org/techniques/T1003/","name":"OS Credential Dumping","subtechnique":[],"id":"T1003"}],"tactic":{"reference":"https://attack.mitre.org/tactics/TA0006/","name":"Credential Access","id":"TA0006"}}],"to":"now","references":["https://blog.netspi.com/decrypting-iis-passwords-to-break-out-of-the-dmz-part-1/","https://symantec-enterprise-blogs.security.com/blogs/threat-intelligence/greenbug-espionage-telco-south-asia"],"version":5,"exceptions_list":[],"immutable":false,"type":"eql","language":"eql","index":["windows-*"],"query":"process where event.type in (\"start\", \"process_started\") and\n  (process.name : \"aspnet_regiis.exe\" or process.pe.original_file_name == \"aspnet_regiis.exe\") and\n  process.args : \"connectionStrings\" and process.args : \"-pdf\"\n","filters":[],"throttle":"no_actions","actions":[]}
{"id":"cf8ac5f0-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T15:57:38.672Z","updated_by":"admin","created_at":"2021-09-22T15:57:38.672Z","created_by":"admin","name":"SSH Authorized Keys File Modification [Duplicate]","tags":["Elastic","Host","Linux","macOS","Persistence","Threat Detection"],"interval":"5m","enabled":false,"description":"The Secure Shell (SSH) authorized_keys file specifies which users are allowed to log into a server using public key authentication. Adversaries may modify it to maintain persistence on a victim host by adding their own public key(s).","risk_score":47,"severity":"medium","license":"Elastic License v2","output_index":".siem-signals-default","timestamp_override":"event.ingested","author":["Elastic"],"false_positives":[],"from":"now-9m","rule_id":"3e2bd1c1-16ac-4980-9bcc-b32a9121dd22","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0003","name":"Persistence","reference":"https://attack.mitre.org/tactics/TA0003/"},"technique":[{"id":"T1098","name":"Account Manipulation","reference":"https://attack.mitre.org/techniques/T1098/","subtechnique":[{"id":"T1098.004","name":"SSH Authorized Keys","reference":"https://attack.mitre.org/techniques/T1098/004/"}]}]}],"to":"now","references":[],"version":1,"exceptions_list":[],"immutable":false,"type":"query","language":"kuery","index":["auditbeat-*","logs-endpoint.events.*"],"query":"event.category:file and event.type:(change or creation) and file.name:(\"authorized_keys\" or \"authorized_keys2\") and not process.executable: (/Library/Developer/CommandLineTools/usr/bin/git or /usr/local/Cellar/maven/*/libexec/bin/mvn or /Library/Java/JavaVirtualMachines/jdk*.jdk/Contents/Home/bin/java or /usr/bin/vim or /usr/local/Cellar/coreutils/*/bin/gcat or /usr/bin/bsdtar or /usr/bin/nautilus or /usr/bin/scp or /usr/bin/touch or /var/lib/docker/*)","throttle":"no_actions","actions":[]}
{"id":"cf8aed00-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T15:57:38.671Z","updated_by":"admin","created_at":"2021-09-22T15:57:38.671Z","created_by":"admin","name":"Suspicious JAR Child Process [Duplicate]","tags":["Elastic","Execution","Host","Linux","macOS","Threat Detection"],"interval":"5m","enabled":false,"description":"Identifies suspicious child processes of a Java Archive (JAR) file. JAR files may be used to deliver malware in order to evade detection.","risk_score":47,"severity":"medium","license":"Elastic License v2","output_index":".siem-signals-default","timestamp_override":"event.ingested","author":["Elastic"],"false_positives":[],"from":"now-9m","rule_id":"9843f14d-f1dc-4f93-89f7-ac20c7945a01","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0002","name":"Execution","reference":"https://attack.mitre.org/tactics/TA0002/"},"technique":[{"id":"T1059","name":"Command and Scripting Interpreter","reference":"https://attack.mitre.org/techniques/T1059/","subtechnique":[{"id":"T1059.007","name":"JavaScript/JScript","reference":"https://attack.mitre.org/techniques/T1059/007/"}]}]}],"to":"now","references":[],"version":1,"exceptions_list":[],"immutable":false,"type":"eql","language":"eql","index":["auditbeat-*","logs-endpoint.events.*"],"query":"process where event.type in (\"start\", \"process_started\") and\n  process.parent.name : \"java\" and\n  process.name : (\"sh\", \"bash\", \"dash\", \"ksh\", \"tcsh\", \"zsh\", \"curl\", \"wget\") and\n  process.args : \"-jar\" and process.args : \"*.jar\" and\n  /* Add any FP's here */\n  not process.executable : (\"/Users/*/.sdkman/*\", \"/Library/Java/JavaVirtualMachines/*\") and\n  not process.args : (\"/usr/local/*\", \"/Users/*/github.com/*\", \"/Users/*/src/*\")\n","throttle":"no_actions","actions":[]}
{"id":"cf8b1410-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T15:57:38.674Z","updated_by":"admin","created_at":"2021-09-22T15:57:38.674Z","created_by":"admin","name":"Attempt to Disable IPTables or Firewall [Duplicate]","tags":["Defense Evasion","Elastic","Host","Linux","Threat Detection"],"interval":"5m","enabled":false,"description":"Adversaries may attempt to disable the iptables or firewall service in an attempt to affect how a host is allowed to receive or send network traffic.","risk_score":47,"severity":"medium","license":"Elastic License v2","output_index":".siem-signals-default","timestamp_override":"event.ingested","author":["Elastic"],"false_positives":[],"from":"now-9m","rule_id":"d6142078-2c42-4c6b-93e7-63e4b8ebd05a","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0005","name":"Defense Evasion","reference":"https://attack.mitre.org/tactics/TA0005/"},"technique":[{"id":"T1562","name":"Impair Defenses","reference":"https://attack.mitre.org/techniques/T1562/","subtechnique":[{"id":"T1562.001","name":"Disable or Modify Tools","reference":"https://attack.mitre.org/techniques/T1562/001/"}]}]}],"to":"now","references":[],"version":7,"exceptions_list":[],"immutable":false,"type":"query","language":"kuery","index":["auditbeat-*","logs-endpoint.events.*"],"query":"event.category:process and event.type:(start or process_started) and process.name:ufw and process.args:(allow or disable or reset) or  (((process.name:service and process.args:stop) or (process.name:chkconfig and process.args:off) or (process.name:systemctl and process.args:(disable or stop or kill))) and process.args:(firewalld or ip6tables or iptables))","throttle":"no_actions","actions":[]}
{"id":"cd82c0f1-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T15:57:35.242Z","updated_by":"admin","created_at":"2021-09-22T15:57:35.242Z","created_by":"admin","name":"Unusual Linux Web Activity [Duplicate]","tags":["Elastic","Host","Linux","ML","Threat Detection"],"interval":"15m","enabled":false,"description":"A machine learning job detected an unusual web URL request from a Linux host, which can indicate malware delivery and execution. Wget and cURL are commonly used by Linux programs to download code and data. Most of the time, their usage is entirely normal. Generally, because they use a list of URLs, they repeatedly download from the same locations. However, Wget and cURL are sometimes used to deliver Linux exploit payloads, and threat actors use these tools to download additional software and code. For these reasons, unusual URLs can indicate unauthorized downloads or threat activity.","risk_score":21,"severity":"low","license":"Elastic License v2","output_index":".siem-signals-default","author":["Elastic"],"false_positives":["A new and unusual program or artifact download in the course of software upgrades, debugging, or troubleshooting could trigger this alert."],"from":"now-45m","rule_id":"57d546c0-87d0-402b-829e-4f7f66274555","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[],"to":"now","references":["https://www.elastic.co/guide/en/security/current/prebuilt-ml-jobs.html"],"version":4,"exceptions_list":[],"immutable":false,"type":"machine_learning","anomaly_threshold":50,"machine_learning_job_id":["linux_anomalous_network_url_activity_ecs"],"throttle":"no_actions","actions":[]}
{"id":"cd83d260-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T15:57:35.243Z","updated_by":"admin","created_at":"2021-09-22T15:57:35.243Z","created_by":"admin","name":"Unusual Linux Process Calling the Metadata Service [Duplicate]","tags":["Elastic","Host","Linux","ML","Threat Detection"],"interval":"15m","enabled":false,"description":"Looks for anomalous access to the metadata service by an unusual process. The metadata service may be targeted in order to harvest credentials or user data scripts containing secrets.","risk_score":21,"severity":"low","license":"Elastic License v2","output_index":".siem-signals-default","author":["Elastic"],"false_positives":["A newly installed program or one that runs very rarely as part of a monthly or quarterly workflow could trigger this detection rule."],"from":"now-45m","rule_id":"c241122b-50ea-4cd0-b13a-c7cd2ffed394","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[],"to":"now","references":[],"version":2,"exceptions_list":[],"immutable":false,"type":"machine_learning","anomaly_threshold":50,"machine_learning_job_id":["linux_rare_metadata_process"],"throttle":"no_actions","actions":[]}
{"id":"cd81d690-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T15:57:35.250Z","updated_by":"admin","created_at":"2021-09-22T15:57:35.250Z","created_by":"admin","name":"Unusual Login Activity [Duplicate]","tags":["Elastic","Host","Linux","ML","Threat Detection"],"interval":"15m","enabled":false,"description":"Identifies an unusually high number of authentication attempts.","risk_score":21,"severity":"low","license":"Elastic License v2","output_index":".siem-signals-default","author":["Elastic"],"false_positives":["Security audits may trigger this alert. Conditions that generate bursts of failed logins, such as misconfigured applications or account lockouts could trigger this alert."],"from":"now-45m","rule_id":"156f75c5-6e63-4614-99d8-062805d5f082","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[],"to":"now","references":["https://www.elastic.co/guide/en/security/current/prebuilt-ml-jobs.html"],"version":4,"exceptions_list":[],"immutable":false,"type":"machine_learning","anomaly_threshold":50,"machine_learning_job_id":["suspicious_login_activity_ecs"],"throttle":"no_actions","actions":[]}
{"id":"cd838440-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T15:57:35.252Z","updated_by":"admin","created_at":"2021-09-22T15:57:35.252Z","created_by":"admin","name":"Unusual Linux System Information Discovery Activity [Duplicate]","tags":["Elastic","Host","Linux","ML","Threat Detection"],"interval":"15m","enabled":false,"description":"Looks for commands related to system information discovery from an unusual user context. This can be due to uncommon troubleshooting activity or due to a compromised account. A compromised account may be used to engage in system information discovery in order to gather detailed information about system configuration and software versions. This may be a precursor to selection of a persistence mechanism or a method of privilege elevation.","risk_score":21,"severity":"low","license":"Elastic License v2","output_index":".siem-signals-default","author":["Elastic"],"false_positives":["Uncommon user command activity can be due to an engineer logging onto a server instance in order to perform manual troubleshooting or reconfiguration."],"from":"now-45m","rule_id":"322c1eab-d8bf-45ad-958d-fc22771bff3a","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0007","name":"Discovery","reference":"https://attack.mitre.org/tactics/TA0007/"},"technique":[{"id":"T1082","name":"System Information Discovery","reference":"https://attack.mitre.org/techniques/T1082/"}]}],"to":"now","references":[],"version":2,"exceptions_list":[],"immutable":false,"type":"machine_learning","anomaly_threshold":75,"machine_learning_job_id":["linux_system_information_discovery"],"throttle":"no_actions","actions":[]}
{"id":"cd83d261-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T15:57:35.256Z","updated_by":"admin","created_at":"2021-09-22T15:57:35.256Z","created_by":"admin","name":"Unusual Linux System Network Configuration Discovery [Duplicate]","tags":["Elastic","Host","Linux","ML","Threat Detection"],"interval":"15m","enabled":false,"description":"Looks for commands related to system network configuration discovery from an unusual user context. This can be due to uncommon troubleshooting activity or due to a compromised account. A compromised account may be used by a threat actor to engage in system network configuration discovery in order to increase their understanding of connected networks and hosts. This information may be used to shape follow-up behaviors such as lateral movement or additional discovery.","risk_score":21,"severity":"low","license":"Elastic License v2","output_index":".siem-signals-default","author":["Elastic"],"false_positives":["Uncommon user command activity can be due to an engineer logging onto a server instance in order to perform manual troubleshooting or reconfiguration."],"from":"now-45m","rule_id":"3c5ed739-a2ed-43a6-aa6e-ced025774cb0","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0007","name":"Discovery","reference":"https://attack.mitre.org/tactics/TA0007/"},"technique":[{"id":"T1016","name":"System Network Configuration Discovery","reference":"https://attack.mitre.org/techniques/T1016/"}]}],"to":"now","references":[],"version":2,"exceptions_list":[],"immutable":false,"type":"machine_learning","anomaly_threshold":25,"machine_learning_job_id":["linux_network_configuration_discovery"],"throttle":"no_actions","actions":[]}
{"id":"d8362a00-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T16:01:21.483Z","updated_by":"admin","created_at":"2021-09-22T15:57:53.956Z","created_by":"admin","name":"[GD] Administrator Privileges Assigned to an Okta Group","tags":["Continuous Monitoring","Elastic","Identity","Monitoring","Okta","SecOps"],"interval":"5m","enabled":false,"description":"Detects when an administrator role is assigned to an Okta group. An adversary may attempt to assign administrator privileges to an Okta group in order to assign additional permissions to compromised user accounts and maintain access to their target organization.","risk_score":47,"severity":"medium","note":"The Okta Fleet integration or Filebeat module must be enabled to use this rule.","license":"Elastic License v2","output_index":".siem-signals-default","meta":{"from":"1m"},"timestamp_override":"event.ingested","author":["Elastic"],"false_positives":["Administrator roles may be assigned to Okta users by a Super Admin user. Verify that the behavior was expected. Exceptions can be added to this rule to filter expected behavior."],"from":"now-360s","rule_id":"85231f1e-375c-470a-8e63-2d8884287b6d","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","technique":[{"reference":"https://attack.mitre.org/techniques/T1098/","name":"Account Manipulation","subtechnique":[],"id":"T1098"}],"tactic":{"reference":"https://attack.mitre.org/tactics/TA0003/","name":"Persistence","id":"TA0003"}}],"to":"now","references":["https://help.okta.com/en/prod/Content/Topics/Security/administrators-admin-comparison.htm","https://developer.okta.com/docs/reference/api/system-log/","https://developer.okta.com/docs/reference/api/event-types/"],"version":6,"exceptions_list":[],"immutable":false,"type":"query","language":"kuery","index":["okta-*"],"query":"event.dataset:okta.system and event.action:group.privilege.grant","filters":[],"throttle":"no_actions","actions":[]}
{"id":"d82e13b0-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T16:01:21.599Z","updated_by":"admin","created_at":"2021-09-22T15:57:53.946Z","created_by":"admin","name":"[GD] Suspicious Activity Reported by Okta User","tags":["Continuous Monitoring","Elastic","Identity","Monitoring","Okta","SecOps"],"interval":"5m","enabled":false,"description":"Detects when a user reports suspicious activity for their Okta account. These events should be investigated, as they can help security teams identify when an adversary is attempting to gain access to their network.","risk_score":47,"severity":"medium","note":"The Okta Fleet integration or Filebeat module must be enabled to use this rule.","license":"Elastic License v2","output_index":".siem-signals-default","meta":{"from":"1m"},"timestamp_override":"event.ingested","author":["Elastic"],"false_positives":["A user may report suspicious activity on their Okta account in error."],"from":"now-360s","rule_id":"7b305959-fb47-49ba-908e-4740aab9fe2c","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","technique":[{"reference":"https://attack.mitre.org/techniques/T1078/","name":"Valid Accounts","subtechnique":[],"id":"T1078"}],"tactic":{"reference":"https://attack.mitre.org/tactics/TA0001/","name":"Initial Access","id":"TA0001"}},{"framework":"MITRE ATT&CK","technique":[{"reference":"https://attack.mitre.org/techniques/T1078/","name":"Valid Accounts","subtechnique":[],"id":"T1078"}],"tactic":{"reference":"https://attack.mitre.org/tactics/TA0003/","name":"Persistence","id":"TA0003"}},{"framework":"MITRE ATT&CK","technique":[{"reference":"https://attack.mitre.org/techniques/T1078/","name":"Valid Accounts","subtechnique":[],"id":"T1078"}],"tactic":{"reference":"https://attack.mitre.org/tactics/TA0004/","name":"Privilege Escalation","id":"TA0004"}},{"framework":"MITRE ATT&CK","technique":[{"reference":"https://attack.mitre.org/techniques/T1078/","name":"Valid Accounts","subtechnique":[],"id":"T1078"}],"tactic":{"reference":"https://attack.mitre.org/tactics/TA0005/","name":"Defense Evasion","id":"TA0005"}}],"to":"now","references":["https://developer.okta.com/docs/reference/api/system-log/","https://developer.okta.com/docs/reference/api/event-types/"],"version":6,"exceptions_list":[],"immutable":false,"type":"query","language":"kuery","index":["okta-*"],"query":"event.dataset:okta.system and event.action:user.account.report_suspicious_activity_by_enduser","filters":[],"throttle":"no_actions","actions":[]}
{"id":"d6490000-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T16:00:34.197Z","updated_by":"admin","created_at":"2021-09-22T15:57:50.919Z","created_by":"admin","name":"[GD] Unusual Country For an AWS Command ","tags":["AWS","Cloud","Elastic","ML"],"interval":"15m","enabled":false,"description":"A machine learning job detected AWS command activity that, while not inherently suspicious or abnormal, is sourcing from a geolocation (country) that is unusual for the command. This can be the result of compromised credentials or keys being used by a threat actor in a different geography then the authorized user(s).","risk_score":21,"severity":"low","note":"### Investigating an Unusual CloudTrail Event ###\nDetection alerts from this rule indicate an AWS API command or method call that is rare and unusual for the geolocation of the source IP address. Here are some possible avenues of investigation:\n- Consider the source IP address and geolocation for the calling user who issued the command. Do they look normal for the calling user? If the source is an EC2 IP address, is it associated with an EC2 instance in one of your accounts or could it be sourcing from an EC2 instance not under your control? If it is an authorized EC2 instance, is the activity associated with normal behavior for the instance role or roles? Are there any other alerts or signs of suspicious activity involving this instance?\n- Consider the user as identified by the `user.name` field. Is this command part of an expected workflow for the user context? Examine the user identity in the `aws.cloudtrail.user_identity.arn` field and the access key id in the `aws.cloudtrail.user_identity.access_key_id` field which can help identify the precise user context. The user agent details in the `user_agent.original` field may also indicate what kind of a client made the request.\n- Consider the time of day. If the user is a human, not a program or script, did the activity take place during a normal time of day?\n- Examine the history of the command. If the command, which is visible in the `event.action field`, manifested only very recently, it might be part of a new automation module or script. If it has a consistent cadence - for example, if it appears in small numbers on a weekly or monthly cadence it might be part of a housekeeping or maintenance process.\n- Examine the request parameters. These may provide indications as to the source of the program or the nature of the tasks it is performing.","license":"Elastic License v2","output_index":".siem-signals-default","meta":{"from":"45m","kibana_siem_app_url":"https://cbbf317cf62e4dd9b9913c1cc96ca394.vpce.gdw55e.elastic-cloud.com:9243/app/security"},"author":["Elastic"],"false_positives":["New or unusual command and user geolocation activity can be due to manual troubleshooting or reconfiguration; changes in cloud automation scripts or workflows; adoption of new services; expansion into new regions; increased adoption of work from home policies; or users who travel frequently."],"from":"now-3600s","rule_id":"e3505ecc-dace-4c29-9c86-ea57c4793e45","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[],"to":"now","references":["https://www.elastic.co/guide/en/security/current/prebuilt-ml-jobs.html"],"version":4,"exceptions_list":[],"immutable":false,"type":"machine_learning","anomaly_threshold":50,"machine_learning_job_id":["rare_method_for_a_country"],"throttle":"no_actions","actions":[]}
{"id":"d3db5b61-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T16:00:34.205Z","updated_by":"admin","created_at":"2021-09-22T15:57:46.940Z","created_by":"admin","name":"[GD] Unusual Child Processes of RunDLL32","tags":["Defense Evasion","Elastic","Host","Threat Detection","Windows"],"interval":"5m","enabled":false,"description":"Identifies child processes of unusual instances of RunDLL32 where the command line parameters were suspicious. Misuse of RunDLL32 could indicate malicious activity.","risk_score":21,"severity":"high","license":"Elastic License v2","output_index":".siem-signals-default","meta":{"from":"4m"},"author":["Elastic"],"false_positives":[],"from":"now-540s","rule_id":"d8feaf7e-9a05-48ec-905f-faf2e5ff2676","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","technique":[{"reference":"https://attack.mitre.org/techniques/T1218/","name":"Signed Binary Proxy Execution","subtechnique":[{"reference":"https://attack.mitre.org/techniques/T1218/011/","name":"Rundll32","id":"T1218.011"}],"id":"T1218"}],"tactic":{"reference":"https://attack.mitre.org/tactics/TA0005/","name":"Defense Evasion","id":"TA0005"}}],"to":"now","references":[],"version":4,"exceptions_list":[],"immutable":false,"type":"eql","language":"eql","index":["windows-*"],"query":"sequence with maxspan=1h\n  [process where event.type in (\"start\", \"process_started\") and\n     (process.name : \"rundll32.exe\" or process.pe.original_file_name == \"RUNDLL32.EXE\") and\n      process.args_count == 1\n  ] by process.entity_id\n  [process where event.type in (\"start\", \"process_started\") and process.parent.name : \"rundll32.exe\"\n  ] by process.parent.entity_id\n","filters":[],"throttle":"no_actions","actions":[]}
{"id":"d646dd20-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T16:00:34.224Z","updated_by":"admin","created_at":"2021-09-22T15:57:50.921Z","created_by":"admin","name":"[GD] AWS IAM Password Recovery Requested","tags":["AWS","Cloud","Continuous Monitoring","Elastic","Identity and Access","SecOps"],"interval":"10m","enabled":false,"description":"Identifies AWS IAM password recovery requests. An adversary may attempt to gain unauthorized AWS access by abusing password recovery mechanisms.","risk_score":21,"severity":"low","note":"The AWS Filebeat module must be enabled to use this rule.","license":"Elastic License v2","output_index":".siem-signals-default","meta":{"from":"50m"},"timestamp_override":"event.ingested","author":["Elastic"],"false_positives":["Verify whether the user identity, user agent, and/or hostname should be requesting changes in your environment. Password reset attempts from unfamiliar users should be investigated. If known behavior is causing false positives, it can be exempted from the rule."],"from":"now-3600s","rule_id":"31263309-af8d-485b-813b-bcae80ff76f7","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","technique":[{"reference":"https://attack.mitre.org/techniques/T1078/","name":"Valid Accounts","subtechnique":[],"id":"T1078"}],"tactic":{"reference":"https://attack.mitre.org/tactics/TA0001/","name":"Initial Access","id":"TA0001"}}],"to":"now","references":["https://www.cadosecurity.com/2020/06/11/an-ongoing-aws-phishing-campaign/"],"version":5,"exceptions_list":[],"immutable":false,"type":"query","language":"kuery","index":["aws-cloudtrail-*","aws-config-*"],"query":"event.action:PasswordRecoveryRequested and event.provider:signin.amazonaws.com and event.outcome:success","filters":[],"throttle":"no_actions","actions":[]}
{"id":"d3d9d4c0-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T16:00:34.250Z","updated_by":"admin","created_at":"2021-09-22T15:57:46.907Z","created_by":"admin","name":"[GD] Windows CryptoAPI Spoofing Vulnerability (CVE-2020-0601 - CurveBall)","tags":["Defense Evasion","Elastic","Host","Threat Detection","Windows"],"interval":"5m","enabled":false,"description":"A spoofing vulnerability exists in the way Windows CryptoAPI (Crypt32.dll) validates Elliptic Curve Cryptography (ECC) certificates. An attacker could exploit the vulnerability by using a spoofed code-signing certificate to sign a malicious executable, making it appear the file was from a trusted, legitimate source.","risk_score":21,"severity":"low","license":"Elastic License v2","output_index":".siem-signals-default","meta":{"from":"1m"},"timestamp_override":"event.ingested","author":["Elastic"],"false_positives":[],"from":"now-360s","rule_id":"4d91bf77-8f03-44a2-9495-b68ce991de32","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","technique":[{"reference":"https://attack.mitre.org/techniques/T1553/","name":"Subvert Trust Controls","subtechnique":[{"reference":"https://attack.mitre.org/techniques/T1553/002/","name":"Code Signing","id":"T1553.002"}],"id":"T1553"}],"tactic":{"reference":"https://attack.mitre.org/tactics/TA0005/","name":"Defense Evasion","id":"TA0005"}}],"to":"now","references":[],"version":7,"exceptions_list":[],"immutable":false,"type":"query","language":"kuery","index":["windows-*"],"query":"event.provider:\"Microsoft-Windows-Audit-CVE\" and message:\"[CVE-2020-0601]\"","filters":[],"throttle":"no_actions","actions":[]}
{"id":"d832cea1-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T16:01:21.417Z","updated_by":"admin","created_at":"2021-09-22T15:57:53.951Z","created_by":"admin","name":"[GD] Threat Detected by Okta ThreatInsight","tags":["Continuous Monitoring","Elastic","Identity","Monitoring","Okta","SecOps"],"interval":"5m","enabled":false,"description":"Detects when Okta ThreatInsight identifies a request from a malicious IP address. Investigating requests from IP addresses identified as malicious by Okta ThreatInsight can help security teams monitor for and respond to credential based attacks against their organization, such as brute force and password spraying attacks.","risk_score":47,"severity":"medium","note":"The Okta Fleet integration or Filebeat module must be enabled to use this rule.","license":"Elastic License v2","output_index":".siem-signals-default","meta":{"from":"1m"},"timestamp_override":"event.ingested","author":["Elastic"],"false_positives":[],"from":"now-360s","rule_id":"728ca0c1-2d1d-47e4-b583-d4f7a165907d","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[],"to":"now","references":["https://developer.okta.com/docs/reference/api/system-log/","https://developer.okta.com/docs/reference/api/event-types/"],"version":7,"exceptions_list":[{"list_id":"783fe305-0c70-4cda-911a-05ad8b80a019","namespace_type":"single","id":"974f89e0-bdb3-11eb-9011-836fc96f7351","type":"detection"}],"immutable":false,"type":"query","language":"kuery","index":["okta-*"],"query":"event.dataset:okta.system and event.action:security.threat.detected","filters":[],"throttle":"no_actions","actions":[]}
{"id":"d82e13b1-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T16:01:21.427Z","updated_by":"admin","created_at":"2021-09-22T15:57:53.943Z","created_by":"admin","name":"[GD] Attempted Bypass of Okta MFA","tags":["Continuous Monitoring","Elastic","Identity","Identity and Access","Okta","SecOps"],"interval":"5m","enabled":false,"description":"Detects attempts to bypass Okta multi-factor authentication (MFA). An adversary may attempt to bypass the Okta MFA policies configured for an organization in order to obtain unauthorized access to an application.","risk_score":73,"severity":"high","note":"The Okta Fleet integration or Filebeat module must be enabled to use this rule.","license":"Elastic License v2","output_index":".siem-signals-default","meta":{"from":"1m"},"timestamp_override":"event.ingested","author":["Elastic"],"false_positives":[],"from":"now-360s","rule_id":"21576526-cd88-45e9-97ec-43b769d09abb","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","technique":[{"reference":"https://attack.mitre.org/techniques/T1111/","name":"Two-Factor Authentication Interception","subtechnique":[],"id":"T1111"}],"tactic":{"reference":"https://attack.mitre.org/tactics/TA0006/","name":"Credential Access","id":"TA0006"}}],"to":"now","references":["https://developer.okta.com/docs/reference/api/system-log/","https://developer.okta.com/docs/reference/api/event-types/"],"version":6,"exceptions_list":[],"immutable":false,"type":"query","language":"kuery","index":["okta-*"],"query":"event.dataset:okta.system and event.action:user.mfa.attempt_bypass","filters":[],"throttle":"no_actions","actions":[]}
{"id":"cd460610-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T15:57:34.850Z","updated_by":"admin","created_at":"2021-09-22T15:57:34.850Z","created_by":"admin","name":"Strace Process Activity [Duplicate]","tags":["Elastic","Host","Linux","Threat Detection"],"interval":"5m","enabled":false,"description":"Strace runs in a privileged context and can be used to escape restrictive environments by instantiating a shell in order to elevate privileges or move laterally.","risk_score":21,"severity":"low","license":"Elastic License v2","output_index":".siem-signals-default","timestamp_override":"event.ingested","author":["Elastic"],"false_positives":["Strace is a dual-use tool that can be used for benign or malicious activity. Some normal use of this command may originate from developers or SREs engaged in debugging or system call tracing."],"from":"now-9m","rule_id":"877a8909-14dd-4570-94a7-bfa00dd1b926","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[],"to":"now","references":["https://en.wikipedia.org/wiki/Strace"],"version":7,"exceptions_list":[],"immutable":false,"type":"query","language":"kuery","index":["auditbeat-*","logs-endpoint.events.*"],"query":"event.category:process and event.type:(start or process_started) and process.name:strace","throttle":"no_actions","actions":[]}
{"id":"cd45b7f0-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T15:59:11.900Z","updated_by":"admin","created_at":"2021-09-22T15:57:35.842Z","created_by":"admin","name":"[GD] Scheduled Task Created Shortly After Login Event","tags":["GD","POC","Windows"],"interval":"5m","enabled":false,"description":"Schtasks.exe is observed creating a new task within 5 minutes after a user logs in.","risk_score":73,"severity":"high","license":"","output_index":".siem-signals-default","meta":{"from":"1m","kibana_siem_app_url":"https://cbbf317cf62e4dd9b9913c1cc96ca394.vpce.gdw55e.elastic-cloud.com:9243/app/security"},"author":[],"false_positives":[],"from":"now-360s","rule_id":"19348b44-d424-4f39-8a48-2a08c94a00cd","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[],"to":"now","references":[],"version":1,"exceptions_list":[],"immutable":false,"type":"eql","language":"eql","index":["windows-*"],"query":"sequence by host.hostname with maxspan = 5m\n  [authentication where event.code : \"4624\"]\n  [process where process.name: \"*schtasks.exe\" and process.args: (\"-create\", \"/create\")]","filters":[],"throttle":"no_actions","actions":[]}
{"id":"cf8d5e00-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T15:57:38.732Z","updated_by":"admin","created_at":"2021-09-22T15:57:38.732Z","created_by":"admin","name":"Base64 Encoding/Decoding Activity [Duplicate]","tags":["Defense Evasion","Elastic","Host","Linux","Threat Detection"],"interval":"5m","enabled":false,"description":"Adversaries may encode/decode data in an attempt to evade detection by host- or network-based security controls.","risk_score":21,"severity":"low","license":"Elastic License v2","output_index":".siem-signals-default","timestamp_override":"event.ingested","author":["Elastic"],"false_positives":["Automated tools such as Jenkins may encode or decode files as part of their normal behavior. These events can be filtered by the process executable or username values."],"from":"now-9m","rule_id":"8f58be12-6f56-4d54-bdf4-4f24225fa31f","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0005","name":"Defense Evasion","reference":"https://attack.mitre.org/tactics/TA0005/"},"technique":[{"id":"T1140","name":"Deobfuscate/Decode Files or Information","reference":"https://attack.mitre.org/techniques/T1140/"},{"id":"T1027","name":"Obfuscated Files or Information","reference":"https://attack.mitre.org/techniques/T1027/"}]}],"to":"now","references":[],"version":7,"exceptions_list":[],"immutable":false,"type":"query","language":"kuery","index":["auditbeat-*","logs-endpoint.events.*"],"query":"event.category:process and event.type:(start or process_started) and process.name:(base64 or base64plain or base64url or base64mime or base64pem)","throttle":"no_actions","actions":[]}
{"id":"cf8d5e01-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T15:57:38.735Z","updated_by":"admin","created_at":"2021-09-22T15:57:38.735Z","created_by":"admin","name":"Unusual Windows User Privilege Elevation Activity [Duplicate]","tags":["Elastic","Host","ML","Threat Detection","Windows"],"interval":"15m","enabled":false,"description":"A machine learning job detected an unusual user context switch, using the runas command or similar techniques, which can indicate account takeover or privilege escalation using compromised accounts. Privilege elevation using tools like runas are more commonly used by domain and network administrators than by regular Windows users.","risk_score":21,"severity":"low","license":"Elastic License v2","output_index":".siem-signals-default","author":["Elastic"],"false_positives":["Uncommon user privilege elevation activity can be due to an administrator, help desk technician, or a user performing manual troubleshooting or reconfiguration."],"from":"now-45m","rule_id":"8afa9ef7-dc5c-4518-8d3a-093e6320287b","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[],"to":"now","references":["https://www.elastic.co/guide/en/security/current/prebuilt-ml-jobs.html"],"version":4,"exceptions_list":[],"immutable":false,"type":"machine_learning","anomaly_threshold":50,"machine_learning_job_id":["windows_rare_user_runas_event"],"throttle":"no_actions","actions":[]}
{"id":"cf8cc1c1-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T15:57:38.737Z","updated_by":"admin","created_at":"2021-09-22T15:57:38.737Z","created_by":"admin","name":"Socat Process Activity [Duplicate]","tags":["Elastic","Host","Linux","Threat Detection"],"interval":"5m","enabled":false,"description":"A Socat process is running on a Linux host. Socat is often used as a persistence mechanism by exporting a reverse shell, or by serving a shell on a listening port. Socat is also sometimes used for lateral movement.","risk_score":47,"severity":"medium","license":"Elastic License v2","output_index":".siem-signals-default","timestamp_override":"event.ingested","author":["Elastic"],"false_positives":["Socat is a dual-use tool that can be used for benign or malicious activity. Some normal use of this program, at varying levels of frequency, may originate from scripts, automation tools, and frameworks. Usage by web servers is more likely to be suspicious."],"from":"now-9m","rule_id":"fbbbdda8-be68-4cb1-97c3-8b32e3542ece","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[],"to":"now","references":["https://blog.ropnop.com/upgrading-simple-shells-to-fully-interactive-ttys/#method-2-using-socat"],"version":7,"exceptions_list":[],"immutable":false,"type":"query","language":"kuery","index":["auditbeat-*","logs-endpoint.events.*"],"query":"event.category:process and event.type:(start or process_started) and process.name:socat and not process.args:-V","throttle":"no_actions","actions":[]}
{"id":"d1ad7ee0-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T15:59:30.172Z","updated_by":"admin","created_at":"2021-09-22T15:57:42.879Z","created_by":"admin","name":"[GD] Suspicious Endpoint Security Parent Process","tags":["Defense Evasion","Elastic","Host","Threat Detection","Windows"],"interval":"5m","enabled":false,"description":"A suspicious Endpoint Security parent process was detected. This may indicate a process hollowing or other form of code injection.","risk_score":47,"severity":"medium","license":"Elastic License v2","output_index":".siem-signals-default","meta":{"from":"4m"},"timestamp_override":"event.ingested","author":["Elastic"],"false_positives":[],"from":"now-540s","rule_id":"e3b4b951-dda3-4ce3-ae32-74ec34c82f72","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","technique":[{"reference":"https://attack.mitre.org/techniques/T1036/","name":"Masquerading","subtechnique":[],"id":"T1036"}],"tactic":{"reference":"https://attack.mitre.org/tactics/TA0005/","name":"Defense Evasion","id":"TA0005"}}],"to":"now","references":[],"version":5,"exceptions_list":[],"immutable":false,"type":"eql","language":"eql","index":["windows-*"],"query":"process where event.type in (\"start\", \"process_started\", \"info\") and\n process.name : (\"esensor.exe\", \"elastic-endpoint.exe\") and\n process.parent.executable != null and\n  /* add FPs here */\n not process.parent.executable : (\"C:\\\\Program Files\\\\Elastic\\\\*\", \n                                  \"C:\\\\Windows\\\\System32\\\\services.exe\", \n                                  \"C:\\\\Windows\\\\System32\\\\WerFault*.exe\", \n                                  \"C:\\\\Windows\\\\System32\\\\wermgr.exe\")\n","filters":[],"throttle":"no_actions","actions":[]}
{"id":"cd7d69c0-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T15:57:35.211Z","updated_by":"admin","created_at":"2021-09-22T15:57:35.211Z","created_by":"admin","name":"Unusual Linux Network Connection Discovery [Duplicate]","tags":["Elastic","Host","Linux","ML","Threat Detection"],"interval":"15m","enabled":false,"description":"Looks for commands related to system network connection discovery from an unusual user context. This can be due to uncommon troubleshooting activity or due to a compromised account. A compromised account may be used by a threat actor to engage in system network connection discovery in order to increase their understanding of connected services and systems. This information may be used to shape follow-up behaviors such as lateral movement or additional discovery.","risk_score":21,"severity":"low","license":"Elastic License v2","output_index":".siem-signals-default","author":["Elastic"],"false_positives":["Uncommon user command activity can be due to an engineer logging onto a server instance in order to perform manual troubleshooting or reconfiguration."],"from":"now-45m","rule_id":"81279a20-3706-41d8-ac1c-45b1543db81f","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0007","name":"Discovery","reference":"https://attack.mitre.org/tactics/TA0007/"},"technique":[{"id":"T1049","name":"System Network Connections Discovery","reference":"https://attack.mitre.org/techniques/T1049/"}]}],"to":"now","references":[],"version":2,"exceptions_list":[],"immutable":false,"type":"machine_learning","anomaly_threshold":25,"machine_learning_job_id":["linux_network_connection_discovery"],"throttle":"no_actions","actions":[]}
{"id":"d1b2af00-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T15:59:30.214Z","updated_by":"admin","created_at":"2021-09-22T15:57:42.891Z","created_by":"admin","name":"[GD] Suspicious WMI Image Load from MS Office","tags":["Elastic","Execution","Host","Threat Detection","Windows"],"interval":"5m","enabled":false,"description":"Identifies a suspicious image load (wmiutils.dll) from Microsoft Office processes. This behavior may indicate adversarial activity where child processes are spawned via Windows Management Instrumentation (WMI). This technique can be used to execute code and evade traditional parent/child processes spawned from MS Office products.","risk_score":21,"severity":"low","license":"Elastic License v2","output_index":".siem-signals-default","meta":{"from":"4m"},"timestamp_override":"event.ingested","author":["Elastic"],"false_positives":[],"from":"now-540s","rule_id":"da362591-585a-4557-a4d1-db2f9faba9f6","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","technique":[{"reference":"https://attack.mitre.org/techniques/T1047/","name":"Windows Management Instrumentation","subtechnique":[],"id":"T1047"}],"tactic":{"reference":"https://attack.mitre.org/tactics/TA0002/","name":"Execution","id":"TA0002"}}],"to":"now","references":["https://medium.com/threatpunter/detecting-adversary-tradecraft-with-image-load-event-logging-and-eql-8de93338c16"],"version":4,"exceptions_list":[],"immutable":false,"type":"eql","language":"eql","index":["windows-*"],"query":"library where process.name : (\"WINWORD.EXE\", \"EXCEL.EXE\", \"POWERPNT.EXE\", \"MSPUB.EXE\", \"MSACCESS.EXE\") and\n  event.action : \"load\" and\n  event.category : \"library\" and\n  dll.name : \"wmiutils.dll\"\n","filters":[],"throttle":"no_actions","actions":[]}
{"id":"cd824bc1-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T15:57:35.237Z","updated_by":"admin","created_at":"2021-09-22T15:57:35.237Z","created_by":"admin","name":"Anomalous Linux Compiler Activity [Duplicate]","tags":["Elastic","Host","Linux","ML","Threat Detection"],"interval":"15m","enabled":false,"description":"Looks for compiler activity by a user context which does not normally run compilers. This can be the result of ad-hoc software changes or unauthorized software deployment. This can also be due to local privilege elevation via locally run exploits or malware activity.","risk_score":21,"severity":"low","license":"Elastic License v2","output_index":".siem-signals-default","author":["Elastic"],"false_positives":["Uncommon compiler activity can be due to an engineer running a local build on a prod or staging instance in the course of troubleshooting or fixing a software issue."],"from":"now-45m","rule_id":"2580b8e2-4921-4a6b-89fe-83251bac388d","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[],"to":"now","references":[],"version":2,"exceptions_list":[],"immutable":false,"type":"machine_learning","anomaly_threshold":50,"machine_learning_job_id":["linux_rare_user_compiler"],"throttle":"no_actions","actions":[]}
{"id":"d3d0d410-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T15:59:47.301Z","updated_by":"admin","created_at":"2021-09-22T15:57:46.753Z","created_by":"admin","name":"[GD] PsExec Network Connection","tags":["Elastic","Execution","Host","Threat Detection","Windows"],"interval":"5m","enabled":false,"description":"Identifies use of the SysInternals tool PsExec.exe making a network connection. This could be an indication of lateral movement.","risk_score":21,"severity":"low","license":"Elastic License v2","output_index":".siem-signals-default","meta":{"from":"4m"},"author":["Elastic"],"false_positives":["PsExec is a dual-use tool that can be used for benign or malicious activity. It's important to baseline your environment to determine the amount of noise to expect from this tool."],"from":"now-540s","rule_id":"26d0a58b-4099-4333-b26e-10162f40b6bd","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","technique":[{"reference":"https://attack.mitre.org/techniques/T1569/","name":"System Services","subtechnique":[{"reference":"https://attack.mitre.org/techniques/T1569/002/","name":"Service Execution","id":"T1569.002"}],"id":"T1569"}],"tactic":{"reference":"https://attack.mitre.org/tactics/TA0002/","name":"Execution","id":"TA0002"}},{"framework":"MITRE ATT&CK","technique":[],"tactic":{"reference":"https://attack.mitre.org/tactics/TA0008/","name":"Lateral Movement","id":"TA0008"}}],"to":"now","references":[],"version":8,"exceptions_list":[],"immutable":false,"type":"eql","language":"eql","index":["windows-*"],"query":"sequence by process.entity_id\n  [process where process.name : \"PsExec.exe\" and event.type == \"start\"]\n  [network where process.name : \"PsExec.exe\"]\n","filters":[],"throttle":"no_actions","actions":[]}
{"id":"cd4a4bd0-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T15:57:34.894Z","updated_by":"admin","created_at":"2021-09-22T15:57:34.894Z","created_by":"admin","name":"Auditd Max Login Sessions [Duplicate]","tags":["Elastic","Host","Initial Access","Linux","Threat Detection"],"interval":"5m","enabled":false,"description":"Identifies that the maximum number login sessions has been reached for a user.","risk_score":47,"severity":"medium","license":"Elastic License v2","output_index":".siem-signals-default","timestamp_override":"event.ingested","author":["Elastic"],"false_positives":[],"from":"now-6m","rule_id":"f1e290ba-0755-43f9-9476-7483dde51a53","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0001","name":"Initial Access","reference":"https://attack.mitre.org/tactics/TA0001/"},"technique":[{"id":"T1078","name":"Valid Accounts","reference":"https://attack.mitre.org/techniques/T1078/"}]},{"framework":"MITRE ATT&CK","tactic":{"id":"TA0003","name":"Persistence","reference":"https://attack.mitre.org/tactics/TA0003/"},"technique":[{"id":"T1078","name":"Valid Accounts","reference":"https://attack.mitre.org/techniques/T1078/"}]}],"to":"now","references":["https://github.com/linux-pam/linux-pam/blob/70c32cc6fca51338f92afa58eb75b1107a5c2430/modules/pam_limits/pam_limits.c#L1007"],"version":1,"exceptions_list":[],"immutable":false,"type":"query","language":"kuery","index":["auditbeat-*"],"query":"event.module:auditd and event.action:\"opened-too-many-sessions-to\"","throttle":"no_actions","actions":[]}
{"id":"d6488ad1-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T16:00:33.831Z","updated_by":"admin","created_at":"2021-09-22T15:57:50.933Z","created_by":"admin","name":"[GD] AWS CloudWatch Log Stream Deletion","tags":["AWS","Cloud","Continuous Monitoring","Elastic","Log Auditing","SecOps"],"interval":"10m","enabled":false,"description":"Identifies the deletion of an AWS CloudWatch log stream, which permanently deletes all associated archived log events with the stream.","risk_score":47,"severity":"medium","note":"The AWS Filebeat module must be enabled to use this rule.","license":"Elastic License v2","output_index":".siem-signals-default","meta":{"from":"50m"},"timestamp_override":"event.ingested","author":["Elastic"],"false_positives":["A log stream may be deleted by a system administrator. Verify whether the user identity, user agent, and/or hostname should be making changes in your environment. Log stream deletions from unfamiliar users or hosts should be investigated. If known behavior is causing false positives, it can be exempted from the rule."],"from":"now-3600s","rule_id":"662a3c1d-9032-4ac8-9b70-94e590ae4659","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","technique":[{"reference":"https://attack.mitre.org/techniques/T1485/","name":"Data Destruction","subtechnique":[],"id":"T1485"}],"tactic":{"reference":"https://attack.mitre.org/tactics/TA0040/","name":"Impact","id":"TA0040"}},{"framework":"MITRE ATT&CK","technique":[{"reference":"https://attack.mitre.org/techniques/T1562/","name":"Impair Defenses","subtechnique":[{"reference":"https://attack.mitre.org/techniques/T1562/001/","name":"Disable or Modify Tools","id":"T1562.001"}],"id":"T1562"}],"tactic":{"reference":"https://attack.mitre.org/tactics/TA0005/","name":"Defense Evasion","id":"TA0005"}}],"to":"now","references":["https://awscli.amazonaws.com/v2/documentation/api/latest/reference/logs/delete-log-stream.html","https://docs.aws.amazon.com/AmazonCloudWatchLogs/latest/APIReference/API_DeleteLogStream.html"],"version":6,"exceptions_list":[],"immutable":false,"type":"query","language":"kuery","index":["aws-cloudtrail-*","aws-config-*"],"query":"event.action:DeleteLogStream and event.dataset:aws.cloudtrail and event.provider:logs.amazonaws.com and event.outcome:success","filters":[],"throttle":"no_actions","actions":[]}
{"id":"d3d93880-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T16:00:33.889Z","updated_by":"admin","created_at":"2021-09-22T15:57:46.923Z","created_by":"admin","name":"[GD] Command Shell Activity Started via RunDLL32","tags":["Elastic","Execution","Host","Threat Detection","Windows"],"interval":"5m","enabled":false,"description":"Identifies command shell activity started via RunDLL32, which is commonly abused by attackers to host malicious code.","risk_score":21,"severity":"low","license":"Elastic License v2","output_index":".siem-signals-default","meta":{"from":"4m"},"timestamp_override":"event.ingested","author":["Elastic"],"false_positives":[],"from":"now-540s","rule_id":"6e0ec5b2-cfae-49e3-9936-a405ddf9f8dc","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","technique":[{"reference":"https://attack.mitre.org/techniques/T1059/","name":"Command and Scripting Interpreter","subtechnique":[{"reference":"https://attack.mitre.org/techniques/T1059/001/","name":"PowerShell","id":"T1059.001"}],"id":"T1059"}],"tactic":{"reference":"https://attack.mitre.org/tactics/TA0002/","name":"Execution","id":"TA0002"}}],"to":"now","references":[],"version":4,"exceptions_list":[],"immutable":false,"type":"eql","language":"eql","index":["windows-*"],"query":"process where event.type in (\"start\", \"process_started\") and\n process.name : (\"cmd.exe\", \"powershell.exe\") and\n  process.parent.name : \"rundll32.exe\" and \n  /* common FPs can be added here */\n  not process.parent.args : \"C:\\\\Windows\\\\System32\\\\SHELL32.dll,RunAsNewUser_RunDLL\"\n","filters":[],"throttle":"no_actions","actions":[]}
{"id":"cf8ac5f1-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T15:57:38.668Z","updated_by":"admin","created_at":"2021-09-22T15:57:38.668Z","created_by":"admin","name":"System Log File Deletion [Duplicate]","tags":["Defense Evasion","Elastic","Host","Linux","Threat Detection"],"interval":"5m","enabled":false,"description":"Identifies the deletion of sensitive Linux system logs. This may indicate an attempt to evade detection or destroy forensic evidence on a system.","risk_score":47,"severity":"medium","license":"Elastic License v2","output_index":".siem-signals-default","timestamp_override":"event.ingested","author":["Elastic"],"false_positives":[],"from":"now-9m","rule_id":"26502433-d474-4eef-8f7e-67156239272e","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0005","name":"Defense Evasion","reference":"https://attack.mitre.org/tactics/TA0005/"},"technique":[{"id":"T1070","name":"Indicator Removal on Host","reference":"https://attack.mitre.org/techniques/T1070/"}]}],"to":"now","references":["https://www.fireeye.com/blog/threat-research/2020/11/live-off-the-land-an-overview-of-unc1945.html"],"version":3,"exceptions_list":[],"immutable":false,"type":"eql","language":"eql","index":["auditbeat-*","logs-endpoint.events.*"],"query":"file where event.type == \"deletion\" and \n  file.path : \n    (\n    \"/var/run/utmp\", \n    \"/var/log/wtmp\", \n    \"/var/log/btmp\", \n    \"/var/log/lastlog\", \n    \"/var/log/faillog\",\n    \"/var/log/syslog\", \n    \"/var/log/messages\", \n    \"/var/log/secure\", \n    \"/var/log/auth.log\"\n    )\n","throttle":"no_actions","actions":[]}
{"id":"cd49d6a0-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T15:57:34.871Z","updated_by":"admin","created_at":"2021-09-22T15:57:34.871Z","created_by":"admin","name":"Base16 or Base32 Encoding/Decoding Activity [Duplicate]","tags":["Defense Evasion","Elastic","Host","Linux","Threat Detection"],"interval":"5m","enabled":false,"description":"Adversaries may encode/decode data in an attempt to evade detection by host- or network-based security controls.","risk_score":21,"severity":"low","license":"Elastic License v2","output_index":".siem-signals-default","timestamp_override":"event.ingested","author":["Elastic"],"false_positives":["Automated tools such as Jenkins may encode or decode files as part of their normal behavior. These events can be filtered by the process executable or username values."],"from":"now-9m","rule_id":"04c7c017-2651-4274-83f3-f8aea00780d9","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0005","name":"Defense Evasion","reference":"https://attack.mitre.org/tactics/TA0005/"},"technique":[{"id":"T1140","name":"Deobfuscate/Decode Files or Information","reference":"https://attack.mitre.org/techniques/T1140/"},{"id":"T1027","name":"Obfuscated Files or Information","reference":"https://attack.mitre.org/techniques/T1027/"}]}],"to":"now","references":[],"version":7,"exceptions_list":[],"immutable":false,"type":"query","language":"kuery","index":["auditbeat-*","logs-endpoint.events.*"],"query":"event.category:process and event.type:(start or process_started) and process.name:(base16 or base32 or base32plain or base32hex)","throttle":"no_actions","actions":[]}
{"id":"cd498880-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T15:57:34.869Z","updated_by":"admin","created_at":"2021-09-22T15:57:34.869Z","created_by":"admin","name":"Connection to Internal Network via Telnet [Duplicate]","tags":["Elastic","Host","Lateral Movement","Linux","Threat Detection"],"interval":"5m","enabled":false,"description":"Telnet provides a command line interface for communication with a remote device or server. This rule identifies Telnet network connections to non-publicly routable IP addresses.","risk_score":47,"severity":"medium","license":"Elastic License v2","output_index":".siem-signals-default","author":["Elastic"],"false_positives":["Telnet can be used for both benign or malicious purposes. Telnet is included by default in some Linux distributions, so its presence is not inherently suspicious. The use of Telnet to manage devices remotely has declined in recent years in favor of more secure protocols such as SSH. Telnet usage by non-automated tools or frameworks may be suspicious."],"from":"now-9m","rule_id":"b4bc257d-0c9f-4daa-99ca-773c0127184c","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0008","name":"Lateral Movement","reference":"https://attack.mitre.org/tactics/TA0008/"},"technique":[{"id":"T1021","name":"Remote Services","reference":"https://attack.mitre.org/techniques/T1021/"}]}],"to":"now","references":[],"version":5,"exceptions_list":[],"immutable":false,"type":"eql","language":"eql","index":["auditbeat-*","logs-endpoint.events.*"],"query":"sequence by process.entity_id\n  [process where process.name == \"telnet\" and event.type == \"start\"]\n  [network where process.name == \"telnet\" and\n    cidrmatch(destination.ip, \"10.0.0.0/8\", \"172.16.0.0/12\", \"192.168.0.0/16\", \"FE80::/10\") and\n    not cidrmatch(destination.ip, \"127.0.0.0/8\", \"::1/128\")]\n","throttle":"no_actions","actions":[]}
{"id":"d82eaff1-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T16:01:21.480Z","updated_by":"admin","created_at":"2021-09-22T15:57:53.959Z","created_by":"admin","name":"[GD] Attempt to Modify an Okta Policy Rule","tags":["Continuous Monitoring","Elastic","Identity","Identity and Access","Okta","SecOps"],"interval":"5m","enabled":false,"description":"Detects attempts to modify a rule within an Okta policy. An adversary may attempt to modify an Okta policy rule in order to weaken an organization's security controls.","risk_score":21,"severity":"low","note":"The Okta Fleet integration or Filebeat module must be enabled to use this rule.","license":"Elastic License v2","output_index":".siem-signals-default","meta":{"from":"1m"},"timestamp_override":"event.ingested","author":["Elastic"],"false_positives":["Consider adding exceptions to this rule to filter false positives if Okta MFA rules are regularly modified in your organization."],"from":"now-360s","rule_id":"ece75c85-30da-4257-a827-a0081f338d2d","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[],"to":"now","references":["https://help.okta.com/en/prod/Content/Topics/Security/Security_Policies.htm","https://developer.okta.com/docs/reference/api/system-log/","https://developer.okta.com/docs/reference/api/event-types/"],"version":6,"exceptions_list":[],"immutable":false,"type":"query","language":"kuery","index":["okta-*"],"query":"event.dataset:okta.system and event.action:policy.rule.update","filters":[],"throttle":"no_actions","actions":[]}
{"id":"cf8b6232-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T15:57:38.694Z","updated_by":"admin","created_at":"2021-09-22T15:57:38.694Z","created_by":"admin","name":"EggShell Backdoor Execution [Duplicate]","tags":["Elastic","Execution","Host","Linux","macOS","Threat Detection"],"interval":"5m","enabled":false,"description":"Identifies the execution of and EggShell Backdoor. EggShell is a known post exploitation tool for macOS and Linux.","risk_score":73,"severity":"high","license":"Elastic License v2","output_index":".siem-signals-default","timestamp_override":"event.ingested","author":["Elastic"],"false_positives":[],"from":"now-9m","rule_id":"3a64bedc-7cb8-4541-a17b-d8ae98244252","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[],"to":"now","references":["https://github.com/neoneggplant/EggShell"],"version":1,"exceptions_list":[],"immutable":false,"type":"query","language":"kuery","index":["auditbeat-*","logs-endpoint.events.*"],"query":"event.category:process and event.type:(start or process_started) and process.name:espl and process.args:eyJkZWJ1ZyI6*","throttle":"no_actions","actions":[]}
{"id":"cd4a24c1-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T15:57:34.875Z","updated_by":"admin","created_at":"2021-09-22T15:57:34.875Z","created_by":"admin","name":"Auditd Login Attempt at Forbidden Time [Duplicate]","tags":["Elastic","Host","Initial Access","Linux","Threat Detection"],"interval":"5m","enabled":false,"description":"Identifies that a login attempt occurred at a forbidden time.","risk_score":47,"severity":"medium","license":"Elastic License v2","output_index":".siem-signals-default","timestamp_override":"event.ingested","author":["Elastic"],"false_positives":[],"from":"now-6m","rule_id":"489c6cb0-b8ee-4fc9-98ea-ec8f489cba24","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0001","name":"Initial Access","reference":"https://attack.mitre.org/tactics/TA0001/"},"technique":[{"id":"T1078","name":"Valid Accounts","reference":"https://attack.mitre.org/techniques/T1078/"}]},{"framework":"MITRE ATT&CK","tactic":{"id":"TA0003","name":"Persistence","reference":"https://attack.mitre.org/tactics/TA0003/"},"technique":[{"id":"T1078","name":"Valid Accounts","reference":"https://attack.mitre.org/techniques/T1078/"}]}],"to":"now","references":["https://github.com/linux-pam/linux-pam/blob/aac5a8fdc4aa3f7e56335a6343774cc1b63b408d/modules/pam_time/pam_time.c#L666"],"version":1,"exceptions_list":[],"immutable":false,"type":"query","language":"kuery","index":["auditbeat-*"],"query":"event.module:auditd and event.action:\"attempted-log-in-during-unusual-hour-to\"","throttle":"no_actions","actions":[]}
{"id":"cd4b3630-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T15:57:34.880Z","updated_by":"admin","created_at":"2021-09-22T15:57:34.880Z","created_by":"admin","name":"Nmap Process Activity [Duplicate]","tags":["Elastic","Host","Linux","Threat Detection"],"interval":"5m","enabled":false,"description":"Nmap was executed on a Linux host. Nmap is a FOSS tool for network scanning and security testing. It can map and discover networks, and identify listening services and operating systems. It is sometimes used to gather information in support of exploitation, execution or lateral movement.","risk_score":21,"severity":"low","license":"Elastic License v2","output_index":".siem-signals-default","timestamp_override":"event.ingested","author":["Elastic"],"false_positives":["Security testing tools and frameworks may run `Nmap` in the course of security auditing. Some normal use of this command may originate from security engineers and network or server administrators. Use of nmap by ordinary users is uncommon."],"from":"now-9m","rule_id":"01a59f4e-b715-4b63-8a93-2c2993c326b0","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[],"to":"now","references":["https://en.wikipedia.org/wiki/Nmap"],"version":7,"exceptions_list":[],"immutable":false,"type":"query","language":"kuery","index":["auditbeat-*","logs-endpoint.events.*"],"query":"event.category:process and event.type:(start or process_started) and process.name:nmap","throttle":"no_actions","actions":[]}
{"id":"d1b212c0-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T16:00:33.915Z","updated_by":"admin","created_at":"2021-09-22T15:57:42.864Z","created_by":"admin","name":"[GD] Windows Script Interpreter Executing Process via WMI","tags":["Elastic","Host","Initial Access","Threat Detection","Windows"],"interval":"5m","enabled":false,"description":"Identifies use of the built-in Windows script interpreters (cscript.exe or wscript.exe) being used to execute a process via Windows Management Instrumentation (WMI). This may be indicative of malicious activity.","risk_score":47,"severity":"medium","license":"Elastic License v2","output_index":".siem-signals-default","meta":{"from":"4m"},"author":["Elastic"],"false_positives":[],"from":"now-540s","rule_id":"69d2f05e-8eff-4846-83d0-e97af7a67ca8","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","technique":[{"reference":"https://attack.mitre.org/techniques/T1566/","name":"Phishing","subtechnique":[{"reference":"https://attack.mitre.org/techniques/T1566/001/","name":"Spearphishing Attachment","id":"T1566.001"}],"id":"T1566"}],"tactic":{"reference":"https://attack.mitre.org/tactics/TA0001/","name":"Initial Access","id":"TA0001"}}],"to":"now","references":[],"version":3,"exceptions_list":[],"immutable":false,"type":"eql","language":"eql","index":["windows-*"],"query":"sequence by host.id with maxspan = 5s\n    [library where dll.name : \"wmiutils.dll\" and process.name : (\"wscript.exe\", \"cscript.exe\")]\n    [process where event.type in (\"start\", \"process_started\") and\n     process.parent.name : \"wmiprvse.exe\" and\n     user.domain != \"NT AUTHORITY\" and\n     (process.pe.original_file_name :\n        (\n          \"cscript.exe\",\n          \"wscript.exe\",\n          \"PowerShell.EXE\",\n          \"Cmd.Exe\",\n          \"MSHTA.EXE\",\n          \"RUNDLL32.EXE\",\n          \"REGSVR32.EXE\",\n          \"MSBuild.exe\",\n          \"InstallUtil.exe\",\n          \"RegAsm.exe\",\n          \"RegSvcs.exe\",\n          \"msxsl.exe\",\n          \"CONTROL.EXE\",\n          \"EXPLORER.EXE\",\n          \"Microsoft.Workflow.Compiler.exe\",\n          \"msiexec.exe\"\n        ) or\n      process.executable : (\"C:\\\\Users\\\\*.exe\", \"C:\\\\ProgramData\\\\*.exe\")\n     )\n    ]\n","filters":[],"throttle":"no_actions","actions":[]}
{"id":"d82f2520-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T16:01:21.546Z","updated_by":"admin","created_at":"2021-09-22T15:57:53.954Z","created_by":"admin","name":"[GD] Attempt to Modify an Okta Policy","tags":["Continuous Monitoring","Elastic","Identity","Monitoring","Okta","SecOps"],"interval":"5m","enabled":false,"description":"Detects attempts to modify an Okta policy. An adversary may attempt to modify an Okta policy in order to weaken an organization's security controls. For example, an adversary may attempt to modify an Okta multi-factor authentication (MFA) policy in order to weaken the authentication requirements for user accounts.","risk_score":21,"severity":"low","note":"The Okta Fleet integration or Filebeat module must be enabled to use this rule.","license":"Elastic License v2","output_index":".siem-signals-default","meta":{"from":"1m"},"timestamp_override":"event.ingested","author":["Elastic"],"false_positives":["Consider adding exceptions to this rule to filter false positives if Okta policies are regularly modified in your organization."],"from":"now-360s","rule_id":"734712c3-1be7-40bf-8efb-c4981ca9437a","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[],"to":"now","references":["https://developer.okta.com/docs/reference/api/system-log/","https://developer.okta.com/docs/reference/api/event-types/"],"version":6,"exceptions_list":[],"immutable":false,"type":"query","language":"kuery","index":["okta-*"],"query":"event.dataset:okta.system and event.action:policy.lifecycle.update","filters":[],"throttle":"no_actions","actions":[]}
{"id":"d82d9e80-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T16:01:21.584Z","updated_by":"admin","created_at":"2021-09-22T15:57:53.943Z","created_by":"admin","name":"[GD] AWS CloudTrail Log Suspended","tags":["AWS","Cloud","Continuous Monitoring","Elastic","Log Auditing","SecOps"],"interval":"10m","enabled":false,"description":"Identifies suspending the recording of AWS API calls and log file delivery for the specified trail. An adversary may suspend trails in an attempt to evade defenses.","risk_score":47,"severity":"medium","note":"The AWS Filebeat module must be enabled to use this rule.","license":"Elastic License v2","output_index":".siem-signals-default","meta":{"from":"50m"},"timestamp_override":"event.ingested","author":["Elastic"],"false_positives":["Suspending the recording of a trail may be done by a system or network administrator. Verify whether the user identity, user agent, and/or hostname should be making changes in your environment. Trail suspensions from unfamiliar users or hosts should be investigated. If known behavior is causing false positives, it can be exempted from the rule."],"from":"now-3600s","rule_id":"b87fbf65-67d5-42f9-8a2d-5a2877f4aefd","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","technique":[{"reference":"https://attack.mitre.org/techniques/T1562/","name":"Impair Defenses","subtechnique":[{"reference":"https://attack.mitre.org/techniques/T1562/001/","name":"Disable or Modify Tools","id":"T1562.001"}],"id":"T1562"}],"tactic":{"reference":"https://attack.mitre.org/tactics/TA0005/","name":"Defense Evasion","id":"TA0005"}}],"to":"now","references":["https://docs.aws.amazon.com/awscloudtrail/latest/APIReference/API_StopLogging.html","https://awscli.amazonaws.com/v2/documentation/api/latest/reference/cloudtrail/stop-logging.html"],"version":6,"exceptions_list":[],"immutable":false,"type":"query","language":"kuery","index":["aws-config-*","aws-cloudtrail-*"],"query":"event.action:StopLogging and event.dataset:aws.cloudtrail and event.provider:cloudtrail.amazonaws.com and event.outcome:success","filters":[],"throttle":"no_actions","actions":[]}
{"id":"cd4b8450-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T15:57:34.885Z","updated_by":"admin","created_at":"2021-09-22T15:57:34.885Z","created_by":"admin","name":"Virtual Machine Fingerprinting [Duplicate]","tags":["Discovery","Elastic","Host","Linux","Threat Detection"],"interval":"5m","enabled":false,"description":"An adversary may attempt to get detailed information about the operating system and hardware. This rule identifies common locations used to discover virtual machine hardware by a non-root user. This technique has been used by the Pupy RAT and other malware.","risk_score":73,"severity":"high","license":"Elastic License v2","output_index":".siem-signals-default","timestamp_override":"event.ingested","author":["Elastic"],"false_positives":["Certain tools or automated software may enumerate hardware information. These tools can be exempted via user name or process arguments to eliminate potential noise."],"from":"now-9m","rule_id":"d84ec33c-76ee-4965-abc3-4753f94c72b2","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0007","name":"Discovery","reference":"https://attack.mitre.org/tactics/TA0007/"},"technique":[{"id":"T1082","name":"System Information Discovery","reference":"https://attack.mitre.org/techniques/T1082/"}]}],"to":"now","references":[],"version":6,"exceptions_list":[],"immutable":false,"type":"query","language":"kuery","index":["auditbeat-*","logs-endpoint.events.*"],"query":"event.category:process and event.type:(start or process_started) and process.args:(\"/sys/class/dmi/id/bios_version\" or \"/sys/class/dmi/id/product_name\" or \"/sys/class/dmi/id/chassis_vendor\" or \"/proc/scsi/scsi\" or \"/proc/ide/hd0/model\") and not user.name:root","throttle":"no_actions","actions":[]}
{"id":"d82d7770-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T16:01:21.408Z","updated_by":"admin","created_at":"2021-09-22T15:57:53.952Z","created_by":"admin","name":"[GD] AWS S3 Bucket Configuration Deletion ","tags":["Asset Visibility","AWS","Cloud","Continuous Monitoring","Elastic","SecOps"],"interval":"10m","enabled":false,"description":"Identifies the deletion of various Amazon Simple Storage Service (S3) bucket configuration components.","risk_score":21,"severity":"low","note":"The AWS Filebeat module must be enabled to use this rule.","license":"Elastic License v2","output_index":".siem-signals-default","meta":{"from":"50m"},"timestamp_override":"event.ingested","author":["Elastic"],"false_positives":["Bucket components may be deleted by a system or network administrator. Verify whether the user identity, user agent, and/or hostname should be making changes in your environment. Bucket component deletions from unfamiliar users or hosts should be investigated. If known behavior is causing false positives, it can be exempted from the rule."],"from":"now-3600s","rule_id":"68dc42ce-be10-46bf-ba85-d32cb3dd5aaf","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","technique":[{"reference":"https://attack.mitre.org/techniques/T1070/","name":"Indicator Removal on Host","subtechnique":[],"id":"T1070"}],"tactic":{"reference":"https://attack.mitre.org/tactics/TA0005/","name":"Defense Evasion","id":"TA0005"}}],"to":"now","references":["https://docs.aws.amazon.com/AmazonS3/latest/API/API_DeleteBucketPolicy.html","https://docs.aws.amazon.com/AmazonS3/latest/API/API_DeleteBucketReplication.html","https://docs.aws.amazon.com/AmazonS3/latest/API/API_DeleteBucketCors.html","https://docs.aws.amazon.com/AmazonS3/latest/API/API_DeleteBucketEncryption.html","https://docs.aws.amazon.com/AmazonS3/latest/API/API_DeleteBucketLifecycle.html"],"version":5,"exceptions_list":[],"immutable":false,"type":"query","language":"kuery","index":["aws-cloudtrail-*","aws-config-*"],"query":"event.action:(DeleteBucketPolicy or DeleteBucketReplication or DeleteBucketCors or DeleteBucketEncryption or DeleteBucketLifecycle) and event.dataset:aws.cloudtrail and event.provider:s3.amazonaws.com and event.outcome:success","filters":[],"throttle":"no_actions","actions":[]}
{"id":"d82a1c10-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T16:01:21.444Z","updated_by":"admin","created_at":"2021-09-22T15:57:53.948Z","created_by":"admin","name":"[GD] AWS EC2 Encryption Disabled","tags":["AWS","Cloud","Continuous Monitoring","Data Protection","Elastic","SecOps"],"interval":"10m","enabled":false,"description":"Identifies disabling of Amazon Elastic Block Store (EBS) encryption by default in the current region. Disabling encryption by default does not change the encryption status of your existing volumes.","risk_score":47,"severity":"medium","note":"The AWS Filebeat module must be enabled to use this rule.","license":"Elastic License v2","output_index":".siem-signals-default","meta":{"from":"50m"},"timestamp_override":"event.ingested","author":["Elastic"],"false_positives":["Disabling encryption may be done by a system or network administrator. Verify whether the user identity, user agent, and/or hostname should be making changes in your environment. Disabling encryption by unfamiliar users or hosts should be investigated. If known behavior is causing false positives, it can be exempted from the rule."],"from":"now-3600s","rule_id":"9b550717-aeba-4c56-a5b4-4f61818e14c9","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","technique":[{"reference":"https://attack.mitre.org/techniques/T1565/","name":"Data Manipulation","subtechnique":[{"reference":"https://attack.mitre.org/techniques/T1565/001/","name":"Stored Data Manipulation","id":"T1565.001"}],"id":"T1565"}],"tactic":{"reference":"https://attack.mitre.org/tactics/TA0040/","name":"Impact","id":"TA0040"}}],"to":"now","references":["https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/EBSEncryption.html","https://awscli.amazonaws.com/v2/documentation/api/latest/reference/ec2/disable-ebs-encryption-by-default.html","https://docs.aws.amazon.com/AWSEC2/latest/APIReference/API_DisableEbsEncryptionByDefault.html"],"version":7,"exceptions_list":[],"immutable":false,"type":"query","language":"kuery","index":["aws-cloudtrail-*","aws-config-*"],"query":"event.action:DisableEbsEncryptionByDefault and event.dataset:aws.cloudtrail and event.provider:ec2.amazonaws.com and event.outcome:success","filters":[],"throttle":"no_actions","actions":[]}
{"id":"d1b59531-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T16:00:34.135Z","updated_by":"admin","created_at":"2021-09-22T15:57:42.871Z","created_by":"admin","name":"[GD] Unusual Process Execution Path - Alternate Data Stream","tags":["Defense Evasion","Elastic","Host","Threat Detection","Windows"],"interval":"5m","enabled":false,"description":"Identifies processes running from an Alternate Data Stream. This is uncommon for legitimate processes and sometimes done by adversaries to hide malware.","risk_score":47,"severity":"medium","license":"Elastic License v2","output_index":".siem-signals-default","meta":{"from":"4m"},"timestamp_override":"event.ingested","author":["Elastic"],"false_positives":[],"from":"now-540s","rule_id":"1cfdd722-a538-4b1e-95d9-42d84a73e10b","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","technique":[{"reference":"https://attack.mitre.org/techniques/T1564/","name":"Hide Artifacts","subtechnique":[],"id":"T1564"}],"tactic":{"reference":"https://attack.mitre.org/tactics/TA0005/","name":"Defense Evasion","id":"TA0005"}}],"to":"now","references":[],"version":4,"exceptions_list":[],"immutable":false,"type":"eql","language":"eql","index":["windows-*"],"query":"process where event.type in (\"start\", \"process_started\") and\n  process.args : \"C:\\\\*:*\"\n","filters":[],"throttle":"no_actions","actions":[]}
{"id":"d3da9810-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T16:00:34.139Z","updated_by":"admin","created_at":"2021-09-22T15:57:46.904Z","created_by":"admin","name":"[GD] Remote Desktop Enabled in Windows Firewall","tags":["Defense Evasion","Elastic","Host","Threat Detection","Windows"],"interval":"5m","enabled":false,"description":"Identifies use of the network shell utility (netsh.exe) to enable inbound Remote Desktop Protocol (RDP) connections in the Windows Firewall.","risk_score":47,"severity":"medium","license":"Elastic License v2","output_index":".siem-signals-default","meta":{"from":"4m"},"timestamp_override":"event.ingested","author":["Elastic"],"false_positives":[],"from":"now-540s","rule_id":"92ff66c5-11eb-4818-9e53-5f8e9a223a20","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","technique":[{"reference":"https://attack.mitre.org/techniques/T1562/","name":"Impair Defenses","subtechnique":[{"reference":"https://attack.mitre.org/techniques/T1562/001/","name":"Disable or Modify Tools","id":"T1562.001"}],"id":"T1562"}],"tactic":{"reference":"https://attack.mitre.org/tactics/TA0005/","name":"Defense Evasion","id":"TA0005"}}],"to":"now","references":[],"version":4,"exceptions_list":[],"immutable":false,"type":"eql","language":"eql","index":["windows-*"],"query":"process where event.type in (\"start\", \"process_started\") and\n (process.name : \"netsh.exe\" or process.pe.original_file_name == \"netsh.exe\") and\n process.args : (\"localport=3389\", \"RemoteDesktop\", \"group=\\\"remote desktop\\\"\") and\n process.args : (\"action=allow\", \"enable=Yes\", \"enable\")\n","filters":[],"throttle":"no_actions","actions":[]}
{"id":"d3da22e1-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T16:00:34.129Z","updated_by":"admin","created_at":"2021-09-22T15:57:46.942Z","created_by":"admin","name":"[GD] Process Activity via Compiled HTML File","tags":["Elastic","Execution","Host","Threat Detection","Windows"],"interval":"5m","enabled":false,"description":"Compiled HTML files (.chm) are commonly distributed as part of the Microsoft HTML Help system. Adversaries may conceal malicious code in a CHM file and deliver it to a victim for execution. CHM content is loaded by the HTML Help executable program (hh.exe).","risk_score":21,"severity":"low","license":"Elastic License v2","output_index":".siem-signals-default","meta":{"from":"4m"},"timestamp_override":"event.ingested","author":["Elastic"],"false_positives":["The HTML Help executable program (hh.exe) runs whenever a user clicks a compiled help (.chm) file or menu item that opens the help file inside the Help Viewer. This is not always malicious, but adversaries may abuse this technology to conceal malicious code."],"from":"now-540s","rule_id":"b53bed45-2225-402a-8fcc-5043927df879","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","technique":[],"tactic":{"reference":"https://attack.mitre.org/tactics/TA0002/","name":"Execution","id":"TA0002"}},{"framework":"MITRE ATT&CK","technique":[{"reference":"https://attack.mitre.org/techniques/T1218/","name":"Signed Binary Proxy Execution","subtechnique":[{"reference":"https://attack.mitre.org/techniques/T1218/001/","name":"Compiled HTML File","id":"T1218.001"}],"id":"T1218"}],"tactic":{"reference":"https://attack.mitre.org/tactics/TA0005/","name":"Defense Evasion","id":"TA0005"}}],"to":"now","references":[],"version":8,"exceptions_list":[],"immutable":false,"type":"query","language":"kuery","index":["windows-*"],"query":"event.category:process and event.type:(start or process_started) and process.name:hh.exe","filters":[],"throttle":"no_actions","actions":[]}
{"id":"cd4a24c0-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T15:57:34.876Z","updated_by":"admin","created_at":"2021-09-22T15:57:34.876Z","created_by":"admin","name":"Potential Shell via Web Server [Duplicate]","tags":["Elastic","Host","Linux","Persistence","Threat Detection"],"interval":"5m","enabled":false,"description":"Identifies suspicious commands executed via a web server, which may suggest a vulnerability and remote shell access.","risk_score":47,"severity":"medium","license":"Elastic License v2","output_index":".siem-signals-default","timestamp_override":"event.ingested","author":["Elastic"],"false_positives":["Network monitoring or management products may have a web server component that runs shell commands as part of normal behavior."],"from":"now-9m","rule_id":"96c24e95-bdb9-4da6-81f0-304f04015334","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0003","name":"Persistence","reference":"https://attack.mitre.org/tactics/TA0003/"},"technique":[{"id":"T1505","name":"Server Software Component","reference":"https://attack.mitre.org/techniques/T1505/","subtechnique":[{"id":"T1505.003","name":"Web Shell","reference":"https://attack.mitre.org/techniques/T1505/003/"}]}]}],"to":"now","references":["https://pentestlab.blog/tag/web-shell/"],"version":9,"exceptions_list":[],"immutable":false,"type":"query","language":"kuery","index":["auditbeat-*","logs-endpoint.events.*"],"query":"event.category:process and event.type:(start or process_started) and process.name:(bash or dash) and user.name:(apache or nginx or www or \"www-data\")","throttle":"no_actions","actions":[]}
{"id":"d3e127c0-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T16:00:33.887Z","updated_by":"admin","created_at":"2021-09-22T15:57:46.906Z","created_by":"admin","name":"[GD] Suspicious WerFault Child Process","tags":["Defense Evasion","Elastic","Host","Threat Detection","Windows"],"interval":"5m","enabled":false,"description":"A suspicious WerFault child process was detected, which may indicate an attempt to run unnoticed. Verify process details such as command line, network connections, file writes and parent process details as well.","risk_score":47,"severity":"medium","license":"Elastic License v2","output_index":".siem-signals-default","meta":{"from":"4m"},"timestamp_override":"event.ingested","author":["Elastic"],"false_positives":["Custom Windows Error Reporting Debugger"],"from":"now-540s","rule_id":"dde3bc29-fe82-4ffd-8631-4bbac6a2f535","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","technique":[{"reference":"https://attack.mitre.org/techniques/T1036/","name":"Masquerading","subtechnique":[],"id":"T1036"}],"tactic":{"reference":"https://attack.mitre.org/tactics/TA0005/","name":"Defense Evasion","id":"TA0005"}}],"to":"now","references":["https://www.hexacorn.com/blog/2019/09/19/silentprocessexit-quick-look-under-the-hood/","https://github.com/sbousseaden/EVTX-ATTACK-SAMPLES/blob/master/Persistence/persistence_SilentProcessExit_ImageHijack_sysmon_13_1.evtx","https://blog.menasec.net/2021/01/"],"version":4,"exceptions_list":[],"immutable":false,"type":"query","language":"kuery","index":["windows-*"],"query":"event.category:process and event.type:(start or process_started) and process.parent.name:WerFault.exe and not process.name:(cofire.exe or psr.exe or VsJITDebugger.exe or TTTracer.exe or rundll32.exe)","filters":[],"throttle":"no_actions","actions":[]}
{"id":"cf8c2580-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T15:57:38.706Z","updated_by":"admin","created_at":"2021-09-22T15:57:38.706Z","created_by":"admin","name":"Suspicious Powershell Script [Duplicate]","tags":["Elastic","Host","ML","Threat Detection","Windows"],"interval":"15m","enabled":false,"description":"A machine learning job detected a PowerShell script with unusual data characteristics, such as obfuscation, that may be a characteristic of malicious PowerShell script text blocks.","risk_score":21,"severity":"low","license":"Elastic License v2","output_index":".siem-signals-default","author":["Elastic"],"false_positives":["Certain kinds of security testing may trigger this alert. PowerShell scripts that use high levels of obfuscation or have unusual script block payloads may trigger this alert."],"from":"now-45m","rule_id":"0ace8496-dcf1-4acf-9a73-1d7bd5cd84e2","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[],"to":"now","references":["https://www.elastic.co/guide/en/security/current/prebuilt-ml-jobs.html"],"version":4,"exceptions_list":[],"immutable":false,"type":"machine_learning","anomaly_threshold":50,"machine_learning_job_id":["windows_anomalous_script"],"throttle":"no_actions","actions":[]}
{"id":"cd835d30-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T15:57:35.254Z","updated_by":"admin","created_at":"2021-09-22T15:57:35.254Z","created_by":"admin","name":"Unusual Sudo Activity [Duplicate]","tags":["Elastic","Host","Linux","ML","Threat Detection"],"interval":"15m","enabled":false,"description":"Looks for sudo activity from an unusual user context. An unusual sudo user could be due to troubleshooting activity or it could be a sign of credentialed access via compromised accounts.","risk_score":21,"severity":"low","license":"Elastic License v2","output_index":".siem-signals-default","author":["Elastic"],"false_positives":["Uncommon sudo activity can be due to an engineer logging onto a server instance in order to perform manual troubleshooting or reconfiguration."],"from":"now-45m","rule_id":"6ab9bde2-8c11-4739-9f02-0064a5a47f0a","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0005","name":"Defense Evasion","reference":"https://attack.mitre.org/tactics/TA0005/"},"technique":[{"id":"T1548","name":"Abuse Elevation Control Mechanism","reference":"https://attack.mitre.org/techniques/T1548/"}]},{"framework":"MITRE ATT&CK","tactic":{"id":"TA0004","name":"Privilege Escalation","reference":"https://attack.mitre.org/tactics/TA0004/"},"technique":[{"id":"T1548","name":"Abuse Elevation Control Mechanism","reference":"https://attack.mitre.org/techniques/T1548/"}]}],"to":"now","references":[],"version":2,"exceptions_list":[],"immutable":false,"type":"machine_learning","anomaly_threshold":75,"machine_learning_job_id":["linux_rare_sudo_user"],"throttle":"no_actions","actions":[]}
{"id":"d3d9d4c1-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T15:59:47.220Z","updated_by":"admin","created_at":"2021-09-22T15:57:46.911Z","created_by":"admin","name":"[GD] Unusual Child Process from a System Virtual Process","tags":["Defense Evasion","Elastic","Host","Threat Detection","Windows"],"interval":"5m","enabled":false,"description":"Identifies a suspicious child process of the Windows virtual system process, which could indicate code injection.","risk_score":73,"severity":"high","license":"Elastic License v2","output_index":".siem-signals-default","meta":{"from":"4m"},"timestamp_override":"event.ingested","author":["Elastic"],"false_positives":[],"from":"now-540s","rule_id":"bd7c4b7e-abf3-44c2-a1df-02503d00d978","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","technique":[{"reference":"https://attack.mitre.org/techniques/T1055/","name":"Process Injection","subtechnique":[],"id":"T1055"}],"tactic":{"reference":"https://attack.mitre.org/tactics/TA0005/","name":"Defense Evasion","id":"TA0005"}}],"to":"now","references":[],"version":4,"exceptions_list":[],"immutable":false,"type":"query","language":"kuery","index":["windows-*"],"query":"event.category:process and event.type:(start or process_started) and process.parent.pid:4 and not process.executable:(Registry or MemCompression or \"C:\\Windows\\System32\\smss.exe\")","filters":[],"throttle":"no_actions","actions":[]}
{"id":"d3d7d8f1-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T15:59:47.229Z","updated_by":"admin","created_at":"2021-09-22T15:57:46.898Z","created_by":"admin","name":"[GD] Execution of COM object via Xwizard","tags":["Elastic","Execution","Host","Threat Detection","Windows"],"interval":"5m","enabled":false,"description":"Windows Component Object Model (COM) is an inter-process communication (IPC) component of the native Windows application programming interface (API) that enables interaction between software objects or executable code. Xwizard can be used to run a COM object created in registry to evade defensive counter measures.","risk_score":47,"severity":"medium","license":"Elastic License v2","output_index":".siem-signals-default","meta":{"from":"4m"},"timestamp_override":"event.ingested","author":["Elastic"],"false_positives":[],"from":"now-540s","rule_id":"c51db843-739b-4814-9d98-0ddf09bb22b0","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","technique":[{"reference":"https://attack.mitre.org/techniques/T1559/","name":"Inter-Process Communication","subtechnique":[{"reference":"https://attack.mitre.org/techniques/T1559/001/","name":"Component Object Model","id":"T1559.001"}],"id":"T1559"}],"tactic":{"reference":"https://attack.mitre.org/tactics/TA0002/","name":"Execution","id":"TA0002"}}],"to":"now","references":["https://lolbas-project.github.io/lolbas/Binaries/Xwizard/","http://www.hexacorn.com/blog/2017/07/31/the-wizard-of-x-oppa-plugx-style/"],"version":2,"exceptions_list":[],"immutable":false,"type":"eql","language":"eql","index":["windows-*"],"query":"process where event.type in (\"start\", \"process_started\") and\n process.pe.original_file_name : \"xwizard.exe\" and\n (\n   (process.args : \"RunWizard\" and process.args : \"{*}\") or\n   (process.executable != null and\n     not process.executable : (\"C:\\\\Windows\\\\SysWOW64\\\\xwizard.exe\", \"C:\\\\Windows\\\\System32\\\\xwizard.exe\")\n   )\n )\n","filters":[],"throttle":"no_actions","actions":[]}
{"id":"d3d9fbd1-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T15:59:47.280Z","updated_by":"admin","created_at":"2021-09-22T15:57:46.912Z","created_by":"admin","name":"[GD] Searching for Saved Credentials via VaultCmd","tags":["Credential Access","Elastic","Host","Threat Detection","Windows"],"interval":"5m","enabled":false,"description":"Windows Credential Manager allows you to create, view, or delete saved credentials for signing into websites, connected applications, and networks. An adversary may abuse this to list or dump credentials stored in the Credential Manager for saved usernames and passwords. This may also be performed in preparation of lateral movement.","risk_score":47,"severity":"medium","license":"Elastic License v2","output_index":".siem-signals-default","meta":{"from":"4m"},"timestamp_override":"event.ingested","author":["Elastic"],"false_positives":[],"from":"now-540s","rule_id":"602cdcb8-2e5e-4be5-9f2e-77871c682572","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","technique":[{"reference":"https://attack.mitre.org/techniques/T1003/","name":"OS Credential Dumping","subtechnique":[],"id":"T1003"}],"tactic":{"reference":"https://attack.mitre.org/tactics/TA0006/","name":"Credential Access","id":"TA0006"}}],"to":"now","references":["https://medium.com/threatpunter/detecting-adversary-tradecraft-with-image-load-event-logging-and-eql-8de93338c16","https://rastamouse.me/blog/rdp-jump-boxes/"],"version":2,"exceptions_list":[],"immutable":false,"type":"eql","language":"eql","index":["windows-*"],"query":"process where event.type in (\"start\", \"process_started\") and\n  (process.pe.original_file_name:\"vaultcmd.exe\" or process.name:\"vaultcmd.exe\") and\n  process.args:\"/list*\"\n","filters":[],"throttle":"no_actions","actions":[]}
{"id":"d646dd21-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T16:00:33.734Z","updated_by":"admin","created_at":"2021-09-22T15:57:50.929Z","created_by":"admin","name":"[GD] AWS WAF Access Control List Deletion","tags":["AWS","Cloud","Continuous Monitoring","Elastic","Network Security","SecOps"],"interval":"10m","enabled":false,"description":"Identifies the deletion of a specified AWS Web Application Firewall (WAF) access control list.","risk_score":47,"severity":"medium","note":"The AWS Filebeat module must be enabled to use this rule.","license":"Elastic License v2","output_index":".siem-signals-default","meta":{"from":"50m"},"timestamp_override":"event.ingested","author":["Elastic"],"false_positives":["Firewall ACL's may be deleted by a system or network administrator. Verify whether the user identity, user agent, and/or hostname should be making changes in your environment. Web ACL deletions from unfamiliar users or hosts should be investigated. If known behavior is causing false positives, it can be exempted from the rule."],"from":"now-3600s","rule_id":"eeaadba2-efe8-47d2-969b-46ce4009d557","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","technique":[{"reference":"https://attack.mitre.org/techniques/T1562/","name":"Impair Defenses","subtechnique":[{"reference":"https://attack.mitre.org/techniques/T1562/001/","name":"Disable or Modify Tools","id":"T1562.001"}],"id":"T1562"}],"tactic":{"reference":"https://attack.mitre.org/tactics/TA0005/","name":"Defense Evasion","id":"TA0005"}}],"to":"now","references":["https://awscli.amazonaws.com/v2/documentation/api/latest/reference/waf-regional/delete-web-acl.html","https://docs.aws.amazon.com/waf/latest/APIReference/API_wafRegional_DeleteWebACL.html"],"version":6,"exceptions_list":[],"immutable":false,"type":"query","language":"kuery","index":["okta-*"],"query":"event.action:DeleteWebACL and event.dataset:aws.cloudtrail and event.outcome:success","filters":[],"throttle":"no_actions","actions":[]}
{"id":"d3dfa121-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T15:59:47.215Z","updated_by":"admin","created_at":"2021-09-22T15:57:46.912Z","created_by":"admin","name":"[GD] NTDS or SAM Database File Copied","tags":["Credential Access","Elastic","Host","Threat Detection","Windows"],"interval":"5m","enabled":false,"description":"Identifies a copy operation of the Active Directory Domain Database (ntds.dit) or Security Account Manager (SAM) files. Those files contain sensitive information including hashed domain and/or local credentials.","risk_score":73,"severity":"high","license":"Elastic License v2","output_index":".siem-signals-default","meta":{"from":"4m"},"timestamp_override":"event.ingested","author":["Elastic"],"false_positives":[],"from":"now-540s","rule_id":"182928ea-936a-4647-924e-4fb57370e1c7","max_signals":33,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","technique":[{"reference":"https://attack.mitre.org/techniques/T1003/","name":"OS Credential Dumping","subtechnique":[],"id":"T1003"}],"tactic":{"reference":"https://attack.mitre.org/tactics/TA0006/","name":"Credential Access","id":"TA0006"}}],"to":"now","references":["https://thedfirreport.com/2020/11/23/pysa-mespinoza-ransomware/"],"version":4,"exceptions_list":[],"immutable":false,"type":"eql","language":"eql","index":["windows-*"],"query":"process where event.type in (\"start\", \"process_started\") and\n process.pe.original_file_name in (\"Cmd.Exe\", \"PowerShell.EXE\", \"XCOPY.EXE\") and\n process.args : (\"copy\", \"xcopy\", \"Copy-Item\", \"move\", \"cp\", \"mv\") and\n process.args : (\"*\\\\ntds.dit\", \"*\\\\config\\\\SAM\", \"\\\\*\\\\GLOBALROOT\\\\Device\\\\HarddiskVolumeShadowCopy*\\\\*\")\n","filters":[],"throttle":"no_actions","actions":[]}
{"id":"cf8c9ab0-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T15:57:38.710Z","updated_by":"admin","created_at":"2021-09-22T15:57:38.710Z","created_by":"admin","name":"Interactive Terminal Spawned via Python [Duplicate]","tags":["Elastic","Execution","Host","Linux","Threat Detection"],"interval":"5m","enabled":false,"description":"Identifies when a terminal (tty) is spawned via Python. Attackers may upgrade a simple reverse shell to a fully interactive tty after obtaining initial access to a host.","risk_score":73,"severity":"high","license":"Elastic License v2","output_index":".siem-signals-default","timestamp_override":"event.ingested","author":["Elastic"],"false_positives":[],"from":"now-9m","rule_id":"81d0da76-bce1-48fc-a2e3-fe1a51c33d76","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0002","name":"Execution","reference":"https://attack.mitre.org/tactics/TA0002/"},"technique":[{"id":"T1059","name":"Command and Scripting Interpreter","reference":"https://attack.mitre.org/techniques/T1059/"}]}],"to":"now","references":[],"version":6,"exceptions_list":[],"immutable":false,"type":"query","language":"kuery","index":["auditbeat-*","logs-endpoint.events.*"],"query":"event.category:process and event.type:(start or process_started) and process.name:python and process.args:(\"import pty; pty.spawn(\\\"/bin/sh\\\")\" or \"import pty; pty.spawn(\\\"/bin/dash\\\")\" or \"import pty; pty.spawn(\\\"/bin/bash\\\")\")","throttle":"no_actions","actions":[]}
{"id":"cf8c73a1-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T15:57:38.713Z","updated_by":"admin","created_at":"2021-09-22T15:57:38.713Z","created_by":"admin","name":"Unusual Windows Path Activity [Duplicate]","tags":["Elastic","Host","ML","Threat Detection","Windows"],"interval":"15m","enabled":false,"description":"Identifies processes started from atypical folders in the file system, which might indicate malware execution or persistence mechanisms. In corporate Windows environments, software installation is centrally managed and it is unusual for programs to be executed from user or temporary directories. Processes executed from these locations can denote that a user downloaded software directly from the Internet or a malicious script or macro executed malware.","risk_score":21,"severity":"low","license":"Elastic License v2","output_index":".siem-signals-default","author":["Elastic"],"false_positives":["A new and unusual program or artifact download in the course of software upgrades, debugging, or troubleshooting could trigger this alert. Users downloading and running programs from unusual locations, such as temporary directories, browser caches, or profile paths could trigger this alert."],"from":"now-45m","rule_id":"7244410d-b755-4f7c-baf0-878bff57918a","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[],"to":"now","references":["https://www.elastic.co/guide/en/security/current/prebuilt-ml-jobs.html"],"version":4,"exceptions_list":[],"immutable":false,"type":"machine_learning","anomaly_threshold":50,"machine_learning_job_id":["windows_anomalous_path_activity_ecs"],"throttle":"no_actions","actions":[]}
{"id":"cf8c4c90-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-09-22T15:57:38.715Z","updated_by":"admin","created_at":"2021-09-22T15:57:38.715Z","created_by":"admin","name":"Attempt to Disable Syslog Service [Duplicate]","tags":["Defense Evasion","Elastic","Host","Linux","Threat Detection"],"interval":"5m","enabled":false,"description":"Adversaries may attempt to disable the syslog service in an attempt to an attempt to disrupt event logging and evade detection by security controls.","risk_score":47,"severity":"medium","license":"Elastic License v2","output_index":".siem-signals-default","timestamp_override":"event.ingested","author":["Elastic"],"false_positives":[],"from":"now-9m","rule_id":"e884d388-39b0-49ae-b91a-a3955df37408","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0005","name":"Defense Evasion","reference":"https://attack.mitre.org/tactics/TA0005/"},"technique":[{"id":"T1562","name":"Impair Defenses","reference":"https://attack.mitre.org/techniques/T1562/","subtechnique":[{"id":"T1562.001","name":"Disable or Modify Tools","reference":"https://attack.mitre.org/techniques/T1562/001/"}]}]}],"to":"now","references":[],"version":7,"exceptions_list":[],"immutable":false,"type":"query","language":"kuery","index":["auditbeat-*","logs-endpoint.events.*"],"query":"event.category:process and event.type:(start or process_started) and ((process.name:service and process.args:stop) or (process.name:chkconfig and process.args:off) or (process.name:systemctl and process.args:(disable or stop or kill))) and process.args:(syslog or rsyslog or \"syslog-ng\")","throttle":"no_actions","actions":[]}
{"id":"386808a0-c58f-11ec-a104-0f9510a5035b","updated_at":"2022-04-28T18:55:47.579Z","updated_by":"clopez1@godaddy.com","created_at":"2022-04-26T18:32:26.446Z","created_by":"jprentice1@godaddy.com","name":"Tanium Alert - GoDaddy MWP SIR PHP Bad File Count on p3nlwpapp001","tags":["GD","Tanium"],"interval":"1h","enabled":true,"description":"Fires when the threshold count of matches for the Tanium question \"GoDaddy MWP SIR PHP Bad File Count on p3nlwpapp001\" is greater than 100","risk_score":47,"severity":"medium","license":"","output_index":".siem-signals-default","meta":{"from":"1h","kibana_siem_app_url":"https://security-prod.kibana.int.gdcorp.tools/app/security"},"author":[],"false_positives":[],"from":"now-7200s","rule_id":"1265ff14-4550-432e-a905-333d8e617c0c","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[],"to":"now","references":[],"version":2,"exceptions_list":[],"immutable":false,"type":"query","language":"kuery","index":["*:tanium-*"],"query":"tanium.GoDaddy-MWP-SIR0034749-Bad-File-Count: * AND tanium.GoDaddy-MWP-SIR0034749-Bad-File-Count > 100","filters":[],"throttle":"rule","actions":[{"group":"default","id":"56fd1b40-5f85-11ec-9d1e-5b56ec0d9762","params":{"body":"{\n  \"short_description\": \"{{context.rule.name}}\",\n  \"assignment_group\": \"infosec_response\",\n  \"category\": \"Unauthorized access\",\n  \"contact_type\": \"siem\",\n  \"description\": \"The {{context.rule.name}} has triggered. Please follow the playbook here https://confluence.godaddy.com/display/IRKB/IRT+-+Tanium+-+PHP+Bad+File+Count+Threshold+reached++in+MWP.\\n\\n{{#context.alerts}}\\n@timestamp: {{signal.original_time}}\\nGoDaddy-MWP-SIR0034749-Bad-File-Count: {{tanium.GoDaddy-MWP-SIR0034749-Bad-File-Count}}\\n{{/context.alerts}}\\n\\nLink to results: {{context.results_link}}\",\n  \"priority\": \"3\",\n  \"severity\": \"3\",\n  \"state\": \"10\"\n}"},"action_type_id":".webhook"},{"group":"default","id":"45e4ab50-9a83-11ec-b095-87bc28af8de9","params":{"message":"The {{context.rule.name}} has triggered. Please follow the playbook here https://confluence.godaddy.com/display/IRKB/IRT+-+Tanium+-+PHP+Bad+File+Count+Threshold+reached++in+MWP."},"action_type_id":".slack"}]}
{"id":"6dc0a350-9a82-11ec-b59d-e77f2674f157","updated_at":"2022-04-06T17:57:37.325Z","updated_by":"schoi@godaddy.com","created_at":"2022-03-02T23:42:32.835Z","created_by":"schoi@godaddy.com","name":"ASM Honey Token Alert","tags":[],"interval":"1h","enabled":true,"description":"Honey token alert across regular/pci/registry org secretsmanager \"DontReadMe\" secret access.","risk_score":21,"severity":"low","license":"","output_index":".siem-signals-default","meta":{"from":"15m","kibana_siem_app_url":"https://security-prod.kibana.int.gdcorp.tools/app/security"},"author":[],"false_positives":[],"from":"now-4500s","rule_id":"94304468-9f9d-4984-b0c5-0ab7cabd927d","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[],"to":"now","references":[],"version":15,"exceptions_list":[],"immutable":false,"type":"query","language":"kuery","index":["*:aws-cloudtrail-*","*:pci-aws-cloudtrail-*","*:registry-aws-cloudtrail-*"],"query":"event.provider: \"secretsmanager.amazonaws.com\" AND aws.cloudtrail.request_parameters: *DontReadMe*","filters":[{"meta":{"type":"phrases","key":"event.action","params":["GetSecretValue","DeleteSecret"],"alias":null,"negate":false,"disabled":false},"query":{"bool":{"should":[{"match_phrase":{"event.action":"GetSecretValue"}},{"match_phrase":{"event.action":"DeleteSecret"}}],"minimum_should_match":1}},"$state":{"store":"appState"}},{"meta":{"alias":null,"negate":true,"disabled":false,"type":"phrase","key":"user.name","params":{"query":"AccountAutomationServiceRole"}},"query":{"match_phrase":{"user.name":"AccountAutomationServiceRole"}},"$state":{"store":"appState"}}],"throttle":"rule","actions":[{"group":"default","id":"3d244760-9a7d-11ec-b095-87bc28af8de9","params":{"message":":honey_pot: ASM Honey Token Alert\n\nAlert: *{{context.rule.name}}* with *{{state.signals_count}}* events.\n\n```\n{{#context.alerts}}\nTime: {{signal.original_time}}\nActor: {{aws.cloudtrail.user_identity.arn}}\nEnvironment: {{environment}}\nEventName: {{event.action}}\nOutcome: {{event.outcome}}\nRegion: {{cloud.region}}\nSecretName: {{aws.cloudtrail.request_parameters}}\nAccountId: {{cloud.account.id}}\nLink: {{context.results_link}}\n---\n{{/context.alerts}}\n```"},"action_type_id":".slack"},{"group":"default","id":"56fd1b40-5f85-11ec-9d1e-5b56ec0d9762","params":{"body":"{\n  \"short_description\": \"Elastic Test - ASM Honey Token Alert\",\n  \"assignment_group\": \"ENG-Product Security\",\n  \"category\": \"Unauthorized access\",\n  \"contact_type\": \"siem\",\n  \"description\": \":honey_pot: ASM Honey Token Alert\\n\\nAlert: *{{context.rule.name}}* with *{{state.signals_count}}* events.\\n\\n```\\n{{#context.alerts}}\\nTime: {{signal.original_time}}\\nActor: {{aws.cloudtrail.user_identity.arn}}\\nEnvironment: {{environment}}\\nEventName: {{event.action}}\\nOutcome: {{event.outcome}}\\nRegion: {{cloud.region}}\\nSecretName: {{aws.cloudtrail.request_parameters}}\\nAccountId: {{cloud.account.id}}\\nLink: {{context.results_link}}\\n---\\n{{/context.alerts}}\\n```\",\n  \"priority\": \"5\",\n  \"severity\": \"5\",\n  \"state\": \"10\"\n}"},"action_type_id":".webhook"}]}
{"id":"59da9f90-9676-11ec-ab18-0d51419cd75c","updated_at":"2022-03-21T22:28:14.063Z","updated_by":"jprentice1@godaddy.com","created_at":"2022-02-25T20:05:59.966Z","created_by":"admin","name":"Suspicious AWS Secrets Manager Events","tags":["GD","Security"],"interval":"1h","enabled":true,"description":"based on splunk Suspicious AWS Secrets Manager Events rule logic. no hits searching over 7 days of historical data","risk_score":21,"severity":"low","license":"","output_index":".siem-signals-default","meta":{"from":"10m","kibana_siem_app_url":"https://security-prod.kibana.int.gdcorp.tools/app/security"},"author":[],"false_positives":[],"from":"now-4200s","rule_id":"0c18aa92-18b7-4c9f-a86e-ce81f86e424c","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[],"to":"now","references":[],"version":13,"exceptions_list":[],"immutable":false,"type":"query","language":"kuery","index":["*:aws-cloudtrail-*"],"query":"NOT (user.name: \"AccountAutomationServiceRole\" OR (user.name: GD-APPSVCS-ESSPInfraRole AND aws.cloudtrail.flattened.request_parameters.secretId: \"essp_apm_deployment\") OR (user.name: GD-APPSVCS-ESSPInfraRole AND aws.cloudtrail.flattened.request_parameters.secretId: \"essp_deployment_credentials\") OR user.name: GD-AWS-IAM-Resources-GDAWSServiceAccountDeployRole-* OR user.name: SC-*-pp-*-LambdaExecutionRole-* OR aws.cloudtrail.user_identity.arn: *GitHubActions)","filters":[{"$state":{"store":"appState"},"meta":{"negate":false,"alias":null,"disabled":false,"type":"phrases","params":["539225272086","763338924548","745293682974"],"key":"cloud.account.id"},"query":{"bool":{"should":[{"match_phrase":{"cloud.account.id":"539225272086"}},{"match_phrase":{"cloud.account.id":"763338924548"}},{"match_phrase":{"cloud.account.id":"745293682974"}}],"minimum_should_match":1}}},{"$state":{"store":"appState"},"meta":{"negate":false,"alias":null,"disabled":false,"type":"phrase","params":{"query":"secretsmanager.amazonaws.com"},"key":"event.provider"},"query":{"match_phrase":{"event.provider":"secretsmanager.amazonaws.com"}}},{"$state":{"store":"appState"},"meta":{"negate":false,"alias":null,"disabled":false,"type":"custom","value":"{\"bool\":{\"should\":[{\"wildcard\":{\"event.action\":{\"value\":\"GetSecretValue*\"}}},{\"wildcard\":{\"event.action\":{\"value\":\"CancelRotateSecret*\"}}},{\"wildcard\":{\"event.action\":{\"value\":\"Create*\"}}},{\"wildcard\":{\"event.action\":{\"value\":\"Delete*\"}}},{\"wildcard\":{\"event.action\":{\"value\":\"Put*\"}}},{\"wildcard\":{\"event.action\":{\"value\":\"Remove*\"}}},{\"wildcard\":{\"event.action\":{\"value\":\"Replicate*\"}}},{\"wildcard\":{\"event.action\":{\"value\":\"Restore*\"}}},{\"wildcard\":{\"event.action\":{\"value\":\"Rotate*\"}}},{\"wildcard\":{\"event.action\":{\"value\":\"StopReplication*\"}}},{\"wildcard\":{\"event.action\":{\"value\":\"Update*\"}}},{\"wildcard\":{\"event.action\":{\"value\":\"Validate*\"}}}],\"minimum_should_match\":1}}","key":"query"},"query":{"bool":{"should":[{"wildcard":{"event.action":{"value":"GetSecretValue*"}}},{"wildcard":{"event.action":{"value":"CancelRotateSecret*"}}},{"wildcard":{"event.action":{"value":"Create*"}}},{"wildcard":{"event.action":{"value":"Delete*"}}},{"wildcard":{"event.action":{"value":"Put*"}}},{"wildcard":{"event.action":{"value":"Remove*"}}},{"wildcard":{"event.action":{"value":"Replicate*"}}},{"wildcard":{"event.action":{"value":"Restore*"}}},{"wildcard":{"event.action":{"value":"Rotate*"}}},{"wildcard":{"event.action":{"value":"StopReplication*"}}},{"wildcard":{"event.action":{"value":"Update*"}}},{"wildcard":{"event.action":{"value":"Validate*"}}}],"minimum_should_match":1}}}],"throttle":"rule","actions":[{"group":"default","id":"56fd1b40-5f85-11ec-9d1e-5b56ec0d9762","params":{"body":"{\n  \"short_description\": \"Suspicious AWS Secrets Manager Events (Storage Account)\",\n  \"assignment_group\": \"OPS-GCSO\",\n  \"category\": \"Unauthorized access\",\n  \"contact_type\": \"siem\",\n  \"description\": \"See following Info: \\nSuspicious AWS Secrets Manager Events (Storage Account)\\n\\n{{#context.alerts}}\\nError Code: {{aws.cloudtrail.error_code}}\\nEnvironment: {{environment}}\\nAccount ID: {{cloud.account.id}}\\nUserType: {{aws.cloudtrail.user_identity.type}}\\nUser/Role: {{user.name}}\\nPrincipal ID: {{user.id}}\\nEvent: {{event.action}}\\nSecretID: {{aws.cloudtrail.flattened.request_parameters.secretId}}\\nsource.address: {{source.address}}\\n{{/context.alerts}}\\n\\nSee Process Here:\\nhttps://confluence.godaddy.com/pages/viewpage.action?pageId=214401496\",\n  \"priority\": \"1\",\n  \"severity\": \"2\",\n  \"state\": \"10\"\n}"},"action_type_id":".webhook"}]}
{"id":"cb7b1120-37f8-11ec-a745-d7b9709e8a2e","updated_at":"2022-03-21T22:36:09.364Z","updated_by":"jprentice1@godaddy.com","created_at":"2021-10-28T14:10:25.143Z","created_by":"admin","name":"[GD] Windows Log Clear Event","tags":["GD","Windows"],"interval":"1h","enabled":true,"description":"To identify if a Log Clear occurred in windows","risk_score":21,"severity":"low","license":"","output_index":".siem-signals-default","meta":{"from":"10m","kibana_siem_app_url":"https://security-prod.kibana.int.gdcorp.tools/app/security"},"author":[],"false_positives":[],"from":"now-4200s","rule_id":"ecb1b1c6-b8f0-41e8-912a-16fa3b871bda","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[],"to":"now","references":[],"version":19,"exceptions_list":[],"immutable":false,"type":"query","language":"kuery","index":["*:windows-*"],"query":"event.code:\"1102\" ","filters":[{"$state":{"store":"appState"},"meta":{"negate":true,"alias":null,"disabled":false,"type":"phrase","params":{"query":"*imaging-prod.local"},"key":"host.name"},"query":{"match_phrase":{"host.name":"*imaging-prod.local"}}}],"throttle":"rule","actions":[{"group":"default","id":"56fd1b40-5f85-11ec-9d1e-5b56ec0d9762","params":{"body":"{\n  \"short_description\": \"Windows Log Clear - {{state.signals_count}} machines\",\n  \"assignment_group\": \"OPS-GCSO\",\n  \"category\": \"Unauthorized access\",\n  \"contact_type\": \"siem\",\n  \"description\": \"Dashboard - Windows Event 1102 Log Clear: https://security-prod.kibana.int.gdcorp.tools/app/dashboards#/view/868c0a70-bd9a-11eb-8d42-f725f3c7ec37\\n Process - https://confluence.godaddy.com/display/IRKB/Windows+Log+Clear+Event+Procedure\\n Threshold - None\",\n  \"priority\": \"3\",\n  \"severity\": \"3\",\n  \"state\": \"10\"\n}"},"action_type_id":".webhook"}]}
{"id":"07995e20-936e-11ec-b058-3bdfa1ca61dc","updated_at":"2022-03-21T22:35:40.281Z","updated_by":"jprentice1@godaddy.com","created_at":"2022-02-21T23:28:52.503Z","created_by":"jprentice1@godaddy.com","name":"IRT - Suspicious AWS IAM Events (Forensic Account)","tags":["GD","Security"],"interval":"1h","enabled":true,"description":"based on Splunk logic:\nindex=\"aws_cloudtrail\" (aws_account_id=197818030129 OR aws_account_id=883229650331 OR aws_account_id=332047608640) (app=\"iam.amazonaws.com\" (eventName=Add* OR eventName=Change* OR eventName=Create* OR eventName=Deactivate* OR eventName=Delete* OR eventName=Enable* OR eventName=Pass* OR eventName=Remove* OR eventName=Reset* OR eventName=Resync* OR eventName=SetSecurity* OR eventName=Update* OR eventName=Upload*)) NOT ((userName=GD-AWS-IAM-Resources-GDAWSServiceAccountDeployRole-* AND sourceIPAddress = cloudformation.amazonaws.com) OR (userName = AWSServiceRoleForTrustedAdvisor AND sourceIPAddress = trustedadvisor.amazonaws.com) OR (userName = ServiceCatalogLaunchConstraintRole AND sourceIPAddress = servicecatalog.amazonaws.com) OR (userName = AccountAutomationServiceRole AND sourceIPAddress = cloudformation.amazonaws.com) OR userName=SC-*-pp-*-LambdaExecutionRole-* OR userName=GD-AWS-IAM-Resources-GDAWSServiceAccountDeployRole-*)\n| fillnull value=\"-\"\n| rename errorCode as Status, environment as Environment, aws_account_id as AccountID, eventName as Event, userName as User, principalUser as PrincipalUser,sourceIPAddress as SourceIP","risk_score":21,"severity":"low","license":"","output_index":".siem-signals-default","meta":{"from":"10m","kibana_siem_app_url":"https://security-prod.kibana.int.gdcorp.tools/app/security"},"author":[],"false_positives":[],"from":"now-4200s","rule_id":"215d0b93-89d6-4eac-a811-bacae4c6315d","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[],"to":"now","references":[],"version":17,"exceptions_list":[],"immutable":false,"type":"query","language":"kuery","index":["*:aws-cloudtrail-*"],"query":"NOT ((user.name: GD-AWS-IAM-Resources-GDAWSServiceAccountDeployRole-* AND source.address: cloudformation.amazonaws.com) OR (user.name: AWSServiceRoleForTrustedAdvisor AND source.address: trustedadvisor.amazonaws.com) OR (user.name: ServiceCatalogLaunchConstraintRole AND source.address: servicecatalog.amazonaws.com) OR (user.name: AccountAutomationServiceRole AND source.address: cloudformation.amazonaws.com) OR user.name: SC-*-pp-*-LambdaExecutionRole-* OR user.name: GD-AWS-IAM-Resources-GDAWSServiceAccountDeployRole-*)","filters":[{"$state":{"store":"appState"},"meta":{"negate":false,"alias":null,"disabled":false,"type":"phrases","params":["197818030129","883229650331","332047608640"],"key":"cloud.account.id"},"query":{"bool":{"should":[{"match_phrase":{"cloud.account.id":"197818030129"}},{"match_phrase":{"cloud.account.id":"883229650331"}},{"match_phrase":{"cloud.account.id":"332047608640"}}],"minimum_should_match":1}}},{"$state":{"store":"appState"},"meta":{"negate":false,"alias":null,"disabled":false,"type":"phrase","params":{"query":"iam.amazonaws.com"},"key":"event.provider"},"query":{"match_phrase":{"event.provider":"iam.amazonaws.com"}}},{"$state":{"store":"appState"},"meta":{"negate":false,"alias":null,"disabled":false,"type":"custom","value":"{\"bool\":{\"should\":[{\"wildcard\":{\"event.action\":{\"value\":\"Add*\"}}},{\"wildcard\":{\"event.action\":{\"value\":\"Change*\"}}},{\"wildcard\":{\"event.action\":{\"value\":\"Create*\"}}},{\"wildcard\":{\"event.action\":{\"value\":\"Deactivate*\"}}},{\"wildcard\":{\"event.action\":{\"value\":\"Delete*\"}}},{\"wildcard\":{\"event.action\":{\"value\":\"Enable*\"}}},{\"wildcard\":{\"event.action\":{\"value\":\"Pass*\"}}},{\"wildcard\":{\"event.action\":{\"value\":\"Remove*\"}}},{\"wildcard\":{\"event.action\":{\"value\":\"Reset*\"}}},{\"wildcard\":{\"event.action\":{\"value\":\"Resync*\"}}},{\"wildcard\":{\"event.action\":{\"value\":\"SetSecurity*\"}}},{\"wildcard\":{\"event.action\":{\"value\":\"Update*\"}}},{\"wildcard\":{\"event.action\":{\"value\":\"Upload*\"}}}],\"minimum_should_match\":1}}","key":"query"},"query":{"bool":{"should":[{"wildcard":{"event.action":{"value":"Add*"}}},{"wildcard":{"event.action":{"value":"Change*"}}},{"wildcard":{"event.action":{"value":"Create*"}}},{"wildcard":{"event.action":{"value":"Deactivate*"}}},{"wildcard":{"event.action":{"value":"Delete*"}}},{"wildcard":{"event.action":{"value":"Enable*"}}},{"wildcard":{"event.action":{"value":"Pass*"}}},{"wildcard":{"event.action":{"value":"Remove*"}}},{"wildcard":{"event.action":{"value":"Reset*"}}},{"wildcard":{"event.action":{"value":"Resync*"}}},{"wildcard":{"event.action":{"value":"SetSecurity*"}}},{"wildcard":{"event.action":{"value":"Update*"}}},{"wildcard":{"event.action":{"value":"Upload*"}}}],"minimum_should_match":1}}}],"throttle":"rule","actions":[{"group":"default","id":"56fd1b40-5f85-11ec-9d1e-5b56ec0d9762","params":{"body":"{\n  \"short_description\": \"Suspicious AWS IAM Events (Forensic Analysis Account)\",\n  \"assignment_group\": \"OPS-GCSO\",\n  \"category\": \"Unauthorized access\",\n  \"contact_type\": \"siem\",\n  \"description\": \"See following Info:\\nSuspicious AWS IAM Events (Forensic Analysis Account)\\n\\n{{#context.alerts}}\\n\\nError Code: {{aws.cloudtrail.error_code}}\\nEnvironment: {{environment}}\\nAccount ID: {{cloud.account.id}}\\nUserType: {{aws.cloudtrail.user_identity.type}}\\nUser/Role: {{user.name}}\\nPrincipal ID: {{user.id}}\\nEvent: {{event.action}}\\nsource.address: {{source.address}}\\n{{/context.alerts}}\\n\\nSee Process Here:\\nhttps://confluence.godaddy.com/pages/viewpage.action?pageId=255072051\",\n  \"priority\": \"1\",\n  \"severity\": \"2\",\n  \"state\": \"10\"\n}"},"action_type_id":".webhook"},{"group":"default","id":"elastic-cloud-email","params":{"message":"The alert condition for '{{context.rule.name}}' was triggered.\n\nLink to results: {{context.results_link}}","subject":"Elastic Alert: {{context.rule.name}}","to":["clopez1@godaddy.com","jmayerpotts@godaddy.com"]},"action_type_id":".email"}]}
{"id":"3f1cfa70-4baa-11ec-8f3e-0bb4bad39cd8","updated_at":"2022-03-10T23:44:34.451Z","updated_by":"schoi@godaddy.com","created_at":"2021-11-22T15:38:32.569Z","created_by":"admin","name":"Trend Micro - Malware unable to be removed","tags":["GD"],"interval":"1h","enabled":true,"description":"To identify Malware flagged by trend but not removed by trend","risk_score":21,"severity":"low","license":"","output_index":".siem-signals-default","meta":{"from":"10m","kibana_siem_app_url":"https://security-prod.kibana.int.gdcorp.tools/app/security"},"author":[],"false_positives":[],"from":"now-4200s","rule_id":"38de3690-7b5d-480e-aa39-3e2392bc1deb","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[],"to":"now","references":[],"version":10,"exceptions_list":[],"immutable":false,"type":"query","language":"kuery","index":["*:onprem-*","onprem-*"],"query":"","filters":[{"$state":{"store":"appState"},"meta":{"negate":false,"alias":null,"disabled":false,"type":"phrase","params":{"query":"DEEPSECURITY"},"key":"aws.fluent_tags"},"query":{"match_phrase":{"aws.fluent_tags":"DEEPSECURITY"}}},{"$state":{"store":"appState"},"meta":{"negate":true,"alias":null,"disabled":false,"type":"phrases","params":["Pass","Delete","deleted","created","Deny","DenyAccess","renamed","Terminate"],"key":"trendmicro.act"},"query":{"bool":{"should":[{"match_phrase":{"trendmicro.act":"Pass"}},{"match_phrase":{"trendmicro.act":"Delete"}},{"match_phrase":{"trendmicro.act":"deleted"}},{"match_phrase":{"trendmicro.act":"created"}},{"match_phrase":{"trendmicro.act":"Deny"}},{"match_phrase":{"trendmicro.act":"DenyAccess"}},{"match_phrase":{"trendmicro.act":"renamed"}},{"match_phrase":{"trendmicro.act":"Terminate"}}],"minimum_should_match":1}}},{"$state":{"store":"appState"},"meta":{"negate":false,"alias":null,"disabled":false,"type":"exists","value":"exists","key":"trendmicro.filePath"},"query":{"exists":{"field":"trendmicro.filePath"}}},{"$state":{"store":"appState"},"meta":{"negate":false,"alias":null,"disabled":false,"type":"exists","value":"exists","key":"trendmicro.trigger"},"query":{"exists":{"field":"trendmicro.trigger"}}},{"$state":{"store":"appState"},"meta":{"negate":false,"alias":null,"disabled":false,"type":"exists","value":"exists","key":"trendmicro.TrendMicroDsFileMD5"},"query":{"exists":{"field":"trendmicro.TrendMicroDsFileMD5"}}}],"throttle":"rule","actions":[{"group":"default","id":"elastic-cloud-email","params":{"subject":"Elastic Alert: {{context.rule.name}}","to":["twhipple@godaddy.com"],"message":"Rule {{context.rule.name}} generated {{state.signals_count}} alerts.\n\nLink to results: {{context.results_link}}"},"action_type_id":".email"}]}
{"id":"99badb80-90d0-11ec-b59d-e77f2674f157","updated_at":"2022-03-21T22:23:04.438Z","updated_by":"jprentice1@godaddy.com","created_at":"2022-02-18T15:36:55.841Z","created_by":"admin","name":"Suspicious AWS IAM Events","tags":["GD","Security"],"interval":"1h","enabled":true,"description":"based on Splunk logic:\nindex=\"aws_cloudtrail\" (aws_account_id=539225272086 OR aws_account_id=763338924548 OR aws_account_id=745293682974) (app=\"iam.amazonaws.com\" (eventName=Add* OR eventName=Change* OR eventName=Create* OR eventName=Deactivate* OR eventName=Delete* OR eventName=Enable* OR eventName=Pass* OR eventName=Remove* OR eventName=Reset* OR eventName=Resync* OR eventName=SetSecurity* OR eventName=Update* OR eventName=Upload*)) NOT ((userName=GD-AWS-IAM-Resources-GDAWSServiceAccountDeployRole-* AND sourceIPAddress = cloudformation.amazonaws.com) OR (userName = AWSServiceRoleForTrustedAdvisor AND sourceIPAddress = trustedadvisor.amazonaws.com) OR (userName = ServiceCatalogLaunchConstraintRole AND sourceIPAddress = servicecatalog.amazonaws.com) OR (userName = AccountAutomationServiceRole AND sourceIPAddress = cloudformation.amazonaws.com) OR userName=SC-*-pp-*-LambdaExecutionRole-* OR userName=GD-AWS-IAM-Resources-GDAWSServiceAccountDeployRole-*)\n | fillnull value=\"-\"\n | rename errorCode as Status, environment as Environment, aws_account_id as AccountID, eventName as Event, userName as User, principalUser as PrincipalUser,sourceIPAddress as SourceIP\n | stats count by Status, Environment, AccountID, User, PrincipalUser, Event, SourceIP\n | sort by Environment, User","risk_score":21,"severity":"low","license":"","output_index":".siem-signals-default","meta":{"from":"10m","kibana_siem_app_url":"https://security-prod.kibana.int.gdcorp.tools/app/security"},"author":[],"false_positives":[],"from":"now-4200s","rule_id":"ad4df7ae-64c9-408f-96f8-f87260dad075","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[],"to":"now","references":[],"version":9,"exceptions_list":[],"immutable":false,"type":"query","language":"kuery","index":["*:aws-cloudtrail-*"],"query":"NOT ((user.name: GD-AWS-IAM-Resources-GDAWSServiceAccountDeployRole-* AND source.address: cloudformation.amazonaws.com) OR (user.name: AWSServiceRoleForTrustedAdvisor AND source.address: trustedadvisor.amazonaws.com) OR (user.name: ServiceCatalogLaunchConstraintRole AND source.address: servicecatalog.amazonaws.com) OR (user.name: AccountAutomationServiceRole AND source.address: cloudformation.amazonaws.com) OR user.name: SC-*-pp-*-LambdaExecutionRole-* OR user.name: GD-AWS-IAM-Resources-GDAWSServiceAccountDeployRole-*)","filters":[{"$state":{"store":"appState"},"meta":{"negate":false,"alias":null,"disabled":false,"type":"phrases","params":["539225272086","763338924548","745293682974"],"key":"cloud.account.id"},"query":{"bool":{"should":[{"match_phrase":{"cloud.account.id":"539225272086"}},{"match_phrase":{"cloud.account.id":"763338924548"}},{"match_phrase":{"cloud.account.id":"745293682974"}}],"minimum_should_match":1}}},{"$state":{"store":"appState"},"meta":{"negate":false,"alias":null,"disabled":false,"type":"phrase","params":{"query":"iam.amazonaws.com"},"key":"event.provider"},"query":{"match_phrase":{"event.provider":"iam.amazonaws.com"}}},{"$state":{"store":"appState"},"meta":{"negate":false,"alias":null,"disabled":false,"type":"custom","value":"{\"bool\":{\"should\":[{\"wildcard\":{\"event.action\":{\"value\":\"Add*\"}}},{\"wildcard\":{\"event.action\":{\"value\":\"Change*\"}}},{\"wildcard\":{\"event.action\":{\"value\":\"Create*\"}}},{\"wildcard\":{\"event.action\":{\"value\":\"Deactivate*\"}}},{\"wildcard\":{\"event.action\":{\"value\":\"Delete*\"}}},{\"wildcard\":{\"event.action\":{\"value\":\"Enable*\"}}},{\"wildcard\":{\"event.action\":{\"value\":\"Pass*\"}}},{\"wildcard\":{\"event.action\":{\"value\":\"Remove*\"}}},{\"wildcard\":{\"event.action\":{\"value\":\"Reset*\"}}},{\"wildcard\":{\"event.action\":{\"value\":\"Resync*\"}}},{\"wildcard\":{\"event.action\":{\"value\":\"SetSecurity*\"}}},{\"wildcard\":{\"event.action\":{\"value\":\"Update*\"}}},{\"wildcard\":{\"event.action\":{\"value\":\"Upload*\"}}}],\"minimum_should_match\":1}}","key":"query"},"query":{"bool":{"should":[{"wildcard":{"event.action":{"value":"Add*"}}},{"wildcard":{"event.action":{"value":"Change*"}}},{"wildcard":{"event.action":{"value":"Create*"}}},{"wildcard":{"event.action":{"value":"Deactivate*"}}},{"wildcard":{"event.action":{"value":"Delete*"}}},{"wildcard":{"event.action":{"value":"Enable*"}}},{"wildcard":{"event.action":{"value":"Pass*"}}},{"wildcard":{"event.action":{"value":"Remove*"}}},{"wildcard":{"event.action":{"value":"Reset*"}}},{"wildcard":{"event.action":{"value":"Resync*"}}},{"wildcard":{"event.action":{"value":"SetSecurity*"}}},{"wildcard":{"event.action":{"value":"Update*"}}},{"wildcard":{"event.action":{"value":"Upload*"}}}],"minimum_should_match":1}}}],"throttle":"rule","actions":[{"group":"default","id":"56fd1b40-5f85-11ec-9d1e-5b56ec0d9762","params":{"body":"{\n  \"short_description\": \"Suspicious AWS IAM Events (Storage Account)\",\n  \"assignment_group\": \"OPS-GCSO\",\n  \"category\": \"Unauthorized access\",\n  \"contact_type\": \"siem\",\n  \"description\": \"See following Info:\\nSuspicious AWS IAM Events (Storage Account)\\n\\n{{#context.alerts}}\\nError Code: {{aws.cloudtrail.error_code}}\\nEnvironment: {{environment}}\\nAccount ID: {{cloud.account.id}}\\nUserType: {{aws.cloudtrail.user_identity.type}}\\nUser/Role: {{user.name}}\\nPrincipal ID: {{user.id}}\\nEvent: {{event.action}}\\nsource.address: {{source.address}}\\n{{/context.alerts}}\\n\\nSee Process Here:\\nhttps://confluence.godaddy.com/pages/viewpage.action?pageId=214401774\",\n  \"priority\": \"1\",\n  \"severity\": \"2\",\n  \"state\": \"10\"\n}"},"action_type_id":".webhook"}]}
{"id":"f67b0f30-3828-11ec-bf42-87570b8f4ed7","updated_at":"2022-04-05T17:26:15.843Z","updated_by":"jprentice1@godaddy.com","created_at":"2021-10-28T19:55:13.532Z","created_by":"admin","name":"[GD] User Altered the Windows System Clock","tags":["GD","Windows"],"interval":"1h","enabled":true,"description":"The windows system clock has been altered by a user.","risk_score":21,"severity":"low","license":"","output_index":".siem-signals-default","meta":{"from":"10m","kibana_siem_app_url":"https://security-prod.kibana.int.gdcorp.tools/app/security"},"author":[],"false_positives":[],"from":"now-4200s","rule_id":"c829aba8-e6f9-4976-9c32-1aeb27330784","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[],"to":"now","references":[],"version":12,"exceptions_list":[],"immutable":false,"type":"query","language":"kuery","index":["*:windows-*"],"query":"winlog.channel: \"Security\" AND event.code:4616 AND (NOT winlog.event_data.ProcessName: \"C:\\\\Windows\\\\System32\\\\svchost.exe\") and (NOT winlog.event_data.ProcessName: \"C:\\\\Program Files\\\\VMware\\\\VMware Tools\\\\vmtoolsd.exe\")","filters":[],"throttle":"1d","actions":[{"group":"default","id":"56fd1b40-5f85-11ec-9d1e-5b56ec0d9762","params":{"body":"{\n  \"short_description\": \"Elastic Test - Windows System Time Altered by a User\",\n  \"assignment_group\": \"infosec_response\",\n  \"category\": \"Unauthorized access\",\n  \"contact_type\": \"siem\",\n  \"description\": \"A Windows system had its time changed by a user.\\n  \\n{{#context.alerts}}\\n@timestamp: {{signal.original_time}}\\nEventCode: {{event.code}}\\nSubjectUserName: {{winlog.event_data.SubjectUserName}}\\nHostname: {{host.hostname}}\\n{{/context.alerts}}\\n  \\nLink to results: {{context.results_link}}\",\n  \"priority\": \"4\",\n  \"severity\": \"4\",\n  \"state\": \"10\"\n}"},"action_type_id":".webhook"},{"group":"default","id":"elastic-cloud-email","params":{"message":"Rule {{context.rule.name}} generated {{state.signals_count}} alerts.\n\nA Windows system had its time changed by a user.\n  \n{{#context.alerts}}\n@timestamp: {{signal.original_time}}\n\nEventCode: {{event.code}}\n\nSubjectUserName: {{winlog.event_data.SubjectUserName}}\n\nHostname: {{host.hostname}}\n{{/context.alerts}}\n  \nLink to results: {{context.results_link}}","to":["productsecurity@godaddy.com"],"subject":"Elastic Alert: {{context.rule.name}}"},"action_type_id":".email"}]}
{"id":"ec400740-5f34-11ec-9d1e-5b56ec0d9762","updated_at":"2022-04-07T23:52:17.874Z","updated_by":"jprentice1@godaddy.com","created_at":"2021-12-17T12:29:05.603Z","created_by":"admin","name":"User Altered the Linux System Clock","tags":["GD"],"interval":"1h","enabled":true,"description":"NTPD command issued ","risk_score":21,"severity":"low","license":"","output_index":".siem-signals-default","meta":{"from":"10m","kibana_siem_app_url":"https://security-prod.kibana.int.gdcorp.tools/app/security"},"author":[],"false_positives":[],"from":"now-4200s","rule_id":"4292bd17-d5a1-405a-ad3a-86a1080ee1a3","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[],"to":"now","references":[],"version":10,"exceptions_list":[],"immutable":false,"type":"query","language":"kuery","index":["*:onprem-*","*:linux-*"],"query":"","filters":[{"meta":{"type":"phrases","key":"aws.fluent_tags.keyword","params":["LINUXLOG","LINUXSECURE"],"alias":null,"negate":false,"disabled":false},"query":{"bool":{"should":[{"match_phrase":{"aws.fluent_tags.keyword":"LINUXLOG"}},{"match_phrase":{"aws.fluent_tags.keyword":"LINUXSECURE"}}],"minimum_should_match":1}},"$state":{"store":"appState"}},{"query":{"bool":{"should":[{"regexp":{"event.original":{"value":".*[^a-z]+ntp.+(start|stop|restart).*"}}},{"regexp":{"event.original":{"value":".*[^a-z]+(start|stop|restart).+ntp.*"}}}],"minimum_should_match":1}},"meta":{"type":"custom","disabled":false,"negate":false,"alias":null,"key":"query","value":"{\"bool\":{\"should\":[{\"regexp\":{\"event.original\":{\"value\":\".*[^a-z]+ntp.+(start|stop|restart).*\"}}},{\"regexp\":{\"event.original\":{\"value\":\".*[^a-z]+(start|stop|restart).+ntp.*\"}}}],\"minimum_should_match\":1}}"},"$state":{"store":"appState"}},{"meta":{"alias":null,"negate":false,"disabled":false,"type":"phrase","key":"event.dataset","params":{"query":"linux-security.auth"}},"query":{"match_phrase":{"event.dataset":"linux-security.auth"}},"$state":{"store":"appState"}}],"throttle":"1d","actions":[{"group":"default","id":"56fd1b40-5f85-11ec-9d1e-5b56ec0d9762","params":{"body":"{\n  \"short_description\": \"Elastic Test - Linux System Time Altered\",\n  \"assignment_group\": \"infosec_response\",\n  \"category\": \"Unauthorized access\",\n  \"contact_type\": \"siem\",\n  \"description\": \"The Linux system clock has potentially been altered by a user.\\n  \\n{{#context.alerts}}\\n@timestamp: {{signal.original_time}}\\ncommand: {{system.auth.sudo.command}}\\nuser.name: {{user.name}}\\nhost.hostname: {{host.hostname}}\\n{{/context.alerts}}\\n  \\nPlease refer to the \\\"User Altered the Linux System Clock\\\" Elastic Alert for more info.\\nLink to results: {{context.results_link}}\",\n  \"priority\": \"4\",\n  \"severity\": \"4\",\n  \"state\": \"10\"\n}"},"action_type_id":".webhook"},{"group":"default","id":"elastic-cloud-email","params":{"message":"Rule {{context.rule.name}} generated {{state.signals_count}} alerts.\n\nThe Linux system clock has potentially been altered by a user.\n  \n{{#context.alerts}}\n@timestamp: {{signal.original_time}}\n\ncommand: {{system.auth.sudo.command}}\n\nuser.name: {{user.name}}\n\nhost.hostname: {{host.hostname}}\n{{/context.alerts}}\n  \nPlease refer to the \"User Altered the Linux System Clock\" Elastic Alert for more info.\n\nLink to results: {{context.results_link}}","to":["clopez1@godaddy.com","bboham@godaddy.com","jprentice1@godaddy.com"],"subject":"Elastic Alert: {{context.rule.name}}"},"action_type_id":".email"}]}
{"id":"eb402df0-5153-11ec-9fcb-3bc48f034fff","updated_at":"2022-03-21T22:28:46.219Z","updated_by":"jprentice1@godaddy.com","created_at":"2021-11-29T20:35:42.309Z","created_by":"admin","name":"Okta - Unusual profile activation","tags":[],"interval":"1h","enabled":true,"description":"Account created by someone other than expected admin users.","risk_score":21,"severity":"low","license":"","output_index":".siem-signals-default","meta":{"from":"10m","kibana_siem_app_url":"https://security-prod.kibana.int.gdcorp.tools/app/security"},"author":[],"false_positives":[],"from":"now-4200s","rule_id":"66bdcac7-2986-4704-80f6-e14c5560c9c0","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[],"to":"now","references":[],"version":17,"exceptions_list":[],"immutable":false,"type":"query","language":"kuery","index":["*:okta-*"],"query":"","filters":[{"$state":{"store":"appState"},"meta":{"negate":false,"alias":null,"disabled":false,"type":"phrase","params":{"query":"user.lifecycle.activate"},"key":"okta.event_type"},"query":{"match_phrase":{"okta.event_type":"user.lifecycle.activate"}}},{"$state":{"store":"appState"},"meta":{"negate":true,"alias":null,"disabled":false,"type":"phrases","params":["jpeoples@godaddy.com","system@okta.com","csvoboda@godaddy.com"],"key":"okta.actor.alternate_id"},"query":{"bool":{"should":[{"match_phrase":{"okta.actor.alternate_id":"jpeoples@godaddy.com"}},{"match_phrase":{"okta.actor.alternate_id":"system@okta.com"}},{"match_phrase":{"okta.actor.alternate_id":"csvoboda@godaddy.com"}}],"minimum_should_match":1}}}],"throttle":"rule","actions":[{"group":"default","id":"56fd1b40-5f85-11ec-9d1e-5b56ec0d9762","params":{"body":"{\n  \"short_description\": \"Okta - Unusual profile activation\",\n  \"assignment_group\": \"OPS-GCSO\",\n  \"category\": \"Unauthorized access\",\n  \"contact_type\": \"siem\",\n  \"description\": \"To identify new profiles added to Okta by uncommon users. requires follow up to validate non malicious activity \\n \\nSee following Info:\\n{{#context.alerts}}\\n@timestamp: {{signal.original_time}}\\nokta.actor.alternate_id: {{okta.actor.alternate_id}}\\nokta.target.alternate_id: {{okta.target.alternate_id}}\\nokta.display_message: {{okta.display_message}}\\nokta.event_type: {{okta.event_type}}\\nevent.outcome: {{event.outcome}}\\n{{/context.alerts}}\\n \\n{{context.results_link}}\",\n  \"priority\": \"1\",\n  \"severity\": \"3\",\n  \"state\": \"10\"\n}"},"action_type_id":".webhook"}]}
{"id":"d82dc591-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2022-03-03T23:14:25.951Z","updated_by":"schoi@godaddy.com","created_at":"2021-09-22T15:57:53.945Z","created_by":"admin","name":"[GD] Okta Brute Force or Password Spraying Attack - BuildingBlock","tags":["Continuous Monitoring","Elastic","Identity","Identity and Access","Okta","SecOps"],"interval":"15m","enabled":true,"description":"Identifies a high number of failed Okta user authentication attempts from a single IP address, which could be indicative of a brute force or password spraying attack. An adversary may attempt a brute force or password spraying attack to obtain unauthorized access to user accounts.","risk_score":47,"severity":"medium","building_block_type":"default","note":"The Okta Fleet integration or Filebeat module must be enabled to use this rule.","license":"Elastic License v2","output_index":".siem-signals-default","meta":{"from":"1m"},"author":["Elastic"],"false_positives":["Automated processes that attempt to authenticate using expired credentials and unbounded retries may lead to false positives."],"from":"now-960s","rule_id":"d63a8353-5a37-437a-b0ac-5bbfefa2498c","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","technique":[{"reference":"https://attack.mitre.org/techniques/T1110/","name":"Brute Force","subtechnique":[],"id":"T1110"}],"tactic":{"reference":"https://attack.mitre.org/tactics/TA0006/","name":"Credential Access","id":"TA0006"}}],"to":"now","references":["https://developer.okta.com/docs/reference/api/system-log/","https://developer.okta.com/docs/reference/api/event-types/"],"version":17,"exceptions_list":[],"immutable":false,"type":"threshold","language":"kuery","index":["okta*","*:okta-*"],"query":"event.dataset:okta.system and event.category:authentication and event.outcome:failure","filters":[],"threshold":{"field":["okta.actor.alternate_id"],"value":60,"cardinality":[]},"throttle":"no_actions","actions":[]}
{"id":"eab84400-5dae-11ec-ad47-191e7283e0c2","updated_at":"2022-03-21T22:35:55.323Z","updated_by":"jprentice1@godaddy.com","created_at":"2021-12-15T13:57:19.305Z","created_by":"admin","name":"[GD] Windows - Bad AD Tools","tags":["GD","Windows"],"interval":"1h","enabled":true,"description":"Converted from Splunk rule with the same name","risk_score":73,"severity":"high","license":"","output_index":".siem-signals-default","meta":{"from":"10m","kibana_siem_app_url":"https://security-prod.kibana.int.gdcorp.tools/app/security"},"author":[],"false_positives":[],"from":"now-4200s","rule_id":"681b053c-53ba-4b1e-9e77-0a460c2680cd","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[],"to":"now","references":[],"version":22,"exceptions_list":[],"immutable":false,"type":"query","language":"kuery","index":["*:windows-*"],"query":"((winlog.event_id: \"4648\" OR winlog.event_id: \"4688\") AND (event.original: *passwordcontrol.exe* OR event.original: *stuc.exe* OR event.original: *Hyena_x64*)) OR (winlog.event_id: \"4104\" AND (event.original: *DomainPasswordSpray* OR event.original: *dafthack*))","filters":[{"$state":{"store":"appState"},"meta":{"negate":false,"alias":null,"disabled":true,"type":"phrases","params":["4104","4648","4688"],"key":"event.code"},"query":{"bool":{"should":[{"match_phrase":{"event.code":"4104"}},{"match_phrase":{"event.code":"4648"}},{"match_phrase":{"event.code":"4688"}}],"minimum_should_match":1}}},{"$state":{"store":"appState"},"meta":{"negate":false,"alias":null,"disabled":true,"type":"custom","value":"{\"bool\":{\"filter\":[{\"query_string\":{\"query\":\"(*passwordcontrol.exe) OR (*stuc.exe) OR (*Hyena_x64*) OR (*DomainPasswordSpray*) OR (*dafthack*)\",\"default_field\":\"process.executable\"}}]}}","key":"query"},"query":{"bool":{"filter":[{"query_string":{"query":"(*passwordcontrol.exe) OR (*stuc.exe) OR (*Hyena_x64*) OR (*DomainPasswordSpray*) OR (*dafthack*)","default_field":"process.executable"}}]}}}],"throttle":"rule","actions":[{"group":"default","id":"56fd1b40-5f85-11ec-9d1e-5b56ec0d9762","params":{"body":"{\n  \"short_description\": \"Windows - Bad AD Tools\",\n  \"assignment_group\": \"OPS-GCSO\",\n  \"category\": \"Unauthorized access\",\n  \"contact_type\": \"siem\",\n  \"description\": \"See following Info:\\n{{#context.alerts}}\\n@timestamp: {{signal.original_time}}\\nComputer: {{winlog.computer_name}}\\nsubject_user_name: {{winlog.event_data.SubjectUserName}}\\ntarget_user_name: {{winlog.event_data.TargetUserName}}\\nprocess: {{process.name}}\\naction: {{event.action}}\\n{{/context.alerts}}\\n\\nThis panel is monitoring for instances of known-bad AD tools being used within our environment. Because this is a key indicator from our persistent social engineerng actor any new values present in this panel require an immediate call-out.\\n \\n{{context.results_link}}\",\n  \"priority\": \"1\",\n  \"severity\": \"2\",\n  \"state\": \"10\"\n}"},"action_type_id":".webhook"},{"group":"default","id":"elastic-cloud-email","params":{"subject":"Elastic Alert: {{context.rule.name}}","to":["gcso@godaddy.com"],"message":"Rule {{context.rule.name}} generated {{state.signals_count}} alerts.\n\nLink to results: {{context.results_link}}"},"action_type_id":".email"},{"group":"default","id":"45e4ab50-9a83-11ec-b095-87bc28af8de9","params":{"message":"Your *{{context.rule.name}}* alert matched {{state.signals_count}} events.\n\n{{#context.alerts}}\nResult: ```{{event.original}}```\n\n{{/context.alerts}}"},"action_type_id":".slack"}]}
{"id":"06f56e30-5c11-11ec-8f3e-0bb4bad39cd8","updated_at":"2021-12-13T12:34:34.860Z","updated_by":"admin","created_at":"2021-12-13T12:34:34.860Z","created_by":"admin","name":"Okta - Rare Country by User","tags":["GD","Okta","Security"],"interval":"15m","enabled":true,"description":"ML job looks for anomalies in country for each user","risk_score":50,"severity":"medium","license":"","output_index":".siem-signals-default","meta":{"from":"10m","kibana_siem_app_url":"https://827ebd6fd06146bea2d2ad3a453d7e43.vpce.gdw55e.elastic-cloud.com:9243/app/security"},"author":[],"false_positives":[],"from":"now-1500s","rule_id":"a76de389-f059-4b5f-8d08-6943323d169f","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[],"to":"now","references":[],"version":1,"exceptions_list":[],"immutable":false,"type":"machine_learning","anomaly_threshold":50,"machine_learning_job_id":["okta-rare-city-by-user"],"throttle":"no_actions","actions":[]}
{"id":"691eb970-af92-11ec-8d7e-45182ce7df0f","updated_at":"2022-03-30T21:06:47.265Z","updated_by":"jprentice1@godaddy.com","created_at":"2022-03-29T18:59:50.560Z","created_by":"jprentice1@godaddy.com","name":"VPN Logins from Russia","tags":["Security","GD"],"interval":"10m","enabled":true,"description":"Alerts on any login from Russia except whitelisted users","risk_score":99,"severity":"critical","license":"","output_index":".siem-signals-default","meta":{"from":"5m","kibana_siem_app_url":"https://security-prod.kibana.int.gdcorp.tools/app/security"},"author":[],"false_positives":[],"from":"now-900s","rule_id":"57aa4f2b-b5ed-4c05-b1b0-3517d632a894","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[],"to":"now","references":[],"version":23,"exceptions_list":[{"list_id":"9c5fe742-9059-4a67-8b9c-6e40c3909187","namespace_type":"single","id":"759aca40-aef2-11ec-b59d-e77f2674f157","type":"detection"}],"immutable":false,"type":"query","language":"kuery","index":["*:okta-*"],"query":"","filters":[{"$state":{"store":"appState"},"meta":{"negate":false,"alias":null,"disabled":false,"type":"phrase","params":{"query":"User single sign on to app"},"key":"okta.display_message"},"query":{"match_phrase":{"okta.display_message":"User single sign on to app"}}},{"$state":{"store":"appState"},"meta":{"negate":false,"alias":null,"disabled":false,"type":"phrase","params":{"query":"Palo Alto Networks - GlobalProtect"},"key":"okta.target.display_name"},"query":{"match_phrase":{"okta.target.display_name":"Palo Alto Networks - GlobalProtect"}}},{"$state":{"store":"appState"},"meta":{"negate":false,"alias":null,"disabled":false,"type":"phrase","params":{"query":"Russia"},"key":"client.geo.country_name"},"query":{"match_phrase":{"client.geo.country_name":"Russia"}}}],"throttle":"rule","actions":[{"group":"default","id":"elastic-cloud-email","params":{"subject":"Elastic Alert: {{context.rule.name}}","to":["clopez1@godaddy.com","pgreen@godaddy.com"],"message":"Rule {{context.rule.name}} generated {{state.signals_count}} alerts.\n\nSee the following info:\n\n{{#context.alerts}}\n @timestamp: {{signal.original_time}}\n\n okta.actor.alternate_id: {{okta.actor.alternate_id}}\n\n Country: {{client.geo.country_name}}\n\n Description: null\n\n client.ip: {{client.ip}}\n\n {{{context.results_link}}}\n{{/context.alerts}}\n\n\nThis alert is for users with VPN logons from the Russia region. Review the tracker below for any users that do not have an exception. If any events are seen:\n\n1. Begin review of user's Okta app access for suspicious activity."},"action_type_id":".email"}]}
{"id":"5bbae290-2b5d-11ec-a2aa-e9d655de077e","updated_at":"2022-03-01T20:03:39.552Z","updated_by":"jprentice1@godaddy.com","created_at":"2021-10-12T13:07:31.578Z","created_by":"admin","name":"[GD] Okta - Successful logins from RF blacklisted IP addresses","tags":["GD"],"interval":"5m","enabled":true,"description":"To determine access from bad sources","risk_score":21,"severity":"low","license":"","output_index":".siem-signals-default","meta":{"from":"10m","kibana_siem_app_url":"https://827ebd6fd06146bea2d2ad3a453d7e43.vpce.gdw55e.elastic-cloud.com:9243/app/security"},"timestamp_override":"@timestamp","author":[],"false_positives":[],"from":"now-900s","rule_id":"1fc0ec66-631f-445b-9a10-001c5237c49b","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0006","reference":"https://attack.mitre.org/tactics/TA0006","name":"Credential Access"},"technique":[]}],"to":"now","references":[],"version":15,"exceptions_list":[],"immutable":false,"type":"threat_match","language":"kuery","index":["*:okta-*"],"query":"event.outcome : \"success\" or okta.outcome.result : \"ALLOW\"","filters":[{"meta":{"type":"phrases","key":"okta.actor.alternate_id","params":["unknown","system@okta.com","ADService@godaddy.com"],"alias":null,"negate":true,"disabled":false},"query":{"bool":{"should":[{"match_phrase":{"okta.actor.alternate_id":"unknown"}},{"match_phrase":{"okta.actor.alternate_id":"system@okta.com"}},{"match_phrase":{"okta.actor.alternate_id":"ADService@godaddy.com"}}],"minimum_should_match":1}},"$state":{"store":"appState"}}],"threat_filters":[],"threat_query":"threatintel.indicator.ip:*","threat_mapping":[{"entries":[{"field":"okta.client.ip","type":"mapping","value":"threatintel.indicator.ip"}]}],"threat_language":"kuery","threat_index":["rf_ip_risklist"],"threat_indicator_path":"","throttle":"no_actions","actions":[]}
{"id":"e5c95200-3288-11ec-a2aa-e9d655de077e","updated_at":"2022-05-02T23:34:56.172Z","updated_by":"jprentice1@godaddy.com","created_at":"2021-10-21T16:06:50.024Z","created_by":"admin","name":"[GD] Okta Brute Force","tags":[],"interval":"5m","enabled":true,"description":"To identify a brute force attack through okta auth.\nThe following is the configuration used to create SNOW SIR tickets:\n\n{\n  \"short_description\": \"Elastic Test - Okta - Brute Force\",\n  \"assignment_group\": \"OPS-GCSO\",\n  \"category\": \"Unauthorized access\",\n  \"contact_type\": \"siem\",\n  \"description\": \"\"\"See attached info:\n{{#context.alerts}}\n@timestamp : {{signal.original_time}}\n{{#signal.threshold_result.terms}}\nokta.actor.alternate_id : {{value}}\n{{/signal.threshold_result.terms}}\nAttempts  : {{signal.threshold_result.count}}\n{{/context.alerts}}\"\"\",\n  \"priority\": \"5\",\n  \"severity\": \"3\",\n  \"state\": \"10\"\n}","risk_score":21,"severity":"low","license":"","output_index":".siem-signals-default","meta":{"from":"1m","kibana_siem_app_url":"https://security-prod.kibana.int.gdcorp.tools/app/security"},"author":[],"false_positives":[],"from":"now-360s","rule_id":"6af72aeb-10e6-4d24-ad12-9b9c02c2a86b","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"reference":"https://attack.mitre.org/tactics/TA0006","name":"Credential Access","id":"TA0006"},"technique":[{"reference":"https://attack.mitre.org/techniques/T1110","name":"Brute Force","id":"T1110","subtechnique":[]}]}],"to":"now","references":[],"version":19,"exceptions_list":[],"immutable":false,"type":"threshold","language":"kuery","index":["*:okta-*"],"query":"NOT (_index: GD-AWS-USA-GD-secessplow-ESSP\\:okta-users-* OR _index: GD-AWS-USA-GD-secessplow-ESSP\\:okta-groups-* OR _index: GD-AWS-USA-GD-secessplow-ESSP\\:okta-apps-*) AND NOT okta.outcome.result : \"SUCCESS\" AND NOT okta.outcome.result: \"ALLOW\"","filters":[{"$state":{"store":"appState"},"meta":{"negate":true,"alias":null,"disabled":false,"type":"custom","value":"{\"bool\":{\"should\":[{\"match_phrase\":{\"okta.actor.alternate_id\":\"unknown\"}},{\"match_phrase\":{\"okta.actor.alternate_id\":\"system@okta.com\"}},{\"match_phrase\":{\"okta.actor.alternate_id\":\"ADService@godaddy.com\"}}],\"minimum_should_match\":1}}","key":"query"},"query":{"bool":{"should":[{"match_phrase":{"okta.actor.alternate_id":"unknown"}},{"match_phrase":{"okta.actor.alternate_id":"system@okta.com"}},{"match_phrase":{"okta.actor.alternate_id":"ADService@godaddy.com"}}],"minimum_should_match":1}}},{"$state":{"store":"appState"},"meta":{"negate":true,"alias":null,"disabled":false,"type":"custom","value":"{\"bool\":{\"should\":[{\"wildcard\":{\"okta.target.display_name\":{\"value\":\"Microsoft Office 365\"}}},{\"wildcard\":{\"okta.target.display_name\":{\"value\":\"GoDaddy SSO\"}}},{\"wildcard\":{\"okta.target.display_name\":{\"value\":\"Slack*\"}}},{\"wildcard\":{\"okta.target.display_name\":{\"value\":\"Okta Admin Console\"}}},{\"wildcard\":{\"okta.target.alternate_id\":{\"value\":\"Zoom Enterprise\"}}}],\"minimum_should_match\":1}}","key":"query"},"query":{"bool":{"should":[{"wildcard":{"okta.target.display_name":{"value":"Microsoft Office 365"}}},{"wildcard":{"okta.target.display_name":{"value":"GoDaddy SSO"}}},{"wildcard":{"okta.target.display_name":{"value":"Slack*"}}},{"wildcard":{"okta.target.display_name":{"value":"Okta Admin Console"}}},{"wildcard":{"okta.target.alternate_id":{"value":"Zoom Enterprise"}}}],"minimum_should_match":1}}},{"$state":{"store":"appState"},"meta":{"negate":true,"alias":null,"disabled":false,"type":"custom","value":"{\"bool\":{\"should\":[{\"match_phrase\":{\"okta.client.user_agent.raw_user_agent\":\"unknown\"}},{\"regexp\":{\"okta.client.user_agent.raw_user_agent\":\"Microsoft Office.*\"}},{\"regexp\":{\"okta.client.user_agent.raw_user_agent\":\"AppleExchangeWebServices.*\"}},{\"regexp\":{\"okta.client.user_agent.raw_user_agent\":\"Android-Mail.*\"}},{\"regexp\":{\"okta.client.user_agent.raw_user_agent\":\".*CalendarAgent.*\"}},{\"match_phrase\":{\"okta.client.user_agent.raw_user_agent\":\"Windows-AzureAD-Authentication-Provider/.*\"}},{\"regexp\":{\"okta.client.user_agent.raw_user_agent\":\"Okta Radius Agent.*\"}},{\"regexp\":{\"okta.client.user_agent.raw_user_agent\":\"PAN GlobalProtect.*\"}},{\"regexp\":{\"okta.client.user_agent.raw_user_agent\":\"Jamf%20Connect.*\"}},{\"regexp\":{\"okta.client.user_agent.raw_user_agent\":\"okta-auth-dotnet.*\"}},{\"regexp\":{\"okta.client.user_agent.raw_user_agent\":\"SecurityAgentHelper.*\"}}],\"minimum_should_match\":1}}","key":"query"},"query":{"bool":{"should":[{"match_phrase":{"okta.client.user_agent.raw_user_agent":"unknown"}},{"regexp":{"okta.client.user_agent.raw_user_agent":"Microsoft Office.*"}},{"regexp":{"okta.client.user_agent.raw_user_agent":"AppleExchangeWebServices.*"}},{"regexp":{"okta.client.user_agent.raw_user_agent":"Android-Mail.*"}},{"regexp":{"okta.client.user_agent.raw_user_agent":".*CalendarAgent.*"}},{"match_phrase":{"okta.client.user_agent.raw_user_agent":"Windows-AzureAD-Authentication-Provider/.*"}},{"regexp":{"okta.client.user_agent.raw_user_agent":"Okta Radius Agent.*"}},{"regexp":{"okta.client.user_agent.raw_user_agent":"PAN GlobalProtect.*"}},{"regexp":{"okta.client.user_agent.raw_user_agent":"Jamf%20Connect.*"}},{"regexp":{"okta.client.user_agent.raw_user_agent":"okta-auth-dotnet.*"}},{"regexp":{"okta.client.user_agent.raw_user_agent":"SecurityAgentHelper.*"}}],"minimum_should_match":1}}},{"$state":{"store":"appState"},"meta":{"field":"client.ip","negate":true,"alias":null,"disabled":false,"params":{"lt":"132.148.54.255","gte":"132.148.54.0"},"type":"range","key":"client.ip"},"query":{"range":{"client.ip":{"lt":"132.148.54.255","gte":"132.148.54.0"}}}},{"$state":{"store":"appState"},"meta":{"field":"client.ip","negate":true,"alias":null,"disabled":false,"params":{"lt":"64.202.160.255","gte":"64.202.160.0"},"type":"range","key":"client.ip"},"query":{"range":{"client.ip":{"lt":"64.202.160.255","gte":"64.202.160.0"}}}},{"$state":{"store":"appState"},"meta":{"negate":true,"alias":null,"disabled":false,"type":"phrases","params":["50.116.41.217","198.58.111.80","192.81.129.227","139.162.220.143"],"key":"client.ip"},"query":{"bool":{"should":[{"match_phrase":{"client.ip":"50.116.41.217"}},{"match_phrase":{"client.ip":"198.58.111.80"}},{"match_phrase":{"client.ip":"192.81.129.227"}},{"match_phrase":{"client.ip":"139.162.220.143"}}],"minimum_should_match":1}}},{"$state":{"store":"appState"},"meta":{"negate":false,"alias":null,"disabled":false,"type":"exists","value":"exists","key":"client.ip"},"query":{"exists":{"field":"client.ip"}}}],"threshold":{"field":["okta.actor.alternate_id"],"value":51,"cardinality":[]},"throttle":"rule","actions":[{"group":"default","id":"56fd1b40-5f85-11ec-9d1e-5b56ec0d9762","params":{"body":"{\n  \"short_description\": \"Elastic Test - Okta - Brute Force\",\n  \"assignment_group\": \"OPS-GCSO\",\n  \"category\": \"Unauthorized access\",\n  \"contact_type\": \"siem\",\n  \"description\": \"See attached info:\\n{{#context.alerts}}\\n@timestamp : {{signal.original_time}}\\n{{#signal.threshold_result.terms}}\\nokta.actor.alternate_id : {{value}}\\n{{/signal.threshold_result.terms}}\\nAttempts  : {{signal.threshold_result.count}}\\n{{/context.alerts}}\\n\\nLink to Visualization for further details: https://security-prod.kibana.int.gdcorp.tools/app/lens#/edit/ebfaac90-ca6e-11ec-bcdd-cddd1ccb20e4?_g=(filters:!(),refreshInterval:(pause:!t,value:0),time:(from:now-30m,to:now))\",\n  \"priority\": \"5\",\n  \"severity\": \"3\",\n  \"state\": \"10\"\n}"},"action_type_id":".webhook"},{"group":"default","id":"elastic-cloud-email","params":{"message":"The alert condition for '{{context.rule.name}}' was triggered.\n\nLink to results: {{context.results_link}}","to":["twhipple1@godaddy.com"],"subject":"Elastic Alert: {{context.rule.name}}"},"action_type_id":".email"}]}
{"id":"cd4c2090-1bbd-11ec-be20-3f0a15bcc54c","updated_at":"2021-12-17T12:39:00.086Z","updated_by":"admin","created_at":"2021-09-22T15:57:35.843Z","created_by":"admin","name":"Linux Brute Force or Password Spraying Attack","tags":["Linux","Continuos Monitoring","Identity","GD"],"interval":"5m","enabled":true,"description":"Detect password spraying attacks on Linux systems","risk_score":21,"severity":"low","license":"","output_index":".siem-signals-default","meta":{"from":"1m","kibana_siem_app_url":"https://security-prod.kibana.int.gdcorp.tools/app/security"},"author":[],"false_positives":[],"from":"now-360s","rule_id":"2330fef9-f340-44b1-b042-b7a0979f06b7","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","technique":[{"reference":"https://attack.mitre.org/techniques/T1110","name":"Brute Force","subtechnique":[{"reference":"https://attack.mitre.org/techniques/T1110/003","name":"Password Spraying","id":"T1110.003"}],"id":"T1110"}],"tactic":{"reference":"https://attack.mitre.org/tactics/TA0006","name":"Credential Access","id":"TA0006"}}],"to":"now","references":[],"version":10,"exceptions_list":[],"immutable":false,"type":"threshold","language":"kuery","index":["linux-secure-*"],"query":"event.outcome: failure and event.category: authentication and event.action: ssh_login","filters":[],"threshold":{"field":["source.ip"],"value":5,"cardinality":[]},"throttle":"no_actions","actions":[]}
{"id":"efcdbed0-5da8-11ec-ad47-191e7283e0c2","updated_at":"2022-03-21T22:35:18.230Z","updated_by":"jprentice1@godaddy.com","created_at":"2021-12-15T13:14:31.079Z","created_by":"admin","name":"Service-Now - HIPS","tags":["GD"],"interval":"1h","enabled":true,"description":"Converted from Splunk rule of the same name","risk_score":21,"severity":"low","license":"","output_index":".siem-signals-default","meta":{"from":"10m","kibana_siem_app_url":"https://security-prod.kibana.int.gdcorp.tools/app/security"},"author":[],"false_positives":[],"from":"now-4200s","rule_id":"0968aa07-8c67-456d-a794-2e8e96b300c3","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[],"to":"now","references":[],"version":16,"exceptions_list":[],"immutable":false,"type":"query","language":"kuery","index":["*:onprem-*"],"query":"not trendmicro.dvchost : P3VMC3* ","filters":[{"$state":{"store":"appState"},"meta":{"negate":false,"alias":null,"disabled":false,"type":"phrase","params":{"query":"DEEPSECURITY"},"key":"aws.fluent_tags"},"query":{"match_phrase":{"aws.fluent_tags":"DEEPSECURITY"}}},{"$state":{"store":"appState"},"meta":{"negate":false,"alias":null,"disabled":false,"type":"phrases","params":["Delete","Quarantine"],"key":"trendmicro.act"},"query":{"bool":{"should":[{"match_phrase":{"trendmicro.act":"Delete"}},{"match_phrase":{"trendmicro.act":"Quarantine"}}],"minimum_should_match":1}}},{"$state":{"store":"appState"},"meta":{"negate":true,"alias":null,"disabled":false,"type":"custom","value":"{\"bool\":{\"should\":[{\"wildcard\":{\"trendmicro.filePath\":{\"value\":\"D:\\\\\\\\\\\\\\\\Content\"}}},{\"wildcard\":{\"trendmicro.filePath\":{\"value\":\"E:\\\\\\\\\\\\\\\\IrisFiles\\\\\\\\\\\\\\\\CorpIrisAttachments\"}}},{\"wildcard\":{\"trendmicro.filePath\":{\"value\":\"E:\\\\\\\\\\\\\\\\LegalDocs\\\\\\\\\\\\\\\\TempFilter\\\\\\\\\\\\\\\\*\"}}},{\"wildcard\":{\"trendmicro.filePath\":{\"value\":\"D:\\\\\\\\\\\\\\\\temp\\\\\\\\\\\\\\\\IIS Temporary Compressed Files\"}}},{\"wildcard\":{\"trendmicro.filePath\":{\"value\":\"D:\\\\\\\\\\\\\\\\registrar server components\\\\\\\\\\\\\\\\Logs\\\\\\\\\\\\\\\\DBPEmailForwardingSvc\\\\\\\\\\\\\\\\*\"}}},{\"wildcard\":{\"trendmicro.filePath\":{\"value\":\"E:\\\\\\\\\\\\\\\\PleskVhosts\\\\\\\\\\\\\\\\*\"}}},{\"wildcard\":{\"trendmicro.filePath\":{\"value\":\"H:\\\\\\\\\\\\\\\\Hosting\\\\\\\\\\\\\\\\*\"}}},{\"wildcard\":{\"trendmicro.filePath\":{\"value\":\"D:\\\\\\\\\\\\\\\\Hosting\\\\\\\\\\\\\\\\*\"}}},{\"wildcard\":{\"trendmicro.filePath\":{\"value\":\"E:\\\\\\\\\\\\\\\\IrisFiles\\\\\\\\\\\\\\\\*\"}}},{\"wildcard\":{\"trendmicro.filePath\":{\"value\":\"E:\\\\\\\\\\\\\\\\System Volume Information\\\\\\\\\\\\\\\\*\"}}},{\"wildcard\":{\"trendmicro.filePath\":{\"value\":\"G:\\\\\\\\\\\\\\\\*\"}}},{\"wildcard\":{\"trendmicro.filePath\":{\"value\":\"*/var/chroot/home/*\"}}},{\"wildcard\":{\"trendmicro.filePath\":{\"value\":\"*/opt/chroot/mount/*\"}}},{\"wildcard\":{\"trendmicro.filePath\":{\"value\":\"*/var/chroot/var/*\"}}},{\"wildcard\":{\"trendmicro.filePath\":{\"value\":\"*/mail/*\"}}},{\"wildcard\":{\"trendmicro.filePath\":{\"value\":\"Z:/PleskVhosts/*\"}}},{\"wildcard\":{\"trendmicro.filePath\":{\"value\":\"*/var/spool/*\"}}},{\"wildcard\":{\"trendmicro.filePath\":{\"value\":\"*/public_html/*\"}}},{\"wildcard\":{\"trendmicro.filePath\":{\"value\":\"*/php/*\"}}},{\"wildcard\":{\"trendmicro.filePath\":{\"value\":\"*/tmp/*\"}}},{\"wildcard\":{\"trendmicro.filePath\":{\"value\":\"*/home/*\"}}},{\"wildcard\":{\"trendmicro.filePath\":{\"value\":\"/dev/shm/*\"}}}],\"minimum_should_match\":1}}","key":"query"},"query":{"bool":{"should":[{"wildcard":{"trendmicro.filePath":{"value":"D:\\\\\\\\Content"}}},{"wildcard":{"trendmicro.filePath":{"value":"E:\\\\\\\\IrisFiles\\\\\\\\CorpIrisAttachments"}}},{"wildcard":{"trendmicro.filePath":{"value":"E:\\\\\\\\LegalDocs\\\\\\\\TempFilter\\\\\\\\*"}}},{"wildcard":{"trendmicro.filePath":{"value":"D:\\\\\\\\temp\\\\\\\\IIS Temporary Compressed Files"}}},{"wildcard":{"trendmicro.filePath":{"value":"D:\\\\\\\\registrar server components\\\\\\\\Logs\\\\\\\\DBPEmailForwardingSvc\\\\\\\\*"}}},{"wildcard":{"trendmicro.filePath":{"value":"E:\\\\\\\\PleskVhosts\\\\\\\\*"}}},{"wildcard":{"trendmicro.filePath":{"value":"H:\\\\\\\\Hosting\\\\\\\\*"}}},{"wildcard":{"trendmicro.filePath":{"value":"D:\\\\\\\\Hosting\\\\\\\\*"}}},{"wildcard":{"trendmicro.filePath":{"value":"E:\\\\\\\\IrisFiles\\\\\\\\*"}}},{"wildcard":{"trendmicro.filePath":{"value":"E:\\\\\\\\System Volume Information\\\\\\\\*"}}},{"wildcard":{"trendmicro.filePath":{"value":"G:\\\\\\\\*"}}},{"wildcard":{"trendmicro.filePath":{"value":"*/var/chroot/home/*"}}},{"wildcard":{"trendmicro.filePath":{"value":"*/opt/chroot/mount/*"}}},{"wildcard":{"trendmicro.filePath":{"value":"*/var/chroot/var/*"}}},{"wildcard":{"trendmicro.filePath":{"value":"*/mail/*"}}},{"wildcard":{"trendmicro.filePath":{"value":"Z:/PleskVhosts/*"}}},{"wildcard":{"trendmicro.filePath":{"value":"*/var/spool/*"}}},{"wildcard":{"trendmicro.filePath":{"value":"*/public_html/*"}}},{"wildcard":{"trendmicro.filePath":{"value":"*/php/*"}}},{"wildcard":{"trendmicro.filePath":{"value":"*/tmp/*"}}},{"wildcard":{"trendmicro.filePath":{"value":"*/home/*"}}},{"wildcard":{"trendmicro.filePath":{"value":"/dev/shm/*"}}}],"minimum_should_match":1}}},{"$state":{"store":"appState"},"meta":{"negate":true,"alias":null,"disabled":false,"type":"custom","value":"{\"bool\":{\"should\":[{\"wildcard\":{\"trendmicro.trigger\":{\"value\":\"Cookie*\"}}},{\"wildcard\":{\"trendmicro.trigger\":{\"value\":\"*WEBSHELL*\"}}},{\"wildcard\":{\"trendmicro.trigger\":{\"value\":\"*CHOPPER*\"}}},{\"wildcard\":{\"trendmicro.trigger\":{\"value\":\"*SPAMBOT*\"}}},{\"wildcard\":{\"trendmicro.trigger\":{\"value\":\"*Adware*\"}}},{\"wildcard\":{\"trendmicro.trigger\":{\"value\":\"*PUA*\"}}}],\"minimum_should_match\":1}}","key":"query"},"query":{"bool":{"should":[{"wildcard":{"trendmicro.trigger":{"value":"Cookie*"}}},{"wildcard":{"trendmicro.trigger":{"value":"*WEBSHELL*"}}},{"wildcard":{"trendmicro.trigger":{"value":"*CHOPPER*"}}},{"wildcard":{"trendmicro.trigger":{"value":"*SPAMBOT*"}}},{"wildcard":{"trendmicro.trigger":{"value":"*Adware*"}}},{"wildcard":{"trendmicro.trigger":{"value":"*PUA*"}}}],"minimum_should_match":1}}}],"throttle":"rule","actions":[{"group":"default","id":"56fd1b40-5f85-11ec-9d1e-5b56ec0d9762","params":{"body":"{\n  \"short_description\": \"HIPS Alert ({{state.signals_count}} alerts)\",\n  \"assignment_group\": \"OPS-GCSO\",\n  \"category\": \"Unauthorized access\",\n  \"contact_type\": \"siem\",\n  \"description\": \"Dashboard - https://security-prod.kibana.int.gdcorp.tools/app/dashboards#/view/796ccc90-51fa-11ec-9cfc-af15db683ef5\\nProcess - https://confluence.godaddy.com/display/IRKB/System+Activity+Investigations\\n\\n{{#context.alerts}}\\n@timestamp: {{signal.original_time}}\\nalert: {{trendmicro.trigger}}\\nInfected_Resource: NULL\\nmsg: {{trendmicro.msg}}\\nact: {{trendmicro.act}}\\ndvchost: {{trendmicro.dvchost}}\\n{{/context.alerts}}\\n\\nAlert Source: Service-Now - HIPS (Elastic)\",\n  \"priority\": \"3\",\n  \"severity\": \"3\",\n  \"state\": \"10\"\n}"},"action_type_id":".webhook"}]}
{"id":"67882710-7e12-11ec-913f-f3e6d4d708c3","updated_at":"2022-03-31T23:39:30.993Z","updated_by":"clopez1@godaddy.com","created_at":"2022-01-25T19:10:05.776Z","created_by":"admin","name":"VPN Logins from China","tags":["Security","GD"],"interval":"10m","enabled":true,"description":"Alerts on any login from China except whitelisted users","risk_score":99,"severity":"critical","license":"","output_index":".siem-signals-default","meta":{"from":"5m","kibana_siem_app_url":"https://security-prod.kibana.int.gdcorp.tools/app/security"},"author":[],"false_positives":[],"from":"now-900s","rule_id":"05f77184-9186-4c41-b492-811f63fa631f","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[],"to":"now","references":[],"version":14,"exceptions_list":[{"list_id":"9c5fe742-9059-4a67-8b9c-6e40c3909187","namespace_type":"single","id":"759aca40-aef2-11ec-b59d-e77f2674f157","type":"detection"}],"immutable":false,"type":"query","language":"kuery","index":["*:okta-*"],"query":"","filters":[{"$state":{"store":"appState"},"meta":{"negate":false,"alias":null,"disabled":false,"type":"phrase","params":{"query":"User single sign on to app"},"key":"okta.display_message"},"query":{"match_phrase":{"okta.display_message":"User single sign on to app"}}},{"$state":{"store":"appState"},"meta":{"negate":false,"alias":null,"disabled":false,"type":"phrase","params":{"query":"Palo Alto Networks - GlobalProtect"},"key":"okta.target.display_name"},"query":{"match_phrase":{"okta.target.display_name":"Palo Alto Networks - GlobalProtect"}}},{"$state":{"store":"appState"},"meta":{"negate":false,"alias":null,"disabled":false,"type":"phrase","params":{"query":"China"},"key":"client.geo.country_name"},"query":{"match_phrase":{"client.geo.country_name":"China"}}}],"throttle":"rule","actions":[{"group":"default","id":"56fd1b40-5f85-11ec-9d1e-5b56ec0d9762","params":{"body":"{\n  \"short_description\": \"VPN Logins from China\",\n  \"assignment_group\": \"OPS-GCSO\",\n  \"category\": \"Unauthorized access\",\n  \"contact_type\": \"siem\",\n  \"description\": \"See the following info:\\n{{#context.alerts}}\\n @timestamp: {{signal.original_time}}\\n okta.actor.alternate_id: {{okta.actor.alternate_id}}\\n Country: {{client.geo.country_name}}\\n Description: null\\n client.ip: {{client.ip}}\\n\\n {{{context.results_link}}}\\n{{/context.alerts}}\\nFollow the following process for this alert - https://confluence.godaddy.com/display/IRKB/IRT+-+VPN+-+Unauthorized+China+VPN\\n\",\n  \"priority\": \"1\",\n  \"severity\": \"3\",\n  \"state\": \"10\"\n}"},"action_type_id":".webhook"}]}
{"id":"1a8e7340-5e84-11ec-913f-f3e6d4d708c3","updated_at":"2022-03-01T20:04:19.160Z","updated_by":"jprentice1@godaddy.com","created_at":"2021-12-16T15:23:22.192Z","created_by":"admin","name":"Trend Micro MD5 identified in tanium or recorded future","tags":["GD"],"interval":"30m","enabled":true,"description":"Currently only matches against Tanium md5s","risk_score":47,"severity":"medium","license":"","output_index":".siem-signals-default","meta":{"from":"1m","kibana_siem_app_url":"https://827ebd6fd06146bea2d2ad3a453d7e43.vpce.gdw55e.elastic-cloud.com:9243/app/security"},"author":[],"false_positives":[],"from":"now-1860s","rule_id":"00453c27-e4a6-4f02-9963-2d8ce0ab8203","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[],"to":"now","references":[],"version":3,"exceptions_list":[],"immutable":false,"type":"threat_match","language":"kuery","index":["*:onprem-*"],"query":"trendmicro.TrendMicroDsFileMD5 : * ","filters":[{"meta":{"alias":null,"negate":false,"disabled":false,"type":"phrase","key":"aws.fluent_tags","params":{"query":"DEEPSECURITY"}},"query":{"match_phrase":{"aws.fluent_tags":"DEEPSECURITY"}},"$state":{"store":"appState"}}],"threat_filters":[],"threat_query":"*","threat_mapping":[{"entries":[{"field":"trendmicro.TrendMicroDsFileMD5","type":"mapping","value":"tanium.match.properties.file.md5"}]}],"threat_language":"kuery","threat_index":["md5-list-tanium"],"threat_indicator_path":"","throttle":"no_actions","actions":[]}
{"id":"487c91f0-94a9-11ec-b058-3bdfa1ca61dc","updated_at":"2022-03-30T21:13:03.266Z","updated_by":"jprentice1@godaddy.com","created_at":"2022-02-23T13:05:32.836Z","created_by":"admin","name":"[GD] Okta Brute Force - more than 1 useragent and more than 2 source IPs","tags":[],"interval":"1h","enabled":true,"description":"To identify a brute force attack through okta auth","risk_score":21,"severity":"low","license":"","output_index":".siem-signals-default","meta":{"from":"10m","kibana_siem_app_url":"https://security-prod.kibana.int.gdcorp.tools/app/security"},"author":[],"false_positives":[],"from":"now-4200s","rule_id":"a4df1ab4-faea-4cd6-b131-8f8271c02b9f","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"reference":"https://attack.mitre.org/tactics/TA0006","name":"Credential Access","id":"TA0006"},"technique":[{"reference":"https://attack.mitre.org/techniques/T1110","name":"Brute Force","id":"T1110","subtechnique":[]}]}],"to":"now","references":[],"version":22,"exceptions_list":[],"immutable":false,"type":"threshold","language":"kuery","index":["*:okta-*"],"query":"event.dataset:okta.system and event.category:authentication and event.outcome:failure","filters":[{"$state":{"store":"appState"},"meta":{"negate":true,"alias":null,"disabled":false,"type":"custom","value":"{\"bool\":{\"should\":[{\"match_phrase\":{\"okta.actor.alternate_id\":\"unknown\"}},{\"match_phrase\":{\"okta.actor.alternate_id\":\"system@okta.com\"}},{\"match_phrase\":{\"okta.actor.alternate_id\":\"ADService@godaddy.com\"}}],\"minimum_should_match\":1}}","key":"query"},"query":{"bool":{"should":[{"match_phrase":{"okta.actor.alternate_id":"unknown"}},{"match_phrase":{"okta.actor.alternate_id":"system@okta.com"}},{"match_phrase":{"okta.actor.alternate_id":"ADService@godaddy.com"}}],"minimum_should_match":1}}},{"$state":{"store":"appState"},"meta":{"negate":true,"alias":null,"disabled":false,"type":"phrase","params":{"query":"/app/office365/exk3q5qqbpJoB61dF0x7/sso/wsfed/username13?"},"key":"url.original"},"query":{"match_phrase":{"url.original":"/app/office365/exk3q5qqbpJoB61dF0x7/sso/wsfed/username13?"}}},{"$state":{"store":"appState"},"meta":{"negate":true,"alias":null,"disabled":false,"type":"phrase","params":{"query":"/app/office365/exk3q5qqbpJoB61dF0x7/sso/wsfed/active?"},"key":"url.original"},"query":{"match_phrase":{"url.original":"/app/office365/exk3q5qqbpJoB61dF0x7/sso/wsfed/active?"}}},{"$state":{"store":"appState"},"meta":{"negate":true,"alias":null,"disabled":false,"type":"custom","value":"{\"bool\":{\"should\":[{\"match_phrase\":{\"okta.client.user_agent.raw_user_agent\":\"unknown\"}},{\"regexp\":{\"okta.client.user_agent.raw_user_agent\":\"Microsoft Office.*\"}},{\"regexp\":{\"okta.client.user_agent.raw_user_agent\":\"AppleExchangeWebServices.*\"}},{\"regexp\":{\"okta.client.user_agent.raw_user_agent\":\"Android-Mail.*\"}},{\"regexp\":{\"okta.client.user_agent.raw_user_agent\":\".*CalendarAgent.*\"}},{\"match_phrase\":{\"okta.client.user_agent.raw_user_agent\":\"Windows-AzureAD-Authentication-Provider/1.0\"}},{\"regexp\":{\"okta.client.user_agent.raw_user_agent\":\"Okta Radius Agent.*\"}},{\"regexp\":{\"okta.client.user_agent.raw_user_agent\":\"PAN GlobalProtect.*\"}},{\"regexp\":{\"okta.client.user_agent.raw_user_agent\":\"Jamf%20Connect.*\"}},{\"regexp\":{\"okta.client.user_agent.raw_user_agent\":\"okta-auth-dotnet-.*\"}},{\"regexp\":{\"okta.client.user_agent.raw_user_agent\":\"SecurityAgentHelper.*\"}}],\"minimum_should_match\":1}}","key":"query"},"query":{"bool":{"should":[{"match_phrase":{"okta.client.user_agent.raw_user_agent":"unknown"}},{"regexp":{"okta.client.user_agent.raw_user_agent":"Microsoft Office.*"}},{"regexp":{"okta.client.user_agent.raw_user_agent":"AppleExchangeWebServices.*"}},{"regexp":{"okta.client.user_agent.raw_user_agent":"Android-Mail.*"}},{"regexp":{"okta.client.user_agent.raw_user_agent":".*CalendarAgent.*"}},{"match_phrase":{"okta.client.user_agent.raw_user_agent":"Windows-AzureAD-Authentication-Provider/1.0"}},{"regexp":{"okta.client.user_agent.raw_user_agent":"Okta Radius Agent.*"}},{"regexp":{"okta.client.user_agent.raw_user_agent":"PAN GlobalProtect.*"}},{"regexp":{"okta.client.user_agent.raw_user_agent":"Jamf%20Connect.*"}},{"regexp":{"okta.client.user_agent.raw_user_agent":"okta-auth-dotnet-.*"}},{"regexp":{"okta.client.user_agent.raw_user_agent":"SecurityAgentHelper.*"}}],"minimum_should_match":1}}},{"$state":{"store":"appState"},"meta":{"field":"client.ip","negate":true,"alias":null,"disabled":false,"params":{"lt":"132.148.54.255","gte":"132.148.54.1"},"type":"range","key":"client.ip"},"query":{"range":{"client.ip":{"lt":"132.148.54.255","gte":"132.148.54.1"}}}},{"$state":{"store":"appState"},"meta":{"field":"client.ip","negate":true,"alias":null,"disabled":false,"params":{"lt":"64.202.160.255","gte":"64.202.160.1"},"type":"range","key":"client.ip"},"query":{"range":{"client.ip":{"lt":"64.202.160.255","gte":"64.202.160.1"}}}},{"$state":{"store":"appState"},"meta":{"negate":true,"alias":null,"disabled":false,"type":"phrases","params":["50.116.41.217","198.58.111.80","192.81.129.227","139.162.220.143"],"key":"client.ip"},"query":{"bool":{"should":[{"match_phrase":{"client.ip":"50.116.41.217"}},{"match_phrase":{"client.ip":"198.58.111.80"}},{"match_phrase":{"client.ip":"192.81.129.227"}},{"match_phrase":{"client.ip":"139.162.220.143"}}],"minimum_should_match":1}}}],"threshold":{"field":["client.ip"],"value":3,"cardinality":[{"field":"okta.client.user_agent.raw_user_agent","value":2}]},"throttle":"rule","actions":[{"group":"default","id":"56fd1b40-5f85-11ec-9d1e-5b56ec0d9762","params":{"body":"{\n  \"short_description\": \"Elastic Test - Okta - Brute Force - more than 1 useragent and more than 2 source IPs\",\n  \"assignment_group\": \"OPS-GCSO\",\n  \"category\": \"Unauthorized access\",\n  \"contact_type\": \"siem\",\n  \"description\": \"See attached info: (currently in-progress)\\n{{#context.alerts}}\\n{{#signal.threshold_result.terms}}\\nclient.ip: {{value}}\\n{{/signal.threshold_result.terms}}\\nLink to search: {{context.results_link}}\\n{{/context.alerts}}\",\n  \"priority\": \"5\",\n  \"severity\": \"3\",\n  \"state\": \"10\"\n}"},"action_type_id":".webhook"},{"group":"default","id":"elastic-cloud-email","params":{"subject":"Elastic Alert: {{context.rule.name}}","to":["twhipple1@godaddy.com"],"message":"The alert condition for '{{context.rule.name}}' was triggered.\n\nLink to results: {{context.results_link}}"},"action_type_id":".email"}]}
{"id":"bd7b6050-aef6-11ec-b058-3bdfa1ca61dc","updated_at":"2022-04-04T17:11:59.362Z","updated_by":"jprentice1@godaddy.com","created_at":"2022-03-29T00:25:31.155Z","created_by":"jprentice1@godaddy.com","name":"Connector Alerting - SNOW SIR Webhook Failures","tags":["godaddy","alerting"],"interval":"1m","enabled":true,"description":"This rule notifies all relevant teams when the SNOW SIR POST Webhook connector has failed to create a ticket for an alert.","risk_score":99,"severity":"critical","license":"","output_index":".siem-signals-default","meta":{"from":"10m","kibana_siem_app_url":"https://security-prod.kibana.int.gdcorp.tools/app/security"},"author":[],"false_positives":[],"from":"now-660s","rule_id":"d16eb402-4350-468f-8b95-e8b178bccd10","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[],"to":"now","references":[],"version":9,"exceptions_list":[],"immutable":false,"type":"query","language":"kuery","index":[".kibana-event-log-*"],"query":"message : *SNOW Prod SIR POST Webhook","filters":[{"$state":{"store":"appState"},"meta":{"negate":false,"alias":null,"disabled":false,"type":"phrase","params":{"query":"failure"},"key":"event.outcome"},"query":{"match_phrase":{"event.outcome":"failure"}}},{"$state":{"store":"appState"},"meta":{"negate":false,"alias":null,"disabled":false,"type":"phrase","params":{"query":"actions"},"key":"event.provider"},"query":{"match_phrase":{"event.provider":"actions"}}}],"throttle":"rule","actions":[{"group":"default","id":"elastic-cloud-email","params":{"subject":"{{context.rule.name}}","to":["productsecurity@godaddy.com","clopez1@godaddy.com","IR@godaddy.com","gcso@godaddy.com"],"message":"{{context.rule.name}}\n\n---\n\nThe SNOW SIR Webhook has failed to run {{state.signals_count}} time(s).\n\nPlease see the following details for the event(s):\n\n{{#context.alerts}}\n@timestamp: {{signal.original_time}}\n\nmessage: {{message}\n\nerror.message: {{error.message}}\n\n{{/context.alerts}}\n---\n\nLink to results dashboard: https://security-prod.kibana.int.gdcorp.tools/app/dashboards#/view/e81c47a0-b209-11ec-b59d-e77f2674f157?_g=(filters%3A!()%2CrefreshInterval%3A(pause%3A!t%2Cvalue%3A0)%2Ctime%3A(from%3Anow-7d%2Fd%2Cto%3Anow))"},"action_type_id":".email"},{"group":"default","id":"3d244760-9a7d-11ec-b095-87bc28af8de9","params":{"message":":alert_red: {{context.rule.name}} :alert_red:\n\nThe *SNOW SIR Webhook* has failed to run *{{state.signals_count}}* time(s).\n\nPlease see the following details for the event(s):\n\n{{#context.alerts}}\n```\n@timestamp: {{signal.original_time}}\n\nmessage: {{message}\n\nerror.message: {{error.message}}\n\n```\n{{/context.alerts}}\n\nLink to results dashboard: https://security-prod.kibana.int.gdcorp.tools/app/dashboards#/view/e81c47a0-b209-11ec-b59d-e77f2674f157?_g=(filters%3A!()%2CrefreshInterval%3A(pause%3A!t%2Cvalue%3A0)%2Ctime%3A(from%3Anow-7d%2Fd%2Cto%3Anow))"},"action_type_id":".slack"}]}
{"id":"c3731840-3282-11ec-a2aa-e9d655de077e","updated_at":"2022-03-03T23:14:48.008Z","updated_by":"schoi@godaddy.com","created_at":"2021-10-21T15:22:55.803Z","created_by":"admin","name":"[GD]Okta - Potentially Successful Password Spray","tags":[],"interval":"10m","enabled":true,"description":"This rule matches the latest successful login against users who recently failed 10 or more login attempts.","risk_score":47,"severity":"medium","license":"","output_index":".siem-signals-default","meta":{"from":"5m","kibana_siem_app_url":"https://security-prod.kibana.int.gdcorp.tools/app/security"},"author":[],"false_positives":[],"from":"now-900s","rule_id":"f60b4b54-7127-4863-adfb-95513ec44d79","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","technique":[{"reference":"https://attack.mitre.org/techniques/T1110","name":"Brute Force","subtechnique":[],"id":"T1110"}],"tactic":{"reference":"https://attack.mitre.org/tactics/TA0006","name":"Credential Access","id":"TA0006"}}],"to":"now","references":[],"version":6,"exceptions_list":[],"immutable":false,"type":"threat_match","language":"kuery","index":["*:okta-*"],"query":"event.outcome: \"success\" ","filters":[],"threat_filters":[{"$state":{"store":"appState"},"meta":{"negate":false,"alias":null,"disabled":false,"type":"range","params":{"lt":"now/d","gte":"now-1d/d"},"key":"timestamp"},"query":{"range":{"timestamp":{"lt":"now/d","gte":"now-1d/d"}}}}],"threat_query":"signal.rule.rule_id: \"d63a8353-5a37-437a-b0ac-5bbfefa2498c\"","threat_mapping":[{"entries":[{"field":"okta.actor.alternate_id","type":"mapping","value":"signal.threshold_result.terms.value"}]}],"threat_language":"kuery","threat_index":[".siem-signals-default"],"threat_indicator_path":"","throttle":"rule","actions":[{"group":"default","id":"56fd1b40-5f85-11ec-9d1e-5b56ec0d9762","params":{"body":"{\n  \"short_description\": \"Okta - Potentially Successful Password Spray\",\n  \"assignment_group\": \"ENG-Product Security\",\n  \"category\": \"Unauthorized access\",\n  \"contact_type\": \"siem\",\n  \"description\": \"{{#context.alerts}}\\n  {{okta.actor.alternate_id}} may be the victim of a password spray attack.\\n  {{/context.alerts}}\\n See https://confluence.godaddy.com/display/IRKB/IRT+-+Okta+-+Potentially+Successful+Password+Spray for more information\",\n  \"priority\": \"5\",\n  \"severity\": \"3\",\n  \"state\": \"10\"\n}"},"action_type_id":".webhook"}]}
{"id":"1794cff0-b202-11ec-b058-3bdfa1ca61dc","updated_at":"2022-04-04T17:11:21.281Z","updated_by":"jprentice1@godaddy.com","created_at":"2022-04-01T21:24:19.759Z","created_by":"jprentice1@godaddy.com","name":"Connector Alerting - Slack Connector Failures","tags":["godaddy","alerting"],"interval":"1m","enabled":true,"description":"This rule notifies all relevant teams when Slack connectors have failed to send messages for alerts.","risk_score":99,"severity":"critical","license":"","output_index":".siem-signals-default","meta":{"from":"10m","kibana_siem_app_url":"https://security-prod.kibana.int.gdcorp.tools/app/security"},"author":[],"false_positives":[],"from":"now-660s","rule_id":"f2d4676c-400b-40ec-8de0-531a1f646482","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[],"to":"now","references":[],"version":8,"exceptions_list":[],"immutable":false,"type":"query","language":"kuery","index":[".kibana-event-log-*"],"query":"message : *Slack*","filters":[{"$state":{"store":"appState"},"meta":{"negate":false,"alias":null,"disabled":false,"type":"phrase","params":{"query":"failure"},"key":"event.outcome"},"query":{"match_phrase":{"event.outcome":"failure"}}},{"$state":{"store":"appState"},"meta":{"negate":false,"alias":null,"disabled":false,"type":"phrase","params":{"query":"actions"},"key":"event.provider"},"query":{"match_phrase":{"event.provider":"actions"}}}],"throttle":"rule","actions":[{"group":"default","id":"elastic-cloud-email","params":{"subject":"{{context.rule.name}}","to":["productsecurity@godaddy.com","clopez1@godaddy.com","IR@godaddy.com","gcso@godaddy.com"],"message":"{{context.rule.name}}\n\n---\n\nSlack Connector failures have been found {{state.signals_count}} time(s).\n\nPlease see the following details for the event(s):\n\n{{#context.alerts}}\n@timestamp: {{signal.original_time}}\n\nmessage: {{message}\n\nerror.message: {{error.message}}\n\n{{/context.alerts}}\n---\n\nLink to results dashboard: https://security-prod.kibana.int.gdcorp.tools/app/dashboards#/view/e81c47a0-b209-11ec-b59d-e77f2674f157?_g=(filters%3A!()%2CrefreshInterval%3A(pause%3A!t%2Cvalue%3A0)%2Ctime%3A(from%3Anow-7d%2Fd%2Cto%3Anow))"},"action_type_id":".email"}]}
{"id":"4287d4a0-90d3-11ec-b59d-e77f2674f157","updated_at":"2022-03-21T22:28:00.114Z","updated_by":"jprentice1@godaddy.com","created_at":"2022-02-18T15:55:58.052Z","created_by":"admin","name":"Suspicious AWS S3 Events","tags":["GD","Security"],"interval":"1h","enabled":true,"description":"based on splunk Suspicious AWS S3 Events rule logic. no hits searching over 7 days of historical data","risk_score":21,"severity":"low","license":"","output_index":".siem-signals-default","meta":{"from":"10m","kibana_siem_app_url":"https://security-prod.kibana.int.gdcorp.tools/app/security"},"author":[],"false_positives":[],"from":"now-4200s","rule_id":"9de0f03f-daa6-409a-abef-1764d6a91290","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[],"to":"now","references":[],"version":8,"exceptions_list":[],"immutable":false,"type":"query","language":"kuery","index":["*:aws-cloudtrail-*"],"query":"NOT ((aws.cloudtrail.user_identity.arn: arn\\:aws\\:iam\\:\\:*\\:user/GD-user-tanium-threat-response AND event.type: UploadPart*) OR (aws.cloudtrail.user_identity.arn: arn\\:aws\\:sts\\:\\:*\\:assumed-role/ServiceCatalogLaunchConstraintRole/servicecatalog AND source.address: \"AWS Internal\") OR (aws.cloudtrail.user_identity.arn: arn\\:aws\\:sts\\:\\:*\\:assumed-role/SC-*-BucketReplicationRole-*/s3-replication AND user.id: *\\:s3-replication AND source.address: \"AWS Internal\"))","filters":[{"$state":{"store":"appState"},"meta":{"negate":false,"alias":null,"disabled":false,"type":"phrases","params":["539225272086","763338924548","745293682974"],"key":"cloud.account.id"},"query":{"bool":{"should":[{"match_phrase":{"cloud.account.id":"539225272086"}},{"match_phrase":{"cloud.account.id":"763338924548"}},{"match_phrase":{"cloud.account.id":"745293682974"}}],"minimum_should_match":1}}},{"$state":{"store":"appState"},"meta":{"negate":false,"alias":null,"disabled":false,"type":"custom","value":"{\"bool\":{\"should\":[{\"wildcard\":{\"aws.cloudtrail.request_parameters\":{\"value\":\"*bucketName=gd-respstorag-*-forensic-storage*\"}}},{\"wildcard\":{\"aws.cloudtrail.request_parameters\":{\"value\":\"*bucketName=gd-respstorag-*-forensic-storage-replica*\"}}}],\"minimum_should_match\":1}}","key":"query"},"query":{"bool":{"should":[{"wildcard":{"aws.cloudtrail.request_parameters":{"value":"*bucketName=gd-respstorag-*-forensic-storage*"}}},{"wildcard":{"aws.cloudtrail.request_parameters":{"value":"*bucketName=gd-respstorag-*-forensic-storage-replica*"}}}],"minimum_should_match":1}}},{"$state":{"store":"appState"},"meta":{"negate":false,"alias":null,"disabled":false,"type":"custom","value":"{\"bool\":{\"should\":[{\"wildcard\":{\"event.action\":{\"value\":\"DeleteBucketPolicy\"}}},{\"wildcard\":{\"event.action\":{\"value\":\"DeleteBucket\"}}},{\"wildcard\":{\"event.action\":{\"value\":\"CreateBucketPolicy\"}}},{\"wildcard\":{\"event.action\":{\"value\":\"CreateBucket\"}}},{\"wildcard\":{\"event.action\":{\"value\":\"GetObject\"}}},{\"wildcard\":{\"event.action\":{\"value\":\"DeleteObjects\"}}},{\"wildcard\":{\"event.action\":{\"value\":\"PutObject*\"}}},{\"wildcard\":{\"event.action\":{\"value\":\"UploadPart*\"}}}],\"minimum_should_match\":1}}","key":"query"},"query":{"bool":{"should":[{"wildcard":{"event.action":{"value":"DeleteBucketPolicy"}}},{"wildcard":{"event.action":{"value":"DeleteBucket"}}},{"wildcard":{"event.action":{"value":"CreateBucketPolicy"}}},{"wildcard":{"event.action":{"value":"CreateBucket"}}},{"wildcard":{"event.action":{"value":"GetObject"}}},{"wildcard":{"event.action":{"value":"DeleteObjects"}}},{"wildcard":{"event.action":{"value":"PutObject*"}}},{"wildcard":{"event.action":{"value":"UploadPart*"}}}],"minimum_should_match":1}}}],"throttle":"rule","actions":[{"group":"default","id":"56fd1b40-5f85-11ec-9d1e-5b56ec0d9762","params":{"body":"{\n  \"short_description\": \"Suspicious AWS S3 Events (Storage Account)\",\n  \"assignment_group\": \"OPS-GCSO\",\n  \"category\": \"Unauthorized access\",\n  \"contact_type\": \"siem\",\n  \"description\": \"See following Info:\\nSuspicious AWS S3 Events (Storage Account)\\n\\n{{#context.alerts}}\\nStatus: {{Status}}\\nEnvironment: {{environment}}\\nAccount ID: {{cloud.account.id}}\\nUserType: {{aws.cloudtrail.user_identity.type}}\\nUser/Role: {{user.name}}\\nPrincipal ID: {{user.id}}\\nEvent: {{event.action}}\\nObject: {{aws.s3.object.key}}\\nsource.address: {{source.address}}\\n{{/context.alerts}}\\n\\nSee Process Here:\\nhttps://confluence.godaddy.com/pages/viewpage.action?pageId=214401824\",\n  \"priority\": \"1\",\n  \"severity\": \"2\",\n  \"state\": \"10\"\n}"},"action_type_id":".webhook"}]}
{"id":"579f1490-2b64-11ec-a2aa-e9d655de077e","updated_at":"2022-03-21T22:35:05.197Z","updated_by":"jprentice1@godaddy.com","created_at":"2021-10-12T13:57:31.821Z","created_by":"admin","name":"[GD] Response-Okta Factor Resets","tags":[],"interval":"1h","enabled":true,"description":"Alert for the GCSO and Response teams based on Okta factor resets.","risk_score":21,"severity":"low","license":"","output_index":".siem-signals-default","meta":{"from":"25h","kibana_siem_app_url":"https://security-prod.kibana.int.gdcorp.tools/app/security"},"author":[],"false_positives":[],"from":"now-93600s","rule_id":"d1959e8a-79a4-4f7e-88e2-ed6fd23d0935","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[],"to":"now","references":[],"version":40,"exceptions_list":[],"immutable":false,"type":"threshold","language":"kuery","index":["*:okta-*"],"query":"okta.actor.id:* and user.target.id:*","filters":[{"$state":{"store":"appState"},"meta":{"negate":false,"alias":null,"disabled":false,"type":"custom","value":"{\"bool\":{\"must_not\":{\"terms\":{\"okta.actor.alternate_id\":[\"02d769kuqxc6A@godaddy.com\",\"02d769kuqxc6B@godaddy.com\",\"02d769kuqxc6A@jomax.paholdings.com\",\"02d769kuqxc6B@jomax.paholdings.com\"]}}}}","key":"query"},"query":{"bool":{"must_not":{"terms":{"okta.actor.alternate_id":["02d769kuqxc6A@godaddy.com","02d769kuqxc6B@godaddy.com","02d769kuqxc6A@jomax.paholdings.com","02d769kuqxc6B@jomax.paholdings.com"]}}}}},{"$state":{"store":"appState"},"meta":{"negate":true,"alias":null,"disabled":false,"type":"custom","value":"{\"script\":{\"script\":\"doc['okta.actor.id'].value == doc['user.target.id'].value\"}}","key":"query"},"query":{"script":{"script":"doc['okta.actor.id'].value == doc['user.target.id'].value"}}},{"$state":{"store":"appState"},"meta":{"negate":false,"alias":null,"disabled":false,"type":"custom","value":"{\"regexp\":{\"okta.display_message\":\"Reset.*\"}}","key":"query"},"query":{"regexp":{"okta.display_message":"Reset.*"}}}],"threshold":{"field":["okta.actor.alternate_id"],"value":3,"cardinality":[]},"throttle":"rule","actions":[{"group":"default","id":"56fd1b40-5f85-11ec-9d1e-5b56ec0d9762","params":{"body":"{\n  \"short_description\": \"Okta Factor Resets Threshold Reached\",\n  \"assignment_group\": \"OPS-GCSO\",\n  \"category\": \"Unauthorized access\",\n  \"contact_type\": \"siem\",\n  \"description\": \"See following Info: \\n{{#context.alerts}}\\n{{#signal.threshold_result.terms}}\\nElastic logs indicate {{value}} has reset another users factor more than twice in the last 24 hours. Please investigate using the following saved Elastic search.\\n{{/signal.threshold_result.terms}}\\nhttps://security-prod.kibana.int.gdcorp.tools/app/discover#/view/1ec16b20-99b7-11ec-ab18-0d51419cd75c?_g=(filters%3A!()%2CrefreshInterval%3A(pause%3A!t%2Cvalue%3A0)%2Ctime%3A(from%3Anow-24h%2Fh%2Cto%3Anow))\\n\\n{{/context.alerts}}\",\n  \"priority\": \"2\",\n  \"severity\": \"2\",\n  \"state\": \"10\"\n}"},"action_type_id":".webhook"}]}
{"_version":"WzEyODkwOTksOV0=","created_at":"2022-03-28T23:54:52.004Z","created_by":"jprentice1@godaddy.com","description":"Alerts on any login from China except whitelisted users","id":"759aca40-aef2-11ec-b59d-e77f2674f157","immutable":false,"list_id":"9c5fe742-9059-4a67-8b9c-6e40c3909187","name":"VPN Logins from China","namespace_type":"single","os_types":[],"tags":[],"tie_breaker_id":"c621fe1f-7479-4a27-b95b-a1267969c187","type":"detection","updated_at":"2022-03-28T23:54:52.016Z","updated_by":"jprentice1@godaddy.com","version":1}
{"_version":"WzEyOTMzNzEsOV0=","comments":[{"created_at":"2022-03-30T21:58:04.097Z","comment":"The users in this filter have been granted an exception to work and VPN from China.\n","id":"0f778c9c-0514-4d3d-a7f9-a72f8777f873","created_by":"clopez1@godaddy.com"}],"created_at":"2022-03-30T21:57:47.732Z","created_by":"clopez1@godaddy.com","description":"VPN Logins from China - exception list item","entries":[{"field":"okta.actor.alternate_id","type":"match_any","value":["ifan@godaddy.com","swang2@godaddy.com"],"operator":"included"}],"id":"6fa37140-b074-11ec-b058-3bdfa1ca61dc","item_id":"70c10e0c-ce26-4fb3-bfd9-8eebb7971285","list_id":"9c5fe742-9059-4a67-8b9c-6e40c3909187","name":"VPN Logins from China - exception list item","namespace_type":"single","os_types":[],"tags":[],"tie_breaker_id":"68c4c803-4aa2-4c55-a41a-0450dc44a88c","type":"simple","updated_at":"2022-03-30T21:58:04.103Z","updated_by":"clopez1@godaddy.com"}
{"_version":"WzEyOTEwOTksOV0=","comments":[{"created_at":"2022-03-30T21:49:50.700Z","comment":"The users in this filter have been granted an exception to work and VPN from Russia.","id":"5ea09b36-1f57-4643-9bd4-848634324ef0","created_by":"clopez1@godaddy.com"}],"created_at":"2022-03-30T21:34:25.765Z","created_by":"clopez1@godaddy.com","description":"VPN Logins from Russia - exception list item","entries":[{"field":"okta.actor.alternate_id","type":"match_any","value":["atelyshev@godaddy.com","afeskoff@godaddy.com","abuziuma@godaddy.com","afralou@godaddy.com","akravchyna@godaddy.com","arurak@godaddy.com","aruzhytskyi@godaddy.com","asemitkin@godaddy.com","aplevachenka@godaddy.com","akukhnavets@godaddy.com","amkrtychian@godaddy.com","c_dbarabash@godaddy.com","dnesterenko@godaddy.com","dzhezhera@godaddy.com","dkemenau@godaddy.com","emoiseev@godaddy.com","hmiahkov@godaddy.com","ibanadiga@godaddy.com","icherhavyy@godaddy.com","iyushko@godaddy.com","mtaparenka@godaddy.com","mmelnyk@godaddy.com","mshamanov@godaddy.com","mnazar@godaddy.com","mbezmen@godaddy.com","milyash@godaddy.com","mprokopovych@godaddy.com","npetrash@godaddy.com","oshvets@godaddy.com","oborodavka@godaddy.com","obrystrikov@godaddy.com","ohryhorenko@godaddy.com","okuklin@godaddy.com","omarkusyk@godaddy.com","opatsiuk@godaddy.com","opopov@godaddy.com","ohonska@godaddy.com","odubrova@godaddy.com","pmalafei@godaddy.com","rperesoliak@godaddy.com","rpikaliuk@godaddy.com","rpryimak@godaddy.com","schernik@godaddy.com","skryhin@godaddy.com","svysotskyi@godaddy.com","skulish@godaddy.com","tbodlak@godaddy.com","tkravchenko1@godaddy.com","vkomyslyvyi@godaddy.com","vyurchenko@godaddy.com","vdadeka@godaddy.com","vbokhan@godaddy.com","vosaulenko@godaddy.com","vapukhtin@godaddy.com","vpohribnichenko@godaddy.com","ylaurynovich@godaddy.com","yserdobolskyi@godaddy.com","aovdiienko@godaddy.com","ylukovnikov@godaddy.com"],"operator":"included"}],"id":"2c004150-b071-11ec-8d7e-45182ce7df0f","item_id":"3cad4704-d142-40c9-aadb-d5651674c0e7","list_id":"9c5fe742-9059-4a67-8b9c-6e40c3909187","name":"VPN Logins from Russia - exception list item","namespace_type":"single","os_types":[],"tags":[],"tie_breaker_id":"8048a41d-54df-4c53-80cb-ad54ff2786d9","type":"simple","updated_at":"2022-03-30T21:49:50.708Z","updated_by":"clopez1@godaddy.com"}
{"exported_count":319,"exported_rules_count":316,"missing_rules":[],"missing_rules_count":0,"exported_exception_list_count":1,"exported_exception_list_item_count":2,"missing_exception_list_item_count":0,"missing_exception_list_items":[],"missing_exception_lists":[],"missing_exception_lists_count":0}